var j6=Object.defineProperty;var WT=e=>{throw TypeError(e)};var M6=(e,t,n)=>t in e?j6(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var z=(e,t,n)=>M6(e,typeof t!="symbol"?t+"":t,n),by=(e,t,n)=>t.has(e)||WT("Cannot "+n);var B=(e,t,n)=>(by(e,t,"read from private field"),n?n.call(e):t.get(e)),Oe=(e,t,n)=>t.has(e)?WT("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),Ce=(e,t,n,r)=>(by(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),it=(e,t,n)=>(by(e,t,"access private method"),n);var Zf=(e,t,n,r)=>({set _(s){Ce(e,t,s,n)},get _(){return B(e,t,r)}});function ER(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in e)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var Eu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function of(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var _R={exports:{}},Vg={},PR={exports:{}},ut={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lf=Symbol.for("react.element"),D6=Symbol.for("react.portal"),O6=Symbol.for("react.fragment"),L6=Symbol.for("react.strict_mode"),F6=Symbol.for("react.profiler"),$6=Symbol.for("react.provider"),U6=Symbol.for("react.context"),V6=Symbol.for("react.forward_ref"),B6=Symbol.for("react.suspense"),z6=Symbol.for("react.memo"),G6=Symbol.for("react.lazy"),HT=Symbol.iterator;function W6(e){return e===null||typeof e!="object"?null:(e=HT&&e[HT]||e["@@iterator"],typeof e=="function"?e:null)}var NR={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},IR=Object.assign,AR={};function Ld(e,t,n){this.props=e,this.context=t,this.refs=AR,this.updater=n||NR}Ld.prototype.isReactComponent={};Ld.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ld.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function RR(){}RR.prototype=Ld.prototype;function wS(e,t,n){this.props=e,this.context=t,this.refs=AR,this.updater=n||NR}var SS=wS.prototype=new RR;SS.constructor=wS;IR(SS,Ld.prototype);SS.isPureReactComponent=!0;var qT=Array.isArray,jR=Object.prototype.hasOwnProperty,kS={current:null},MR={key:!0,ref:!0,__self:!0,__source:!0};function DR(e,t,n){var r,s={},i=null,o=null;if(t!=null)for(r in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)jR.call(t,r)&&!MR.hasOwnProperty(r)&&(s[r]=t[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];s.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:lf,type:e,key:i,ref:o,props:s,_owner:kS.current}}function H6(e,t){return{$$typeof:lf,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function TS(e){return typeof e=="object"&&e!==null&&e.$$typeof===lf}function q6(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var KT=/\/+/g;function wy(e,t){return typeof e=="object"&&e!==null&&e.key!=null?q6(""+e.key):t.toString(36)}function jp(e,t,n,r,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case lf:case D6:o=!0}}if(o)return o=e,s=s(o),e=r===""?"."+wy(o,0):r,qT(s)?(n="",e!=null&&(n=e.replace(KT,"$&/")+"/"),jp(s,t,n,"",function(d){return d})):s!=null&&(TS(s)&&(s=H6(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(KT,"$&/")+"/")+e)),t.push(s)),1;if(o=0,r=r===""?".":r+":",qT(e))for(var l=0;l<e.length;l++){i=e[l];var c=r+wy(i,l);o+=jp(i,t,n,c,s)}else if(c=W6(e),typeof c=="function")for(e=c.call(e),l=0;!(i=e.next()).done;)i=i.value,c=r+wy(i,l++),o+=jp(i,t,n,c,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function ep(e,t,n){if(e==null)return e;var r=[],s=0;return jp(e,r,"","",function(i){return t.call(n,i,s++)}),r}function K6(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var jr={current:null},Mp={transition:null},Q6={ReactCurrentDispatcher:jr,ReactCurrentBatchConfig:Mp,ReactCurrentOwner:kS};function OR(){throw Error("act(...) is not supported in production builds of React.")}ut.Children={map:ep,forEach:function(e,t,n){ep(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return ep(e,function(){t++}),t},toArray:function(e){return ep(e,function(t){return t})||[]},only:function(e){if(!TS(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ut.Component=Ld;ut.Fragment=O6;ut.Profiler=F6;ut.PureComponent=wS;ut.StrictMode=L6;ut.Suspense=B6;ut.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Q6;ut.act=OR;ut.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=IR({},e.props),s=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=kS.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)jR.call(t,c)&&!MR.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:lf,type:e.type,key:s,ref:i,props:r,_owner:o}};ut.createContext=function(e){return e={$$typeof:U6,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:$6,_context:e},e.Consumer=e};ut.createElement=DR;ut.createFactory=function(e){var t=DR.bind(null,e);return t.type=e,t};ut.createRef=function(){return{current:null}};ut.forwardRef=function(e){return{$$typeof:V6,render:e}};ut.isValidElement=TS;ut.lazy=function(e){return{$$typeof:G6,_payload:{_status:-1,_result:e},_init:K6}};ut.memo=function(e,t){return{$$typeof:z6,type:e,compare:t===void 0?null:t}};ut.startTransition=function(e){var t=Mp.transition;Mp.transition={};try{e()}finally{Mp.transition=t}};ut.unstable_act=OR;ut.useCallback=function(e,t){return jr.current.useCallback(e,t)};ut.useContext=function(e){return jr.current.useContext(e)};ut.useDebugValue=function(){};ut.useDeferredValue=function(e){return jr.current.useDeferredValue(e)};ut.useEffect=function(e,t){return jr.current.useEffect(e,t)};ut.useId=function(){return jr.current.useId()};ut.useImperativeHandle=function(e,t,n){return jr.current.useImperativeHandle(e,t,n)};ut.useInsertionEffect=function(e,t){return jr.current.useInsertionEffect(e,t)};ut.useLayoutEffect=function(e,t){return jr.current.useLayoutEffect(e,t)};ut.useMemo=function(e,t){return jr.current.useMemo(e,t)};ut.useReducer=function(e,t,n){return jr.current.useReducer(e,t,n)};ut.useRef=function(e){return jr.current.useRef(e)};ut.useState=function(e){return jr.current.useState(e)};ut.useSyncExternalStore=function(e,t,n){return jr.current.useSyncExternalStore(e,t,n)};ut.useTransition=function(){return jr.current.useTransition()};ut.version="18.3.1";PR.exports=ut;var p=PR.exports;const xe=of(p),Bg=ER({__proto__:null,default:xe},[p]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var J6=p,Y6=Symbol.for("react.element"),X6=Symbol.for("react.fragment"),Z6=Object.prototype.hasOwnProperty,ez=J6.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,tz={key:!0,ref:!0,__self:!0,__source:!0};function LR(e,t,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)Z6.call(t,r)&&!tz.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)s[r]===void 0&&(s[r]=t[r]);return{$$typeof:Y6,type:e,key:i,ref:o,props:s,_owner:ez.current}}Vg.Fragment=X6;Vg.jsx=LR;Vg.jsxs=LR;_R.exports=Vg;var a=_R.exports,FR={exports:{}},hs={},$R={exports:{}},UR={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(k,E){var M=k.length;k.push(E);e:for(;0<M;){var A=M-1>>>1,F=k[A];if(0<s(F,E))k[A]=E,k[M]=F,M=A;else break e}}function n(k){return k.length===0?null:k[0]}function r(k){if(k.length===0)return null;var E=k[0],M=k.pop();if(M!==E){k[0]=M;e:for(var A=0,F=k.length,q=F>>>1;A<q;){var P=2*(A+1)-1,j=k[P],$=P+1,W=k[$];if(0>s(j,M))$<F&&0>s(W,j)?(k[A]=W,k[$]=M,A=$):(k[A]=j,k[P]=M,A=P);else if($<F&&0>s(W,M))k[A]=W,k[$]=M,A=$;else break e}}return E}function s(k,E){var M=k.sortIndex-E.sortIndex;return M!==0?M:k.id-E.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],d=[],u=1,h=null,f=3,m=!1,g=!1,v=!1,x=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(k){for(var E=n(d);E!==null;){if(E.callback===null)r(d);else if(E.startTime<=k)r(d),E.sortIndex=E.expirationTime,t(c,E);else break;E=n(d)}}function w(k){if(v=!1,b(k),!g)if(n(c)!==null)g=!0,V(C);else{var E=n(d);E!==null&&te(w,E.startTime-k)}}function C(k,E){g=!1,v&&(v=!1,S(L),L=-1),m=!0;var M=f;try{for(b(E),h=n(c);h!==null&&(!(h.expirationTime>E)||k&&!G());){var A=h.callback;if(typeof A=="function"){h.callback=null,f=h.priorityLevel;var F=A(h.expirationTime<=E);E=e.unstable_now(),typeof F=="function"?h.callback=F:h===n(c)&&r(c),b(E)}else r(c);h=n(c)}if(h!==null)var q=!0;else{var P=n(d);P!==null&&te(w,P.startTime-E),q=!1}return q}finally{h=null,f=M,m=!1}}var I=!1,R=null,L=-1,N=5,O=-1;function G(){return!(e.unstable_now()-O<N)}function H(){if(R!==null){var k=e.unstable_now();O=k;var E=!0;try{E=R(!0,k)}finally{E?re():(I=!1,R=null)}}else I=!1}var re;if(typeof y=="function")re=function(){y(H)};else if(typeof MessageChannel<"u"){var X=new MessageChannel,Q=X.port2;X.port1.onmessage=H,re=function(){Q.postMessage(null)}}else re=function(){x(H,0)};function V(k){R=k,I||(I=!0,re())}function te(k,E){L=x(function(){k(e.unstable_now())},E)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(k){k.callback=null},e.unstable_continueExecution=function(){g||m||(g=!0,V(C))},e.unstable_forceFrameRate=function(k){0>k||125<k?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<k?Math.floor(1e3/k):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(k){switch(f){case 1:case 2:case 3:var E=3;break;default:E=f}var M=f;f=E;try{return k()}finally{f=M}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(k,E){switch(k){case 1:case 2:case 3:case 4:case 5:break;default:k=3}var M=f;f=k;try{return E()}finally{f=M}},e.unstable_scheduleCallback=function(k,E,M){var A=e.unstable_now();switch(typeof M=="object"&&M!==null?(M=M.delay,M=typeof M=="number"&&0<M?A+M:A):M=A,k){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=M+F,k={id:u++,callback:E,priorityLevel:k,startTime:M,expirationTime:F,sortIndex:-1},M>A?(k.sortIndex=M,t(d,k),n(c)===null&&k===n(d)&&(v?(S(L),L=-1):v=!0,te(w,M-A))):(k.sortIndex=F,t(c,k),g||m||(g=!0,V(C))),k},e.unstable_shouldYield=G,e.unstable_wrapCallback=function(k){var E=f;return function(){var M=f;f=E;try{return k.apply(this,arguments)}finally{f=M}}}})(UR);$R.exports=UR;var nz=$R.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rz=p,cs=nz;function ye(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var VR=new Set,ah={};function ql(e,t){fd(e,t),fd(e+"Capture",t)}function fd(e,t){for(ah[e]=t,e=0;e<t.length;e++)VR.add(t[e])}var la=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Wx=Object.prototype.hasOwnProperty,sz=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,QT={},JT={};function iz(e){return Wx.call(JT,e)?!0:Wx.call(QT,e)?!1:sz.test(e)?JT[e]=!0:(QT[e]=!0,!1)}function az(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function oz(e,t,n,r){if(t===null||typeof t>"u"||az(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Mr(e,t,n,r,s,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var ir={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){ir[e]=new Mr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];ir[t]=new Mr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){ir[e]=new Mr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){ir[e]=new Mr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){ir[e]=new Mr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){ir[e]=new Mr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){ir[e]=new Mr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){ir[e]=new Mr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){ir[e]=new Mr(e,5,!1,e.toLowerCase(),null,!1,!1)});var CS=/[\-:]([a-z])/g;function ES(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(CS,ES);ir[t]=new Mr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(CS,ES);ir[t]=new Mr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(CS,ES);ir[t]=new Mr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){ir[e]=new Mr(e,1,!1,e.toLowerCase(),null,!1,!1)});ir.xlinkHref=new Mr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){ir[e]=new Mr(e,1,!1,e.toLowerCase(),null,!0,!0)});function _S(e,t,n,r){var s=ir.hasOwnProperty(t)?ir[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(oz(t,n,s,r)&&(n=null),r||s===null?iz(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var ba=rz.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,tp=Symbol.for("react.element"),fc=Symbol.for("react.portal"),pc=Symbol.for("react.fragment"),PS=Symbol.for("react.strict_mode"),Hx=Symbol.for("react.profiler"),BR=Symbol.for("react.provider"),zR=Symbol.for("react.context"),NS=Symbol.for("react.forward_ref"),qx=Symbol.for("react.suspense"),Kx=Symbol.for("react.suspense_list"),IS=Symbol.for("react.memo"),Oa=Symbol.for("react.lazy"),GR=Symbol.for("react.offscreen"),YT=Symbol.iterator;function ou(e){return e===null||typeof e!="object"?null:(e=YT&&e[YT]||e["@@iterator"],typeof e=="function"?e:null)}var Xt=Object.assign,Sy;function _u(e){if(Sy===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Sy=t&&t[1]||""}return`
`+Sy+e}var ky=!1;function Ty(e,t){if(!e||ky)return"";ky=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var r=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){r=d}e.call(t.prototype)}else{try{throw Error()}catch(d){r=d}e()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{ky=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?_u(e):""}function lz(e){switch(e.tag){case 5:return _u(e.type);case 16:return _u("Lazy");case 13:return _u("Suspense");case 19:return _u("SuspenseList");case 0:case 2:case 15:return e=Ty(e.type,!1),e;case 11:return e=Ty(e.type.render,!1),e;case 1:return e=Ty(e.type,!0),e;default:return""}}function Qx(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case pc:return"Fragment";case fc:return"Portal";case Hx:return"Profiler";case PS:return"StrictMode";case qx:return"Suspense";case Kx:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case zR:return(e.displayName||"Context")+".Consumer";case BR:return(e._context.displayName||"Context")+".Provider";case NS:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case IS:return t=e.displayName||null,t!==null?t:Qx(e.type)||"Memo";case Oa:t=e._payload,e=e._init;try{return Qx(e(t))}catch{}}return null}function cz(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qx(t);case 8:return t===PS?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function xo(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function WR(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function dz(e){var t=WR(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function np(e){e._valueTracker||(e._valueTracker=dz(e))}function HR(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=WR(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function wm(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Jx(e,t){var n=t.checked;return Xt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function XT(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=xo(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function qR(e,t){t=t.checked,t!=null&&_S(e,"checked",t,!1)}function Yx(e,t){qR(e,t);var n=xo(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Xx(e,t.type,n):t.hasOwnProperty("defaultValue")&&Xx(e,t.type,xo(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function ZT(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Xx(e,t,n){(t!=="number"||wm(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Pu=Array.isArray;function Ac(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+xo(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Zx(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ye(91));return Xt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function eC(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(ye(92));if(Pu(n)){if(1<n.length)throw Error(ye(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:xo(n)}}function KR(e,t){var n=xo(t.value),r=xo(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function tC(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function QR(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function eb(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?QR(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var rp,JR=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(rp=rp||document.createElement("div"),rp.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=rp.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function oh(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Vu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},uz=["Webkit","ms","Moz","O"];Object.keys(Vu).forEach(function(e){uz.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Vu[t]=Vu[e]})});function YR(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Vu.hasOwnProperty(e)&&Vu[e]?(""+t).trim():t+"px"}function XR(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=YR(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var hz=Xt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function tb(e,t){if(t){if(hz[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ye(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ye(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ye(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ye(62))}}function nb(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var rb=null;function AS(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var sb=null,Rc=null,jc=null;function nC(e){if(e=uf(e)){if(typeof sb!="function")throw Error(ye(280));var t=e.stateNode;t&&(t=qg(t),sb(e.stateNode,e.type,t))}}function ZR(e){Rc?jc?jc.push(e):jc=[e]:Rc=e}function ej(){if(Rc){var e=Rc,t=jc;if(jc=Rc=null,nC(e),t)for(e=0;e<t.length;e++)nC(t[e])}}function tj(e,t){return e(t)}function nj(){}var Cy=!1;function rj(e,t,n){if(Cy)return e(t,n);Cy=!0;try{return tj(e,t,n)}finally{Cy=!1,(Rc!==null||jc!==null)&&(nj(),ej())}}function lh(e,t){var n=e.stateNode;if(n===null)return null;var r=qg(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(ye(231,t,typeof n));return n}var ib=!1;if(la)try{var lu={};Object.defineProperty(lu,"passive",{get:function(){ib=!0}}),window.addEventListener("test",lu,lu),window.removeEventListener("test",lu,lu)}catch{ib=!1}function fz(e,t,n,r,s,i,o,l,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(n,d)}catch(u){this.onError(u)}}var Bu=!1,Sm=null,km=!1,ab=null,pz={onError:function(e){Bu=!0,Sm=e}};function mz(e,t,n,r,s,i,o,l,c){Bu=!1,Sm=null,fz.apply(pz,arguments)}function gz(e,t,n,r,s,i,o,l,c){if(mz.apply(this,arguments),Bu){if(Bu){var d=Sm;Bu=!1,Sm=null}else throw Error(ye(198));km||(km=!0,ab=d)}}function Kl(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function sj(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function rC(e){if(Kl(e)!==e)throw Error(ye(188))}function vz(e){var t=e.alternate;if(!t){if(t=Kl(e),t===null)throw Error(ye(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return rC(s),e;if(i===r)return rC(s),t;i=i.sibling}throw Error(ye(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(ye(189))}}if(n.alternate!==r)throw Error(ye(190))}if(n.tag!==3)throw Error(ye(188));return n.stateNode.current===n?e:t}function ij(e){return e=vz(e),e!==null?aj(e):null}function aj(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=aj(e);if(t!==null)return t;e=e.sibling}return null}var oj=cs.unstable_scheduleCallback,sC=cs.unstable_cancelCallback,yz=cs.unstable_shouldYield,xz=cs.unstable_requestPaint,un=cs.unstable_now,bz=cs.unstable_getCurrentPriorityLevel,RS=cs.unstable_ImmediatePriority,lj=cs.unstable_UserBlockingPriority,Tm=cs.unstable_NormalPriority,wz=cs.unstable_LowPriority,cj=cs.unstable_IdlePriority,zg=null,bi=null;function Sz(e){if(bi&&typeof bi.onCommitFiberRoot=="function")try{bi.onCommitFiberRoot(zg,e,void 0,(e.current.flags&128)===128)}catch{}}var Ys=Math.clz32?Math.clz32:Cz,kz=Math.log,Tz=Math.LN2;function Cz(e){return e>>>=0,e===0?32:31-(kz(e)/Tz|0)|0}var sp=64,ip=4194304;function Nu(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Cm(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,i=e.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=Nu(l):(i&=o,i!==0&&(r=Nu(i)))}else o=n&~s,o!==0?r=Nu(o):i!==0&&(r=Nu(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&s)&&(s=r&-r,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Ys(t),s=1<<n,r|=e[n],t&=~s;return r}function Ez(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _z(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-Ys(i),l=1<<o,c=s[o];c===-1?(!(l&n)||l&r)&&(s[o]=Ez(l,t)):c<=t&&(e.expiredLanes|=l),i&=~l}}function ob(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function dj(){var e=sp;return sp<<=1,!(sp&4194240)&&(sp=64),e}function Ey(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function cf(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ys(t),e[t]=n}function Pz(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-Ys(n),i=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~i}}function jS(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Ys(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var At=0;function uj(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var hj,MS,fj,pj,mj,lb=!1,ap=[],no=null,ro=null,so=null,ch=new Map,dh=new Map,Fa=[],Nz="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function iC(e,t){switch(e){case"focusin":case"focusout":no=null;break;case"dragenter":case"dragleave":ro=null;break;case"mouseover":case"mouseout":so=null;break;case"pointerover":case"pointerout":ch.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":dh.delete(t.pointerId)}}function cu(e,t,n,r,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},t!==null&&(t=uf(t),t!==null&&MS(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function Iz(e,t,n,r,s){switch(t){case"focusin":return no=cu(no,e,t,n,r,s),!0;case"dragenter":return ro=cu(ro,e,t,n,r,s),!0;case"mouseover":return so=cu(so,e,t,n,r,s),!0;case"pointerover":var i=s.pointerId;return ch.set(i,cu(ch.get(i)||null,e,t,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,dh.set(i,cu(dh.get(i)||null,e,t,n,r,s)),!0}return!1}function gj(e){var t=tl(e.target);if(t!==null){var n=Kl(t);if(n!==null){if(t=n.tag,t===13){if(t=sj(n),t!==null){e.blockedOn=t,mj(e.priority,function(){fj(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Dp(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=cb(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);rb=r,n.target.dispatchEvent(r),rb=null}else return t=uf(n),t!==null&&MS(t),e.blockedOn=n,!1;t.shift()}return!0}function aC(e,t,n){Dp(e)&&n.delete(t)}function Az(){lb=!1,no!==null&&Dp(no)&&(no=null),ro!==null&&Dp(ro)&&(ro=null),so!==null&&Dp(so)&&(so=null),ch.forEach(aC),dh.forEach(aC)}function du(e,t){e.blockedOn===t&&(e.blockedOn=null,lb||(lb=!0,cs.unstable_scheduleCallback(cs.unstable_NormalPriority,Az)))}function uh(e){function t(s){return du(s,e)}if(0<ap.length){du(ap[0],e);for(var n=1;n<ap.length;n++){var r=ap[n];r.blockedOn===e&&(r.blockedOn=null)}}for(no!==null&&du(no,e),ro!==null&&du(ro,e),so!==null&&du(so,e),ch.forEach(t),dh.forEach(t),n=0;n<Fa.length;n++)r=Fa[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Fa.length&&(n=Fa[0],n.blockedOn===null);)gj(n),n.blockedOn===null&&Fa.shift()}var Mc=ba.ReactCurrentBatchConfig,Em=!0;function Rz(e,t,n,r){var s=At,i=Mc.transition;Mc.transition=null;try{At=1,DS(e,t,n,r)}finally{At=s,Mc.transition=i}}function jz(e,t,n,r){var s=At,i=Mc.transition;Mc.transition=null;try{At=4,DS(e,t,n,r)}finally{At=s,Mc.transition=i}}function DS(e,t,n,r){if(Em){var s=cb(e,t,n,r);if(s===null)Oy(e,t,r,_m,n),iC(e,r);else if(Iz(s,e,t,n,r))r.stopPropagation();else if(iC(e,r),t&4&&-1<Nz.indexOf(e)){for(;s!==null;){var i=uf(s);if(i!==null&&hj(i),i=cb(e,t,n,r),i===null&&Oy(e,t,r,_m,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Oy(e,t,r,null,n)}}var _m=null;function cb(e,t,n,r){if(_m=null,e=AS(r),e=tl(e),e!==null)if(t=Kl(e),t===null)e=null;else if(n=t.tag,n===13){if(e=sj(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return _m=e,null}function vj(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(bz()){case RS:return 1;case lj:return 4;case Tm:case wz:return 16;case cj:return 536870912;default:return 16}default:return 16}}var Za=null,OS=null,Op=null;function yj(){if(Op)return Op;var e,t=OS,n=t.length,r,s="value"in Za?Za.value:Za.textContent,i=s.length;for(e=0;e<n&&t[e]===s[e];e++);var o=n-e;for(r=1;r<=o&&t[n-r]===s[i-r];r++);return Op=s.slice(e,1<r?1-r:void 0)}function Lp(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function op(){return!0}function oC(){return!1}function fs(e){function t(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(n=e[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?op:oC,this.isPropagationStopped=oC,this}return Xt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=op)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=op)},persist:function(){},isPersistent:op}),t}var Fd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},LS=fs(Fd),df=Xt({},Fd,{view:0,detail:0}),Mz=fs(df),_y,Py,uu,Gg=Xt({},df,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:FS,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==uu&&(uu&&e.type==="mousemove"?(_y=e.screenX-uu.screenX,Py=e.screenY-uu.screenY):Py=_y=0,uu=e),_y)},movementY:function(e){return"movementY"in e?e.movementY:Py}}),lC=fs(Gg),Dz=Xt({},Gg,{dataTransfer:0}),Oz=fs(Dz),Lz=Xt({},df,{relatedTarget:0}),Ny=fs(Lz),Fz=Xt({},Fd,{animationName:0,elapsedTime:0,pseudoElement:0}),$z=fs(Fz),Uz=Xt({},Fd,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Vz=fs(Uz),Bz=Xt({},Fd,{data:0}),cC=fs(Bz),zz={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Gz={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Wz={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Hz(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Wz[e])?!!t[e]:!1}function FS(){return Hz}var qz=Xt({},df,{key:function(e){if(e.key){var t=zz[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Lp(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Gz[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:FS,charCode:function(e){return e.type==="keypress"?Lp(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Lp(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Kz=fs(qz),Qz=Xt({},Gg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),dC=fs(Qz),Jz=Xt({},df,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:FS}),Yz=fs(Jz),Xz=Xt({},Fd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Zz=fs(Xz),eG=Xt({},Gg,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),tG=fs(eG),nG=[9,13,27,32],$S=la&&"CompositionEvent"in window,zu=null;la&&"documentMode"in document&&(zu=document.documentMode);var rG=la&&"TextEvent"in window&&!zu,xj=la&&(!$S||zu&&8<zu&&11>=zu),uC=" ",hC=!1;function bj(e,t){switch(e){case"keyup":return nG.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function wj(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var mc=!1;function sG(e,t){switch(e){case"compositionend":return wj(t);case"keypress":return t.which!==32?null:(hC=!0,uC);case"textInput":return e=t.data,e===uC&&hC?null:e;default:return null}}function iG(e,t){if(mc)return e==="compositionend"||!$S&&bj(e,t)?(e=yj(),Op=OS=Za=null,mc=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return xj&&t.locale!=="ko"?null:t.data;default:return null}}var aG={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function fC(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!aG[e.type]:t==="textarea"}function Sj(e,t,n,r){ZR(r),t=Pm(t,"onChange"),0<t.length&&(n=new LS("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Gu=null,hh=null;function oG(e){jj(e,0)}function Wg(e){var t=yc(e);if(HR(t))return e}function lG(e,t){if(e==="change")return t}var kj=!1;if(la){var Iy;if(la){var Ay="oninput"in document;if(!Ay){var pC=document.createElement("div");pC.setAttribute("oninput","return;"),Ay=typeof pC.oninput=="function"}Iy=Ay}else Iy=!1;kj=Iy&&(!document.documentMode||9<document.documentMode)}function mC(){Gu&&(Gu.detachEvent("onpropertychange",Tj),hh=Gu=null)}function Tj(e){if(e.propertyName==="value"&&Wg(hh)){var t=[];Sj(t,hh,e,AS(e)),rj(oG,t)}}function cG(e,t,n){e==="focusin"?(mC(),Gu=t,hh=n,Gu.attachEvent("onpropertychange",Tj)):e==="focusout"&&mC()}function dG(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Wg(hh)}function uG(e,t){if(e==="click")return Wg(t)}function hG(e,t){if(e==="input"||e==="change")return Wg(t)}function fG(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ti=typeof Object.is=="function"?Object.is:fG;function fh(e,t){if(ti(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Wx.call(t,s)||!ti(e[s],t[s]))return!1}return!0}function gC(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function vC(e,t){var n=gC(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=gC(n)}}function Cj(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Cj(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Ej(){for(var e=window,t=wm();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=wm(e.document)}return t}function US(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function pG(e){var t=Ej(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Cj(n.ownerDocument.documentElement,n)){if(r!==null&&US(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!e.extend&&i>r&&(s=r,r=i,i=s),s=vC(n,i);var o=vC(n,r);s&&o&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mG=la&&"documentMode"in document&&11>=document.documentMode,gc=null,db=null,Wu=null,ub=!1;function yC(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;ub||gc==null||gc!==wm(r)||(r=gc,"selectionStart"in r&&US(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Wu&&fh(Wu,r)||(Wu=r,r=Pm(db,"onSelect"),0<r.length&&(t=new LS("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gc)))}function lp(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var vc={animationend:lp("Animation","AnimationEnd"),animationiteration:lp("Animation","AnimationIteration"),animationstart:lp("Animation","AnimationStart"),transitionend:lp("Transition","TransitionEnd")},Ry={},_j={};la&&(_j=document.createElement("div").style,"AnimationEvent"in window||(delete vc.animationend.animation,delete vc.animationiteration.animation,delete vc.animationstart.animation),"TransitionEvent"in window||delete vc.transitionend.transition);function Hg(e){if(Ry[e])return Ry[e];if(!vc[e])return e;var t=vc[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in _j)return Ry[e]=t[n];return e}var Pj=Hg("animationend"),Nj=Hg("animationiteration"),Ij=Hg("animationstart"),Aj=Hg("transitionend"),Rj=new Map,xC="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function jo(e,t){Rj.set(e,t),ql(t,[e])}for(var jy=0;jy<xC.length;jy++){var My=xC[jy],gG=My.toLowerCase(),vG=My[0].toUpperCase()+My.slice(1);jo(gG,"on"+vG)}jo(Pj,"onAnimationEnd");jo(Nj,"onAnimationIteration");jo(Ij,"onAnimationStart");jo("dblclick","onDoubleClick");jo("focusin","onFocus");jo("focusout","onBlur");jo(Aj,"onTransitionEnd");fd("onMouseEnter",["mouseout","mouseover"]);fd("onMouseLeave",["mouseout","mouseover"]);fd("onPointerEnter",["pointerout","pointerover"]);fd("onPointerLeave",["pointerout","pointerover"]);ql("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ql("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ql("onBeforeInput",["compositionend","keypress","textInput","paste"]);ql("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ql("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ql("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Iu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),yG=new Set("cancel close invalid load scroll toggle".split(" ").concat(Iu));function bC(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,gz(r,t,void 0,e),e.currentTarget=null}function jj(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;bC(s,l,d),i=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,d=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;bC(s,l,d),i=c}}}if(km)throw e=ab,km=!1,ab=null,e}function Ut(e,t){var n=t[gb];n===void 0&&(n=t[gb]=new Set);var r=e+"__bubble";n.has(r)||(Mj(t,e,2,!1),n.add(r))}function Dy(e,t,n){var r=0;t&&(r|=4),Mj(n,e,r,t)}var cp="_reactListening"+Math.random().toString(36).slice(2);function ph(e){if(!e[cp]){e[cp]=!0,VR.forEach(function(n){n!=="selectionchange"&&(yG.has(n)||Dy(n,!1,e),Dy(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[cp]||(t[cp]=!0,Dy("selectionchange",!1,t))}}function Mj(e,t,n,r){switch(vj(t)){case 1:var s=Rz;break;case 4:s=jz;break;default:s=DS}n=s.bind(null,t,n,e),s=void 0,!ib||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function Oy(e,t,n,r,s){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=tl(l),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}l=l.parentNode}}r=r.return}rj(function(){var d=i,u=AS(n),h=[];e:{var f=Rj.get(e);if(f!==void 0){var m=LS,g=e;switch(e){case"keypress":if(Lp(n)===0)break e;case"keydown":case"keyup":m=Kz;break;case"focusin":g="focus",m=Ny;break;case"focusout":g="blur",m=Ny;break;case"beforeblur":case"afterblur":m=Ny;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=lC;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=Oz;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=Yz;break;case Pj:case Nj:case Ij:m=$z;break;case Aj:m=Zz;break;case"scroll":m=Mz;break;case"wheel":m=tG;break;case"copy":case"cut":case"paste":m=Vz;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=dC}var v=(t&4)!==0,x=!v&&e==="scroll",S=v?f!==null?f+"Capture":null:f;v=[];for(var y=d,b;y!==null;){b=y;var w=b.stateNode;if(b.tag===5&&w!==null&&(b=w,S!==null&&(w=lh(y,S),w!=null&&v.push(mh(y,w,b)))),x)break;y=y.return}0<v.length&&(f=new m(f,g,null,n,u),h.push({event:f,listeners:v}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",f&&n!==rb&&(g=n.relatedTarget||n.fromElement)&&(tl(g)||g[ca]))break e;if((m||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,m?(g=n.relatedTarget||n.toElement,m=d,g=g?tl(g):null,g!==null&&(x=Kl(g),g!==x||g.tag!==5&&g.tag!==6)&&(g=null)):(m=null,g=d),m!==g)){if(v=lC,w="onMouseLeave",S="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(v=dC,w="onPointerLeave",S="onPointerEnter",y="pointer"),x=m==null?f:yc(m),b=g==null?f:yc(g),f=new v(w,y+"leave",m,n,u),f.target=x,f.relatedTarget=b,w=null,tl(u)===d&&(v=new v(S,y+"enter",g,n,u),v.target=b,v.relatedTarget=x,w=v),x=w,m&&g)t:{for(v=m,S=g,y=0,b=v;b;b=ac(b))y++;for(b=0,w=S;w;w=ac(w))b++;for(;0<y-b;)v=ac(v),y--;for(;0<b-y;)S=ac(S),b--;for(;y--;){if(v===S||S!==null&&v===S.alternate)break t;v=ac(v),S=ac(S)}v=null}else v=null;m!==null&&wC(h,f,m,v,!1),g!==null&&x!==null&&wC(h,x,g,v,!0)}}e:{if(f=d?yc(d):window,m=f.nodeName&&f.nodeName.toLowerCase(),m==="select"||m==="input"&&f.type==="file")var C=lG;else if(fC(f))if(kj)C=hG;else{C=dG;var I=cG}else(m=f.nodeName)&&m.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(C=uG);if(C&&(C=C(e,d))){Sj(h,C,n,u);break e}I&&I(e,f,d),e==="focusout"&&(I=f._wrapperState)&&I.controlled&&f.type==="number"&&Xx(f,"number",f.value)}switch(I=d?yc(d):window,e){case"focusin":(fC(I)||I.contentEditable==="true")&&(gc=I,db=d,Wu=null);break;case"focusout":Wu=db=gc=null;break;case"mousedown":ub=!0;break;case"contextmenu":case"mouseup":case"dragend":ub=!1,yC(h,n,u);break;case"selectionchange":if(mG)break;case"keydown":case"keyup":yC(h,n,u)}var R;if($S)e:{switch(e){case"compositionstart":var L="onCompositionStart";break e;case"compositionend":L="onCompositionEnd";break e;case"compositionupdate":L="onCompositionUpdate";break e}L=void 0}else mc?bj(e,n)&&(L="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(L="onCompositionStart");L&&(xj&&n.locale!=="ko"&&(mc||L!=="onCompositionStart"?L==="onCompositionEnd"&&mc&&(R=yj()):(Za=u,OS="value"in Za?Za.value:Za.textContent,mc=!0)),I=Pm(d,L),0<I.length&&(L=new cC(L,e,null,n,u),h.push({event:L,listeners:I}),R?L.data=R:(R=wj(n),R!==null&&(L.data=R)))),(R=rG?sG(e,n):iG(e,n))&&(d=Pm(d,"onBeforeInput"),0<d.length&&(u=new cC("onBeforeInput","beforeinput",null,n,u),h.push({event:u,listeners:d}),u.data=R))}jj(h,t)})}function mh(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Pm(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=lh(e,n),i!=null&&r.unshift(mh(e,i,s)),i=lh(e,t),i!=null&&r.push(mh(e,i,s))),e=e.return}return r}function ac(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function wC(e,t,n,r,s){for(var i=t._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,d=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&d!==null&&(l=d,s?(c=lh(n,i),c!=null&&o.unshift(mh(n,c,l))):s||(c=lh(n,i),c!=null&&o.push(mh(n,c,l)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var xG=/\r\n?/g,bG=/\u0000|\uFFFD/g;function SC(e){return(typeof e=="string"?e:""+e).replace(xG,`
`).replace(bG,"")}function dp(e,t,n){if(t=SC(t),SC(e)!==t&&n)throw Error(ye(425))}function Nm(){}var hb=null,fb=null;function pb(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var mb=typeof setTimeout=="function"?setTimeout:void 0,wG=typeof clearTimeout=="function"?clearTimeout:void 0,kC=typeof Promise=="function"?Promise:void 0,SG=typeof queueMicrotask=="function"?queueMicrotask:typeof kC<"u"?function(e){return kC.resolve(null).then(e).catch(kG)}:mb;function kG(e){setTimeout(function(){throw e})}function Ly(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),uh(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);uh(t)}function io(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function TC(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var $d=Math.random().toString(36).slice(2),pi="__reactFiber$"+$d,gh="__reactProps$"+$d,ca="__reactContainer$"+$d,gb="__reactEvents$"+$d,TG="__reactListeners$"+$d,CG="__reactHandles$"+$d;function tl(e){var t=e[pi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ca]||n[pi]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=TC(e);e!==null;){if(n=e[pi])return n;e=TC(e)}return t}e=n,n=e.parentNode}return null}function uf(e){return e=e[pi]||e[ca],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function yc(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ye(33))}function qg(e){return e[gh]||null}var vb=[],xc=-1;function Mo(e){return{current:e}}function Bt(e){0>xc||(e.current=vb[xc],vb[xc]=null,xc--)}function Lt(e,t){xc++,vb[xc]=e.current,e.current=t}var bo={},vr=Mo(bo),zr=Mo(!1),Cl=bo;function pd(e,t){var n=e.type.contextTypes;if(!n)return bo;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Gr(e){return e=e.childContextTypes,e!=null}function Im(){Bt(zr),Bt(vr)}function CC(e,t,n){if(vr.current!==bo)throw Error(ye(168));Lt(vr,t),Lt(zr,n)}function Dj(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(ye(108,cz(e)||"Unknown",s));return Xt({},n,r)}function Am(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||bo,Cl=vr.current,Lt(vr,e),Lt(zr,zr.current),!0}function EC(e,t,n){var r=e.stateNode;if(!r)throw Error(ye(169));n?(e=Dj(e,t,Cl),r.__reactInternalMemoizedMergedChildContext=e,Bt(zr),Bt(vr),Lt(vr,e)):Bt(zr),Lt(zr,n)}var Wi=null,Kg=!1,Fy=!1;function Oj(e){Wi===null?Wi=[e]:Wi.push(e)}function EG(e){Kg=!0,Oj(e)}function Do(){if(!Fy&&Wi!==null){Fy=!0;var e=0,t=At;try{var n=Wi;for(At=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Wi=null,Kg=!1}catch(s){throw Wi!==null&&(Wi=Wi.slice(e+1)),oj(RS,Do),s}finally{At=t,Fy=!1}}return null}var bc=[],wc=0,Rm=null,jm=0,bs=[],ws=0,El=null,Xi=1,Zi="";function Qo(e,t){bc[wc++]=jm,bc[wc++]=Rm,Rm=e,jm=t}function Lj(e,t,n){bs[ws++]=Xi,bs[ws++]=Zi,bs[ws++]=El,El=e;var r=Xi;e=Zi;var s=32-Ys(r)-1;r&=~(1<<s),n+=1;var i=32-Ys(t)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Xi=1<<32-Ys(t)+s|n<<s|r,Zi=i+e}else Xi=1<<i|n<<s|r,Zi=e}function VS(e){e.return!==null&&(Qo(e,1),Lj(e,1,0))}function BS(e){for(;e===Rm;)Rm=bc[--wc],bc[wc]=null,jm=bc[--wc],bc[wc]=null;for(;e===El;)El=bs[--ws],bs[ws]=null,Zi=bs[--ws],bs[ws]=null,Xi=bs[--ws],bs[ws]=null}var ss=null,rs=null,Wt=!1,zs=null;function Fj(e,t){var n=Ts(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function _C(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,ss=e,rs=io(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,ss=e,rs=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=El!==null?{id:Xi,overflow:Zi}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Ts(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,ss=e,rs=null,!0):!1;default:return!1}}function yb(e){return(e.mode&1)!==0&&(e.flags&128)===0}function xb(e){if(Wt){var t=rs;if(t){var n=t;if(!_C(e,t)){if(yb(e))throw Error(ye(418));t=io(n.nextSibling);var r=ss;t&&_C(e,t)?Fj(r,n):(e.flags=e.flags&-4097|2,Wt=!1,ss=e)}}else{if(yb(e))throw Error(ye(418));e.flags=e.flags&-4097|2,Wt=!1,ss=e}}}function PC(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;ss=e}function up(e){if(e!==ss)return!1;if(!Wt)return PC(e),Wt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!pb(e.type,e.memoizedProps)),t&&(t=rs)){if(yb(e))throw $j(),Error(ye(418));for(;t;)Fj(e,t),t=io(t.nextSibling)}if(PC(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ye(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){rs=io(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}rs=null}}else rs=ss?io(e.stateNode.nextSibling):null;return!0}function $j(){for(var e=rs;e;)e=io(e.nextSibling)}function md(){rs=ss=null,Wt=!1}function zS(e){zs===null?zs=[e]:zs.push(e)}var _G=ba.ReactCurrentBatchConfig;function hu(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ye(309));var r=n.stateNode}if(!r)throw Error(ye(147,e));var s=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(ye(284));if(!n._owner)throw Error(ye(290,e))}return e}function hp(e,t){throw e=Object.prototype.toString.call(t),Error(ye(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function NC(e){var t=e._init;return t(e._payload)}function Uj(e){function t(S,y){if(e){var b=S.deletions;b===null?(S.deletions=[y],S.flags|=16):b.push(y)}}function n(S,y){if(!e)return null;for(;y!==null;)t(S,y),y=y.sibling;return null}function r(S,y){for(S=new Map;y!==null;)y.key!==null?S.set(y.key,y):S.set(y.index,y),y=y.sibling;return S}function s(S,y){return S=co(S,y),S.index=0,S.sibling=null,S}function i(S,y,b){return S.index=b,e?(b=S.alternate,b!==null?(b=b.index,b<y?(S.flags|=2,y):b):(S.flags|=2,y)):(S.flags|=1048576,y)}function o(S){return e&&S.alternate===null&&(S.flags|=2),S}function l(S,y,b,w){return y===null||y.tag!==6?(y=Wy(b,S.mode,w),y.return=S,y):(y=s(y,b),y.return=S,y)}function c(S,y,b,w){var C=b.type;return C===pc?u(S,y,b.props.children,w,b.key):y!==null&&(y.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Oa&&NC(C)===y.type)?(w=s(y,b.props),w.ref=hu(S,y,b),w.return=S,w):(w=Gp(b.type,b.key,b.props,null,S.mode,w),w.ref=hu(S,y,b),w.return=S,w)}function d(S,y,b,w){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=Hy(b,S.mode,w),y.return=S,y):(y=s(y,b.children||[]),y.return=S,y)}function u(S,y,b,w,C){return y===null||y.tag!==7?(y=yl(b,S.mode,w,C),y.return=S,y):(y=s(y,b),y.return=S,y)}function h(S,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Wy(""+y,S.mode,b),y.return=S,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case tp:return b=Gp(y.type,y.key,y.props,null,S.mode,b),b.ref=hu(S,null,y),b.return=S,b;case fc:return y=Hy(y,S.mode,b),y.return=S,y;case Oa:var w=y._init;return h(S,w(y._payload),b)}if(Pu(y)||ou(y))return y=yl(y,S.mode,b,null),y.return=S,y;hp(S,y)}return null}function f(S,y,b,w){var C=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return C!==null?null:l(S,y,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case tp:return b.key===C?c(S,y,b,w):null;case fc:return b.key===C?d(S,y,b,w):null;case Oa:return C=b._init,f(S,y,C(b._payload),w)}if(Pu(b)||ou(b))return C!==null?null:u(S,y,b,w,null);hp(S,b)}return null}function m(S,y,b,w,C){if(typeof w=="string"&&w!==""||typeof w=="number")return S=S.get(b)||null,l(y,S,""+w,C);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case tp:return S=S.get(w.key===null?b:w.key)||null,c(y,S,w,C);case fc:return S=S.get(w.key===null?b:w.key)||null,d(y,S,w,C);case Oa:var I=w._init;return m(S,y,b,I(w._payload),C)}if(Pu(w)||ou(w))return S=S.get(b)||null,u(y,S,w,C,null);hp(y,w)}return null}function g(S,y,b,w){for(var C=null,I=null,R=y,L=y=0,N=null;R!==null&&L<b.length;L++){R.index>L?(N=R,R=null):N=R.sibling;var O=f(S,R,b[L],w);if(O===null){R===null&&(R=N);break}e&&R&&O.alternate===null&&t(S,R),y=i(O,y,L),I===null?C=O:I.sibling=O,I=O,R=N}if(L===b.length)return n(S,R),Wt&&Qo(S,L),C;if(R===null){for(;L<b.length;L++)R=h(S,b[L],w),R!==null&&(y=i(R,y,L),I===null?C=R:I.sibling=R,I=R);return Wt&&Qo(S,L),C}for(R=r(S,R);L<b.length;L++)N=m(R,S,L,b[L],w),N!==null&&(e&&N.alternate!==null&&R.delete(N.key===null?L:N.key),y=i(N,y,L),I===null?C=N:I.sibling=N,I=N);return e&&R.forEach(function(G){return t(S,G)}),Wt&&Qo(S,L),C}function v(S,y,b,w){var C=ou(b);if(typeof C!="function")throw Error(ye(150));if(b=C.call(b),b==null)throw Error(ye(151));for(var I=C=null,R=y,L=y=0,N=null,O=b.next();R!==null&&!O.done;L++,O=b.next()){R.index>L?(N=R,R=null):N=R.sibling;var G=f(S,R,O.value,w);if(G===null){R===null&&(R=N);break}e&&R&&G.alternate===null&&t(S,R),y=i(G,y,L),I===null?C=G:I.sibling=G,I=G,R=N}if(O.done)return n(S,R),Wt&&Qo(S,L),C;if(R===null){for(;!O.done;L++,O=b.next())O=h(S,O.value,w),O!==null&&(y=i(O,y,L),I===null?C=O:I.sibling=O,I=O);return Wt&&Qo(S,L),C}for(R=r(S,R);!O.done;L++,O=b.next())O=m(R,S,L,O.value,w),O!==null&&(e&&O.alternate!==null&&R.delete(O.key===null?L:O.key),y=i(O,y,L),I===null?C=O:I.sibling=O,I=O);return e&&R.forEach(function(H){return t(S,H)}),Wt&&Qo(S,L),C}function x(S,y,b,w){if(typeof b=="object"&&b!==null&&b.type===pc&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case tp:e:{for(var C=b.key,I=y;I!==null;){if(I.key===C){if(C=b.type,C===pc){if(I.tag===7){n(S,I.sibling),y=s(I,b.props.children),y.return=S,S=y;break e}}else if(I.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Oa&&NC(C)===I.type){n(S,I.sibling),y=s(I,b.props),y.ref=hu(S,I,b),y.return=S,S=y;break e}n(S,I);break}else t(S,I);I=I.sibling}b.type===pc?(y=yl(b.props.children,S.mode,w,b.key),y.return=S,S=y):(w=Gp(b.type,b.key,b.props,null,S.mode,w),w.ref=hu(S,y,b),w.return=S,S=w)}return o(S);case fc:e:{for(I=b.key;y!==null;){if(y.key===I)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){n(S,y.sibling),y=s(y,b.children||[]),y.return=S,S=y;break e}else{n(S,y);break}else t(S,y);y=y.sibling}y=Hy(b,S.mode,w),y.return=S,S=y}return o(S);case Oa:return I=b._init,x(S,y,I(b._payload),w)}if(Pu(b))return g(S,y,b,w);if(ou(b))return v(S,y,b,w);hp(S,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(n(S,y.sibling),y=s(y,b),y.return=S,S=y):(n(S,y),y=Wy(b,S.mode,w),y.return=S,S=y),o(S)):n(S,y)}return x}var gd=Uj(!0),Vj=Uj(!1),Mm=Mo(null),Dm=null,Sc=null,GS=null;function WS(){GS=Sc=Dm=null}function HS(e){var t=Mm.current;Bt(Mm),e._currentValue=t}function bb(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Dc(e,t){Dm=e,GS=Sc=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Ur=!0),e.firstContext=null)}function Ps(e){var t=e._currentValue;if(GS!==e)if(e={context:e,memoizedValue:t,next:null},Sc===null){if(Dm===null)throw Error(ye(308));Sc=e,Dm.dependencies={lanes:0,firstContext:e}}else Sc=Sc.next=e;return t}var nl=null;function qS(e){nl===null?nl=[e]:nl.push(e)}function Bj(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,qS(t)):(n.next=s.next,s.next=n),t.interleaved=n,da(e,r)}function da(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var La=!1;function KS(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function zj(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function sa(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ao(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,St&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,da(e,n)}return s=r.interleaved,s===null?(t.next=t,qS(r)):(t.next=s.next,s.next=t),r.interleaved=t,da(e,n)}function Fp(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,jS(e,n)}}function IC(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=t:i=i.next=t}else s=i=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Om(e,t,n,r){var s=e.updateQueue;La=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,d=c.next;c.next=null,o===null?i=d:o.next=d,o=c;var u=e.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==o&&(l===null?u.firstBaseUpdate=d:l.next=d,u.lastBaseUpdate=c))}if(i!==null){var h=s.baseState;o=0,u=d=c=null,l=i;do{var f=l.lane,m=l.eventTime;if((r&f)===f){u!==null&&(u=u.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var g=e,v=l;switch(f=t,m=n,v.tag){case 1:if(g=v.payload,typeof g=="function"){h=g.call(m,h,f);break e}h=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=v.payload,f=typeof g=="function"?g.call(m,h,f):g,f==null)break e;h=Xt({},h,f);break e;case 2:La=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,f=s.effects,f===null?s.effects=[l]:f.push(l))}else m={eventTime:m,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(d=u=m,c=h):u=u.next=m,o|=f;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;f=l,l=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(u===null&&(c=h),s.baseState=c,s.firstBaseUpdate=d,s.lastBaseUpdate=u,t=s.shared.interleaved,t!==null){s=t;do o|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);Pl|=o,e.lanes=o,e.memoizedState=h}}function AC(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(ye(191,s));s.call(r)}}}var hf={},wi=Mo(hf),vh=Mo(hf),yh=Mo(hf);function rl(e){if(e===hf)throw Error(ye(174));return e}function QS(e,t){switch(Lt(yh,t),Lt(vh,e),Lt(wi,hf),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:eb(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=eb(t,e)}Bt(wi),Lt(wi,t)}function vd(){Bt(wi),Bt(vh),Bt(yh)}function Gj(e){rl(yh.current);var t=rl(wi.current),n=eb(t,e.type);t!==n&&(Lt(vh,e),Lt(wi,n))}function JS(e){vh.current===e&&(Bt(wi),Bt(vh))}var Qt=Mo(0);function Lm(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var $y=[];function YS(){for(var e=0;e<$y.length;e++)$y[e]._workInProgressVersionPrimary=null;$y.length=0}var $p=ba.ReactCurrentDispatcher,Uy=ba.ReactCurrentBatchConfig,_l=0,Yt=null,Nn=null,Bn=null,Fm=!1,Hu=!1,xh=0,PG=0;function cr(){throw Error(ye(321))}function XS(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ti(e[n],t[n]))return!1;return!0}function ZS(e,t,n,r,s,i){if(_l=i,Yt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,$p.current=e===null||e.memoizedState===null?RG:jG,e=n(r,s),Hu){i=0;do{if(Hu=!1,xh=0,25<=i)throw Error(ye(301));i+=1,Bn=Nn=null,t.updateQueue=null,$p.current=MG,e=n(r,s)}while(Hu)}if($p.current=$m,t=Nn!==null&&Nn.next!==null,_l=0,Bn=Nn=Yt=null,Fm=!1,t)throw Error(ye(300));return e}function e0(){var e=xh!==0;return xh=0,e}function di(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Bn===null?Yt.memoizedState=Bn=e:Bn=Bn.next=e,Bn}function Ns(){if(Nn===null){var e=Yt.alternate;e=e!==null?e.memoizedState:null}else e=Nn.next;var t=Bn===null?Yt.memoizedState:Bn.next;if(t!==null)Bn=t,Nn=e;else{if(e===null)throw Error(ye(310));Nn=e,e={memoizedState:Nn.memoizedState,baseState:Nn.baseState,baseQueue:Nn.baseQueue,queue:Nn.queue,next:null},Bn===null?Yt.memoizedState=Bn=e:Bn=Bn.next=e}return Bn}function bh(e,t){return typeof t=="function"?t(e):t}function Vy(e){var t=Ns(),n=t.queue;if(n===null)throw Error(ye(311));n.lastRenderedReducer=e;var r=Nn,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,c=null,d=i;do{var u=d.lane;if((_l&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var h={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=h,o=r):c=c.next=h,Yt.lanes|=u,Pl|=u}d=d.next}while(d!==null&&d!==i);c===null?o=r:c.next=l,ti(r,t.memoizedState)||(Ur=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do i=s.lane,Yt.lanes|=i,Pl|=i,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function By(e){var t=Ns(),n=t.queue;if(n===null)throw Error(ye(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,i=t.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=e(i,o.action),o=o.next;while(o!==s);ti(i,t.memoizedState)||(Ur=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function Wj(){}function Hj(e,t){var n=Yt,r=Ns(),s=t(),i=!ti(r.memoizedState,s);if(i&&(r.memoizedState=s,Ur=!0),r=r.queue,t0(Qj.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||Bn!==null&&Bn.memoizedState.tag&1){if(n.flags|=2048,wh(9,Kj.bind(null,n,r,s,t),void 0,null),Gn===null)throw Error(ye(349));_l&30||qj(n,t,s)}return s}function qj(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Yt.updateQueue,t===null?(t={lastEffect:null,stores:null},Yt.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Kj(e,t,n,r){t.value=n,t.getSnapshot=r,Jj(t)&&Yj(e)}function Qj(e,t,n){return n(function(){Jj(t)&&Yj(e)})}function Jj(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ti(e,n)}catch{return!0}}function Yj(e){var t=da(e,1);t!==null&&Xs(t,e,1,-1)}function RC(e){var t=di();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bh,lastRenderedState:e},t.queue=e,e=e.dispatch=AG.bind(null,Yt,e),[t.memoizedState,e]}function wh(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Yt.updateQueue,t===null?(t={lastEffect:null,stores:null},Yt.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function Xj(){return Ns().memoizedState}function Up(e,t,n,r){var s=di();Yt.flags|=e,s.memoizedState=wh(1|t,n,void 0,r===void 0?null:r)}function Qg(e,t,n,r){var s=Ns();r=r===void 0?null:r;var i=void 0;if(Nn!==null){var o=Nn.memoizedState;if(i=o.destroy,r!==null&&XS(r,o.deps)){s.memoizedState=wh(t,n,i,r);return}}Yt.flags|=e,s.memoizedState=wh(1|t,n,i,r)}function jC(e,t){return Up(8390656,8,e,t)}function t0(e,t){return Qg(2048,8,e,t)}function Zj(e,t){return Qg(4,2,e,t)}function eM(e,t){return Qg(4,4,e,t)}function tM(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function nM(e,t,n){return n=n!=null?n.concat([e]):null,Qg(4,4,tM.bind(null,t,e),n)}function n0(){}function rM(e,t){var n=Ns();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&XS(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function sM(e,t){var n=Ns();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&XS(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function iM(e,t,n){return _l&21?(ti(n,t)||(n=dj(),Yt.lanes|=n,Pl|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Ur=!0),e.memoizedState=n)}function NG(e,t){var n=At;At=n!==0&&4>n?n:4,e(!0);var r=Uy.transition;Uy.transition={};try{e(!1),t()}finally{At=n,Uy.transition=r}}function aM(){return Ns().memoizedState}function IG(e,t,n){var r=lo(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},oM(e))lM(t,n);else if(n=Bj(e,t,n,r),n!==null){var s=Pr();Xs(n,e,r,s),cM(n,t,r)}}function AG(e,t,n){var r=lo(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(oM(e))lM(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,ti(l,o)){var c=t.interleaved;c===null?(s.next=s,qS(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}n=Bj(e,t,s,r),n!==null&&(s=Pr(),Xs(n,e,r,s),cM(n,t,r))}}function oM(e){var t=e.alternate;return e===Yt||t!==null&&t===Yt}function lM(e,t){Hu=Fm=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function cM(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,jS(e,n)}}var $m={readContext:Ps,useCallback:cr,useContext:cr,useEffect:cr,useImperativeHandle:cr,useInsertionEffect:cr,useLayoutEffect:cr,useMemo:cr,useReducer:cr,useRef:cr,useState:cr,useDebugValue:cr,useDeferredValue:cr,useTransition:cr,useMutableSource:cr,useSyncExternalStore:cr,useId:cr,unstable_isNewReconciler:!1},RG={readContext:Ps,useCallback:function(e,t){return di().memoizedState=[e,t===void 0?null:t],e},useContext:Ps,useEffect:jC,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Up(4194308,4,tM.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Up(4194308,4,e,t)},useInsertionEffect:function(e,t){return Up(4,2,e,t)},useMemo:function(e,t){var n=di();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=di();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=IG.bind(null,Yt,e),[r.memoizedState,e]},useRef:function(e){var t=di();return e={current:e},t.memoizedState=e},useState:RC,useDebugValue:n0,useDeferredValue:function(e){return di().memoizedState=e},useTransition:function(){var e=RC(!1),t=e[0];return e=NG.bind(null,e[1]),di().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Yt,s=di();if(Wt){if(n===void 0)throw Error(ye(407));n=n()}else{if(n=t(),Gn===null)throw Error(ye(349));_l&30||qj(r,t,n)}s.memoizedState=n;var i={value:n,getSnapshot:t};return s.queue=i,jC(Qj.bind(null,r,i,e),[e]),r.flags|=2048,wh(9,Kj.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=di(),t=Gn.identifierPrefix;if(Wt){var n=Zi,r=Xi;n=(r&~(1<<32-Ys(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=xh++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=PG++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},jG={readContext:Ps,useCallback:rM,useContext:Ps,useEffect:t0,useImperativeHandle:nM,useInsertionEffect:Zj,useLayoutEffect:eM,useMemo:sM,useReducer:Vy,useRef:Xj,useState:function(){return Vy(bh)},useDebugValue:n0,useDeferredValue:function(e){var t=Ns();return iM(t,Nn.memoizedState,e)},useTransition:function(){var e=Vy(bh)[0],t=Ns().memoizedState;return[e,t]},useMutableSource:Wj,useSyncExternalStore:Hj,useId:aM,unstable_isNewReconciler:!1},MG={readContext:Ps,useCallback:rM,useContext:Ps,useEffect:t0,useImperativeHandle:nM,useInsertionEffect:Zj,useLayoutEffect:eM,useMemo:sM,useReducer:By,useRef:Xj,useState:function(){return By(bh)},useDebugValue:n0,useDeferredValue:function(e){var t=Ns();return Nn===null?t.memoizedState=e:iM(t,Nn.memoizedState,e)},useTransition:function(){var e=By(bh)[0],t=Ns().memoizedState;return[e,t]},useMutableSource:Wj,useSyncExternalStore:Hj,useId:aM,unstable_isNewReconciler:!1};function $s(e,t){if(e&&e.defaultProps){t=Xt({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function wb(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Xt({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Jg={isMounted:function(e){return(e=e._reactInternals)?Kl(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Pr(),s=lo(e),i=sa(r,s);i.payload=t,n!=null&&(i.callback=n),t=ao(e,i,s),t!==null&&(Xs(t,e,s,r),Fp(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Pr(),s=lo(e),i=sa(r,s);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=ao(e,i,s),t!==null&&(Xs(t,e,s,r),Fp(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Pr(),r=lo(e),s=sa(n,r);s.tag=2,t!=null&&(s.callback=t),t=ao(e,s,r),t!==null&&(Xs(t,e,r,n),Fp(t,e,r))}};function MC(e,t,n,r,s,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,o):t.prototype&&t.prototype.isPureReactComponent?!fh(n,r)||!fh(s,i):!0}function dM(e,t,n){var r=!1,s=bo,i=t.contextType;return typeof i=="object"&&i!==null?i=Ps(i):(s=Gr(t)?Cl:vr.current,r=t.contextTypes,i=(r=r!=null)?pd(e,s):bo),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Jg,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function DC(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Jg.enqueueReplaceState(t,t.state,null)}function Sb(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},KS(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=Ps(i):(i=Gr(t)?Cl:vr.current,s.context=pd(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(wb(e,t,i,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&Jg.enqueueReplaceState(s,s.state,null),Om(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function yd(e,t){try{var n="",r=t;do n+=lz(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function zy(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function kb(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var DG=typeof WeakMap=="function"?WeakMap:Map;function uM(e,t,n){n=sa(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Vm||(Vm=!0,jb=r),kb(e,t)},n}function hM(e,t,n){n=sa(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){kb(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){kb(e,t),typeof r!="function"&&(oo===null?oo=new Set([this]):oo.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function OC(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new DG;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=QG.bind(null,e,t,n),t.then(e,e))}function LC(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function FC(e,t,n,r,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=sa(-1,1),t.tag=2,ao(n,t,1))),n.lanes|=1),e)}var OG=ba.ReactCurrentOwner,Ur=!1;function Tr(e,t,n,r){t.child=e===null?Vj(t,null,n,r):gd(t,e.child,n,r)}function $C(e,t,n,r,s){n=n.render;var i=t.ref;return Dc(t,s),r=ZS(e,t,n,r,i,s),n=e0(),e!==null&&!Ur?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,ua(e,t,s)):(Wt&&n&&VS(t),t.flags|=1,Tr(e,t,r,s),t.child)}function UC(e,t,n,r,s){if(e===null){var i=n.type;return typeof i=="function"&&!d0(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,fM(e,t,i,r,s)):(e=Gp(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:fh,n(o,r)&&e.ref===t.ref)return ua(e,t,s)}return t.flags|=1,e=co(i,r),e.ref=t.ref,e.return=t,t.child=e}function fM(e,t,n,r,s){if(e!==null){var i=e.memoizedProps;if(fh(i,r)&&e.ref===t.ref)if(Ur=!1,t.pendingProps=r=i,(e.lanes&s)!==0)e.flags&131072&&(Ur=!0);else return t.lanes=e.lanes,ua(e,t,s)}return Tb(e,t,n,r,s)}function pM(e,t,n){var r=t.pendingProps,s=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Lt(Tc,Yr),Yr|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Lt(Tc,Yr),Yr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Lt(Tc,Yr),Yr|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,Lt(Tc,Yr),Yr|=r;return Tr(e,t,s,n),t.child}function mM(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Tb(e,t,n,r,s){var i=Gr(n)?Cl:vr.current;return i=pd(t,i),Dc(t,s),n=ZS(e,t,n,r,i,s),r=e0(),e!==null&&!Ur?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,ua(e,t,s)):(Wt&&r&&VS(t),t.flags|=1,Tr(e,t,n,s),t.child)}function VC(e,t,n,r,s){if(Gr(n)){var i=!0;Am(t)}else i=!1;if(Dc(t,s),t.stateNode===null)Vp(e,t),dM(t,n,r),Sb(t,n,r,s),r=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=Ps(d):(d=Gr(n)?Cl:vr.current,d=pd(t,d));var u=n.getDerivedStateFromProps,h=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==d)&&DC(t,o,r,d),La=!1;var f=t.memoizedState;o.state=f,Om(t,r,o,s),c=t.memoizedState,l!==r||f!==c||zr.current||La?(typeof u=="function"&&(wb(t,n,u,r),c=t.memoizedState),(l=La||MC(t,n,l,r,f,c,d))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),o.props=r,o.state=c,o.context=d,r=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,zj(e,t),l=t.memoizedProps,d=t.type===t.elementType?l:$s(t.type,l),o.props=d,h=t.pendingProps,f=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=Ps(c):(c=Gr(n)?Cl:vr.current,c=pd(t,c));var m=n.getDerivedStateFromProps;(u=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==h||f!==c)&&DC(t,o,r,c),La=!1,f=t.memoizedState,o.state=f,Om(t,r,o,s);var g=t.memoizedState;l!==h||f!==g||zr.current||La?(typeof m=="function"&&(wb(t,n,m,r),g=t.memoizedState),(d=La||MC(t,n,d,r,f,g,c)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,g,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,g,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=g),o.props=r,o.state=g,o.context=c,r=d):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),r=!1)}return Cb(e,t,n,r,i,s)}function Cb(e,t,n,r,s,i){mM(e,t);var o=(t.flags&128)!==0;if(!r&&!o)return s&&EC(t,n,!1),ua(e,t,i);r=t.stateNode,OG.current=t;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&o?(t.child=gd(t,e.child,null,i),t.child=gd(t,null,l,i)):Tr(e,t,l,i),t.memoizedState=r.state,s&&EC(t,n,!0),t.child}function gM(e){var t=e.stateNode;t.pendingContext?CC(e,t.pendingContext,t.pendingContext!==t.context):t.context&&CC(e,t.context,!1),QS(e,t.containerInfo)}function BC(e,t,n,r,s){return md(),zS(s),t.flags|=256,Tr(e,t,n,r),t.child}var Eb={dehydrated:null,treeContext:null,retryLane:0};function _b(e){return{baseLanes:e,cachePool:null,transitions:null}}function vM(e,t,n){var r=t.pendingProps,s=Qt.current,i=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Lt(Qt,s&1),e===null)return xb(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=r.children,e=r.fallback,i?(r=t.mode,i=t.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Zg(o,r,0,null),e=yl(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=_b(n),t.memoizedState=Eb,e):r0(t,o));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return LG(e,t,o,r,l,s,n);if(i){i=r.fallback,o=t.mode,s=e.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=c,t.deletions=null):(r=co(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=co(l,i):(i=yl(i,o,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,o=e.child.memoizedState,o=o===null?_b(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~n,t.memoizedState=Eb,r}return i=e.child,e=i.sibling,r=co(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function r0(e,t){return t=Zg({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function fp(e,t,n,r){return r!==null&&zS(r),gd(t,e.child,null,n),e=r0(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function LG(e,t,n,r,s,i,o){if(n)return t.flags&256?(t.flags&=-257,r=zy(Error(ye(422))),fp(e,t,o,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,s=t.mode,r=Zg({mode:"visible",children:r.children},s,0,null),i=yl(i,s,o,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&gd(t,e.child,null,o),t.child.memoizedState=_b(o),t.memoizedState=Eb,i);if(!(t.mode&1))return fp(e,t,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(ye(419)),r=zy(i,r,void 0),fp(e,t,o,r)}if(l=(o&e.childLanes)!==0,Ur||l){if(r=Gn,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,da(e,s),Xs(r,e,s,-1))}return c0(),r=zy(Error(ye(421))),fp(e,t,o,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=JG.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,rs=io(s.nextSibling),ss=t,Wt=!0,zs=null,e!==null&&(bs[ws++]=Xi,bs[ws++]=Zi,bs[ws++]=El,Xi=e.id,Zi=e.overflow,El=t),t=r0(t,r.children),t.flags|=4096,t)}function zC(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),bb(e.return,t,n)}function Gy(e,t,n,r,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function yM(e,t,n){var r=t.pendingProps,s=r.revealOrder,i=r.tail;if(Tr(e,t,r.children,n),r=Qt.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&zC(e,n,t);else if(e.tag===19)zC(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Lt(Qt,r),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&Lm(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),Gy(t,!1,s,n,i);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Lm(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}Gy(t,!0,n,null,i);break;case"together":Gy(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Vp(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ua(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Pl|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ye(153));if(t.child!==null){for(e=t.child,n=co(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=co(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function FG(e,t,n){switch(t.tag){case 3:gM(t),md();break;case 5:Gj(t);break;case 1:Gr(t.type)&&Am(t);break;case 4:QS(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;Lt(Mm,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Lt(Qt,Qt.current&1),t.flags|=128,null):n&t.child.childLanes?vM(e,t,n):(Lt(Qt,Qt.current&1),e=ua(e,t,n),e!==null?e.sibling:null);Lt(Qt,Qt.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return yM(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Lt(Qt,Qt.current),r)break;return null;case 22:case 23:return t.lanes=0,pM(e,t,n)}return ua(e,t,n)}var xM,Pb,bM,wM;xM=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Pb=function(){};bM=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,rl(wi.current);var i=null;switch(n){case"input":s=Jx(e,s),r=Jx(e,r),i=[];break;case"select":s=Xt({},s,{value:void 0}),r=Xt({},r,{value:void 0}),i=[];break;case"textarea":s=Zx(e,s),r=Zx(e,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Nm)}tb(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var l=s[d];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(ah.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var c=r[d];if(l=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(ah.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Ut("scroll",e),i||l===c||(i=[])):(i=i||[]).push(d,c))}n&&(i=i||[]).push("style",n);var d=i;(t.updateQueue=d)&&(t.flags|=4)}};wM=function(e,t,n,r){n!==r&&(t.flags|=4)};function fu(e,t){if(!Wt)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function dr(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function $G(e,t,n){var r=t.pendingProps;switch(BS(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return dr(t),null;case 1:return Gr(t.type)&&Im(),dr(t),null;case 3:return r=t.stateNode,vd(),Bt(zr),Bt(vr),YS(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(up(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,zs!==null&&(Ob(zs),zs=null))),Pb(e,t),dr(t),null;case 5:JS(t);var s=rl(yh.current);if(n=t.type,e!==null&&t.stateNode!=null)bM(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(ye(166));return dr(t),null}if(e=rl(wi.current),up(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[pi]=t,r[gh]=i,e=(t.mode&1)!==0,n){case"dialog":Ut("cancel",r),Ut("close",r);break;case"iframe":case"object":case"embed":Ut("load",r);break;case"video":case"audio":for(s=0;s<Iu.length;s++)Ut(Iu[s],r);break;case"source":Ut("error",r);break;case"img":case"image":case"link":Ut("error",r),Ut("load",r);break;case"details":Ut("toggle",r);break;case"input":XT(r,i),Ut("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ut("invalid",r);break;case"textarea":eC(r,i),Ut("invalid",r)}tb(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&dp(r.textContent,l,e),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&dp(r.textContent,l,e),s=["children",""+l]):ah.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Ut("scroll",r)}switch(n){case"input":np(r),ZT(r,i,!0);break;case"textarea":np(r),tC(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Nm)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=QR(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=o.createElement(n,{is:r.is}):(e=o.createElement(n),n==="select"&&(o=e,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):e=o.createElementNS(e,n),e[pi]=t,e[gh]=r,xM(e,t,!1,!1),t.stateNode=e;e:{switch(o=nb(n,r),n){case"dialog":Ut("cancel",e),Ut("close",e),s=r;break;case"iframe":case"object":case"embed":Ut("load",e),s=r;break;case"video":case"audio":for(s=0;s<Iu.length;s++)Ut(Iu[s],e);s=r;break;case"source":Ut("error",e),s=r;break;case"img":case"image":case"link":Ut("error",e),Ut("load",e),s=r;break;case"details":Ut("toggle",e),s=r;break;case"input":XT(e,r),s=Jx(e,r),Ut("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=Xt({},r,{value:void 0}),Ut("invalid",e);break;case"textarea":eC(e,r),s=Zx(e,r),Ut("invalid",e);break;default:s=r}tb(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?XR(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&JR(e,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&oh(e,c):typeof c=="number"&&oh(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(ah.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Ut("scroll",e):c!=null&&_S(e,i,c,o))}switch(n){case"input":np(e),ZT(e,r,!1);break;case"textarea":np(e),tC(e);break;case"option":r.value!=null&&e.setAttribute("value",""+xo(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?Ac(e,!!r.multiple,i,!1):r.defaultValue!=null&&Ac(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Nm)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return dr(t),null;case 6:if(e&&t.stateNode!=null)wM(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(ye(166));if(n=rl(yh.current),rl(wi.current),up(t)){if(r=t.stateNode,n=t.memoizedProps,r[pi]=t,(i=r.nodeValue!==n)&&(e=ss,e!==null))switch(e.tag){case 3:dp(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&dp(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[pi]=t,t.stateNode=r}return dr(t),null;case 13:if(Bt(Qt),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Wt&&rs!==null&&t.mode&1&&!(t.flags&128))$j(),md(),t.flags|=98560,i=!1;else if(i=up(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(ye(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ye(317));i[pi]=t}else md(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;dr(t),i=!1}else zs!==null&&(Ob(zs),zs=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Qt.current&1?jn===0&&(jn=3):c0())),t.updateQueue!==null&&(t.flags|=4),dr(t),null);case 4:return vd(),Pb(e,t),e===null&&ph(t.stateNode.containerInfo),dr(t),null;case 10:return HS(t.type._context),dr(t),null;case 17:return Gr(t.type)&&Im(),dr(t),null;case 19:if(Bt(Qt),i=t.memoizedState,i===null)return dr(t),null;if(r=(t.flags&128)!==0,o=i.rendering,o===null)if(r)fu(i,!1);else{if(jn!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Lm(e),o!==null){for(t.flags|=128,fu(i,!1),r=o.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Lt(Qt,Qt.current&1|2),t.child}e=e.sibling}i.tail!==null&&un()>xd&&(t.flags|=128,r=!0,fu(i,!1),t.lanes=4194304)}else{if(!r)if(e=Lm(o),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),fu(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Wt)return dr(t),null}else 2*un()-i.renderingStartTime>xd&&n!==1073741824&&(t.flags|=128,r=!0,fu(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(n=i.last,n!==null?n.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=un(),t.sibling=null,n=Qt.current,Lt(Qt,r?n&1|2:n&1),t):(dr(t),null);case 22:case 23:return l0(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Yr&1073741824&&(dr(t),t.subtreeFlags&6&&(t.flags|=8192)):dr(t),null;case 24:return null;case 25:return null}throw Error(ye(156,t.tag))}function UG(e,t){switch(BS(t),t.tag){case 1:return Gr(t.type)&&Im(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return vd(),Bt(zr),Bt(vr),YS(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return JS(t),null;case 13:if(Bt(Qt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ye(340));md()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Bt(Qt),null;case 4:return vd(),null;case 10:return HS(t.type._context),null;case 22:case 23:return l0(),null;case 24:return null;default:return null}}var pp=!1,fr=!1,VG=typeof WeakSet=="function"?WeakSet:Set,Ae=null;function kc(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){nn(e,t,r)}else n.current=null}function Nb(e,t,n){try{n()}catch(r){nn(e,t,r)}}var GC=!1;function BG(e,t){if(hb=Em,e=Ej(),US(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,d=0,u=0,h=e,f=null;t:for(;;){for(var m;h!==n||s!==0&&h.nodeType!==3||(l=o+s),h!==i||r!==0&&h.nodeType!==3||(c=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(m=h.firstChild)!==null;)f=h,h=m;for(;;){if(h===e)break t;if(f===n&&++d===s&&(l=o),f===i&&++u===r&&(c=o),(m=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=m}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(fb={focusedElem:e,selectionRange:n},Em=!1,Ae=t;Ae!==null;)if(t=Ae,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ae=e;else for(;Ae!==null;){t=Ae;try{var g=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var v=g.memoizedProps,x=g.memoizedState,S=t.stateNode,y=S.getSnapshotBeforeUpdate(t.elementType===t.type?v:$s(t.type,v),x);S.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ye(163))}}catch(w){nn(t,t.return,w)}if(e=t.sibling,e!==null){e.return=t.return,Ae=e;break}Ae=t.return}return g=GC,GC=!1,g}function qu(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&Nb(t,n,i)}s=s.next}while(s!==r)}}function Yg(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Ib(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function SM(e){var t=e.alternate;t!==null&&(e.alternate=null,SM(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[pi],delete t[gh],delete t[gb],delete t[TG],delete t[CG])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function kM(e){return e.tag===5||e.tag===3||e.tag===4}function WC(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||kM(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Ab(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Nm));else if(r!==4&&(e=e.child,e!==null))for(Ab(e,t,n),e=e.sibling;e!==null;)Ab(e,t,n),e=e.sibling}function Rb(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Rb(e,t,n),e=e.sibling;e!==null;)Rb(e,t,n),e=e.sibling}var Yn=null,Bs=!1;function Ea(e,t,n){for(n=n.child;n!==null;)TM(e,t,n),n=n.sibling}function TM(e,t,n){if(bi&&typeof bi.onCommitFiberUnmount=="function")try{bi.onCommitFiberUnmount(zg,n)}catch{}switch(n.tag){case 5:fr||kc(n,t);case 6:var r=Yn,s=Bs;Yn=null,Ea(e,t,n),Yn=r,Bs=s,Yn!==null&&(Bs?(e=Yn,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Yn.removeChild(n.stateNode));break;case 18:Yn!==null&&(Bs?(e=Yn,n=n.stateNode,e.nodeType===8?Ly(e.parentNode,n):e.nodeType===1&&Ly(e,n),uh(e)):Ly(Yn,n.stateNode));break;case 4:r=Yn,s=Bs,Yn=n.stateNode.containerInfo,Bs=!0,Ea(e,t,n),Yn=r,Bs=s;break;case 0:case 11:case 14:case 15:if(!fr&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Nb(n,t,o),s=s.next}while(s!==r)}Ea(e,t,n);break;case 1:if(!fr&&(kc(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){nn(n,t,l)}Ea(e,t,n);break;case 21:Ea(e,t,n);break;case 22:n.mode&1?(fr=(r=fr)||n.memoizedState!==null,Ea(e,t,n),fr=r):Ea(e,t,n);break;default:Ea(e,t,n)}}function HC(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new VG),t.forEach(function(r){var s=YG.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Os(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:Yn=l.stateNode,Bs=!1;break e;case 3:Yn=l.stateNode.containerInfo,Bs=!0;break e;case 4:Yn=l.stateNode.containerInfo,Bs=!0;break e}l=l.return}if(Yn===null)throw Error(ye(160));TM(i,o,s),Yn=null,Bs=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(d){nn(s,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)CM(t,e),t=t.sibling}function CM(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Os(t,e),ci(e),r&4){try{qu(3,e,e.return),Yg(3,e)}catch(v){nn(e,e.return,v)}try{qu(5,e,e.return)}catch(v){nn(e,e.return,v)}}break;case 1:Os(t,e),ci(e),r&512&&n!==null&&kc(n,n.return);break;case 5:if(Os(t,e),ci(e),r&512&&n!==null&&kc(n,n.return),e.flags&32){var s=e.stateNode;try{oh(s,"")}catch(v){nn(e,e.return,v)}}if(r&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,o=n!==null?n.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&qR(s,i),nb(l,o);var d=nb(l,i);for(o=0;o<c.length;o+=2){var u=c[o],h=c[o+1];u==="style"?XR(s,h):u==="dangerouslySetInnerHTML"?JR(s,h):u==="children"?oh(s,h):_S(s,u,h,d)}switch(l){case"input":Yx(s,i);break;case"textarea":KR(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var m=i.value;m!=null?Ac(s,!!i.multiple,m,!1):f!==!!i.multiple&&(i.defaultValue!=null?Ac(s,!!i.multiple,i.defaultValue,!0):Ac(s,!!i.multiple,i.multiple?[]:"",!1))}s[gh]=i}catch(v){nn(e,e.return,v)}}break;case 6:if(Os(t,e),ci(e),r&4){if(e.stateNode===null)throw Error(ye(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(v){nn(e,e.return,v)}}break;case 3:if(Os(t,e),ci(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{uh(t.containerInfo)}catch(v){nn(e,e.return,v)}break;case 4:Os(t,e),ci(e);break;case 13:Os(t,e),ci(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(a0=un())),r&4&&HC(e);break;case 22:if(u=n!==null&&n.memoizedState!==null,e.mode&1?(fr=(d=fr)||u,Os(t,e),fr=d):Os(t,e),ci(e),r&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!u&&e.mode&1)for(Ae=e,u=e.child;u!==null;){for(h=Ae=u;Ae!==null;){switch(f=Ae,m=f.child,f.tag){case 0:case 11:case 14:case 15:qu(4,f,f.return);break;case 1:kc(f,f.return);var g=f.stateNode;if(typeof g.componentWillUnmount=="function"){r=f,n=f.return;try{t=r,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(v){nn(r,n,v)}}break;case 5:kc(f,f.return);break;case 22:if(f.memoizedState!==null){KC(h);continue}}m!==null?(m.return=f,Ae=m):KC(h)}u=u.sibling}e:for(u=null,h=e;;){if(h.tag===5){if(u===null){u=h;try{s=h.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=h.stateNode,c=h.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=YR("display",o))}catch(v){nn(e,e.return,v)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(v){nn(e,e.return,v)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Os(t,e),ci(e),r&4&&HC(e);break;case 21:break;default:Os(t,e),ci(e)}}function ci(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(kM(n)){var r=n;break e}n=n.return}throw Error(ye(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(oh(s,""),r.flags&=-33);var i=WC(e);Rb(e,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=WC(e);Ab(e,l,o);break;default:throw Error(ye(161))}}catch(c){nn(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function zG(e,t,n){Ae=e,EM(e)}function EM(e,t,n){for(var r=(e.mode&1)!==0;Ae!==null;){var s=Ae,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||pp;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||fr;l=pp;var d=fr;if(pp=o,(fr=c)&&!d)for(Ae=s;Ae!==null;)o=Ae,c=o.child,o.tag===22&&o.memoizedState!==null?QC(s):c!==null?(c.return=o,Ae=c):QC(s);for(;i!==null;)Ae=i,EM(i),i=i.sibling;Ae=s,pp=l,fr=d}qC(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Ae=i):qC(e)}}function qC(e){for(;Ae!==null;){var t=Ae;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:fr||Yg(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!fr)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:$s(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&AC(t,i,r);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}AC(t,o,n)}break;case 5:var l=t.stateNode;if(n===null&&t.flags&4){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&uh(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ye(163))}fr||t.flags&512&&Ib(t)}catch(f){nn(t,t.return,f)}}if(t===e){Ae=null;break}if(n=t.sibling,n!==null){n.return=t.return,Ae=n;break}Ae=t.return}}function KC(e){for(;Ae!==null;){var t=Ae;if(t===e){Ae=null;break}var n=t.sibling;if(n!==null){n.return=t.return,Ae=n;break}Ae=t.return}}function QC(e){for(;Ae!==null;){var t=Ae;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Yg(4,t)}catch(c){nn(t,n,c)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(c){nn(t,s,c)}}var i=t.return;try{Ib(t)}catch(c){nn(t,i,c)}break;case 5:var o=t.return;try{Ib(t)}catch(c){nn(t,o,c)}}}catch(c){nn(t,t.return,c)}if(t===e){Ae=null;break}var l=t.sibling;if(l!==null){l.return=t.return,Ae=l;break}Ae=t.return}}var GG=Math.ceil,Um=ba.ReactCurrentDispatcher,s0=ba.ReactCurrentOwner,Cs=ba.ReactCurrentBatchConfig,St=0,Gn=null,kn=null,er=0,Yr=0,Tc=Mo(0),jn=0,Sh=null,Pl=0,Xg=0,i0=0,Ku=null,$r=null,a0=0,xd=1/0,Gi=null,Vm=!1,jb=null,oo=null,mp=!1,eo=null,Bm=0,Qu=0,Mb=null,Bp=-1,zp=0;function Pr(){return St&6?un():Bp!==-1?Bp:Bp=un()}function lo(e){return e.mode&1?St&2&&er!==0?er&-er:_G.transition!==null?(zp===0&&(zp=dj()),zp):(e=At,e!==0||(e=window.event,e=e===void 0?16:vj(e.type)),e):1}function Xs(e,t,n,r){if(50<Qu)throw Qu=0,Mb=null,Error(ye(185));cf(e,n,r),(!(St&2)||e!==Gn)&&(e===Gn&&(!(St&2)&&(Xg|=n),jn===4&&$a(e,er)),Wr(e,r),n===1&&St===0&&!(t.mode&1)&&(xd=un()+500,Kg&&Do()))}function Wr(e,t){var n=e.callbackNode;_z(e,t);var r=Cm(e,e===Gn?er:0);if(r===0)n!==null&&sC(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&sC(n),t===1)e.tag===0?EG(JC.bind(null,e)):Oj(JC.bind(null,e)),SG(function(){!(St&6)&&Do()}),n=null;else{switch(uj(r)){case 1:n=RS;break;case 4:n=lj;break;case 16:n=Tm;break;case 536870912:n=cj;break;default:n=Tm}n=MM(n,_M.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function _M(e,t){if(Bp=-1,zp=0,St&6)throw Error(ye(327));var n=e.callbackNode;if(Oc()&&e.callbackNode!==n)return null;var r=Cm(e,e===Gn?er:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=zm(e,r);else{t=r;var s=St;St|=2;var i=NM();(Gn!==e||er!==t)&&(Gi=null,xd=un()+500,vl(e,t));do try{qG();break}catch(l){PM(e,l)}while(!0);WS(),Um.current=i,St=s,kn!==null?t=0:(Gn=null,er=0,t=jn)}if(t!==0){if(t===2&&(s=ob(e),s!==0&&(r=s,t=Db(e,s))),t===1)throw n=Sh,vl(e,0),$a(e,r),Wr(e,un()),n;if(t===6)$a(e,r);else{if(s=e.current.alternate,!(r&30)&&!WG(s)&&(t=zm(e,r),t===2&&(i=ob(e),i!==0&&(r=i,t=Db(e,i))),t===1))throw n=Sh,vl(e,0),$a(e,r),Wr(e,un()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(ye(345));case 2:Jo(e,$r,Gi);break;case 3:if($a(e,r),(r&130023424)===r&&(t=a0+500-un(),10<t)){if(Cm(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){Pr(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=mb(Jo.bind(null,e,$r,Gi),t);break}Jo(e,$r,Gi);break;case 4:if($a(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var o=31-Ys(r);i=1<<o,o=t[o],o>s&&(s=o),r&=~i}if(r=s,r=un()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*GG(r/1960))-r,10<r){e.timeoutHandle=mb(Jo.bind(null,e,$r,Gi),r);break}Jo(e,$r,Gi);break;case 5:Jo(e,$r,Gi);break;default:throw Error(ye(329))}}}return Wr(e,un()),e.callbackNode===n?_M.bind(null,e):null}function Db(e,t){var n=Ku;return e.current.memoizedState.isDehydrated&&(vl(e,t).flags|=256),e=zm(e,t),e!==2&&(t=$r,$r=n,t!==null&&Ob(t)),e}function Ob(e){$r===null?$r=e:$r.push.apply($r,e)}function WG(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!ti(i(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function $a(e,t){for(t&=~i0,t&=~Xg,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Ys(t),r=1<<n;e[n]=-1,t&=~r}}function JC(e){if(St&6)throw Error(ye(327));Oc();var t=Cm(e,0);if(!(t&1))return Wr(e,un()),null;var n=zm(e,t);if(e.tag!==0&&n===2){var r=ob(e);r!==0&&(t=r,n=Db(e,r))}if(n===1)throw n=Sh,vl(e,0),$a(e,t),Wr(e,un()),n;if(n===6)throw Error(ye(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Jo(e,$r,Gi),Wr(e,un()),null}function o0(e,t){var n=St;St|=1;try{return e(t)}finally{St=n,St===0&&(xd=un()+500,Kg&&Do())}}function Nl(e){eo!==null&&eo.tag===0&&!(St&6)&&Oc();var t=St;St|=1;var n=Cs.transition,r=At;try{if(Cs.transition=null,At=1,e)return e()}finally{At=r,Cs.transition=n,St=t,!(St&6)&&Do()}}function l0(){Yr=Tc.current,Bt(Tc)}function vl(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,wG(n)),kn!==null)for(n=kn.return;n!==null;){var r=n;switch(BS(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Im();break;case 3:vd(),Bt(zr),Bt(vr),YS();break;case 5:JS(r);break;case 4:vd();break;case 13:Bt(Qt);break;case 19:Bt(Qt);break;case 10:HS(r.type._context);break;case 22:case 23:l0()}n=n.return}if(Gn=e,kn=e=co(e.current,null),er=Yr=t,jn=0,Sh=null,i0=Xg=Pl=0,$r=Ku=null,nl!==null){for(t=0;t<nl.length;t++)if(n=nl[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}nl=null}return e}function PM(e,t){do{var n=kn;try{if(WS(),$p.current=$m,Fm){for(var r=Yt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Fm=!1}if(_l=0,Bn=Nn=Yt=null,Hu=!1,xh=0,s0.current=null,n===null||n.return===null){jn=1,Sh=t,kn=null;break}e:{var i=e,o=n.return,l=n,c=t;if(t=er,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=l,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var m=LC(o);if(m!==null){m.flags&=-257,FC(m,o,l,i,t),m.mode&1&&OC(i,d,t),t=m,c=d;var g=t.updateQueue;if(g===null){var v=new Set;v.add(c),t.updateQueue=v}else g.add(c);break e}else{if(!(t&1)){OC(i,d,t),c0();break e}c=Error(ye(426))}}else if(Wt&&l.mode&1){var x=LC(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),FC(x,o,l,i,t),zS(yd(c,l));break e}}i=c=yd(c,l),jn!==4&&(jn=2),Ku===null?Ku=[i]:Ku.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var S=uM(i,c,t);IC(i,S);break e;case 1:l=c;var y=i.type,b=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(oo===null||!oo.has(b)))){i.flags|=65536,t&=-t,i.lanes|=t;var w=hM(i,l,t);IC(i,w);break e}}i=i.return}while(i!==null)}AM(n)}catch(C){t=C,kn===n&&n!==null&&(kn=n=n.return);continue}break}while(!0)}function NM(){var e=Um.current;return Um.current=$m,e===null?$m:e}function c0(){(jn===0||jn===3||jn===2)&&(jn=4),Gn===null||!(Pl&268435455)&&!(Xg&268435455)||$a(Gn,er)}function zm(e,t){var n=St;St|=2;var r=NM();(Gn!==e||er!==t)&&(Gi=null,vl(e,t));do try{HG();break}catch(s){PM(e,s)}while(!0);if(WS(),St=n,Um.current=r,kn!==null)throw Error(ye(261));return Gn=null,er=0,jn}function HG(){for(;kn!==null;)IM(kn)}function qG(){for(;kn!==null&&!yz();)IM(kn)}function IM(e){var t=jM(e.alternate,e,Yr);e.memoizedProps=e.pendingProps,t===null?AM(e):kn=t,s0.current=null}function AM(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=UG(n,t),n!==null){n.flags&=32767,kn=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{jn=6,kn=null;return}}else if(n=$G(n,t,Yr),n!==null){kn=n;return}if(t=t.sibling,t!==null){kn=t;return}kn=t=e}while(t!==null);jn===0&&(jn=5)}function Jo(e,t,n){var r=At,s=Cs.transition;try{Cs.transition=null,At=1,KG(e,t,n,r)}finally{Cs.transition=s,At=r}return null}function KG(e,t,n,r){do Oc();while(eo!==null);if(St&6)throw Error(ye(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(ye(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(Pz(e,i),e===Gn&&(kn=Gn=null,er=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||mp||(mp=!0,MM(Tm,function(){return Oc(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Cs.transition,Cs.transition=null;var o=At;At=1;var l=St;St|=4,s0.current=null,BG(e,n),CM(n,e),pG(fb),Em=!!hb,fb=hb=null,e.current=n,zG(n),xz(),St=l,At=o,Cs.transition=i}else e.current=n;if(mp&&(mp=!1,eo=e,Bm=s),i=e.pendingLanes,i===0&&(oo=null),Sz(n.stateNode),Wr(e,un()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Vm)throw Vm=!1,e=jb,jb=null,e;return Bm&1&&e.tag!==0&&Oc(),i=e.pendingLanes,i&1?e===Mb?Qu++:(Qu=0,Mb=e):Qu=0,Do(),null}function Oc(){if(eo!==null){var e=uj(Bm),t=Cs.transition,n=At;try{if(Cs.transition=null,At=16>e?16:e,eo===null)var r=!1;else{if(e=eo,eo=null,Bm=0,St&6)throw Error(ye(331));var s=St;for(St|=4,Ae=e.current;Ae!==null;){var i=Ae,o=i.child;if(Ae.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(Ae=d;Ae!==null;){var u=Ae;switch(u.tag){case 0:case 11:case 15:qu(8,u,i)}var h=u.child;if(h!==null)h.return=u,Ae=h;else for(;Ae!==null;){u=Ae;var f=u.sibling,m=u.return;if(SM(u),u===d){Ae=null;break}if(f!==null){f.return=m,Ae=f;break}Ae=m}}}var g=i.alternate;if(g!==null){var v=g.child;if(v!==null){g.child=null;do{var x=v.sibling;v.sibling=null,v=x}while(v!==null)}}Ae=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Ae=o;else e:for(;Ae!==null;){if(i=Ae,i.flags&2048)switch(i.tag){case 0:case 11:case 15:qu(9,i,i.return)}var S=i.sibling;if(S!==null){S.return=i.return,Ae=S;break e}Ae=i.return}}var y=e.current;for(Ae=y;Ae!==null;){o=Ae;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,Ae=b;else e:for(o=y;Ae!==null;){if(l=Ae,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Yg(9,l)}}catch(C){nn(l,l.return,C)}if(l===o){Ae=null;break e}var w=l.sibling;if(w!==null){w.return=l.return,Ae=w;break e}Ae=l.return}}if(St=s,Do(),bi&&typeof bi.onPostCommitFiberRoot=="function")try{bi.onPostCommitFiberRoot(zg,e)}catch{}r=!0}return r}finally{At=n,Cs.transition=t}}return!1}function YC(e,t,n){t=yd(n,t),t=uM(e,t,1),e=ao(e,t,1),t=Pr(),e!==null&&(cf(e,1,t),Wr(e,t))}function nn(e,t,n){if(e.tag===3)YC(e,e,n);else for(;t!==null;){if(t.tag===3){YC(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(oo===null||!oo.has(r))){e=yd(n,e),e=hM(t,e,1),t=ao(t,e,1),e=Pr(),t!==null&&(cf(t,1,e),Wr(t,e));break}}t=t.return}}function QG(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Pr(),e.pingedLanes|=e.suspendedLanes&n,Gn===e&&(er&n)===n&&(jn===4||jn===3&&(er&130023424)===er&&500>un()-a0?vl(e,0):i0|=n),Wr(e,t)}function RM(e,t){t===0&&(e.mode&1?(t=ip,ip<<=1,!(ip&130023424)&&(ip=4194304)):t=1);var n=Pr();e=da(e,t),e!==null&&(cf(e,t,n),Wr(e,n))}function JG(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),RM(e,n)}function YG(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(ye(314))}r!==null&&r.delete(t),RM(e,n)}var jM;jM=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||zr.current)Ur=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Ur=!1,FG(e,t,n);Ur=!!(e.flags&131072)}else Ur=!1,Wt&&t.flags&1048576&&Lj(t,jm,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Vp(e,t),e=t.pendingProps;var s=pd(t,vr.current);Dc(t,n),s=ZS(null,t,r,e,s,n);var i=e0();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Gr(r)?(i=!0,Am(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,KS(t),s.updater=Jg,t.stateNode=s,s._reactInternals=t,Sb(t,r,e,n),t=Cb(null,t,r,!0,i,n)):(t.tag=0,Wt&&i&&VS(t),Tr(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Vp(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=ZG(r),e=$s(r,e),s){case 0:t=Tb(null,t,r,e,n);break e;case 1:t=VC(null,t,r,e,n);break e;case 11:t=$C(null,t,r,e,n);break e;case 14:t=UC(null,t,r,$s(r.type,e),n);break e}throw Error(ye(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:$s(r,s),Tb(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:$s(r,s),VC(e,t,r,s,n);case 3:e:{if(gM(t),e===null)throw Error(ye(387));r=t.pendingProps,i=t.memoizedState,s=i.element,zj(e,t),Om(t,r,null,n);var o=t.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=yd(Error(ye(423)),t),t=BC(e,t,r,n,s);break e}else if(r!==s){s=yd(Error(ye(424)),t),t=BC(e,t,r,n,s);break e}else for(rs=io(t.stateNode.containerInfo.firstChild),ss=t,Wt=!0,zs=null,n=Vj(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(md(),r===s){t=ua(e,t,n);break e}Tr(e,t,r,n)}t=t.child}return t;case 5:return Gj(t),e===null&&xb(t),r=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,o=s.children,pb(r,s)?o=null:i!==null&&pb(r,i)&&(t.flags|=32),mM(e,t),Tr(e,t,o,n),t.child;case 6:return e===null&&xb(t),null;case 13:return vM(e,t,n);case 4:return QS(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=gd(t,null,r,n):Tr(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:$s(r,s),$C(e,t,r,s,n);case 7:return Tr(e,t,t.pendingProps,n),t.child;case 8:return Tr(e,t,t.pendingProps.children,n),t.child;case 12:return Tr(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,i=t.memoizedProps,o=s.value,Lt(Mm,r._currentValue),r._currentValue=o,i!==null)if(ti(i.value,o)){if(i.children===s.children&&!zr.current){t=ua(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=sa(-1,n&-n),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),bb(i.return,n,t),l.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(ye(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),bb(o,n,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Tr(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,Dc(t,n),s=Ps(s),r=r(s),t.flags|=1,Tr(e,t,r,n),t.child;case 14:return r=t.type,s=$s(r,t.pendingProps),s=$s(r.type,s),UC(e,t,r,s,n);case 15:return fM(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:$s(r,s),Vp(e,t),t.tag=1,Gr(r)?(e=!0,Am(t)):e=!1,Dc(t,n),dM(t,r,s),Sb(t,r,s,n),Cb(null,t,r,!0,e,n);case 19:return yM(e,t,n);case 22:return pM(e,t,n)}throw Error(ye(156,t.tag))};function MM(e,t){return oj(e,t)}function XG(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ts(e,t,n,r){return new XG(e,t,n,r)}function d0(e){return e=e.prototype,!(!e||!e.isReactComponent)}function ZG(e){if(typeof e=="function")return d0(e)?1:0;if(e!=null){if(e=e.$$typeof,e===NS)return 11;if(e===IS)return 14}return 2}function co(e,t){var n=e.alternate;return n===null?(n=Ts(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Gp(e,t,n,r,s,i){var o=2;if(r=e,typeof e=="function")d0(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case pc:return yl(n.children,s,i,t);case PS:o=8,s|=8;break;case Hx:return e=Ts(12,n,t,s|2),e.elementType=Hx,e.lanes=i,e;case qx:return e=Ts(13,n,t,s),e.elementType=qx,e.lanes=i,e;case Kx:return e=Ts(19,n,t,s),e.elementType=Kx,e.lanes=i,e;case GR:return Zg(n,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case BR:o=10;break e;case zR:o=9;break e;case NS:o=11;break e;case IS:o=14;break e;case Oa:o=16,r=null;break e}throw Error(ye(130,e==null?e:typeof e,""))}return t=Ts(o,n,t,s),t.elementType=e,t.type=r,t.lanes=i,t}function yl(e,t,n,r){return e=Ts(7,e,r,t),e.lanes=n,e}function Zg(e,t,n,r){return e=Ts(22,e,r,t),e.elementType=GR,e.lanes=n,e.stateNode={isHidden:!1},e}function Wy(e,t,n){return e=Ts(6,e,null,t),e.lanes=n,e}function Hy(e,t,n){return t=Ts(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function eW(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ey(0),this.expirationTimes=Ey(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ey(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function u0(e,t,n,r,s,i,o,l,c){return e=new eW(e,t,n,l,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Ts(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},KS(i),e}function tW(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:fc,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function DM(e){if(!e)return bo;e=e._reactInternals;e:{if(Kl(e)!==e||e.tag!==1)throw Error(ye(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Gr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ye(171))}if(e.tag===1){var n=e.type;if(Gr(n))return Dj(e,n,t)}return t}function OM(e,t,n,r,s,i,o,l,c){return e=u0(n,r,!0,e,s,i,o,l,c),e.context=DM(null),n=e.current,r=Pr(),s=lo(n),i=sa(r,s),i.callback=t??null,ao(n,i,s),e.current.lanes=s,cf(e,s,r),Wr(e,r),e}function ev(e,t,n,r){var s=t.current,i=Pr(),o=lo(s);return n=DM(n),t.context===null?t.context=n:t.pendingContext=n,t=sa(i,o),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=ao(s,t,o),e!==null&&(Xs(e,s,o,i),Fp(e,s,o)),o}function Gm(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function XC(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function h0(e,t){XC(e,t),(e=e.alternate)&&XC(e,t)}function nW(){return null}var LM=typeof reportError=="function"?reportError:function(e){console.error(e)};function f0(e){this._internalRoot=e}tv.prototype.render=f0.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ye(409));ev(e,t,null,null)};tv.prototype.unmount=f0.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Nl(function(){ev(null,e,null,null)}),t[ca]=null}};function tv(e){this._internalRoot=e}tv.prototype.unstable_scheduleHydration=function(e){if(e){var t=pj();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Fa.length&&t!==0&&t<Fa[n].priority;n++);Fa.splice(n,0,e),n===0&&gj(e)}};function p0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function nv(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function ZC(){}function rW(e,t,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=Gm(o);i.call(d)}}var o=OM(t,r,e,0,null,!1,!1,"",ZC);return e._reactRootContainer=o,e[ca]=o.current,ph(e.nodeType===8?e.parentNode:e),Nl(),o}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var d=Gm(c);l.call(d)}}var c=u0(e,0,!1,null,null,!1,!1,"",ZC);return e._reactRootContainer=c,e[ca]=c.current,ph(e.nodeType===8?e.parentNode:e),Nl(function(){ev(t,c,n,r)}),c}function rv(e,t,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=Gm(o);l.call(c)}}ev(t,o,e,s)}else o=rW(n,t,e,s,r);return Gm(o)}hj=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Nu(t.pendingLanes);n!==0&&(jS(t,n|1),Wr(t,un()),!(St&6)&&(xd=un()+500,Do()))}break;case 13:Nl(function(){var r=da(e,1);if(r!==null){var s=Pr();Xs(r,e,1,s)}}),h0(e,1)}};MS=function(e){if(e.tag===13){var t=da(e,134217728);if(t!==null){var n=Pr();Xs(t,e,134217728,n)}h0(e,134217728)}};fj=function(e){if(e.tag===13){var t=lo(e),n=da(e,t);if(n!==null){var r=Pr();Xs(n,e,t,r)}h0(e,t)}};pj=function(){return At};mj=function(e,t){var n=At;try{return At=e,t()}finally{At=n}};sb=function(e,t,n){switch(t){case"input":if(Yx(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=qg(r);if(!s)throw Error(ye(90));HR(r),Yx(r,s)}}}break;case"textarea":KR(e,n);break;case"select":t=n.value,t!=null&&Ac(e,!!n.multiple,t,!1)}};tj=o0;nj=Nl;var sW={usingClientEntryPoint:!1,Events:[uf,yc,qg,ZR,ej,o0]},pu={findFiberByHostInstance:tl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},iW={bundleType:pu.bundleType,version:pu.version,rendererPackageName:pu.rendererPackageName,rendererConfig:pu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ba.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=ij(e),e===null?null:e.stateNode},findFiberByHostInstance:pu.findFiberByHostInstance||nW,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var gp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!gp.isDisabled&&gp.supportsFiber)try{zg=gp.inject(iW),bi=gp}catch{}}hs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sW;hs.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p0(t))throw Error(ye(200));return tW(e,t,null,n)};hs.createRoot=function(e,t){if(!p0(e))throw Error(ye(299));var n=!1,r="",s=LM;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=u0(e,1,!1,null,null,n,!1,r,s),e[ca]=t.current,ph(e.nodeType===8?e.parentNode:e),new f0(t)};hs.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ye(188)):(e=Object.keys(e).join(","),Error(ye(268,e)));return e=ij(t),e=e===null?null:e.stateNode,e};hs.flushSync=function(e){return Nl(e)};hs.hydrate=function(e,t,n){if(!nv(t))throw Error(ye(200));return rv(null,e,t,!0,n)};hs.hydrateRoot=function(e,t,n){if(!p0(e))throw Error(ye(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=LM;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=OM(t,null,e,1,n??null,s,!1,i,o),e[ca]=t.current,ph(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new tv(t)};hs.render=function(e,t,n){if(!nv(t))throw Error(ye(200));return rv(null,e,t,!1,n)};hs.unmountComponentAtNode=function(e){if(!nv(e))throw Error(ye(40));return e._reactRootContainer?(Nl(function(){rv(null,null,e,!1,function(){e._reactRootContainer=null,e[ca]=null})}),!0):!1};hs.unstable_batchedUpdates=o0;hs.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!nv(n))throw Error(ye(200));if(e==null||e._reactInternals===void 0)throw Error(ye(38));return rv(e,t,n,!1,r)};hs.version="18.3.1-next-f1338f8080-20240426";function FM(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(FM)}catch(e){console.error(e)}}FM(),FR.exports=hs;var Ql=FR.exports;const aW=of(Ql);var $M,eE=Ql;$M=eE.createRoot,eE.hydrateRoot;const oW="modulepreload",lW=function(e){return"/"+e},tE={},m0=function(t,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(n.map(c=>{if(c=lW(c),c in tE)return;tE[c]=!0;const d=c.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":oW,d||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),d)return new Promise((f,m)=>{h.addEventListener("load",f),h.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return t().catch(i)})};function cW(e,t){if(e instanceof RegExp)return{keys:!1,pattern:e};var n,r,s,i,o=[],l="",c=e.split("/");for(c[0]||c.shift();s=c.shift();)n=s[0],n==="*"?(o.push(n),l+=s[1]==="?"?"(?:/(.*))?":"/(.*)"):n===":"?(r=s.indexOf("?",1),i=s.indexOf(".",1),o.push(s.substring(1,~r?r:~i?i:s.length)),l+=~r&&!~i?"(?:/([^/]+?))?":"/([^/]+?)",~i&&(l+=(~r?"?":"")+"\\"+s.substring(i))):l+="/"+s;return{keys:o,pattern:new RegExp("^"+l+(t?"(?=$|/)":"/?$"),"i")}}var UM={exports:{}},VM={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bd=p;function dW(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var uW=typeof Object.is=="function"?Object.is:dW,hW=bd.useState,fW=bd.useEffect,pW=bd.useLayoutEffect,mW=bd.useDebugValue;function gW(e,t){var n=t(),r=hW({inst:{value:n,getSnapshot:t}}),s=r[0].inst,i=r[1];return pW(function(){s.value=n,s.getSnapshot=t,qy(s)&&i({inst:s})},[e,n,t]),fW(function(){return qy(s)&&i({inst:s}),e(function(){qy(s)&&i({inst:s})})},[e]),mW(n),n}function qy(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!uW(e,n)}catch{return!0}}function vW(e,t){return t()}var yW=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?vW:gW;VM.useSyncExternalStore=bd.useSyncExternalStore!==void 0?bd.useSyncExternalStore:yW;UM.exports=VM;var BM=UM.exports;const xW=Bg.useInsertionEffect,bW=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",wW=bW?p.useLayoutEffect:p.useEffect,SW=xW||wW,zM=e=>{const t=p.useRef([e,(...n)=>t[0](...n)]).current;return SW(()=>{t[0]=e}),t[1]},kW="popstate",g0="pushState",v0="replaceState",TW="hashchange",nE=[kW,g0,v0,TW],CW=e=>{for(const t of nE)addEventListener(t,e);return()=>{for(const t of nE)removeEventListener(t,e)}},GM=(e,t)=>BM.useSyncExternalStore(CW,e,t),rE=()=>location.search,EW=({ssrSearch:e}={})=>GM(rE,e!=null?()=>e:rE),sE=()=>location.pathname,_W=({ssrPath:e}={})=>GM(sE,e!=null?()=>e:sE),PW=(e,{replace:t=!1,state:n=null}={})=>history[t?v0:g0](n,"",e),NW=(e={})=>[_W(e),PW],iE=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[iE]>"u"){for(const e of[g0,v0]){const t=history[e];history[e]=function(){const n=t.apply(this,arguments),r=new Event(e);return r.arguments=arguments,dispatchEvent(r),n}}Object.defineProperty(window,iE,{value:!0})}const IW=(e,t)=>t.toLowerCase().indexOf(e.toLowerCase())?"~"+t:t.slice(e.length)||"/",WM=(e="")=>e==="/"?"":e,AW=(e,t)=>e[0]==="~"?e.slice(1):WM(t)+e,RW=(e="",t)=>IW(aE(WM(e)),aE(t)),aE=e=>{try{return decodeURI(e)}catch{return e}},HM={hook:NW,searchHook:EW,parser:cW,base:"",ssrPath:void 0,ssrSearch:void 0,ssrContext:void 0,hrefs:e=>e},qM=p.createContext(HM),Ud=()=>p.useContext(qM),KM={},QM=p.createContext(KM),jW=()=>p.useContext(QM),sv=e=>{const[t,n]=e.hook(e);return[RW(e.base,t),zM((r,s)=>n(AW(r,e.base),s))]},Jl=()=>sv(Ud()),y0=(e,t,n,r)=>{const{pattern:s,keys:i}=t instanceof RegExp?{keys:!1,pattern:t}:e(t||"*",r),o=s.exec(n)||[],[l,...c]=o;return l!==void 0?[!0,(()=>{const d=i!==!1?Object.fromEntries(i.map((h,f)=>[h,c[f]])):o.groups;let u={...c};return d&&Object.assign(u,d),u})(),...r?[l]:[]]:[!1,null]},MW=e=>y0(Ud().parser,e,Jl()[0]),DW=({children:e,...t})=>{var u,h,f;const n=Ud(),r=t.hook?HM:n;let s=r;const[i,o=t.ssrSearch??""]=((u=t.ssrPath)==null?void 0:u.split("?"))??[];i&&(t.ssrSearch=o,t.ssrPath=i),t.hrefs=t.hrefs??((h=t.hook)==null?void 0:h.hrefs),t.searchHook=t.searchHook??((f=t.hook)==null?void 0:f.searchHook);let l=p.useRef({}),c=l.current,d=c;for(let m in r){const g=m==="base"?r[m]+(t[m]??""):t[m]??r[m];c===d&&g!==d[m]&&(l.current=d={...d}),d[m]=g,(g!==r[m]||g!==s[m])&&(s=d)}return p.createElement(qM.Provider,{value:s,children:e})},oE=({children:e,component:t},n)=>t?p.createElement(t,{params:n}):typeof e=="function"?e(n):e,OW=e=>{let t=p.useRef(KM);const n=t.current;return t.current=Object.keys(e).length!==Object.keys(n).length||Object.entries(e).some(([r,s])=>s!==n[r])?e:n},Ls=({path:e,nest:t,match:n,...r})=>{const s=Ud(),[i]=sv(s),[o,l,c]=n??y0(s.parser,e,i,t),d=OW({...jW(),...l});if(!o)return null;const u=c?p.createElement(DW,{base:c},oE(r,d)):oE(r,d);return p.createElement(QM.Provider,{value:d,children:u})};p.forwardRef((e,t)=>{const n=Ud(),[r,s]=sv(n),{to:i="",href:o=i,onClick:l,asChild:c,children:d,className:u,replace:h,state:f,...m}=e,g=zM(x=>{x.ctrlKey||x.metaKey||x.altKey||x.shiftKey||x.button!==0||(l==null||l(x),x.defaultPrevented||(x.preventDefault(),s(o,e)))}),v=n.hrefs(o[0]==="~"?o.slice(1):n.base+o,n);return c&&p.isValidElement(d)?p.cloneElement(d,{onClick:g,href:v}):p.createElement("a",{...m,onClick:g,href:v,className:u!=null&&u.call?u(r===o):u,children:d,ref:t})});const JM=e=>Array.isArray(e)?e.flatMap(t=>JM(t&&t.type===p.Fragment?t.props.children:t)):[e],LW=({children:e,location:t})=>{const n=Ud(),[r]=sv(n);for(const s of JM(e)){let i=0;if(p.isValidElement(s)&&(i=y0(n.parser,s.props.path,t||r,s.props.nest))[0])return p.cloneElement(s,{match:i})}return null};var Vd=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},FW={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},Ga,bS,SN,$W=(SN=class{constructor(){Oe(this,Ga,FW);Oe(this,bS,!1)}setTimeoutProvider(e){Ce(this,Ga,e)}setTimeout(e,t){return B(this,Ga).setTimeout(e,t)}clearTimeout(e){B(this,Ga).clearTimeout(e)}setInterval(e,t){return B(this,Ga).setInterval(e,t)}clearInterval(e){B(this,Ga).clearInterval(e)}},Ga=new WeakMap,bS=new WeakMap,SN),sl=new $W;function UW(e){setTimeout(e,0)}var Il=typeof window>"u"||"Deno"in globalThis;function Cr(){}function VW(e,t){return typeof e=="function"?e(t):e}function Lb(e){return typeof e=="number"&&e>=0&&e!==1/0}function YM(e,t){return Math.max(e+(t||0)-Date.now(),0)}function uo(e,t){return typeof e=="function"?e(t):e}function xs(e,t){return typeof e=="function"?e(t):e}function lE(e,t){const{type:n="all",exact:r,fetchStatus:s,predicate:i,queryKey:o,stale:l}=e;if(o){if(r){if(t.queryHash!==x0(o,t.options))return!1}else if(!kh(t.queryKey,o))return!1}if(n!=="all"){const c=t.isActive();if(n==="active"&&!c||n==="inactive"&&c)return!1}return!(typeof l=="boolean"&&t.isStale()!==l||s&&s!==t.state.fetchStatus||i&&!i(t))}function cE(e,t){const{exact:n,status:r,predicate:s,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(n){if(Al(t.options.mutationKey)!==Al(i))return!1}else if(!kh(t.options.mutationKey,i))return!1}return!(r&&t.state.status!==r||s&&!s(t))}function x0(e,t){return((t==null?void 0:t.queryKeyHashFn)||Al)(e)}function Al(e){return JSON.stringify(e,(t,n)=>Fb(n)?Object.keys(n).sort().reduce((r,s)=>(r[s]=n[s],r),{}):n)}function kh(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(n=>kh(e[n],t[n])):!1}var BW=Object.prototype.hasOwnProperty;function XM(e,t){if(e===t)return e;const n=dE(e)&&dE(t);if(!n&&!(Fb(e)&&Fb(t)))return t;const s=(n?e:Object.keys(e)).length,i=n?t:Object.keys(t),o=i.length,l=n?new Array(o):{};let c=0;for(let d=0;d<o;d++){const u=n?d:i[d],h=e[u],f=t[u];if(h===f){l[u]=h,(n?d<s:BW.call(e,u))&&c++;continue}if(h===null||f===null||typeof h!="object"||typeof f!="object"){l[u]=f;continue}const m=XM(h,f);l[u]=m,m===h&&c++}return s===o&&c===s?e:l}function Wm(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}function dE(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Fb(e){if(!uE(e))return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(!uE(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function uE(e){return Object.prototype.toString.call(e)==="[object Object]"}function zW(e){return new Promise(t=>{sl.setTimeout(t,e)})}function $b(e,t,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,t):n.structuralSharing!==!1?XM(e,t):t}function GW(e,t,n=0){const r=[...e,t];return n&&r.length>n?r.slice(1):r}function WW(e,t,n=0){const r=[t,...e];return n&&r.length>n?r.slice(0,-1):r}var b0=Symbol();function ZM(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===b0?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function eD(e,t){return typeof e=="function"?e(...t):!!e}var ll,Wa,td,kN,HW=(kN=class extends Vd{constructor(){super();Oe(this,ll);Oe(this,Wa);Oe(this,td);Ce(this,td,t=>{if(!Il&&window.addEventListener){const n=()=>t();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){B(this,Wa)||this.setEventListener(B(this,td))}onUnsubscribe(){var t;this.hasListeners()||((t=B(this,Wa))==null||t.call(this),Ce(this,Wa,void 0))}setEventListener(t){var n;Ce(this,td,t),(n=B(this,Wa))==null||n.call(this),Ce(this,Wa,t(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(t){B(this,ll)!==t&&(Ce(this,ll,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(n=>{n(t)})}isFocused(){var t;return typeof B(this,ll)=="boolean"?B(this,ll):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},ll=new WeakMap,Wa=new WeakMap,td=new WeakMap,kN),w0=new HW;function Ub(){let e,t;const n=new Promise((s,i)=>{e=s,t=i});n.status="pending",n.catch(()=>{});function r(s){Object.assign(n,s),delete n.resolve,delete n.reject}return n.resolve=s=>{r({status:"fulfilled",value:s}),e(s)},n.reject=s=>{r({status:"rejected",reason:s}),t(s)},n}var qW=UW;function KW(){let e=[],t=0,n=l=>{l()},r=l=>{l()},s=qW;const i=l=>{t?e.push(l):s(()=>{n(l)})},o=()=>{const l=e;e=[],l.length&&s(()=>{r(()=>{l.forEach(c=>{n(c)})})})};return{batch:l=>{let c;t++;try{c=l()}finally{t--,t||o()}return c},batchCalls:l=>(...c)=>{i(()=>{l(...c)})},schedule:i,setNotifyFunction:l=>{n=l},setBatchNotifyFunction:l=>{r=l},setScheduler:l=>{s=l}}}var Rn=KW(),nd,Ha,rd,TN,QW=(TN=class extends Vd{constructor(){super();Oe(this,nd,!0);Oe(this,Ha);Oe(this,rd);Ce(this,rd,t=>{if(!Il&&window.addEventListener){const n=()=>t(!0),r=()=>t(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){B(this,Ha)||this.setEventListener(B(this,rd))}onUnsubscribe(){var t;this.hasListeners()||((t=B(this,Ha))==null||t.call(this),Ce(this,Ha,void 0))}setEventListener(t){var n;Ce(this,rd,t),(n=B(this,Ha))==null||n.call(this),Ce(this,Ha,t(this.setOnline.bind(this)))}setOnline(t){B(this,nd)!==t&&(Ce(this,nd,t),this.listeners.forEach(r=>{r(t)}))}isOnline(){return B(this,nd)}},nd=new WeakMap,Ha=new WeakMap,rd=new WeakMap,TN),Hm=new QW;function JW(e){return Math.min(1e3*2**e,3e4)}function tD(e){return(e??"online")==="online"?Hm.isOnline():!0}var Vb=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function nD(e){let t=!1,n=0,r;const s=Ub(),i=()=>s.status!=="pending",o=v=>{var x;if(!i()){const S=new Vb(v);f(S),(x=e.onCancel)==null||x.call(e,S)}},l=()=>{t=!0},c=()=>{t=!1},d=()=>w0.isFocused()&&(e.networkMode==="always"||Hm.isOnline())&&e.canRun(),u=()=>tD(e.networkMode)&&e.canRun(),h=v=>{i()||(r==null||r(),s.resolve(v))},f=v=>{i()||(r==null||r(),s.reject(v))},m=()=>new Promise(v=>{var x;r=S=>{(i()||d())&&v(S)},(x=e.onPause)==null||x.call(e)}).then(()=>{var v;r=void 0,i()||(v=e.onContinue)==null||v.call(e)}),g=()=>{if(i())return;let v;const x=n===0?e.initialPromise:void 0;try{v=x??e.fn()}catch(S){v=Promise.reject(S)}Promise.resolve(v).then(h).catch(S=>{var I;if(i())return;const y=e.retry??(Il?0:3),b=e.retryDelay??JW,w=typeof b=="function"?b(n,S):b,C=y===!0||typeof y=="number"&&n<y||typeof y=="function"&&y(n,S);if(t||!C){f(S);return}n++,(I=e.onFail)==null||I.call(e,n,S),zW(w).then(()=>d()?void 0:m()).then(()=>{t?f(S):g()})})};return{promise:s,status:()=>s.status,cancel:o,continue:()=>(r==null||r(),s),cancelRetry:l,continueRetry:c,canStart:u,start:()=>(u()?g():m().then(g),s)}}var cl,CN,rD=(CN=class{constructor(){Oe(this,cl)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Lb(this.gcTime)&&Ce(this,cl,sl.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Il?1/0:5*60*1e3))}clearGcTimeout(){B(this,cl)&&(sl.clearTimeout(B(this,cl)),Ce(this,cl,void 0))}},cl=new WeakMap,CN),dl,sd,vs,ul,Vn,tf,hl,Us,Ui,EN,YW=(EN=class extends rD{constructor(t){super();Oe(this,Us);Oe(this,dl);Oe(this,sd);Oe(this,vs);Oe(this,ul);Oe(this,Vn);Oe(this,tf);Oe(this,hl);Ce(this,hl,!1),Ce(this,tf,t.defaultOptions),this.setOptions(t.options),this.observers=[],Ce(this,ul,t.client),Ce(this,vs,B(this,ul).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Ce(this,dl,fE(this.options)),this.state=t.state??B(this,dl),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=B(this,Vn))==null?void 0:t.promise}setOptions(t){if(this.options={...B(this,tf),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=fE(this.options);n.data!==void 0&&(this.setState(hE(n.data,n.dataUpdatedAt)),Ce(this,dl,n))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&B(this,vs).remove(this)}setData(t,n){const r=$b(this.state.data,t,this.options);return it(this,Us,Ui).call(this,{data:r,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),r}setState(t,n){it(this,Us,Ui).call(this,{type:"setState",state:t,setStateOptions:n})}cancel(t){var r,s;const n=(r=B(this,Vn))==null?void 0:r.promise;return(s=B(this,Vn))==null||s.cancel(t),n?n.then(Cr).catch(Cr):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(B(this,dl))}isActive(){return this.observers.some(t=>xs(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===b0||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>uo(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!YM(this.state.dataUpdatedAt,t)}onFocus(){var n;const t=this.observers.find(r=>r.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(n=B(this,Vn))==null||n.continue()}onOnline(){var n;const t=this.observers.find(r=>r.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(n=B(this,Vn))==null||n.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),B(this,vs).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(n=>n!==t),this.observers.length||(B(this,Vn)&&(B(this,hl)?B(this,Vn).cancel({revert:!0}):B(this,Vn).cancelRetry()),this.scheduleGc()),B(this,vs).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||it(this,Us,Ui).call(this,{type:"invalidate"})}async fetch(t,n){var c,d,u,h,f,m,g,v,x,S,y,b;if(this.state.fetchStatus!=="idle"&&((c=B(this,Vn))==null?void 0:c.status())!=="rejected"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(B(this,Vn))return B(this,Vn).continueRetry(),B(this,Vn).promise}if(t&&this.setOptions(t),!this.options.queryFn){const w=this.observers.find(C=>C.options.queryFn);w&&this.setOptions(w.options)}const r=new AbortController,s=w=>{Object.defineProperty(w,"signal",{enumerable:!0,get:()=>(Ce(this,hl,!0),r.signal)})},i=()=>{const w=ZM(this.options,n),I=(()=>{const R={client:B(this,ul),queryKey:this.queryKey,meta:this.meta};return s(R),R})();return Ce(this,hl,!1),this.options.persister?this.options.persister(w,I,this):w(I)},l=(()=>{const w={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:B(this,ul),state:this.state,fetchFn:i};return s(w),w})();(d=this.options.behavior)==null||d.onFetch(l,this),Ce(this,sd,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((u=l.fetchOptions)==null?void 0:u.meta))&&it(this,Us,Ui).call(this,{type:"fetch",meta:(h=l.fetchOptions)==null?void 0:h.meta}),Ce(this,Vn,nD({initialPromise:n==null?void 0:n.initialPromise,fn:l.fetchFn,onCancel:w=>{w instanceof Vb&&w.revert&&this.setState({...B(this,sd),fetchStatus:"idle"}),r.abort()},onFail:(w,C)=>{it(this,Us,Ui).call(this,{type:"failed",failureCount:w,error:C})},onPause:()=>{it(this,Us,Ui).call(this,{type:"pause"})},onContinue:()=>{it(this,Us,Ui).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0}));try{const w=await B(this,Vn).start();if(w===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(w),(m=(f=B(this,vs).config).onSuccess)==null||m.call(f,w,this),(v=(g=B(this,vs).config).onSettled)==null||v.call(g,w,this.state.error,this),w}catch(w){if(w instanceof Vb){if(w.silent)return B(this,Vn).promise;if(w.revert){if(this.state.data===void 0)throw w;return this.state.data}}throw it(this,Us,Ui).call(this,{type:"error",error:w}),(S=(x=B(this,vs).config).onError)==null||S.call(x,w,this),(b=(y=B(this,vs).config).onSettled)==null||b.call(y,this.state.data,w,this),w}finally{this.scheduleGc()}}},dl=new WeakMap,sd=new WeakMap,vs=new WeakMap,ul=new WeakMap,Vn=new WeakMap,tf=new WeakMap,hl=new WeakMap,Us=new WeakSet,Ui=function(t){const n=r=>{switch(t.type){case"failed":return{...r,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...sD(r.data,this.options),fetchMeta:t.meta??null};case"success":const s={...r,...hE(t.data,t.dataUpdatedAt),dataUpdateCount:r.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return Ce(this,sd,t.manual?s:void 0),s;case"error":const i=t.error;return{...r,error:i,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...t.state}}};this.state=n(this.state),Rn.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),B(this,vs).notify({query:this,type:"updated",action:t})})},EN);function sD(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:tD(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function hE(e,t){return{data:e,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function fE(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,n=t!==void 0,r=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var Or,pt,nf,Sr,fl,id,Ki,qa,rf,ad,od,pl,ml,Ka,ld,It,Au,Bb,zb,Gb,Wb,Hb,qb,Kb,iD,_N,XW=(_N=class extends Vd{constructor(t,n){super();Oe(this,It);Oe(this,Or);Oe(this,pt);Oe(this,nf);Oe(this,Sr);Oe(this,fl);Oe(this,id);Oe(this,Ki);Oe(this,qa);Oe(this,rf);Oe(this,ad);Oe(this,od);Oe(this,pl);Oe(this,ml);Oe(this,Ka);Oe(this,ld,new Set);this.options=n,Ce(this,Or,t),Ce(this,qa,null),Ce(this,Ki,Ub()),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(B(this,pt).addObserver(this),pE(B(this,pt),this.options)?it(this,It,Au).call(this):this.updateResult(),it(this,It,Wb).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Qb(B(this,pt),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Qb(B(this,pt),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,it(this,It,Hb).call(this),it(this,It,qb).call(this),B(this,pt).removeObserver(this)}setOptions(t){const n=this.options,r=B(this,pt);if(this.options=B(this,Or).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof xs(this.options.enabled,B(this,pt))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");it(this,It,Kb).call(this),B(this,pt).setOptions(this.options),n._defaulted&&!Wm(this.options,n)&&B(this,Or).getQueryCache().notify({type:"observerOptionsUpdated",query:B(this,pt),observer:this});const s=this.hasListeners();s&&mE(B(this,pt),r,this.options,n)&&it(this,It,Au).call(this),this.updateResult(),s&&(B(this,pt)!==r||xs(this.options.enabled,B(this,pt))!==xs(n.enabled,B(this,pt))||uo(this.options.staleTime,B(this,pt))!==uo(n.staleTime,B(this,pt)))&&it(this,It,Bb).call(this);const i=it(this,It,zb).call(this);s&&(B(this,pt)!==r||xs(this.options.enabled,B(this,pt))!==xs(n.enabled,B(this,pt))||i!==B(this,Ka))&&it(this,It,Gb).call(this,i)}getOptimisticResult(t){const n=B(this,Or).getQueryCache().build(B(this,Or),t),r=this.createResult(n,t);return eH(this,r)&&(Ce(this,Sr,r),Ce(this,id,this.options),Ce(this,fl,B(this,pt).state)),r}getCurrentResult(){return B(this,Sr)}trackResult(t,n){return new Proxy(t,{get:(r,s)=>(this.trackProp(s),n==null||n(s),s==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&B(this,Ki).status==="pending"&&B(this,Ki).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(r,s))})}trackProp(t){B(this,ld).add(t)}getCurrentQuery(){return B(this,pt)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const n=B(this,Or).defaultQueryOptions(t),r=B(this,Or).getQueryCache().build(B(this,Or),n);return r.fetch().then(()=>this.createResult(r,n))}fetch(t){return it(this,It,Au).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),B(this,Sr)))}createResult(t,n){var N;const r=B(this,pt),s=this.options,i=B(this,Sr),o=B(this,fl),l=B(this,id),d=t!==r?t.state:B(this,nf),{state:u}=t;let h={...u},f=!1,m;if(n._optimisticResults){const O=this.hasListeners(),G=!O&&pE(t,n),H=O&&mE(t,r,n,s);(G||H)&&(h={...h,...sD(u.data,t.options)}),n._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:g,errorUpdatedAt:v,status:x}=h;m=h.data;let S=!1;if(n.placeholderData!==void 0&&m===void 0&&x==="pending"){let O;i!=null&&i.isPlaceholderData&&n.placeholderData===(l==null?void 0:l.placeholderData)?(O=i.data,S=!0):O=typeof n.placeholderData=="function"?n.placeholderData((N=B(this,od))==null?void 0:N.state.data,B(this,od)):n.placeholderData,O!==void 0&&(x="success",m=$b(i==null?void 0:i.data,O,n),f=!0)}if(n.select&&m!==void 0&&!S)if(i&&m===(o==null?void 0:o.data)&&n.select===B(this,rf))m=B(this,ad);else try{Ce(this,rf,n.select),m=n.select(m),m=$b(i==null?void 0:i.data,m,n),Ce(this,ad,m),Ce(this,qa,null)}catch(O){Ce(this,qa,O)}B(this,qa)&&(g=B(this,qa),m=B(this,ad),v=Date.now(),x="error");const y=h.fetchStatus==="fetching",b=x==="pending",w=x==="error",C=b&&y,I=m!==void 0,L={status:x,fetchStatus:h.fetchStatus,isPending:b,isSuccess:x==="success",isError:w,isInitialLoading:C,isLoading:C,data:m,dataUpdatedAt:h.dataUpdatedAt,error:g,errorUpdatedAt:v,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>d.dataUpdateCount||h.errorUpdateCount>d.errorUpdateCount,isFetching:y,isRefetching:y&&!b,isLoadingError:w&&!I,isPaused:h.fetchStatus==="paused",isPlaceholderData:f,isRefetchError:w&&I,isStale:S0(t,n),refetch:this.refetch,promise:B(this,Ki),isEnabled:xs(n.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const O=re=>{L.status==="error"?re.reject(L.error):L.data!==void 0&&re.resolve(L.data)},G=()=>{const re=Ce(this,Ki,L.promise=Ub());O(re)},H=B(this,Ki);switch(H.status){case"pending":t.queryHash===r.queryHash&&O(H);break;case"fulfilled":(L.status==="error"||L.data!==H.value)&&G();break;case"rejected":(L.status!=="error"||L.error!==H.reason)&&G();break}}return L}updateResult(){const t=B(this,Sr),n=this.createResult(B(this,pt),this.options);if(Ce(this,fl,B(this,pt).state),Ce(this,id,this.options),B(this,fl).data!==void 0&&Ce(this,od,B(this,pt)),Wm(n,t))return;Ce(this,Sr,n);const r=()=>{if(!t)return!0;const{notifyOnChangeProps:s}=this.options,i=typeof s=="function"?s():s;if(i==="all"||!i&&!B(this,ld).size)return!0;const o=new Set(i??B(this,ld));return this.options.throwOnError&&o.add("error"),Object.keys(B(this,Sr)).some(l=>{const c=l;return B(this,Sr)[c]!==t[c]&&o.has(c)})};it(this,It,iD).call(this,{listeners:r()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&it(this,It,Wb).call(this)}},Or=new WeakMap,pt=new WeakMap,nf=new WeakMap,Sr=new WeakMap,fl=new WeakMap,id=new WeakMap,Ki=new WeakMap,qa=new WeakMap,rf=new WeakMap,ad=new WeakMap,od=new WeakMap,pl=new WeakMap,ml=new WeakMap,Ka=new WeakMap,ld=new WeakMap,It=new WeakSet,Au=function(t){it(this,It,Kb).call(this);let n=B(this,pt).fetch(this.options,t);return t!=null&&t.throwOnError||(n=n.catch(Cr)),n},Bb=function(){it(this,It,Hb).call(this);const t=uo(this.options.staleTime,B(this,pt));if(Il||B(this,Sr).isStale||!Lb(t))return;const r=YM(B(this,Sr).dataUpdatedAt,t)+1;Ce(this,pl,sl.setTimeout(()=>{B(this,Sr).isStale||this.updateResult()},r))},zb=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(B(this,pt)):this.options.refetchInterval)??!1},Gb=function(t){it(this,It,qb).call(this),Ce(this,Ka,t),!(Il||xs(this.options.enabled,B(this,pt))===!1||!Lb(B(this,Ka))||B(this,Ka)===0)&&Ce(this,ml,sl.setInterval(()=>{(this.options.refetchIntervalInBackground||w0.isFocused())&&it(this,It,Au).call(this)},B(this,Ka)))},Wb=function(){it(this,It,Bb).call(this),it(this,It,Gb).call(this,it(this,It,zb).call(this))},Hb=function(){B(this,pl)&&(sl.clearTimeout(B(this,pl)),Ce(this,pl,void 0))},qb=function(){B(this,ml)&&(sl.clearInterval(B(this,ml)),Ce(this,ml,void 0))},Kb=function(){const t=B(this,Or).getQueryCache().build(B(this,Or),this.options);if(t===B(this,pt))return;const n=B(this,pt);Ce(this,pt,t),Ce(this,nf,t.state),this.hasListeners()&&(n==null||n.removeObserver(this),t.addObserver(this))},iD=function(t){Rn.batch(()=>{t.listeners&&this.listeners.forEach(n=>{n(B(this,Sr))}),B(this,Or).getQueryCache().notify({query:B(this,pt),type:"observerResultsUpdated"})})},_N);function ZW(e,t){return xs(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function pE(e,t){return ZW(e,t)||e.state.data!==void 0&&Qb(e,t,t.refetchOnMount)}function Qb(e,t,n){if(xs(t.enabled,e)!==!1&&uo(t.staleTime,e)!=="static"){const r=typeof n=="function"?n(e):n;return r==="always"||r!==!1&&S0(e,t)}return!1}function mE(e,t,n,r){return(e!==t||xs(r.enabled,e)===!1)&&(!n.suspense||e.state.status!=="error")&&S0(e,n)}function S0(e,t){return xs(t.enabled,e)!==!1&&e.isStaleByTime(uo(t.staleTime,e))}function eH(e,t){return!Wm(e.getCurrentResult(),t)}function gE(e){return{onFetch:(t,n)=>{var u,h,f,m,g;const r=t.options,s=(f=(h=(u=t.fetchOptions)==null?void 0:u.meta)==null?void 0:h.fetchMore)==null?void 0:f.direction,i=((m=t.state.data)==null?void 0:m.pages)||[],o=((g=t.state.data)==null?void 0:g.pageParams)||[];let l={pages:[],pageParams:[]},c=0;const d=async()=>{let v=!1;const x=b=>{Object.defineProperty(b,"signal",{enumerable:!0,get:()=>(t.signal.aborted?v=!0:t.signal.addEventListener("abort",()=>{v=!0}),t.signal)})},S=ZM(t.options,t.fetchOptions),y=async(b,w,C)=>{if(v)return Promise.reject();if(w==null&&b.pages.length)return Promise.resolve(b);const R=(()=>{const G={client:t.client,queryKey:t.queryKey,pageParam:w,direction:C?"backward":"forward",meta:t.options.meta};return x(G),G})(),L=await S(R),{maxPages:N}=t.options,O=C?WW:GW;return{pages:O(b.pages,L,N),pageParams:O(b.pageParams,w,N)}};if(s&&i.length){const b=s==="backward",w=b?tH:vE,C={pages:i,pageParams:o},I=w(r,C);l=await y(C,I,b)}else{const b=e??i.length;do{const w=c===0?o[0]??r.initialPageParam:vE(r,l);if(c>0&&w==null)break;l=await y(l,w),c++}while(c<b)}return l};t.options.persister?t.fetchFn=()=>{var v,x;return(x=(v=t.options).persister)==null?void 0:x.call(v,d,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n)}:t.fetchFn=d}}}function vE(e,{pages:t,pageParams:n}){const r=t.length-1;return t.length>0?e.getNextPageParam(t[r],t,n[r],n):void 0}function tH(e,{pages:t,pageParams:n}){var r;return t.length>0?(r=e.getPreviousPageParam)==null?void 0:r.call(e,t[0],t,n[0],n):void 0}var sf,ui,kr,gl,hi,ja,PN,nH=(PN=class extends rD{constructor(t){super();Oe(this,hi);Oe(this,sf);Oe(this,ui);Oe(this,kr);Oe(this,gl);Ce(this,sf,t.client),this.mutationId=t.mutationId,Ce(this,kr,t.mutationCache),Ce(this,ui,[]),this.state=t.state||aD(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){B(this,ui).includes(t)||(B(this,ui).push(t),this.clearGcTimeout(),B(this,kr).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Ce(this,ui,B(this,ui).filter(n=>n!==t)),this.scheduleGc(),B(this,kr).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){B(this,ui).length||(this.state.status==="pending"?this.scheduleGc():B(this,kr).remove(this))}continue(){var t;return((t=B(this,gl))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var o,l,c,d,u,h,f,m,g,v,x,S,y,b,w,C,I,R,L,N;const n=()=>{it(this,hi,ja).call(this,{type:"continue"})},r={client:B(this,sf),meta:this.options.meta,mutationKey:this.options.mutationKey};Ce(this,gl,nD({fn:()=>this.options.mutationFn?this.options.mutationFn(t,r):Promise.reject(new Error("No mutationFn found")),onFail:(O,G)=>{it(this,hi,ja).call(this,{type:"failed",failureCount:O,error:G})},onPause:()=>{it(this,hi,ja).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>B(this,kr).canRun(this)}));const s=this.state.status==="pending",i=!B(this,gl).canStart();try{if(s)n();else{it(this,hi,ja).call(this,{type:"pending",variables:t,isPaused:i}),await((l=(o=B(this,kr).config).onMutate)==null?void 0:l.call(o,t,this,r));const G=await((d=(c=this.options).onMutate)==null?void 0:d.call(c,t,r));G!==this.state.context&&it(this,hi,ja).call(this,{type:"pending",context:G,variables:t,isPaused:i})}const O=await B(this,gl).start();return await((h=(u=B(this,kr).config).onSuccess)==null?void 0:h.call(u,O,t,this.state.context,this,r)),await((m=(f=this.options).onSuccess)==null?void 0:m.call(f,O,t,this.state.context,r)),await((v=(g=B(this,kr).config).onSettled)==null?void 0:v.call(g,O,null,this.state.variables,this.state.context,this,r)),await((S=(x=this.options).onSettled)==null?void 0:S.call(x,O,null,t,this.state.context,r)),it(this,hi,ja).call(this,{type:"success",data:O}),O}catch(O){try{throw await((b=(y=B(this,kr).config).onError)==null?void 0:b.call(y,O,t,this.state.context,this,r)),await((C=(w=this.options).onError)==null?void 0:C.call(w,O,t,this.state.context,r)),await((R=(I=B(this,kr).config).onSettled)==null?void 0:R.call(I,void 0,O,this.state.variables,this.state.context,this,r)),await((N=(L=this.options).onSettled)==null?void 0:N.call(L,void 0,O,t,this.state.context,r)),O}finally{it(this,hi,ja).call(this,{type:"error",error:O})}}finally{B(this,kr).runNext(this)}}},sf=new WeakMap,ui=new WeakMap,kr=new WeakMap,gl=new WeakMap,hi=new WeakSet,ja=function(t){const n=r=>{switch(t.type){case"failed":return{...r,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...r,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:t.error,failureCount:r.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=n(this.state),Rn.batch(()=>{B(this,ui).forEach(r=>{r.onMutationUpdate(t)}),B(this,kr).notify({mutation:this,type:"updated",action:t})})},PN);function aD(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Qi,Vs,af,NN,rH=(NN=class extends Vd{constructor(t={}){super();Oe(this,Qi);Oe(this,Vs);Oe(this,af);this.config=t,Ce(this,Qi,new Set),Ce(this,Vs,new Map),Ce(this,af,0)}build(t,n,r){const s=new nH({client:t,mutationCache:this,mutationId:++Zf(this,af)._,options:t.defaultMutationOptions(n),state:r});return this.add(s),s}add(t){B(this,Qi).add(t);const n=vp(t);if(typeof n=="string"){const r=B(this,Vs).get(n);r?r.push(t):B(this,Vs).set(n,[t])}this.notify({type:"added",mutation:t})}remove(t){if(B(this,Qi).delete(t)){const n=vp(t);if(typeof n=="string"){const r=B(this,Vs).get(n);if(r)if(r.length>1){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}else r[0]===t&&B(this,Vs).delete(n)}}this.notify({type:"removed",mutation:t})}canRun(t){const n=vp(t);if(typeof n=="string"){const r=B(this,Vs).get(n),s=r==null?void 0:r.find(i=>i.state.status==="pending");return!s||s===t}else return!0}runNext(t){var r;const n=vp(t);if(typeof n=="string"){const s=(r=B(this,Vs).get(n))==null?void 0:r.find(i=>i!==t&&i.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Rn.batch(()=>{B(this,Qi).forEach(t=>{this.notify({type:"removed",mutation:t})}),B(this,Qi).clear(),B(this,Vs).clear()})}getAll(){return Array.from(B(this,Qi))}find(t){const n={exact:!0,...t};return this.getAll().find(r=>cE(n,r))}findAll(t={}){return this.getAll().filter(n=>cE(t,n))}notify(t){Rn.batch(()=>{this.listeners.forEach(n=>{n(t)})})}resumePausedMutations(){const t=this.getAll().filter(n=>n.state.isPaused);return Rn.batch(()=>Promise.all(t.map(n=>n.continue().catch(Cr))))}},Qi=new WeakMap,Vs=new WeakMap,af=new WeakMap,NN);function vp(e){var t;return(t=e.options.scope)==null?void 0:t.id}var Ji,Qa,Lr,Yi,oa,Wp,Jb,IN,sH=(IN=class extends Vd{constructor(n,r){super();Oe(this,oa);Oe(this,Ji);Oe(this,Qa);Oe(this,Lr);Oe(this,Yi);Ce(this,Ji,n),this.setOptions(r),this.bindMethods(),it(this,oa,Wp).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){var s;const r=this.options;this.options=B(this,Ji).defaultMutationOptions(n),Wm(this.options,r)||B(this,Ji).getMutationCache().notify({type:"observerOptionsUpdated",mutation:B(this,Lr),observer:this}),r!=null&&r.mutationKey&&this.options.mutationKey&&Al(r.mutationKey)!==Al(this.options.mutationKey)?this.reset():((s=B(this,Lr))==null?void 0:s.state.status)==="pending"&&B(this,Lr).setOptions(this.options)}onUnsubscribe(){var n;this.hasListeners()||(n=B(this,Lr))==null||n.removeObserver(this)}onMutationUpdate(n){it(this,oa,Wp).call(this),it(this,oa,Jb).call(this,n)}getCurrentResult(){return B(this,Qa)}reset(){var n;(n=B(this,Lr))==null||n.removeObserver(this),Ce(this,Lr,void 0),it(this,oa,Wp).call(this),it(this,oa,Jb).call(this)}mutate(n,r){var s;return Ce(this,Yi,r),(s=B(this,Lr))==null||s.removeObserver(this),Ce(this,Lr,B(this,Ji).getMutationCache().build(B(this,Ji),this.options)),B(this,Lr).addObserver(this),B(this,Lr).execute(n)}},Ji=new WeakMap,Qa=new WeakMap,Lr=new WeakMap,Yi=new WeakMap,oa=new WeakSet,Wp=function(){var r;const n=((r=B(this,Lr))==null?void 0:r.state)??aD();Ce(this,Qa,{...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset})},Jb=function(n){Rn.batch(()=>{var r,s,i,o,l,c,d,u;if(B(this,Yi)&&this.hasListeners()){const h=B(this,Qa).variables,f=B(this,Qa).context,m={client:B(this,Ji),meta:this.options.meta,mutationKey:this.options.mutationKey};(n==null?void 0:n.type)==="success"?((s=(r=B(this,Yi)).onSuccess)==null||s.call(r,n.data,h,f,m),(o=(i=B(this,Yi)).onSettled)==null||o.call(i,n.data,null,h,f,m)):(n==null?void 0:n.type)==="error"&&((c=(l=B(this,Yi)).onError)==null||c.call(l,n.error,h,f,m),(u=(d=B(this,Yi)).onSettled)==null||u.call(d,void 0,n.error,h,f,m))}this.listeners.forEach(h=>{h(B(this,Qa))})})},IN),fi,AN,iH=(AN=class extends Vd{constructor(t={}){super();Oe(this,fi);this.config=t,Ce(this,fi,new Map)}build(t,n,r){const s=n.queryKey,i=n.queryHash??x0(s,n);let o=this.get(i);return o||(o=new YW({client:t,queryKey:s,queryHash:i,options:t.defaultQueryOptions(n),state:r,defaultOptions:t.getQueryDefaults(s)}),this.add(o)),o}add(t){B(this,fi).has(t.queryHash)||(B(this,fi).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const n=B(this,fi).get(t.queryHash);n&&(t.destroy(),n===t&&B(this,fi).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Rn.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return B(this,fi).get(t)}getAll(){return[...B(this,fi).values()]}find(t){const n={exact:!0,...t};return this.getAll().find(r=>lE(n,r))}findAll(t={}){const n=this.getAll();return Object.keys(t).length>0?n.filter(r=>lE(t,r)):n}notify(t){Rn.batch(()=>{this.listeners.forEach(n=>{n(t)})})}onFocus(){Rn.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Rn.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},fi=new WeakMap,AN),tn,Ja,Ya,cd,dd,Xa,ud,hd,RN,aH=(RN=class{constructor(e={}){Oe(this,tn);Oe(this,Ja);Oe(this,Ya);Oe(this,cd);Oe(this,dd);Oe(this,Xa);Oe(this,ud);Oe(this,hd);Ce(this,tn,e.queryCache||new iH),Ce(this,Ja,e.mutationCache||new rH),Ce(this,Ya,e.defaultOptions||{}),Ce(this,cd,new Map),Ce(this,dd,new Map),Ce(this,Xa,0)}mount(){Zf(this,Xa)._++,B(this,Xa)===1&&(Ce(this,ud,w0.subscribe(async e=>{e&&(await this.resumePausedMutations(),B(this,tn).onFocus())})),Ce(this,hd,Hm.subscribe(async e=>{e&&(await this.resumePausedMutations(),B(this,tn).onOnline())})))}unmount(){var e,t;Zf(this,Xa)._--,B(this,Xa)===0&&((e=B(this,ud))==null||e.call(this),Ce(this,ud,void 0),(t=B(this,hd))==null||t.call(this),Ce(this,hd,void 0))}isFetching(e){return B(this,tn).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return B(this,Ja).findAll({...e,status:"pending"}).length}getQueryData(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=B(this,tn).get(t.queryHash))==null?void 0:n.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),n=B(this,tn).build(this,t),r=n.state.data;return r===void 0?this.fetchQuery(e):(e.revalidateIfStale&&n.isStaleByTime(uo(t.staleTime,n))&&this.prefetchQuery(t),Promise.resolve(r))}getQueriesData(e){return B(this,tn).findAll(e).map(({queryKey:t,state:n})=>{const r=n.data;return[t,r]})}setQueryData(e,t,n){const r=this.defaultQueryOptions({queryKey:e}),s=B(this,tn).get(r.queryHash),i=s==null?void 0:s.state.data,o=VW(t,i);if(o!==void 0)return B(this,tn).build(this,r).setData(o,{...n,manual:!0})}setQueriesData(e,t,n){return Rn.batch(()=>B(this,tn).findAll(e).map(({queryKey:r})=>[r,this.setQueryData(r,t,n)]))}getQueryState(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=B(this,tn).get(t.queryHash))==null?void 0:n.state}removeQueries(e){const t=B(this,tn);Rn.batch(()=>{t.findAll(e).forEach(n=>{t.remove(n)})})}resetQueries(e,t){const n=B(this,tn);return Rn.batch(()=>(n.findAll(e).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const n={revert:!0,...t},r=Rn.batch(()=>B(this,tn).findAll(e).map(s=>s.cancel(n)));return Promise.all(r).then(Cr).catch(Cr)}invalidateQueries(e,t={}){return Rn.batch(()=>(B(this,tn).findAll(e).forEach(n=>{n.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const n={...t,cancelRefetch:t.cancelRefetch??!0},r=Rn.batch(()=>B(this,tn).findAll(e).filter(s=>!s.isDisabled()&&!s.isStatic()).map(s=>{let i=s.fetch(void 0,n);return n.throwOnError||(i=i.catch(Cr)),s.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(r).then(Cr)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const n=B(this,tn).build(this,t);return n.isStaleByTime(uo(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Cr).catch(Cr)}fetchInfiniteQuery(e){return e.behavior=gE(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Cr).catch(Cr)}ensureInfiniteQueryData(e){return e.behavior=gE(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Hm.isOnline()?B(this,Ja).resumePausedMutations():Promise.resolve()}getQueryCache(){return B(this,tn)}getMutationCache(){return B(this,Ja)}getDefaultOptions(){return B(this,Ya)}setDefaultOptions(e){Ce(this,Ya,e)}setQueryDefaults(e,t){B(this,cd).set(Al(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...B(this,cd).values()],n={};return t.forEach(r=>{kh(e,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(e,t){B(this,dd).set(Al(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...B(this,dd).values()],n={};return t.forEach(r=>{kh(e,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...B(this,Ya).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=x0(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===b0&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...B(this,Ya).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){B(this,tn).clear(),B(this,Ja).clear()}},tn=new WeakMap,Ja=new WeakMap,Ya=new WeakMap,cd=new WeakMap,dd=new WeakMap,Xa=new WeakMap,ud=new WeakMap,hd=new WeakMap,RN),oD=p.createContext(void 0),ff=e=>{const t=p.useContext(oD);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},oH=({client:e,children:t})=>(p.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),a.jsx(oD.Provider,{value:e,children:t})),lD=p.createContext(!1),lH=()=>p.useContext(lD);lD.Provider;function cH(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var dH=p.createContext(cH()),uH=()=>p.useContext(dH),hH=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},fH=e=>{p.useEffect(()=>{e.clearReset()},[e])},pH=({result:e,errorResetBoundary:t,throwOnError:n,query:r,suspense:s})=>e.isError&&!t.isReset()&&!e.isFetching&&r&&(s&&e.data===void 0||eD(n,[e.error,r])),mH=e=>{if(e.suspense){const n=s=>s==="static"?s:Math.max(s??1e3,1e3),r=e.staleTime;e.staleTime=typeof r=="function"?(...s)=>n(r(...s)):n(r),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},gH=(e,t)=>e.isLoading&&e.isFetching&&!t,vH=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,yE=(e,t,n)=>t.fetchOptimistic(e).catch(()=>{n.clearReset()});function yH(e,t,n){var h,f,m,g,v;const r=lH(),s=uH(),i=ff(),o=i.defaultQueryOptions(e);(f=(h=i.getDefaultOptions().queries)==null?void 0:h._experimental_beforeQuery)==null||f.call(h,o),o._optimisticResults=r?"isRestoring":"optimistic",mH(o),hH(o,s),fH(s);const l=!i.getQueryCache().get(o.queryHash),[c]=p.useState(()=>new t(i,o)),d=c.getOptimisticResult(o),u=!r&&e.subscribed!==!1;if(p.useSyncExternalStore(p.useCallback(x=>{const S=u?c.subscribe(Rn.batchCalls(x)):Cr;return c.updateResult(),S},[c,u]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),p.useEffect(()=>{c.setOptions(o)},[o,c]),vH(o,d))throw yE(o,c,s);if(pH({result:d,errorResetBoundary:s,throwOnError:o.throwOnError,query:i.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw d.error;if((g=(m=i.getDefaultOptions().queries)==null?void 0:m._experimental_afterQuery)==null||g.call(m,o,d),o.experimental_prefetchInRender&&!Il&&gH(d,r)){const x=l?yE(o,c,s):(v=i.getQueryCache().get(o.queryHash))==null?void 0:v.promise;x==null||x.catch(Cr).finally(()=>{c.updateResult()})}return o.notifyOnChangeProps?d:c.trackResult(d)}function Pt(e,t){return yH(e,XW)}function Nt(e,t){const n=ff(),[r]=p.useState(()=>new sH(n,e));p.useEffect(()=>{r.setOptions(e)},[r,e]);const s=p.useSyncExternalStore(p.useCallback(o=>r.subscribe(Rn.batchCalls(o)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),i=p.useCallback((o,l)=>{r.mutate(o,l).catch(Cr)},[r]);if(s.error&&eD(r.options.throwOnError,[s.error]))throw s.error;return{...s,mutate:i,mutateAsync:s.mutate}}const xH="";function lt(e){return e.startsWith("http")?e:`${xH}${e}`}async function cD(e){if(!e.ok){const t=await e.text()||e.statusText;throw new Error(`${e.status}: ${t}`)}}async function kt(e,t,n){const r=lt(t),s=await fetch(r,{method:e,headers:n?{"Content-Type":"application/json"}:{},body:n?JSON.stringify(n):void 0,credentials:"include"});return await cD(s),s}const bH=({on401:e})=>async({queryKey:t})=>{const n=t.join("/"),r=lt(n),s=await fetch(r,{credentials:"include"});return s.status===401?null:(await cD(s),await s.json())},ze=new aH({defaultOptions:{queries:{queryFn:bH({on401:"returnNull"}),refetchInterval:!1,refetchOnWindowFocus:!1,staleTime:3e4,refetchOnMount:!0,retry:!1},mutations:{retry:!1}}}),wH=1,SH=1e6;let Ky=0;function kH(){return Ky=(Ky+1)%Number.MAX_SAFE_INTEGER,Ky.toString()}const Qy=new Map,xE=e=>{if(Qy.has(e))return;const t=setTimeout(()=>{Qy.delete(e),Ju({type:"REMOVE_TOAST",toastId:e})},SH);Qy.set(e,t)},TH=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,wH)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(n=>n.id===t.toast.id?{...n,...t.toast}:n)};case"DISMISS_TOAST":{const{toastId:n}=t;return n?xE(n):e.toasts.forEach(r=>{xE(r.id)}),{...e,toasts:e.toasts.map(r=>r.id===n||n===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(n=>n.id!==t.toastId)}}},Hp=[];let qp={toasts:[]};function Ju(e){qp=TH(qp,e),Hp.forEach(t=>{t(qp)})}function CH({...e}){const t=kH(),n=s=>Ju({type:"UPDATE_TOAST",toast:{...s,id:t}}),r=()=>Ju({type:"DISMISS_TOAST",toastId:t});return Ju({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:s=>{s||r()}}}),{id:t,dismiss:r,update:n}}function Wn(){const[e,t]=p.useState(qp);return p.useEffect(()=>(Hp.push(t),()=>{const n=Hp.indexOf(t);n>-1&&Hp.splice(n,1)}),[e]),{...e,toast:CH,dismiss:n=>Ju({type:"DISMISS_TOAST",toastId:n})}}function pe(e,t,{checkForDefaultPrevented:n=!0}={}){return function(s){if(e==null||e(s),n===!1||!s.defaultPrevented)return t==null?void 0:t(s)}}function bE(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function Ii(...e){return t=>{let n=!1;const r=e.map(s=>{const i=bE(s,t);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():bE(e[s],null)}}}}function We(...e){return p.useCallback(Ii(...e),e)}function EH(e,t){const n=p.createContext(t),r=i=>{const{children:o,...l}=i,c=p.useMemo(()=>l,Object.values(l));return a.jsx(n.Provider,{value:c,children:o})};r.displayName=e+"Provider";function s(i){const o=p.useContext(n);if(o)return o;if(t!==void 0)return t;throw new Error(`\`${i}\` must be used within \`${e}\``)}return[r,s]}function Mn(e,t=[]){let n=[];function r(i,o){const l=p.createContext(o),c=n.length;n=[...n,o];const d=h=>{var S;const{scope:f,children:m,...g}=h,v=((S=f==null?void 0:f[e])==null?void 0:S[c])||l,x=p.useMemo(()=>g,Object.values(g));return a.jsx(v.Provider,{value:x,children:m})};d.displayName=i+"Provider";function u(h,f){var v;const m=((v=f==null?void 0:f[e])==null?void 0:v[c])||l,g=p.useContext(m);if(g)return g;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[d,u]}const s=()=>{const i=n.map(o=>p.createContext(o));return function(l){const c=(l==null?void 0:l[e])||i;return p.useMemo(()=>({[`__scope${e}`]:{...l,[e]:c}}),[l,c])}};return s.scopeName=e,[r,_H(s,...t)]}function _H(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=r.reduce((l,{useScope:c,scopeName:d})=>{const h=c(i)[`__scope${d}`];return{...l,...h}},{});return p.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return n.scopeName=t.scopeName,n}function wE(e){const t=PH(e),n=p.forwardRef((r,s)=>{const{children:i,...o}=r,l=p.Children.toArray(i),c=l.find(IH);if(c){const d=c.props.children,u=l.map(h=>h===c?p.Children.count(d)>1?p.Children.only(null):p.isValidElement(d)?d.props.children:null:h);return a.jsx(t,{...o,ref:s,children:p.isValidElement(d)?p.cloneElement(d,void 0,u):null})}return a.jsx(t,{...o,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}function PH(e){const t=p.forwardRef((n,r)=>{const{children:s,...i}=n;if(p.isValidElement(s)){const o=RH(s),l=AH(i,s.props);return s.type!==p.Fragment&&(l.ref=r?Ii(r,o):o),p.cloneElement(s,l)}return p.Children.count(s)>1?p.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var NH=Symbol("radix.slottable");function IH(e){return p.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===NH}function AH(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...l)=>{const c=i(...l);return s(...l),c}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function RH(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function pf(e){const t=e+"CollectionProvider",[n,r]=Mn(t),[s,i]=n(t,{collectionRef:{current:null},itemMap:new Map}),o=v=>{const{scope:x,children:S}=v,y=xe.useRef(null),b=xe.useRef(new Map).current;return a.jsx(s,{scope:x,itemMap:b,collectionRef:y,children:S})};o.displayName=t;const l=e+"CollectionSlot",c=wE(l),d=xe.forwardRef((v,x)=>{const{scope:S,children:y}=v,b=i(l,S),w=We(x,b.collectionRef);return a.jsx(c,{ref:w,children:y})});d.displayName=l;const u=e+"CollectionItemSlot",h="data-radix-collection-item",f=wE(u),m=xe.forwardRef((v,x)=>{const{scope:S,children:y,...b}=v,w=xe.useRef(null),C=We(x,w),I=i(u,S);return xe.useEffect(()=>(I.itemMap.set(w,{ref:w,...b}),()=>void I.itemMap.delete(w))),a.jsx(f,{[h]:"",ref:C,children:y})});m.displayName=u;function g(v){const x=i(e+"CollectionConsumer",v);return xe.useCallback(()=>{const y=x.collectionRef.current;if(!y)return[];const b=Array.from(y.querySelectorAll(`[${h}]`));return Array.from(x.itemMap.values()).sort((I,R)=>b.indexOf(I.ref.current)-b.indexOf(R.ref.current))},[x.collectionRef,x.itemMap])}return[{Provider:o,Slot:d,ItemSlot:m},g,r]}function jH(e){const t=MH(e),n=p.forwardRef((r,s)=>{const{children:i,...o}=r,l=p.Children.toArray(i),c=l.find(OH);if(c){const d=c.props.children,u=l.map(h=>h===c?p.Children.count(d)>1?p.Children.only(null):p.isValidElement(d)?d.props.children:null:h);return a.jsx(t,{...o,ref:s,children:p.isValidElement(d)?p.cloneElement(d,void 0,u):null})}return a.jsx(t,{...o,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}function MH(e){const t=p.forwardRef((n,r)=>{const{children:s,...i}=n;if(p.isValidElement(s)){const o=FH(s),l=LH(i,s.props);return s.type!==p.Fragment&&(l.ref=r?Ii(r,o):o),p.cloneElement(s,l)}return p.Children.count(s)>1?p.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var DH=Symbol("radix.slottable");function OH(e){return p.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===DH}function LH(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...l)=>{const c=i(...l);return s(...l),c}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function FH(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var $H=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Re=$H.reduce((e,t)=>{const n=jH(`Primitive.${t}`),r=p.forwardRef((s,i)=>{const{asChild:o,...l}=s,c=o?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),a.jsx(c,{...l,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function k0(e,t){e&&Ql.flushSync(()=>e.dispatchEvent(t))}function rn(e){const t=p.useRef(e);return p.useEffect(()=>{t.current=e}),p.useMemo(()=>(...n)=>{var r;return(r=t.current)==null?void 0:r.call(t,...n)},[])}function UH(e,t=globalThis==null?void 0:globalThis.document){const n=rn(e);p.useEffect(()=>{const r=s=>{s.key==="Escape"&&n(s)};return t.addEventListener("keydown",r,{capture:!0}),()=>t.removeEventListener("keydown",r,{capture:!0})},[n,t])}var VH="DismissableLayer",Yb="dismissableLayer.update",BH="dismissableLayer.pointerDownOutside",zH="dismissableLayer.focusOutside",SE,dD=p.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Yl=p.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:o,onDismiss:l,...c}=e,d=p.useContext(dD),[u,h]=p.useState(null),f=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=p.useState({}),g=We(t,R=>h(R)),v=Array.from(d.layers),[x]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),S=v.indexOf(x),y=u?v.indexOf(u):-1,b=d.layersWithOutsidePointerEventsDisabled.size>0,w=y>=S,C=WH(R=>{const L=R.target,N=[...d.branches].some(O=>O.contains(L));!w||N||(s==null||s(R),o==null||o(R),R.defaultPrevented||l==null||l())},f),I=HH(R=>{const L=R.target;[...d.branches].some(O=>O.contains(L))||(i==null||i(R),o==null||o(R),R.defaultPrevented||l==null||l())},f);return UH(R=>{y===d.layers.size-1&&(r==null||r(R),!R.defaultPrevented&&l&&(R.preventDefault(),l()))},f),p.useEffect(()=>{if(u)return n&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(SE=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(u)),d.layers.add(u),kE(),()=>{n&&d.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=SE)}},[u,f,n,d]),p.useEffect(()=>()=>{u&&(d.layers.delete(u),d.layersWithOutsidePointerEventsDisabled.delete(u),kE())},[u,d]),p.useEffect(()=>{const R=()=>m({});return document.addEventListener(Yb,R),()=>document.removeEventListener(Yb,R)},[]),a.jsx(Re.div,{...c,ref:g,style:{pointerEvents:b?w?"auto":"none":void 0,...e.style},onFocusCapture:pe(e.onFocusCapture,I.onFocusCapture),onBlurCapture:pe(e.onBlurCapture,I.onBlurCapture),onPointerDownCapture:pe(e.onPointerDownCapture,C.onPointerDownCapture)})});Yl.displayName=VH;var GH="DismissableLayerBranch",uD=p.forwardRef((e,t)=>{const n=p.useContext(dD),r=p.useRef(null),s=We(t,r);return p.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),a.jsx(Re.div,{...e,ref:s})});uD.displayName=GH;function WH(e,t=globalThis==null?void 0:globalThis.document){const n=rn(e),r=p.useRef(!1),s=p.useRef(()=>{});return p.useEffect(()=>{const i=l=>{if(l.target&&!r.current){let c=function(){hD(BH,n,d,{discrete:!0})};const d={originalEvent:l};l.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=c,t.addEventListener("click",s.current,{once:!0})):c()}else t.removeEventListener("click",s.current);r.current=!1},o=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),t.removeEventListener("pointerdown",i),t.removeEventListener("click",s.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function HH(e,t=globalThis==null?void 0:globalThis.document){const n=rn(e),r=p.useRef(!1);return p.useEffect(()=>{const s=i=>{i.target&&!r.current&&hD(zH,n,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function kE(){const e=new CustomEvent(Yb);document.dispatchEvent(e)}function hD(e,t,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&s.addEventListener(e,t,{once:!0}),r?k0(s,i):s.dispatchEvent(i)}var qH=Yl,KH=uD,on=globalThis!=null&&globalThis.document?p.useLayoutEffect:()=>{},QH="Portal",Bd=p.forwardRef((e,t)=>{var l;const{container:n,...r}=e,[s,i]=p.useState(!1);on(()=>i(!0),[]);const o=n||s&&((l=globalThis==null?void 0:globalThis.document)==null?void 0:l.body);return o?aW.createPortal(a.jsx(Re.div,{...r,ref:t}),o):null});Bd.displayName=QH;function JH(e,t){return p.useReducer((n,r)=>t[n][r]??n,e)}var Pn=e=>{const{present:t,children:n}=e,r=YH(t),s=typeof n=="function"?n({present:r.isPresent}):p.Children.only(n),i=We(r.ref,XH(s));return typeof n=="function"||r.isPresent?p.cloneElement(s,{ref:i}):null};Pn.displayName="Presence";function YH(e){const[t,n]=p.useState(),r=p.useRef(null),s=p.useRef(e),i=p.useRef("none"),o=e?"mounted":"unmounted",[l,c]=JH(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return p.useEffect(()=>{const d=yp(r.current);i.current=l==="mounted"?d:"none"},[l]),on(()=>{const d=r.current,u=s.current;if(u!==e){const f=i.current,m=yp(d);e?c("MOUNT"):m==="none"||(d==null?void 0:d.display)==="none"?c("UNMOUNT"):c(u&&f!==m?"ANIMATION_OUT":"UNMOUNT"),s.current=e}},[e,c]),on(()=>{if(t){let d;const u=t.ownerDocument.defaultView??window,h=m=>{const v=yp(r.current).includes(CSS.escape(m.animationName));if(m.target===t&&v&&(c("ANIMATION_END"),!s.current)){const x=t.style.animationFillMode;t.style.animationFillMode="forwards",d=u.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=x)})}},f=m=>{m.target===t&&(i.current=yp(r.current))};return t.addEventListener("animationstart",f),t.addEventListener("animationcancel",h),t.addEventListener("animationend",h),()=>{u.clearTimeout(d),t.removeEventListener("animationstart",f),t.removeEventListener("animationcancel",h),t.removeEventListener("animationend",h)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:p.useCallback(d=>{r.current=d?getComputedStyle(d):null,n(d)},[])}}function yp(e){return(e==null?void 0:e.animationName)||"none"}function XH(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var ZH=Bg[" useInsertionEffect ".trim().toString()]||on;function qr({prop:e,defaultProp:t,onChange:n=()=>{},caller:r}){const[s,i,o]=e8({defaultProp:t,onChange:n}),l=e!==void 0,c=l?e:s;{const u=p.useRef(e!==void 0);p.useEffect(()=>{const h=u.current;h!==l&&console.warn(`${r} is changing from ${h?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=l},[l,r])}const d=p.useCallback(u=>{var h;if(l){const f=t8(u)?u(e):u;f!==e&&((h=o.current)==null||h.call(o,f))}else i(u)},[l,e,i,o]);return[c,d]}function e8({defaultProp:e,onChange:t}){const[n,r]=p.useState(e),s=p.useRef(n),i=p.useRef(t);return ZH(()=>{i.current=t},[t]),p.useEffect(()=>{var o;s.current!==n&&((o=i.current)==null||o.call(i,n),s.current=n)},[n,s]),[n,r,i]}function t8(e){return typeof e=="function"}var fD=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),n8="VisuallyHidden",iv=p.forwardRef((e,t)=>a.jsx(Re.span,{...e,ref:t,style:{...fD,...e.style}}));iv.displayName=n8;var r8=iv,T0="ToastProvider",[C0,s8,i8]=pf("Toast"),[pD]=Mn("Toast",[i8]),[a8,av]=pD(T0),mD=e=>{const{__scopeToast:t,label:n="Notification",duration:r=5e3,swipeDirection:s="right",swipeThreshold:i=50,children:o}=e,[l,c]=p.useState(null),[d,u]=p.useState(0),h=p.useRef(!1),f=p.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${T0}\`. Expected non-empty \`string\`.`),a.jsx(C0.Provider,{scope:t,children:a.jsx(a8,{scope:t,label:n,duration:r,swipeDirection:s,swipeThreshold:i,toastCount:d,viewport:l,onViewportChange:c,onToastAdd:p.useCallback(()=>u(m=>m+1),[]),onToastRemove:p.useCallback(()=>u(m=>m-1),[]),isFocusedToastEscapeKeyDownRef:h,isClosePausedRef:f,children:o})})};mD.displayName=T0;var gD="ToastViewport",o8=["F8"],Xb="toast.viewportPause",Zb="toast.viewportResume",vD=p.forwardRef((e,t)=>{const{__scopeToast:n,hotkey:r=o8,label:s="Notifications ({hotkey})",...i}=e,o=av(gD,n),l=s8(n),c=p.useRef(null),d=p.useRef(null),u=p.useRef(null),h=p.useRef(null),f=We(t,h,o.onViewportChange),m=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),g=o.toastCount>0;p.useEffect(()=>{const x=S=>{var b;r.length!==0&&r.every(w=>S[w]||S.code===w)&&((b=h.current)==null||b.focus())};return document.addEventListener("keydown",x),()=>document.removeEventListener("keydown",x)},[r]),p.useEffect(()=>{const x=c.current,S=h.current;if(g&&x&&S){const y=()=>{if(!o.isClosePausedRef.current){const I=new CustomEvent(Xb);S.dispatchEvent(I),o.isClosePausedRef.current=!0}},b=()=>{if(o.isClosePausedRef.current){const I=new CustomEvent(Zb);S.dispatchEvent(I),o.isClosePausedRef.current=!1}},w=I=>{!x.contains(I.relatedTarget)&&b()},C=()=>{x.contains(document.activeElement)||b()};return x.addEventListener("focusin",y),x.addEventListener("focusout",w),x.addEventListener("pointermove",y),x.addEventListener("pointerleave",C),window.addEventListener("blur",y),window.addEventListener("focus",b),()=>{x.removeEventListener("focusin",y),x.removeEventListener("focusout",w),x.removeEventListener("pointermove",y),x.removeEventListener("pointerleave",C),window.removeEventListener("blur",y),window.removeEventListener("focus",b)}}},[g,o.isClosePausedRef]);const v=p.useCallback(({tabbingDirection:x})=>{const y=l().map(b=>{const w=b.ref.current,C=[w,...b8(w)];return x==="forwards"?C:C.reverse()});return(x==="forwards"?y.reverse():y).flat()},[l]);return p.useEffect(()=>{const x=h.current;if(x){const S=y=>{var C,I,R;const b=y.altKey||y.ctrlKey||y.metaKey;if(y.key==="Tab"&&!b){const L=document.activeElement,N=y.shiftKey;if(y.target===x&&N){(C=d.current)==null||C.focus();return}const H=v({tabbingDirection:N?"backwards":"forwards"}),re=H.findIndex(X=>X===L);Jy(H.slice(re+1))?y.preventDefault():N?(I=d.current)==null||I.focus():(R=u.current)==null||R.focus()}};return x.addEventListener("keydown",S),()=>x.removeEventListener("keydown",S)}},[l,v]),a.jsxs(KH,{ref:c,role:"region","aria-label":s.replace("{hotkey}",m),tabIndex:-1,style:{pointerEvents:g?void 0:"none"},children:[g&&a.jsx(ew,{ref:d,onFocusFromOutsideViewport:()=>{const x=v({tabbingDirection:"forwards"});Jy(x)}}),a.jsx(C0.Slot,{scope:n,children:a.jsx(Re.ol,{tabIndex:-1,...i,ref:f})}),g&&a.jsx(ew,{ref:u,onFocusFromOutsideViewport:()=>{const x=v({tabbingDirection:"backwards"});Jy(x)}})]})});vD.displayName=gD;var yD="ToastFocusProxy",ew=p.forwardRef((e,t)=>{const{__scopeToast:n,onFocusFromOutsideViewport:r,...s}=e,i=av(yD,n);return a.jsx(iv,{tabIndex:0,...s,ref:t,style:{position:"fixed"},onFocus:o=>{var d;const l=o.relatedTarget;!((d=i.viewport)!=null&&d.contains(l))&&r()}})});ew.displayName=yD;var mf="Toast",l8="toast.swipeStart",c8="toast.swipeMove",d8="toast.swipeCancel",u8="toast.swipeEnd",xD=p.forwardRef((e,t)=>{const{forceMount:n,open:r,defaultOpen:s,onOpenChange:i,...o}=e,[l,c]=qr({prop:r,defaultProp:s??!0,onChange:i,caller:mf});return a.jsx(Pn,{present:n||l,children:a.jsx(p8,{open:l,...o,ref:t,onClose:()=>c(!1),onPause:rn(e.onPause),onResume:rn(e.onResume),onSwipeStart:pe(e.onSwipeStart,d=>{d.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:pe(e.onSwipeMove,d=>{const{x:u,y:h}=d.detail.delta;d.currentTarget.setAttribute("data-swipe","move"),d.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${u}px`),d.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${h}px`)}),onSwipeCancel:pe(e.onSwipeCancel,d=>{d.currentTarget.setAttribute("data-swipe","cancel"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),d.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:pe(e.onSwipeEnd,d=>{const{x:u,y:h}=d.detail.delta;d.currentTarget.setAttribute("data-swipe","end"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),d.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${u}px`),d.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${h}px`),c(!1)})})})});xD.displayName=mf;var[h8,f8]=pD(mf,{onClose(){}}),p8=p.forwardRef((e,t)=>{const{__scopeToast:n,type:r="foreground",duration:s,open:i,onClose:o,onEscapeKeyDown:l,onPause:c,onResume:d,onSwipeStart:u,onSwipeMove:h,onSwipeCancel:f,onSwipeEnd:m,...g}=e,v=av(mf,n),[x,S]=p.useState(null),y=We(t,X=>S(X)),b=p.useRef(null),w=p.useRef(null),C=s||v.duration,I=p.useRef(0),R=p.useRef(C),L=p.useRef(0),{onToastAdd:N,onToastRemove:O}=v,G=rn(()=>{var Q;(x==null?void 0:x.contains(document.activeElement))&&((Q=v.viewport)==null||Q.focus()),o()}),H=p.useCallback(X=>{!X||X===1/0||(window.clearTimeout(L.current),I.current=new Date().getTime(),L.current=window.setTimeout(G,X))},[G]);p.useEffect(()=>{const X=v.viewport;if(X){const Q=()=>{H(R.current),d==null||d()},V=()=>{const te=new Date().getTime()-I.current;R.current=R.current-te,window.clearTimeout(L.current),c==null||c()};return X.addEventListener(Xb,V),X.addEventListener(Zb,Q),()=>{X.removeEventListener(Xb,V),X.removeEventListener(Zb,Q)}}},[v.viewport,C,c,d,H]),p.useEffect(()=>{i&&!v.isClosePausedRef.current&&H(C)},[i,C,v.isClosePausedRef,H]),p.useEffect(()=>(N(),()=>O()),[N,O]);const re=p.useMemo(()=>x?ED(x):null,[x]);return v.viewport?a.jsxs(a.Fragment,{children:[re&&a.jsx(m8,{__scopeToast:n,role:"status","aria-live":r==="foreground"?"assertive":"polite",children:re}),a.jsx(h8,{scope:n,onClose:G,children:Ql.createPortal(a.jsx(C0.ItemSlot,{scope:n,children:a.jsx(qH,{asChild:!0,onEscapeKeyDown:pe(l,()=>{v.isFocusedToastEscapeKeyDownRef.current||G(),v.isFocusedToastEscapeKeyDownRef.current=!1}),children:a.jsx(Re.li,{tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":v.swipeDirection,...g,ref:y,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:pe(e.onKeyDown,X=>{X.key==="Escape"&&(l==null||l(X.nativeEvent),X.nativeEvent.defaultPrevented||(v.isFocusedToastEscapeKeyDownRef.current=!0,G()))}),onPointerDown:pe(e.onPointerDown,X=>{X.button===0&&(b.current={x:X.clientX,y:X.clientY})}),onPointerMove:pe(e.onPointerMove,X=>{if(!b.current)return;const Q=X.clientX-b.current.x,V=X.clientY-b.current.y,te=!!w.current,k=["left","right"].includes(v.swipeDirection),E=["left","up"].includes(v.swipeDirection)?Math.min:Math.max,M=k?E(0,Q):0,A=k?0:E(0,V),F=X.pointerType==="touch"?10:2,q={x:M,y:A},P={originalEvent:X,delta:q};te?(w.current=q,xp(c8,h,P,{discrete:!1})):TE(q,v.swipeDirection,F)?(w.current=q,xp(l8,u,P,{discrete:!1}),X.target.setPointerCapture(X.pointerId)):(Math.abs(Q)>F||Math.abs(V)>F)&&(b.current=null)}),onPointerUp:pe(e.onPointerUp,X=>{const Q=w.current,V=X.target;if(V.hasPointerCapture(X.pointerId)&&V.releasePointerCapture(X.pointerId),w.current=null,b.current=null,Q){const te=X.currentTarget,k={originalEvent:X,delta:Q};TE(Q,v.swipeDirection,v.swipeThreshold)?xp(u8,m,k,{discrete:!0}):xp(d8,f,k,{discrete:!0}),te.addEventListener("click",E=>E.preventDefault(),{once:!0})}})})})}),v.viewport)})]}):null}),m8=e=>{const{__scopeToast:t,children:n,...r}=e,s=av(mf,t),[i,o]=p.useState(!1),[l,c]=p.useState(!1);return y8(()=>o(!0)),p.useEffect(()=>{const d=window.setTimeout(()=>c(!0),1e3);return()=>window.clearTimeout(d)},[]),l?null:a.jsx(Bd,{asChild:!0,children:a.jsx(iv,{...r,children:i&&a.jsxs(a.Fragment,{children:[s.label," ",n]})})})},g8="ToastTitle",bD=p.forwardRef((e,t)=>{const{__scopeToast:n,...r}=e;return a.jsx(Re.div,{...r,ref:t})});bD.displayName=g8;var v8="ToastDescription",wD=p.forwardRef((e,t)=>{const{__scopeToast:n,...r}=e;return a.jsx(Re.div,{...r,ref:t})});wD.displayName=v8;var SD="ToastAction",kD=p.forwardRef((e,t)=>{const{altText:n,...r}=e;return n.trim()?a.jsx(CD,{altText:n,asChild:!0,children:a.jsx(E0,{...r,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${SD}\`. Expected non-empty \`string\`.`),null)});kD.displayName=SD;var TD="ToastClose",E0=p.forwardRef((e,t)=>{const{__scopeToast:n,...r}=e,s=f8(TD,n);return a.jsx(CD,{asChild:!0,children:a.jsx(Re.button,{type:"button",...r,ref:t,onClick:pe(e.onClick,s.onClose)})})});E0.displayName=TD;var CD=p.forwardRef((e,t)=>{const{__scopeToast:n,altText:r,...s}=e;return a.jsx(Re.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...s,ref:t})});function ED(e){const t=[];return Array.from(e.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&t.push(r.textContent),x8(r)){const s=r.ariaHidden||r.hidden||r.style.display==="none",i=r.dataset.radixToastAnnounceExclude==="";if(!s)if(i){const o=r.dataset.radixToastAnnounceAlt;o&&t.push(o)}else t.push(...ED(r))}}),t}function xp(e,t,n,{discrete:r}){const s=n.originalEvent.currentTarget,i=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:n});t&&s.addEventListener(e,t,{once:!0}),r?k0(s,i):s.dispatchEvent(i)}var TE=(e,t,n=0)=>{const r=Math.abs(e.x),s=Math.abs(e.y),i=r>s;return t==="left"||t==="right"?i&&r>n:!i&&s>n};function y8(e=()=>{}){const t=rn(e);on(()=>{let n=0,r=0;return n=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(r)}},[t])}function x8(e){return e.nodeType===e.ELEMENT_NODE}function b8(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function Jy(e){const t=document.activeElement;return e.some(n=>n===t?!0:(n.focus(),document.activeElement!==t))}var w8=mD,_D=vD,PD=xD,ND=bD,ID=wD,AD=kD,RD=E0;function jD(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(n=jD(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function MD(){for(var e,t,n=0,r="",s=arguments.length;n<s;n++)(e=arguments[n])&&(t=jD(e))&&(r&&(r+=" "),r+=t);return r}const CE=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,EE=MD,gf=(e,t)=>n=>{var r;if((t==null?void 0:t.variants)==null)return EE(e,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:s,defaultVariants:i}=t,o=Object.keys(s).map(d=>{const u=n==null?void 0:n[d],h=i==null?void 0:i[d];if(u===null)return null;const f=CE(u)||CE(h);return s[d][f]}),l=n&&Object.entries(n).reduce((d,u)=>{let[h,f]=u;return f===void 0||(d[h]=f),d},{}),c=t==null||(r=t.compoundVariants)===null||r===void 0?void 0:r.reduce((d,u)=>{let{class:h,className:f,...m}=u;return Object.entries(m).every(g=>{let[v,x]=g;return Array.isArray(x)?x.includes({...i,...l}[v]):{...i,...l}[v]===x})?[...d,h,f]:d},[]);return EE(e,o,c,n==null?void 0:n.class,n==null?void 0:n.className)};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S8=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),DD=(...e)=>e.filter((t,n,r)=>!!t&&r.indexOf(t)===n).join(" ");/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var k8={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T8=p.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:s="",children:i,iconNode:o,...l},c)=>p.createElement("svg",{ref:c,...k8,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:DD("lucide",s),...l},[...o.map(([d,u])=>p.createElement(d,u)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=(e,t)=>{const n=p.forwardRef(({className:r,...s},i)=>p.createElement(T8,{ref:i,iconNode:t,className:DD(`lucide-${S8(e)}`,r),...s}));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OD=_e("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C8=_e("BellOff",[["path",{d:"M8.7 3A6 6 0 0 1 18 8a21.3 21.3 0 0 0 .6 5",key:"o7mx20"}],["path",{d:"M17 17H3s3-2 3-9a4.67 4.67 0 0 1 .3-1.7",key:"16f1lm"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yu=_e("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E8=_e("Book",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LD=_e("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _8=_e("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P8=_e("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zr=_e("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vf=_e("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N8=_e("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _0=_e("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tw=_e("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nw=_e("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FD=_e("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ov=_e("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I8=_e("Coffee",[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A8=_e("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R8=_e("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j8=_e("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M8=_e("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kp=_e("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D8=_e("Film",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qm=_e("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ia=_e("Gamepad2",[["line",{x1:"6",x2:"10",y1:"11",y2:"11",key:"1gktln"}],["line",{x1:"8",x2:"8",y1:"9",y2:"13",key:"qnk9ow"}],["line",{x1:"15",x2:"15.01",y1:"12",y2:"12",key:"krot7o"}],["line",{x1:"18",x2:"18.01",y1:"10",y2:"10",key:"1lcuu1"}],["path",{d:"M17.32 5H6.68a4 4 0 0 0-3.978 3.59c-.006.052-.01.101-.017.152C2.604 9.416 2 14.456 2 16a3 3 0 0 0 3 3c1 0 1.5-.5 2-1l1.414-1.414A2 2 0 0 1 9.828 16h4.344a2 2 0 0 1 1.414.586L17 18c.5.5 1 1 2 1a3 3 0 0 0 3-3c0-1.545-.604-6.584-.685-7.258-.007-.05-.011-.1-.017-.151A4 4 0 0 0 17.32 5z",key:"mfqc10"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $D=_e("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O8=_e("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L8=_e("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rl=_e("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yy=_e("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _E=_e("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lv=_e("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UD=_e("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VD=_e("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gi=_e("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xl=_e("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F8=_e("MicVocal",[["path",{d:"m11 7.601-5.994 8.19a1 1 0 0 0 .1 1.298l.817.818a1 1 0 0 0 1.314.087L15.09 12",key:"80a601"}],["path",{d:"M16.5 21.174C15.5 20.5 14.372 20 13 20c-2.058 0-3.928 2.356-6 2-2.072-.356-2.775-3.369-1.5-4.5",key:"j0ngtp"}],["circle",{cx:"16",cy:"7",r:"5",key:"d08jfb"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wd=_e("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BD=_e("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zD=_e("MonitorOff",[["path",{d:"M17 17H4a2 2 0 0 1-2-2V5c0-1.5 1-2 1-2",key:"k0q8oc"}],["path",{d:"M22 15V5a2 2 0 0 0-2-2H9",key:"cp1ac0"}],["path",{d:"M8 21h8",key:"1ev6f3"}],["path",{d:"M12 17v4",key:"1riwvh"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xu=_e("MonitorUp",[["path",{d:"m9 10 3-3 3 3",key:"11gsxs"}],["path",{d:"M12 13V7",key:"h0r20n"}],["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["path",{d:"M12 17v4",key:"1riwvh"}],["path",{d:"M8 21h8",key:"1ev6f3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rw=_e("Move",[["path",{d:"M12 2v20",key:"t6zp3m"}],["path",{d:"m15 19-3 3-3-3",key:"11eu04"}],["path",{d:"m19 9 3 3-3 3",key:"1mg7y2"}],["path",{d:"M2 12h20",key:"9i4pu4"}],["path",{d:"m5 9-3 3 3 3",key:"j64kie"}],["path",{d:"m9 5 3-3 3 3",key:"l8vdw6"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PE=_e("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P0=_e("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $8=_e("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GD=_e("PhoneOff",[["path",{d:"M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-3.33-2.67m-2.67-3.34a19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91",key:"z86iuo"}],["line",{x1:"22",x2:"2",y1:"2",y2:"22",key:"11kh81"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vr=_e("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U8=_e("Plane",[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sw=_e("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nr=_e("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bl=_e("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wo=_e("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V8=_e("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NE=_e("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WD=_e("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Th=_e("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iw=_e("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B8=_e("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qp=_e("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jp=_e("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const So=_e("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const il=_e("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HD=_e("UserMinus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Km=_e("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qD=_e("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jt=_e("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N0=_e("Volume2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KD=_e("VolumeX",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z8=_e("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G8=_e("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ot=_e("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QD=_e("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),I0="-",W8=e=>{const t=q8(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:o=>{const l=o.split(I0);return l[0]===""&&l.length!==1&&l.shift(),JD(l,t)||H8(o)},getConflictingClassGroupIds:(o,l)=>{const c=n[o]||[];return l&&r[o]?[...c,...r[o]]:c}}},JD=(e,t)=>{var o;if(e.length===0)return t.classGroupId;const n=e[0],r=t.nextPart.get(n),s=r?JD(e.slice(1),r):void 0;if(s)return s;if(t.validators.length===0)return;const i=e.join(I0);return(o=t.validators.find(({validator:l})=>l(i)))==null?void 0:o.classGroupId},IE=/^\[(.+)\]$/,H8=e=>{if(IE.test(e)){const t=IE.exec(e)[1],n=t==null?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},q8=e=>{const{theme:t,prefix:n}=e,r={nextPart:new Map,validators:[]};return Q8(Object.entries(e.classGroups),n).forEach(([i,o])=>{aw(o,r,i,t)}),r},aw=(e,t,n,r)=>{e.forEach(s=>{if(typeof s=="string"){const i=s===""?t:AE(t,s);i.classGroupId=n;return}if(typeof s=="function"){if(K8(s)){aw(s(r),t,n,r);return}t.validators.push({validator:s,classGroupId:n});return}Object.entries(s).forEach(([i,o])=>{aw(o,AE(t,i),n,r)})})},AE=(e,t)=>{let n=e;return t.split(I0).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},K8=e=>e.isThemeGetter,Q8=(e,t)=>t?e.map(([n,r])=>{const s=r.map(i=>typeof i=="string"?t+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,l])=>[t+o,l])):i);return[n,s]}):e,J8=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,r=new Map;const s=(i,o)=>{n.set(i,o),t++,t>e&&(t=0,r=n,n=new Map)};return{get(i){let o=n.get(i);if(o!==void 0)return o;if((o=r.get(i))!==void 0)return s(i,o),o},set(i,o){n.has(i)?n.set(i,o):s(i,o)}}},YD="!",Y8=e=>{const{separator:t,experimentalParseClassName:n}=e,r=t.length===1,s=t[0],i=t.length,o=l=>{const c=[];let d=0,u=0,h;for(let x=0;x<l.length;x++){let S=l[x];if(d===0){if(S===s&&(r||l.slice(x,x+i)===t)){c.push(l.slice(u,x)),u=x+i;continue}if(S==="/"){h=x;continue}}S==="["?d++:S==="]"&&d--}const f=c.length===0?l:l.substring(u),m=f.startsWith(YD),g=m?f.substring(1):f,v=h&&h>u?h-u:void 0;return{modifiers:c,hasImportantModifier:m,baseClassName:g,maybePostfixModifierPosition:v}};return n?l=>n({className:l,parseClassName:o}):o},X8=e=>{if(e.length<=1)return e;const t=[];let n=[];return e.forEach(r=>{r[0]==="["?(t.push(...n.sort(),r),n=[]):n.push(r)}),t.push(...n.sort()),t},Z8=e=>({cache:J8(e.cacheSize),parseClassName:Y8(e),...W8(e)}),eq=/\s+/,tq=(e,t)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:s}=t,i=[],o=e.trim().split(eq);let l="";for(let c=o.length-1;c>=0;c-=1){const d=o[c],{modifiers:u,hasImportantModifier:h,baseClassName:f,maybePostfixModifierPosition:m}=n(d);let g=!!m,v=r(g?f.substring(0,m):f);if(!v){if(!g){l=d+(l.length>0?" "+l:l);continue}if(v=r(f),!v){l=d+(l.length>0?" "+l:l);continue}g=!1}const x=X8(u).join(":"),S=h?x+YD:x,y=S+v;if(i.includes(y))continue;i.push(y);const b=s(v,g);for(let w=0;w<b.length;++w){const C=b[w];i.push(S+C)}l=d+(l.length>0?" "+l:l)}return l};function nq(){let e=0,t,n,r="";for(;e<arguments.length;)(t=arguments[e++])&&(n=XD(t))&&(r&&(r+=" "),r+=n);return r}const XD=e=>{if(typeof e=="string")return e;let t,n="";for(let r=0;r<e.length;r++)e[r]&&(t=XD(e[r]))&&(n&&(n+=" "),n+=t);return n};function rq(e,...t){let n,r,s,i=o;function o(c){const d=t.reduce((u,h)=>h(u),e());return n=Z8(d),r=n.cache.get,s=n.cache.set,i=l,l(c)}function l(c){const d=r(c);if(d)return d;const u=tq(c,n);return s(c,u),u}return function(){return i(nq.apply(null,arguments))}}const $t=e=>{const t=n=>n[e]||[];return t.isThemeGetter=!0,t},ZD=/^\[(?:([a-z-]+):)?(.+)\]$/i,sq=/^\d+\/\d+$/,iq=new Set(["px","full","screen"]),aq=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,oq=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,lq=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,cq=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,dq=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Oi=e=>Lc(e)||iq.has(e)||sq.test(e),_a=e=>zd(e,"length",yq),Lc=e=>!!e&&!Number.isNaN(Number(e)),Xy=e=>zd(e,"number",Lc),mu=e=>!!e&&Number.isInteger(Number(e)),uq=e=>e.endsWith("%")&&Lc(e.slice(0,-1)),st=e=>ZD.test(e),Pa=e=>aq.test(e),hq=new Set(["length","size","percentage"]),fq=e=>zd(e,hq,eO),pq=e=>zd(e,"position",eO),mq=new Set(["image","url"]),gq=e=>zd(e,mq,bq),vq=e=>zd(e,"",xq),gu=()=>!0,zd=(e,t,n)=>{const r=ZD.exec(e);return r?r[1]?typeof t=="string"?r[1]===t:t.has(r[1]):n(r[2]):!1},yq=e=>oq.test(e)&&!lq.test(e),eO=()=>!1,xq=e=>cq.test(e),bq=e=>dq.test(e),wq=()=>{const e=$t("colors"),t=$t("spacing"),n=$t("blur"),r=$t("brightness"),s=$t("borderColor"),i=$t("borderRadius"),o=$t("borderSpacing"),l=$t("borderWidth"),c=$t("contrast"),d=$t("grayscale"),u=$t("hueRotate"),h=$t("invert"),f=$t("gap"),m=$t("gradientColorStops"),g=$t("gradientColorStopPositions"),v=$t("inset"),x=$t("margin"),S=$t("opacity"),y=$t("padding"),b=$t("saturate"),w=$t("scale"),C=$t("sepia"),I=$t("skew"),R=$t("space"),L=$t("translate"),N=()=>["auto","contain","none"],O=()=>["auto","hidden","clip","visible","scroll"],G=()=>["auto",st,t],H=()=>[st,t],re=()=>["",Oi,_a],X=()=>["auto",Lc,st],Q=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],V=()=>["solid","dashed","dotted","double","none"],te=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],k=()=>["start","end","center","between","around","evenly","stretch"],E=()=>["","0",st],M=()=>["auto","avoid","all","avoid-page","page","left","right","column"],A=()=>[Lc,st];return{cacheSize:500,separator:":",theme:{colors:[gu],spacing:[Oi,_a],blur:["none","",Pa,st],brightness:A(),borderColor:[e],borderRadius:["none","","full",Pa,st],borderSpacing:H(),borderWidth:re(),contrast:A(),grayscale:E(),hueRotate:A(),invert:E(),gap:H(),gradientColorStops:[e],gradientColorStopPositions:[uq,_a],inset:G(),margin:G(),opacity:A(),padding:H(),saturate:A(),scale:A(),sepia:E(),skew:A(),space:H(),translate:H()},classGroups:{aspect:[{aspect:["auto","square","video",st]}],container:["container"],columns:[{columns:[Pa]}],"break-after":[{"break-after":M()}],"break-before":[{"break-before":M()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...Q(),st]}],overflow:[{overflow:O()}],"overflow-x":[{"overflow-x":O()}],"overflow-y":[{"overflow-y":O()}],overscroll:[{overscroll:N()}],"overscroll-x":[{"overscroll-x":N()}],"overscroll-y":[{"overscroll-y":N()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[v]}],"inset-x":[{"inset-x":[v]}],"inset-y":[{"inset-y":[v]}],start:[{start:[v]}],end:[{end:[v]}],top:[{top:[v]}],right:[{right:[v]}],bottom:[{bottom:[v]}],left:[{left:[v]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",mu,st]}],basis:[{basis:G()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",st]}],grow:[{grow:E()}],shrink:[{shrink:E()}],order:[{order:["first","last","none",mu,st]}],"grid-cols":[{"grid-cols":[gu]}],"col-start-end":[{col:["auto",{span:["full",mu,st]},st]}],"col-start":[{"col-start":X()}],"col-end":[{"col-end":X()}],"grid-rows":[{"grid-rows":[gu]}],"row-start-end":[{row:["auto",{span:[mu,st]},st]}],"row-start":[{"row-start":X()}],"row-end":[{"row-end":X()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",st]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",st]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...k()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...k(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...k(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[y]}],px:[{px:[y]}],py:[{py:[y]}],ps:[{ps:[y]}],pe:[{pe:[y]}],pt:[{pt:[y]}],pr:[{pr:[y]}],pb:[{pb:[y]}],pl:[{pl:[y]}],m:[{m:[x]}],mx:[{mx:[x]}],my:[{my:[x]}],ms:[{ms:[x]}],me:[{me:[x]}],mt:[{mt:[x]}],mr:[{mr:[x]}],mb:[{mb:[x]}],ml:[{ml:[x]}],"space-x":[{"space-x":[R]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[R]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",st,t]}],"min-w":[{"min-w":[st,t,"min","max","fit"]}],"max-w":[{"max-w":[st,t,"none","full","min","max","fit","prose",{screen:[Pa]},Pa]}],h:[{h:[st,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[st,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[st,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[st,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Pa,_a]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Xy]}],"font-family":[{font:[gu]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",st]}],"line-clamp":[{"line-clamp":["none",Lc,Xy]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Oi,st]}],"list-image":[{"list-image":["none",st]}],"list-style-type":[{list:["none","disc","decimal",st]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[S]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[S]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...V(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Oi,_a]}],"underline-offset":[{"underline-offset":["auto",Oi,st]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:H()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",st]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",st]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[S]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...Q(),pq]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",fq]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},gq]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[g]}],"gradient-via-pos":[{via:[g]}],"gradient-to-pos":[{to:[g]}],"gradient-from":[{from:[m]}],"gradient-via":[{via:[m]}],"gradient-to":[{to:[m]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[S]}],"border-style":[{border:[...V(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[S]}],"divide-style":[{divide:V()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...V()]}],"outline-offset":[{"outline-offset":[Oi,st]}],"outline-w":[{outline:[Oi,_a]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:re()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[S]}],"ring-offset-w":[{"ring-offset":[Oi,_a]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Pa,vq]}],"shadow-color":[{shadow:[gu]}],opacity:[{opacity:[S]}],"mix-blend":[{"mix-blend":[...te(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":te()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",Pa,st]}],grayscale:[{grayscale:[d]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[h]}],saturate:[{saturate:[b]}],sepia:[{sepia:[C]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[d]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[S]}],"backdrop-saturate":[{"backdrop-saturate":[b]}],"backdrop-sepia":[{"backdrop-sepia":[C]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",st]}],duration:[{duration:A()}],ease:[{ease:["linear","in","out","in-out",st]}],delay:[{delay:A()}],animate:[{animate:["none","spin","ping","pulse","bounce",st]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[w]}],"scale-x":[{"scale-x":[w]}],"scale-y":[{"scale-y":[w]}],rotate:[{rotate:[mu,st]}],"translate-x":[{"translate-x":[L]}],"translate-y":[{"translate-y":[L]}],"skew-x":[{"skew-x":[I]}],"skew-y":[{"skew-y":[I]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",st]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",st]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":H()}],"scroll-mx":[{"scroll-mx":H()}],"scroll-my":[{"scroll-my":H()}],"scroll-ms":[{"scroll-ms":H()}],"scroll-me":[{"scroll-me":H()}],"scroll-mt":[{"scroll-mt":H()}],"scroll-mr":[{"scroll-mr":H()}],"scroll-mb":[{"scroll-mb":H()}],"scroll-ml":[{"scroll-ml":H()}],"scroll-p":[{"scroll-p":H()}],"scroll-px":[{"scroll-px":H()}],"scroll-py":[{"scroll-py":H()}],"scroll-ps":[{"scroll-ps":H()}],"scroll-pe":[{"scroll-pe":H()}],"scroll-pt":[{"scroll-pt":H()}],"scroll-pr":[{"scroll-pr":H()}],"scroll-pb":[{"scroll-pb":H()}],"scroll-pl":[{"scroll-pl":H()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",st]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Oi,_a,Xy]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},Sq=rq(wq);function be(...e){return Sq(MD(e))}const kq=w8,tO=p.forwardRef(({className:e,...t},n)=>a.jsx(_D,{ref:n,className:be("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[320px]",e),...t}));tO.displayName=_D.displayName;const Tq=gf("group pointer-events-auto relative flex w-full items-center justify-between space-x-2 overflow-hidden rounded-md border p-3 py-2 pr-6 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),nO=p.forwardRef(({className:e,variant:t,...n},r)=>a.jsx(PD,{ref:r,className:be(Tq({variant:t}),e),...n}));nO.displayName=PD.displayName;const Cq=p.forwardRef(({className:e,...t},n)=>a.jsx(AD,{ref:n,className:be("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t}));Cq.displayName=AD.displayName;const rO=p.forwardRef(({className:e,...t},n)=>a.jsx(RD,{ref:n,className:be("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:a.jsx(Ot,{className:"h-4 w-4"})}));rO.displayName=RD.displayName;const sO=p.forwardRef(({className:e,...t},n)=>a.jsx(ND,{ref:n,className:be("text-sm font-semibold",e),...t}));sO.displayName=ND.displayName;const iO=p.forwardRef(({className:e,...t},n)=>a.jsx(ID,{ref:n,className:be("text-sm opacity-90",e),...t}));iO.displayName=ID.displayName;function Eq(){const{toasts:e}=Wn();return a.jsxs(kq,{children:[e.map(function({id:t,title:n,description:r,action:s,...i}){return a.jsxs(nO,{...i,children:[a.jsxs("div",{className:"grid gap-1",children:[n&&a.jsx(sO,{children:n}),r&&a.jsx(iO,{children:r})]}),s,a.jsx(rO,{})]},t)}),a.jsx(tO,{})]})}var _q=Bg[" useId ".trim().toString()]||(()=>{}),Pq=0;function is(e){const[t,n]=p.useState(_q());return on(()=>{n(r=>r??String(Pq++))},[e]),t?`radix-${t}`:""}const Nq=["top","right","bottom","left"],ko=Math.min,es=Math.max,Qm=Math.round,bp=Math.floor,Si=e=>({x:e,y:e}),Iq={left:"right",right:"left",bottom:"top",top:"bottom"},Aq={start:"end",end:"start"};function ow(e,t,n){return es(e,ko(t,n))}function ha(e,t){return typeof e=="function"?e(t):e}function fa(e){return e.split("-")[0]}function Gd(e){return e.split("-")[1]}function A0(e){return e==="x"?"y":"x"}function R0(e){return e==="y"?"height":"width"}const Rq=new Set(["top","bottom"]);function vi(e){return Rq.has(fa(e))?"y":"x"}function j0(e){return A0(vi(e))}function jq(e,t,n){n===void 0&&(n=!1);const r=Gd(e),s=j0(e),i=R0(s);let o=s==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[i]>t.floating[i]&&(o=Jm(o)),[o,Jm(o)]}function Mq(e){const t=Jm(e);return[lw(e),t,lw(t)]}function lw(e){return e.replace(/start|end/g,t=>Aq[t])}const RE=["left","right"],jE=["right","left"],Dq=["top","bottom"],Oq=["bottom","top"];function Lq(e,t,n){switch(e){case"top":case"bottom":return n?t?jE:RE:t?RE:jE;case"left":case"right":return t?Dq:Oq;default:return[]}}function Fq(e,t,n,r){const s=Gd(e);let i=Lq(fa(e),n==="start",r);return s&&(i=i.map(o=>o+"-"+s),t&&(i=i.concat(i.map(lw)))),i}function Jm(e){return e.replace(/left|right|bottom|top/g,t=>Iq[t])}function $q(e){return{top:0,right:0,bottom:0,left:0,...e}}function aO(e){return typeof e!="number"?$q(e):{top:e,right:e,bottom:e,left:e}}function Ym(e){const{x:t,y:n,width:r,height:s}=e;return{width:r,height:s,top:n,left:t,right:t+r,bottom:n+s,x:t,y:n}}function ME(e,t,n){let{reference:r,floating:s}=e;const i=vi(t),o=j0(t),l=R0(o),c=fa(t),d=i==="y",u=r.x+r.width/2-s.width/2,h=r.y+r.height/2-s.height/2,f=r[l]/2-s[l]/2;let m;switch(c){case"top":m={x:u,y:r.y-s.height};break;case"bottom":m={x:u,y:r.y+r.height};break;case"right":m={x:r.x+r.width,y:h};break;case"left":m={x:r.x-s.width,y:h};break;default:m={x:r.x,y:r.y}}switch(Gd(t)){case"start":m[o]-=f*(n&&d?-1:1);break;case"end":m[o]+=f*(n&&d?-1:1);break}return m}const Uq=async(e,t,n)=>{const{placement:r="bottom",strategy:s="absolute",middleware:i=[],platform:o}=n,l=i.filter(Boolean),c=await(o.isRTL==null?void 0:o.isRTL(t));let d=await o.getElementRects({reference:e,floating:t,strategy:s}),{x:u,y:h}=ME(d,r,c),f=r,m={},g=0;for(let v=0;v<l.length;v++){const{name:x,fn:S}=l[v],{x:y,y:b,data:w,reset:C}=await S({x:u,y:h,initialPlacement:r,placement:f,strategy:s,middlewareData:m,rects:d,platform:o,elements:{reference:e,floating:t}});u=y??u,h=b??h,m={...m,[x]:{...m[x],...w}},C&&g<=50&&(g++,typeof C=="object"&&(C.placement&&(f=C.placement),C.rects&&(d=C.rects===!0?await o.getElementRects({reference:e,floating:t,strategy:s}):C.rects),{x:u,y:h}=ME(d,f,c)),v=-1)}return{x:u,y:h,placement:f,strategy:s,middlewareData:m}};async function Ch(e,t){var n;t===void 0&&(t={});const{x:r,y:s,platform:i,rects:o,elements:l,strategy:c}=e,{boundary:d="clippingAncestors",rootBoundary:u="viewport",elementContext:h="floating",altBoundary:f=!1,padding:m=0}=ha(t,e),g=aO(m),x=l[f?h==="floating"?"reference":"floating":h],S=Ym(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(x)))==null||n?x:x.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(l.floating)),boundary:d,rootBoundary:u,strategy:c})),y=h==="floating"?{x:r,y:s,width:o.floating.width,height:o.floating.height}:o.reference,b=await(i.getOffsetParent==null?void 0:i.getOffsetParent(l.floating)),w=await(i.isElement==null?void 0:i.isElement(b))?await(i.getScale==null?void 0:i.getScale(b))||{x:1,y:1}:{x:1,y:1},C=Ym(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:y,offsetParent:b,strategy:c}):y);return{top:(S.top-C.top+g.top)/w.y,bottom:(C.bottom-S.bottom+g.bottom)/w.y,left:(S.left-C.left+g.left)/w.x,right:(C.right-S.right+g.right)/w.x}}const Vq=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:s,rects:i,platform:o,elements:l,middlewareData:c}=t,{element:d,padding:u=0}=ha(e,t)||{};if(d==null)return{};const h=aO(u),f={x:n,y:r},m=j0(s),g=R0(m),v=await o.getDimensions(d),x=m==="y",S=x?"top":"left",y=x?"bottom":"right",b=x?"clientHeight":"clientWidth",w=i.reference[g]+i.reference[m]-f[m]-i.floating[g],C=f[m]-i.reference[m],I=await(o.getOffsetParent==null?void 0:o.getOffsetParent(d));let R=I?I[b]:0;(!R||!await(o.isElement==null?void 0:o.isElement(I)))&&(R=l.floating[b]||i.floating[g]);const L=w/2-C/2,N=R/2-v[g]/2-1,O=ko(h[S],N),G=ko(h[y],N),H=O,re=R-v[g]-G,X=R/2-v[g]/2+L,Q=ow(H,X,re),V=!c.arrow&&Gd(s)!=null&&X!==Q&&i.reference[g]/2-(X<H?O:G)-v[g]/2<0,te=V?X<H?X-H:X-re:0;return{[m]:f[m]+te,data:{[m]:Q,centerOffset:X-Q-te,...V&&{alignmentOffset:te}},reset:V}}}),Bq=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:s,middlewareData:i,rects:o,initialPlacement:l,platform:c,elements:d}=t,{mainAxis:u=!0,crossAxis:h=!0,fallbackPlacements:f,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:g="none",flipAlignment:v=!0,...x}=ha(e,t);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const S=fa(s),y=vi(l),b=fa(l)===l,w=await(c.isRTL==null?void 0:c.isRTL(d.floating)),C=f||(b||!v?[Jm(l)]:Mq(l)),I=g!=="none";!f&&I&&C.push(...Fq(l,v,g,w));const R=[l,...C],L=await Ch(t,x),N=[];let O=((r=i.flip)==null?void 0:r.overflows)||[];if(u&&N.push(L[S]),h){const X=jq(s,o,w);N.push(L[X[0]],L[X[1]])}if(O=[...O,{placement:s,overflows:N}],!N.every(X=>X<=0)){var G,H;const X=(((G=i.flip)==null?void 0:G.index)||0)+1,Q=R[X];if(Q&&(!(h==="alignment"?y!==vi(Q):!1)||O.every(k=>vi(k.placement)===y?k.overflows[0]>0:!0)))return{data:{index:X,overflows:O},reset:{placement:Q}};let V=(H=O.filter(te=>te.overflows[0]<=0).sort((te,k)=>te.overflows[1]-k.overflows[1])[0])==null?void 0:H.placement;if(!V)switch(m){case"bestFit":{var re;const te=(re=O.filter(k=>{if(I){const E=vi(k.placement);return E===y||E==="y"}return!0}).map(k=>[k.placement,k.overflows.filter(E=>E>0).reduce((E,M)=>E+M,0)]).sort((k,E)=>k[1]-E[1])[0])==null?void 0:re[0];te&&(V=te);break}case"initialPlacement":V=l;break}if(s!==V)return{reset:{placement:V}}}return{}}}};function DE(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function OE(e){return Nq.some(t=>e[t]>=0)}const zq=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:r="referenceHidden",...s}=ha(e,t);switch(r){case"referenceHidden":{const i=await Ch(t,{...s,elementContext:"reference"}),o=DE(i,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:OE(o)}}}case"escaped":{const i=await Ch(t,{...s,altBoundary:!0}),o=DE(i,n.floating);return{data:{escapedOffsets:o,escaped:OE(o)}}}default:return{}}}}},oO=new Set(["left","top"]);async function Gq(e,t){const{placement:n,platform:r,elements:s}=e,i=await(r.isRTL==null?void 0:r.isRTL(s.floating)),o=fa(n),l=Gd(n),c=vi(n)==="y",d=oO.has(o)?-1:1,u=i&&c?-1:1,h=ha(t,e);let{mainAxis:f,crossAxis:m,alignmentAxis:g}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return l&&typeof g=="number"&&(m=l==="end"?g*-1:g),c?{x:m*u,y:f*d}:{x:f*d,y:m*u}}const Wq=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:s,y:i,placement:o,middlewareData:l}=t,c=await Gq(t,e);return o===((n=l.offset)==null?void 0:n.placement)&&(r=l.arrow)!=null&&r.alignmentOffset?{}:{x:s+c.x,y:i+c.y,data:{...c,placement:o}}}}},Hq=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:s}=t,{mainAxis:i=!0,crossAxis:o=!1,limiter:l={fn:x=>{let{x:S,y}=x;return{x:S,y}}},...c}=ha(e,t),d={x:n,y:r},u=await Ch(t,c),h=vi(fa(s)),f=A0(h);let m=d[f],g=d[h];if(i){const x=f==="y"?"top":"left",S=f==="y"?"bottom":"right",y=m+u[x],b=m-u[S];m=ow(y,m,b)}if(o){const x=h==="y"?"top":"left",S=h==="y"?"bottom":"right",y=g+u[x],b=g-u[S];g=ow(y,g,b)}const v=l.fn({...t,[f]:m,[h]:g});return{...v,data:{x:v.x-n,y:v.y-r,enabled:{[f]:i,[h]:o}}}}}},qq=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:s,rects:i,middlewareData:o}=t,{offset:l=0,mainAxis:c=!0,crossAxis:d=!0}=ha(e,t),u={x:n,y:r},h=vi(s),f=A0(h);let m=u[f],g=u[h];const v=ha(l,t),x=typeof v=="number"?{mainAxis:v,crossAxis:0}:{mainAxis:0,crossAxis:0,...v};if(c){const b=f==="y"?"height":"width",w=i.reference[f]-i.floating[b]+x.mainAxis,C=i.reference[f]+i.reference[b]-x.mainAxis;m<w?m=w:m>C&&(m=C)}if(d){var S,y;const b=f==="y"?"width":"height",w=oO.has(fa(s)),C=i.reference[h]-i.floating[b]+(w&&((S=o.offset)==null?void 0:S[h])||0)+(w?0:x.crossAxis),I=i.reference[h]+i.reference[b]+(w?0:((y=o.offset)==null?void 0:y[h])||0)-(w?x.crossAxis:0);g<C?g=C:g>I&&(g=I)}return{[f]:m,[h]:g}}}},Kq=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var n,r;const{placement:s,rects:i,platform:o,elements:l}=t,{apply:c=()=>{},...d}=ha(e,t),u=await Ch(t,d),h=fa(s),f=Gd(s),m=vi(s)==="y",{width:g,height:v}=i.floating;let x,S;h==="top"||h==="bottom"?(x=h,S=f===(await(o.isRTL==null?void 0:o.isRTL(l.floating))?"start":"end")?"left":"right"):(S=h,x=f==="end"?"top":"bottom");const y=v-u.top-u.bottom,b=g-u.left-u.right,w=ko(v-u[x],y),C=ko(g-u[S],b),I=!t.middlewareData.shift;let R=w,L=C;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(L=b),(r=t.middlewareData.shift)!=null&&r.enabled.y&&(R=y),I&&!f){const O=es(u.left,0),G=es(u.right,0),H=es(u.top,0),re=es(u.bottom,0);m?L=g-2*(O!==0||G!==0?O+G:es(u.left,u.right)):R=v-2*(H!==0||re!==0?H+re:es(u.top,u.bottom))}await c({...t,availableWidth:L,availableHeight:R});const N=await o.getDimensions(l.floating);return g!==N.width||v!==N.height?{reset:{rects:!0}}:{}}}};function cv(){return typeof window<"u"}function Wd(e){return lO(e)?(e.nodeName||"").toLowerCase():"#document"}function as(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Ai(e){var t;return(t=(lO(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function lO(e){return cv()?e instanceof Node||e instanceof as(e).Node:!1}function ni(e){return cv()?e instanceof Element||e instanceof as(e).Element:!1}function Ci(e){return cv()?e instanceof HTMLElement||e instanceof as(e).HTMLElement:!1}function LE(e){return!cv()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof as(e).ShadowRoot}const Qq=new Set(["inline","contents"]);function yf(e){const{overflow:t,overflowX:n,overflowY:r,display:s}=ri(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!Qq.has(s)}const Jq=new Set(["table","td","th"]);function Yq(e){return Jq.has(Wd(e))}const Xq=[":popover-open",":modal"];function dv(e){return Xq.some(t=>{try{return e.matches(t)}catch{return!1}})}const Zq=["transform","translate","scale","rotate","perspective"],e9=["transform","translate","scale","rotate","perspective","filter"],t9=["paint","layout","strict","content"];function M0(e){const t=D0(),n=ni(e)?ri(e):e;return Zq.some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||e9.some(r=>(n.willChange||"").includes(r))||t9.some(r=>(n.contain||"").includes(r))}function n9(e){let t=To(e);for(;Ci(t)&&!Sd(t);){if(M0(t))return t;if(dv(t))return null;t=To(t)}return null}function D0(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const r9=new Set(["html","body","#document"]);function Sd(e){return r9.has(Wd(e))}function ri(e){return as(e).getComputedStyle(e)}function uv(e){return ni(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function To(e){if(Wd(e)==="html")return e;const t=e.assignedSlot||e.parentNode||LE(e)&&e.host||Ai(e);return LE(t)?t.host:t}function cO(e){const t=To(e);return Sd(t)?e.ownerDocument?e.ownerDocument.body:e.body:Ci(t)&&yf(t)?t:cO(t)}function Eh(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const s=cO(e),i=s===((r=e.ownerDocument)==null?void 0:r.body),o=as(s);if(i){const l=cw(o);return t.concat(o,o.visualViewport||[],yf(s)?s:[],l&&n?Eh(l):[])}return t.concat(s,Eh(s,[],n))}function cw(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function dO(e){const t=ri(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const s=Ci(e),i=s?e.offsetWidth:n,o=s?e.offsetHeight:r,l=Qm(n)!==i||Qm(r)!==o;return l&&(n=i,r=o),{width:n,height:r,$:l}}function O0(e){return ni(e)?e:e.contextElement}function Fc(e){const t=O0(e);if(!Ci(t))return Si(1);const n=t.getBoundingClientRect(),{width:r,height:s,$:i}=dO(t);let o=(i?Qm(n.width):n.width)/r,l=(i?Qm(n.height):n.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!l||!Number.isFinite(l))&&(l=1),{x:o,y:l}}const s9=Si(0);function uO(e){const t=as(e);return!D0()||!t.visualViewport?s9:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function i9(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==as(e)?!1:t}function jl(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const s=e.getBoundingClientRect(),i=O0(e);let o=Si(1);t&&(r?ni(r)&&(o=Fc(r)):o=Fc(e));const l=i9(i,n,r)?uO(i):Si(0);let c=(s.left+l.x)/o.x,d=(s.top+l.y)/o.y,u=s.width/o.x,h=s.height/o.y;if(i){const f=as(i),m=r&&ni(r)?as(r):r;let g=f,v=cw(g);for(;v&&r&&m!==g;){const x=Fc(v),S=v.getBoundingClientRect(),y=ri(v),b=S.left+(v.clientLeft+parseFloat(y.paddingLeft))*x.x,w=S.top+(v.clientTop+parseFloat(y.paddingTop))*x.y;c*=x.x,d*=x.y,u*=x.x,h*=x.y,c+=b,d+=w,g=as(v),v=cw(g)}}return Ym({width:u,height:h,x:c,y:d})}function hv(e,t){const n=uv(e).scrollLeft;return t?t.left+n:jl(Ai(e)).left+n}function hO(e,t){const n=e.getBoundingClientRect(),r=n.left+t.scrollLeft-hv(e,n),s=n.top+t.scrollTop;return{x:r,y:s}}function a9(e){let{elements:t,rect:n,offsetParent:r,strategy:s}=e;const i=s==="fixed",o=Ai(r),l=t?dv(t.floating):!1;if(r===o||l&&i)return n;let c={scrollLeft:0,scrollTop:0},d=Si(1);const u=Si(0),h=Ci(r);if((h||!h&&!i)&&((Wd(r)!=="body"||yf(o))&&(c=uv(r)),Ci(r))){const m=jl(r);d=Fc(r),u.x=m.x+r.clientLeft,u.y=m.y+r.clientTop}const f=o&&!h&&!i?hO(o,c):Si(0);return{width:n.width*d.x,height:n.height*d.y,x:n.x*d.x-c.scrollLeft*d.x+u.x+f.x,y:n.y*d.y-c.scrollTop*d.y+u.y+f.y}}function o9(e){return Array.from(e.getClientRects())}function l9(e){const t=Ai(e),n=uv(e),r=e.ownerDocument.body,s=es(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),i=es(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let o=-n.scrollLeft+hv(e);const l=-n.scrollTop;return ri(r).direction==="rtl"&&(o+=es(t.clientWidth,r.clientWidth)-s),{width:s,height:i,x:o,y:l}}const FE=25;function c9(e,t){const n=as(e),r=Ai(e),s=n.visualViewport;let i=r.clientWidth,o=r.clientHeight,l=0,c=0;if(s){i=s.width,o=s.height;const u=D0();(!u||u&&t==="fixed")&&(l=s.offsetLeft,c=s.offsetTop)}const d=hv(r);if(d<=0){const u=r.ownerDocument,h=u.body,f=getComputedStyle(h),m=u.compatMode==="CSS1Compat"&&parseFloat(f.marginLeft)+parseFloat(f.marginRight)||0,g=Math.abs(r.clientWidth-h.clientWidth-m);g<=FE&&(i-=g)}else d<=FE&&(i+=d);return{width:i,height:o,x:l,y:c}}const d9=new Set(["absolute","fixed"]);function u9(e,t){const n=jl(e,!0,t==="fixed"),r=n.top+e.clientTop,s=n.left+e.clientLeft,i=Ci(e)?Fc(e):Si(1),o=e.clientWidth*i.x,l=e.clientHeight*i.y,c=s*i.x,d=r*i.y;return{width:o,height:l,x:c,y:d}}function $E(e,t,n){let r;if(t==="viewport")r=c9(e,n);else if(t==="document")r=l9(Ai(e));else if(ni(t))r=u9(t,n);else{const s=uO(e);r={x:t.x-s.x,y:t.y-s.y,width:t.width,height:t.height}}return Ym(r)}function fO(e,t){const n=To(e);return n===t||!ni(n)||Sd(n)?!1:ri(n).position==="fixed"||fO(n,t)}function h9(e,t){const n=t.get(e);if(n)return n;let r=Eh(e,[],!1).filter(l=>ni(l)&&Wd(l)!=="body"),s=null;const i=ri(e).position==="fixed";let o=i?To(e):e;for(;ni(o)&&!Sd(o);){const l=ri(o),c=M0(o);!c&&l.position==="fixed"&&(s=null),(i?!c&&!s:!c&&l.position==="static"&&!!s&&d9.has(s.position)||yf(o)&&!c&&fO(e,o))?r=r.filter(u=>u!==o):s=l,o=To(o)}return t.set(e,r),r}function f9(e){let{element:t,boundary:n,rootBoundary:r,strategy:s}=e;const o=[...n==="clippingAncestors"?dv(t)?[]:h9(t,this._c):[].concat(n),r],l=o[0],c=o.reduce((d,u)=>{const h=$E(t,u,s);return d.top=es(h.top,d.top),d.right=ko(h.right,d.right),d.bottom=ko(h.bottom,d.bottom),d.left=es(h.left,d.left),d},$E(t,l,s));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function p9(e){const{width:t,height:n}=dO(e);return{width:t,height:n}}function m9(e,t,n){const r=Ci(t),s=Ai(t),i=n==="fixed",o=jl(e,!0,i,t);let l={scrollLeft:0,scrollTop:0};const c=Si(0);function d(){c.x=hv(s)}if(r||!r&&!i)if((Wd(t)!=="body"||yf(s))&&(l=uv(t)),r){const m=jl(t,!0,i,t);c.x=m.x+t.clientLeft,c.y=m.y+t.clientTop}else s&&d();i&&!r&&s&&d();const u=s&&!r&&!i?hO(s,l):Si(0),h=o.left+l.scrollLeft-c.x-u.x,f=o.top+l.scrollTop-c.y-u.y;return{x:h,y:f,width:o.width,height:o.height}}function Zy(e){return ri(e).position==="static"}function UE(e,t){if(!Ci(e)||ri(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return Ai(e)===n&&(n=n.ownerDocument.body),n}function pO(e,t){const n=as(e);if(dv(e))return n;if(!Ci(e)){let s=To(e);for(;s&&!Sd(s);){if(ni(s)&&!Zy(s))return s;s=To(s)}return n}let r=UE(e,t);for(;r&&Yq(r)&&Zy(r);)r=UE(r,t);return r&&Sd(r)&&Zy(r)&&!M0(r)?n:r||n9(e)||n}const g9=async function(e){const t=this.getOffsetParent||pO,n=this.getDimensions,r=await n(e.floating);return{reference:m9(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function v9(e){return ri(e).direction==="rtl"}const y9={convertOffsetParentRelativeRectToViewportRelativeRect:a9,getDocumentElement:Ai,getClippingRect:f9,getOffsetParent:pO,getElementRects:g9,getClientRects:o9,getDimensions:p9,getScale:Fc,isElement:ni,isRTL:v9};function mO(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function x9(e,t){let n=null,r;const s=Ai(e);function i(){var l;clearTimeout(r),(l=n)==null||l.disconnect(),n=null}function o(l,c){l===void 0&&(l=!1),c===void 0&&(c=1),i();const d=e.getBoundingClientRect(),{left:u,top:h,width:f,height:m}=d;if(l||t(),!f||!m)return;const g=bp(h),v=bp(s.clientWidth-(u+f)),x=bp(s.clientHeight-(h+m)),S=bp(u),b={rootMargin:-g+"px "+-v+"px "+-x+"px "+-S+"px",threshold:es(0,ko(1,c))||1};let w=!0;function C(I){const R=I[0].intersectionRatio;if(R!==c){if(!w)return o();R?o(!1,R):r=setTimeout(()=>{o(!1,1e-7)},1e3)}R===1&&!mO(d,e.getBoundingClientRect())&&o(),w=!1}try{n=new IntersectionObserver(C,{...b,root:s.ownerDocument})}catch{n=new IntersectionObserver(C,b)}n.observe(e)}return o(!0),i}function b9(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:c=!1}=r,d=O0(e),u=s||i?[...d?Eh(d):[],...Eh(t)]:[];u.forEach(S=>{s&&S.addEventListener("scroll",n,{passive:!0}),i&&S.addEventListener("resize",n)});const h=d&&l?x9(d,n):null;let f=-1,m=null;o&&(m=new ResizeObserver(S=>{let[y]=S;y&&y.target===d&&m&&(m.unobserve(t),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var b;(b=m)==null||b.observe(t)})),n()}),d&&!c&&m.observe(d),m.observe(t));let g,v=c?jl(e):null;c&&x();function x(){const S=jl(e);v&&!mO(v,S)&&n(),v=S,g=requestAnimationFrame(x)}return n(),()=>{var S;u.forEach(y=>{s&&y.removeEventListener("scroll",n),i&&y.removeEventListener("resize",n)}),h==null||h(),(S=m)==null||S.disconnect(),m=null,c&&cancelAnimationFrame(g)}}const w9=Wq,S9=Hq,k9=Bq,T9=Kq,C9=zq,VE=Vq,E9=qq,_9=(e,t,n)=>{const r=new Map,s={platform:y9,...n},i={...s.platform,_c:r};return Uq(e,t,{...s,platform:i})};var P9=typeof document<"u",N9=function(){},Yp=P9?p.useLayoutEffect:N9;function Xm(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,s;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!Xm(e[r],t[r]))return!1;return!0}if(s=Object.keys(e),n=s.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,s[r]))return!1;for(r=n;r--!==0;){const i=s[r];if(!(i==="_owner"&&e.$$typeof)&&!Xm(e[i],t[i]))return!1}return!0}return e!==e&&t!==t}function gO(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function BE(e,t){const n=gO(e);return Math.round(t*n)/n}function ex(e){const t=p.useRef(e);return Yp(()=>{t.current=e}),t}function I9(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:s,elements:{reference:i,floating:o}={},transform:l=!0,whileElementsMounted:c,open:d}=e,[u,h]=p.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[f,m]=p.useState(r);Xm(f,r)||m(r);const[g,v]=p.useState(null),[x,S]=p.useState(null),y=p.useCallback(k=>{k!==I.current&&(I.current=k,v(k))},[]),b=p.useCallback(k=>{k!==R.current&&(R.current=k,S(k))},[]),w=i||g,C=o||x,I=p.useRef(null),R=p.useRef(null),L=p.useRef(u),N=c!=null,O=ex(c),G=ex(s),H=ex(d),re=p.useCallback(()=>{if(!I.current||!R.current)return;const k={placement:t,strategy:n,middleware:f};G.current&&(k.platform=G.current),_9(I.current,R.current,k).then(E=>{const M={...E,isPositioned:H.current!==!1};X.current&&!Xm(L.current,M)&&(L.current=M,Ql.flushSync(()=>{h(M)}))})},[f,t,n,G,H]);Yp(()=>{d===!1&&L.current.isPositioned&&(L.current.isPositioned=!1,h(k=>({...k,isPositioned:!1})))},[d]);const X=p.useRef(!1);Yp(()=>(X.current=!0,()=>{X.current=!1}),[]),Yp(()=>{if(w&&(I.current=w),C&&(R.current=C),w&&C){if(O.current)return O.current(w,C,re);re()}},[w,C,re,O,N]);const Q=p.useMemo(()=>({reference:I,floating:R,setReference:y,setFloating:b}),[y,b]),V=p.useMemo(()=>({reference:w,floating:C}),[w,C]),te=p.useMemo(()=>{const k={position:n,left:0,top:0};if(!V.floating)return k;const E=BE(V.floating,u.x),M=BE(V.floating,u.y);return l?{...k,transform:"translate("+E+"px, "+M+"px)",...gO(V.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:E,top:M}},[n,l,V.floating,u.x,u.y]);return p.useMemo(()=>({...u,update:re,refs:Q,elements:V,floatingStyles:te}),[u,re,Q,V,te])}const A9=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:r,padding:s}=typeof e=="function"?e(n):e;return r&&t(r)?r.current!=null?VE({element:r.current,padding:s}).fn(n):{}:r?VE({element:r,padding:s}).fn(n):{}}}},R9=(e,t)=>({...w9(e),options:[e,t]}),j9=(e,t)=>({...S9(e),options:[e,t]}),M9=(e,t)=>({...E9(e),options:[e,t]}),D9=(e,t)=>({...k9(e),options:[e,t]}),O9=(e,t)=>({...T9(e),options:[e,t]}),L9=(e,t)=>({...C9(e),options:[e,t]}),F9=(e,t)=>({...A9(e),options:[e,t]});var $9="Arrow",vO=p.forwardRef((e,t)=>{const{children:n,width:r=10,height:s=5,...i}=e;return a.jsx(Re.svg,{...i,ref:t,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:a.jsx("polygon",{points:"0,0 30,0 15,10"})})});vO.displayName=$9;var U9=vO;function fv(e){const[t,n]=p.useState(void 0);return on(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let o,l;if("borderBoxSize"in i){const c=i.borderBoxSize,d=Array.isArray(c)?c[0]:c;o=d.inlineSize,l=d.blockSize}else o=e.offsetWidth,l=e.offsetHeight;n({width:o,height:l})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else n(void 0)},[e]),t}var L0="Popper",[yO,Oo]=Mn(L0),[V9,xO]=yO(L0),bO=e=>{const{__scopePopper:t,children:n}=e,[r,s]=p.useState(null);return a.jsx(V9,{scope:t,anchor:r,onAnchorChange:s,children:n})};bO.displayName=L0;var wO="PopperAnchor",SO=p.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...s}=e,i=xO(wO,n),o=p.useRef(null),l=We(t,o),c=p.useRef(null);return p.useEffect(()=>{const d=c.current;c.current=(r==null?void 0:r.current)||o.current,d!==c.current&&i.onAnchorChange(c.current)}),r?null:a.jsx(Re.div,{...s,ref:l})});SO.displayName=wO;var F0="PopperContent",[B9,z9]=yO(F0),kO=p.forwardRef((e,t)=>{var W,ie,Z,ne,ae,ge;const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:o=0,arrowPadding:l=0,avoidCollisions:c=!0,collisionBoundary:d=[],collisionPadding:u=0,sticky:h="partial",hideWhenDetached:f=!1,updatePositionStrategy:m="optimized",onPlaced:g,...v}=e,x=xO(F0,n),[S,y]=p.useState(null),b=We(t,Le=>y(Le)),[w,C]=p.useState(null),I=fv(w),R=(I==null?void 0:I.width)??0,L=(I==null?void 0:I.height)??0,N=r+(i!=="center"?"-"+i:""),O=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},G=Array.isArray(d)?d:[d],H=G.length>0,re={padding:O,boundary:G.filter(W9),altBoundary:H},{refs:X,floatingStyles:Q,placement:V,isPositioned:te,middlewareData:k}=I9({strategy:"fixed",placement:N,whileElementsMounted:(...Le)=>b9(...Le,{animationFrame:m==="always"}),elements:{reference:x.anchor},middleware:[R9({mainAxis:s+L,alignmentAxis:o}),c&&j9({mainAxis:!0,crossAxis:!1,limiter:h==="partial"?M9():void 0,...re}),c&&D9({...re}),O9({...re,apply:({elements:Le,rects:Ct,availableWidth:pn,availableHeight:mn})=>{const{width:Fn,height:se}=Ct.reference,Ee=Le.floating.style;Ee.setProperty("--radix-popper-available-width",`${pn}px`),Ee.setProperty("--radix-popper-available-height",`${mn}px`),Ee.setProperty("--radix-popper-anchor-width",`${Fn}px`),Ee.setProperty("--radix-popper-anchor-height",`${se}px`)}}),w&&F9({element:w,padding:l}),H9({arrowWidth:R,arrowHeight:L}),f&&L9({strategy:"referenceHidden",...re})]}),[E,M]=EO(V),A=rn(g);on(()=>{te&&(A==null||A())},[te,A]);const F=(W=k.arrow)==null?void 0:W.x,q=(ie=k.arrow)==null?void 0:ie.y,P=((Z=k.arrow)==null?void 0:Z.centerOffset)!==0,[j,$]=p.useState();return on(()=>{S&&$(window.getComputedStyle(S).zIndex)},[S]),a.jsx("div",{ref:X.setFloating,"data-radix-popper-content-wrapper":"",style:{...Q,transform:te?Q.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:j,"--radix-popper-transform-origin":[(ne=k.transformOrigin)==null?void 0:ne.x,(ae=k.transformOrigin)==null?void 0:ae.y].join(" "),...((ge=k.hide)==null?void 0:ge.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:a.jsx(B9,{scope:n,placedSide:E,onArrowChange:C,arrowX:F,arrowY:q,shouldHideArrow:P,children:a.jsx(Re.div,{"data-side":E,"data-align":M,...v,ref:b,style:{...v.style,animation:te?void 0:"none"}})})})});kO.displayName=F0;var TO="PopperArrow",G9={top:"bottom",right:"left",bottom:"top",left:"right"},CO=p.forwardRef(function(t,n){const{__scopePopper:r,...s}=t,i=z9(TO,r),o=G9[i.placedSide];return a.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:a.jsx(U9,{...s,ref:n,style:{...s.style,display:"block"}})})});CO.displayName=TO;function W9(e){return e!==null}var H9=e=>({name:"transformOrigin",options:e,fn(t){var x,S,y;const{placement:n,rects:r,middlewareData:s}=t,o=((x=s.arrow)==null?void 0:x.centerOffset)!==0,l=o?0:e.arrowWidth,c=o?0:e.arrowHeight,[d,u]=EO(n),h={start:"0%",center:"50%",end:"100%"}[u],f=(((S=s.arrow)==null?void 0:S.x)??0)+l/2,m=(((y=s.arrow)==null?void 0:y.y)??0)+c/2;let g="",v="";return d==="bottom"?(g=o?h:`${f}px`,v=`${-c}px`):d==="top"?(g=o?h:`${f}px`,v=`${r.floating.height+c}px`):d==="right"?(g=`${-c}px`,v=o?h:`${m}px`):d==="left"&&(g=`${r.floating.width+c}px`,v=o?h:`${m}px`),{data:{x:g,y:v}}}});function EO(e){const[t,n="center"]=e.split("-");return[t,n]}var $0=bO,xf=SO,pv=kO,mv=CO,q9=Symbol("radix.slottable");function K9(e){const t=({children:n})=>a.jsx(a.Fragment,{children:n});return t.displayName=`${e}.Slottable`,t.__radixId=q9,t}var[gv]=Mn("Tooltip",[Oo]),U0=Oo(),_O="TooltipProvider",Q9=700,zE="tooltip.open",[J9,PO]=gv(_O),NO=e=>{const{__scopeTooltip:t,delayDuration:n=Q9,skipDelayDuration:r=300,disableHoverableContent:s=!1,children:i}=e,o=p.useRef(!0),l=p.useRef(!1),c=p.useRef(0);return p.useEffect(()=>{const d=c.current;return()=>window.clearTimeout(d)},[]),a.jsx(J9,{scope:t,isOpenDelayedRef:o,delayDuration:n,onOpen:p.useCallback(()=>{window.clearTimeout(c.current),o.current=!1},[]),onClose:p.useCallback(()=>{window.clearTimeout(c.current),c.current=window.setTimeout(()=>o.current=!0,r)},[r]),isPointerInTransitRef:l,onPointerInTransitChange:p.useCallback(d=>{l.current=d},[]),disableHoverableContent:s,children:i})};NO.displayName=_O;var IO="Tooltip",[yfe,vv]=gv(IO),dw="TooltipTrigger",Y9=p.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,s=vv(dw,n),i=PO(dw,n),o=U0(n),l=p.useRef(null),c=We(t,l,s.onTriggerChange),d=p.useRef(!1),u=p.useRef(!1),h=p.useCallback(()=>d.current=!1,[]);return p.useEffect(()=>()=>document.removeEventListener("pointerup",h),[h]),a.jsx(xf,{asChild:!0,...o,children:a.jsx(Re.button,{"aria-describedby":s.open?s.contentId:void 0,"data-state":s.stateAttribute,...r,ref:c,onPointerMove:pe(e.onPointerMove,f=>{f.pointerType!=="touch"&&!u.current&&!i.isPointerInTransitRef.current&&(s.onTriggerEnter(),u.current=!0)}),onPointerLeave:pe(e.onPointerLeave,()=>{s.onTriggerLeave(),u.current=!1}),onPointerDown:pe(e.onPointerDown,()=>{s.open&&s.onClose(),d.current=!0,document.addEventListener("pointerup",h,{once:!0})}),onFocus:pe(e.onFocus,()=>{d.current||s.onOpen()}),onBlur:pe(e.onBlur,s.onClose),onClick:pe(e.onClick,s.onClose)})})});Y9.displayName=dw;var X9="TooltipPortal",[xfe,Z9]=gv(X9,{forceMount:void 0}),kd="TooltipContent",AO=p.forwardRef((e,t)=>{const n=Z9(kd,e.__scopeTooltip),{forceMount:r=n.forceMount,side:s="top",...i}=e,o=vv(kd,e.__scopeTooltip);return a.jsx(Pn,{present:r||o.open,children:o.disableHoverableContent?a.jsx(RO,{side:s,...i,ref:t}):a.jsx(e7,{side:s,...i,ref:t})})}),e7=p.forwardRef((e,t)=>{const n=vv(kd,e.__scopeTooltip),r=PO(kd,e.__scopeTooltip),s=p.useRef(null),i=We(t,s),[o,l]=p.useState(null),{trigger:c,onClose:d}=n,u=s.current,{onPointerInTransitChange:h}=r,f=p.useCallback(()=>{l(null),h(!1)},[h]),m=p.useCallback((g,v)=>{const x=g.currentTarget,S={x:g.clientX,y:g.clientY},y=i7(S,x.getBoundingClientRect()),b=a7(S,y),w=o7(v.getBoundingClientRect()),C=c7([...b,...w]);l(C),h(!0)},[h]);return p.useEffect(()=>()=>f(),[f]),p.useEffect(()=>{if(c&&u){const g=x=>m(x,u),v=x=>m(x,c);return c.addEventListener("pointerleave",g),u.addEventListener("pointerleave",v),()=>{c.removeEventListener("pointerleave",g),u.removeEventListener("pointerleave",v)}}},[c,u,m,f]),p.useEffect(()=>{if(o){const g=v=>{const x=v.target,S={x:v.clientX,y:v.clientY},y=(c==null?void 0:c.contains(x))||(u==null?void 0:u.contains(x)),b=!l7(S,o);y?f():b&&(f(),d())};return document.addEventListener("pointermove",g),()=>document.removeEventListener("pointermove",g)}},[c,u,o,d,f]),a.jsx(RO,{...e,ref:i})}),[t7,n7]=gv(IO,{isInside:!1}),r7=K9("TooltipContent"),RO=p.forwardRef((e,t)=>{const{__scopeTooltip:n,children:r,"aria-label":s,onEscapeKeyDown:i,onPointerDownOutside:o,...l}=e,c=vv(kd,n),d=U0(n),{onClose:u}=c;return p.useEffect(()=>(document.addEventListener(zE,u),()=>document.removeEventListener(zE,u)),[u]),p.useEffect(()=>{if(c.trigger){const h=f=>{const m=f.target;m!=null&&m.contains(c.trigger)&&u()};return window.addEventListener("scroll",h,{capture:!0}),()=>window.removeEventListener("scroll",h,{capture:!0})}},[c.trigger,u]),a.jsx(Yl,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:h=>h.preventDefault(),onDismiss:u,children:a.jsxs(pv,{"data-state":c.stateAttribute,...d,...l,ref:t,style:{...l.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[a.jsx(r7,{children:r}),a.jsx(t7,{scope:n,isInside:!0,children:a.jsx(r8,{id:c.contentId,role:"tooltip",children:s||r})})]})})});AO.displayName=kd;var jO="TooltipArrow",s7=p.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,s=U0(n);return n7(jO,n).isInside?null:a.jsx(mv,{...s,...r,ref:t})});s7.displayName=jO;function i7(e,t){const n=Math.abs(t.top-e.y),r=Math.abs(t.bottom-e.y),s=Math.abs(t.right-e.x),i=Math.abs(t.left-e.x);switch(Math.min(n,r,s,i)){case i:return"left";case s:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function a7(e,t,n=5){const r=[];switch(t){case"top":r.push({x:e.x-n,y:e.y+n},{x:e.x+n,y:e.y+n});break;case"bottom":r.push({x:e.x-n,y:e.y-n},{x:e.x+n,y:e.y-n});break;case"left":r.push({x:e.x+n,y:e.y-n},{x:e.x+n,y:e.y+n});break;case"right":r.push({x:e.x-n,y:e.y-n},{x:e.x-n,y:e.y+n});break}return r}function o7(e){const{top:t,right:n,bottom:r,left:s}=e;return[{x:s,y:t},{x:n,y:t},{x:n,y:r},{x:s,y:r}]}function l7(e,t){const{x:n,y:r}=e;let s=!1;for(let i=0,o=t.length-1;i<t.length;o=i++){const l=t[i],c=t[o],d=l.x,u=l.y,h=c.x,f=c.y;u>r!=f>r&&n<(h-d)*(r-u)/(f-u)+d&&(s=!s)}return s}function c7(e){const t=e.slice();return t.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),d7(t)}function d7(e){if(e.length<=1)return e.slice();const t=[];for(let r=0;r<e.length;r++){const s=e[r];for(;t.length>=2;){const i=t[t.length-1],o=t[t.length-2];if((i.x-o.x)*(s.y-o.y)>=(i.y-o.y)*(s.x-o.x))t.pop();else break}t.push(s)}t.pop();const n=[];for(let r=e.length-1;r>=0;r--){const s=e[r];for(;n.length>=2;){const i=n[n.length-1],o=n[n.length-2];if((i.x-o.x)*(s.y-o.y)>=(i.y-o.y)*(s.x-o.x))n.pop();else break}n.push(s)}return n.pop(),t.length===1&&n.length===1&&t[0].x===n[0].x&&t[0].y===n[0].y?t:t.concat(n)}var u7=NO,MO=AO;const h7=u7,f7=p.forwardRef(({className:e,sideOffset:t=4,...n},r)=>a.jsx(MO,{ref:r,sideOffset:t,className:be("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",e),...n}));f7.displayName=MO.displayName;const p7={theme:"system",setTheme:()=>null},DO=p.createContext(p7);function m7({children:e,defaultTheme:t="dark",storageKey:n="gamematch-ui-theme",...r}){const[s,i]=p.useState(()=>localStorage.getItem(n)||t);p.useEffect(()=>{const l=window.document.documentElement;if(l.classList.remove("light","dark","theme-midnight","theme-forest","theme-sunset","theme-neon"),s==="system"){const u=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";l.classList.add(u);return}const d={dark:"dark",light:"light",midnight:"theme-midnight",forest:"theme-forest",sunset:"theme-sunset",neon:"theme-neon"}[s]||"dark";l.classList.add(d)},[s]);const o={theme:s,setTheme:l=>{localStorage.setItem(n,l),i(l)}};return a.jsx(DO.Provider,{...r,value:o,children:e})}const g7=()=>{const e=p.useContext(DO);if(e===void 0)throw new Error("useTheme must be used within a ThemeProvider");return e},OO=p.createContext(void 0);function v7({children:e}){const[t,n]=p.useState(()=>localStorage.getItem("gamematch-background-theme")||"solid");p.useEffect(()=>{localStorage.setItem("gamematch-background-theme",t)},[t]);const r=s=>{n(s)};return a.jsx(OO.Provider,{value:{background:t,setBackground:r},children:e})}function V0(){const e=p.useContext(OO);if(e===void 0)throw new Error("useBackground must be used within a BackgroundProvider");return e}const LO=p.createContext(void 0);function y7({children:e}){const[t,n]=p.useState(()=>localStorage.getItem("layoutWidth")||"compact"),r=o=>{n(o),localStorage.setItem("layoutWidth",o)},s=()=>{switch(t){case"compact":return"max-w-3xl";case"comfortable":return"max-w-7xl";case"cozy":return"max-w-5xl";default:return"max-w-3xl"}},i=()=>{switch(t){case"compact":return"text-sm";case"comfortable":return"text-base";case"cozy":return"text-sm";default:return"text-sm"}};return a.jsx(LO.Provider,{value:{layoutWidth:t,setLayoutWidth:r,getContainerClass:s,getFontSizeClass:i},children:e})}function Ri(){const e=p.useContext(LO);if(e===void 0)throw new Error("useLayout must be used within a LayoutProvider");return e}function x7(e){let t;const n=new Set,r=(d,u)=>{const h=typeof d=="function"?d(t):d;if(h!==t){const f=t;t=u?h:Object.assign({},t,h),n.forEach(m=>m(t,f))}},s=()=>t,i=(d,u=s,h=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let f=u(t);function m(){const g=u(t);if(!h(f,g)){const v=f;d(f=g,v)}}return n.add(m),()=>n.delete(m)},c={setState:r,getState:s,subscribe:(d,u,h)=>u||h?i(d,u,h):(n.add(d),()=>n.delete(d)),destroy:()=>n.clear()};return t=e(r,s,c),c}const b7=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),GE=b7?p.useEffect:p.useLayoutEffect;function wp(e){const t=typeof e=="function"?x7(e):e,n=(r=t.getState,s=Object.is)=>{const[,i]=p.useReducer(x=>x+1,0),o=t.getState(),l=p.useRef(o),c=p.useRef(r),d=p.useRef(s),u=p.useRef(!1),h=p.useRef();h.current===void 0&&(h.current=r(o));let f,m=!1;(l.current!==o||c.current!==r||d.current!==s||u.current)&&(f=r(o),m=!s(h.current,f)),GE(()=>{m&&(h.current=f),l.current=o,c.current=r,d.current=s,u.current=!1});const g=p.useRef(o);GE(()=>{const x=()=>{try{const y=t.getState(),b=c.current(y);d.current(h.current,b)||(l.current=y,h.current=b,i())}catch{u.current=!0,i()}},S=t.subscribe(x);return t.getState()!==g.current&&x(),S},[]);const v=m?f:h.current;return p.useDebugValue(v),v};return Object.assign(n,t),n[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const r=[n,t];return{next(){const s=r.length<=0;return{value:r.shift(),done:s}}}},n}function w7(e,t){return e===t}function S7(e,t,n){if(t===null||n===null||t.length!==n.length)return!1;for(var r=t.length,s=0;s<r;s++)if(!e(t[s],n[s]))return!1;return!0}function k7(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:w7,n=null,r=null;return function(){return S7(t,n,arguments)||(r=e.apply(null,arguments)),n=arguments,r}}function T7(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every(function(r){return typeof r=="function"})){var n=t.map(function(r){return typeof r}).join(", ");throw new Error("Selector creators expect all input-selectors to be functions, "+("instead received the following types: ["+n+"]"))}return t}function C7(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(){for(var s=arguments.length,i=Array(s),o=0;o<s;o++)i[o]=arguments[o];var l=0,c=i.pop(),d=T7(i),u=e.apply(void 0,[function(){return l++,c.apply(null,arguments)}].concat(n)),h=e(function(){for(var f=[],m=d.length,g=0;g<m;g++)f.push(d[g].apply(null,arguments));return u.apply(null,f)});return h.resultFunc=c,h.dependencies=d,h.recomputations=function(){return l},h.resetRecomputations=function(){return l=0},h}}var me=C7(k7),uw={exports:{}};(function(e,t){(function(n,r){var s="1.0.41",i="",o="?",l="function",c="undefined",d="object",u="string",h="major",f="model",m="name",g="type",v="vendor",x="version",S="architecture",y="console",b="mobile",w="tablet",C="smarttv",I="wearable",R="embedded",L=500,N="Amazon",O="Apple",G="ASUS",H="BlackBerry",re="Browser",X="Chrome",Q="Edge",V="Firefox",te="Google",k="Honor",E="Huawei",M="Lenovo",A="LG",F="Microsoft",q="Motorola",P="Nvidia",j="OnePlus",$="Opera",W="OPPO",ie="Samsung",Z="Sharp",ne="Sony",ae="Xiaomi",ge="Zebra",Le="Facebook",Ct="Chromium OS",pn="Mac OS",mn=" Browser",Fn=function(Qe,ht){var qe={};for(var wt in Qe)ht[wt]&&ht[wt].length%2===0?qe[wt]=ht[wt].concat(Qe[wt]):qe[wt]=Qe[wt];return qe},se=function(Qe){for(var ht={},qe=0;qe<Qe.length;qe++)ht[Qe[qe].toUpperCase()]=Qe[qe];return ht},Ee=function(Qe,ht){return typeof Qe===u?U(ht).indexOf(U(Qe))!==-1:!1},U=function(Qe){return Qe.toLowerCase()},J=function(Qe){return typeof Qe===u?Qe.replace(/[^\d\.]/g,i).split(".")[0]:r},Y=function(Qe,ht){if(typeof Qe===u)return Qe=Qe.replace(/^\s\s*/,i),typeof ht===c?Qe:Qe.substring(0,L)},ce=function(Qe,ht){for(var qe=0,wt,ar,or,ft,Ve,$n;qe<ht.length&&!Ve;){var sc=ht[qe],Hf=ht[qe+1];for(wt=ar=0;wt<sc.length&&!Ve&&sc[wt];)if(Ve=sc[wt++].exec(Qe),Ve)for(or=0;or<Hf.length;or++)$n=Ve[++ar],ft=Hf[or],typeof ft===d&&ft.length>0?ft.length===2?typeof ft[1]==l?this[ft[0]]=ft[1].call(this,$n):this[ft[0]]=ft[1]:ft.length===3?typeof ft[1]===l&&!(ft[1].exec&&ft[1].test)?this[ft[0]]=$n?ft[1].call(this,$n,ft[2]):r:this[ft[0]]=$n?$n.replace(ft[1],ft[2]):r:ft.length===4&&(this[ft[0]]=$n?ft[3].call(this,$n.replace(ft[1],ft[2])):r):this[ft]=$n||r;qe+=2}},he=function(Qe,ht){for(var qe in ht)if(typeof ht[qe]===d&&ht[qe].length>0){for(var wt=0;wt<ht[qe].length;wt++)if(Ee(ht[qe][wt],Qe))return qe===o?r:qe}else if(Ee(ht[qe],Qe))return qe===o?r:qe;return ht.hasOwnProperty("*")?ht["*"]:Qe},fe={"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},je={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},ct={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[x,[m,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[x,[m,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[m,x],[/opios[\/ ]+([\w\.]+)/i],[x,[m,$+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[x,[m,$+" GX"]],[/\bopr\/([\w\.]+)/i],[x,[m,$]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[x,[m,"Baidu"]],[/\b(?:mxbrowser|mxios|myie2)\/?([-\w\.]*)\b/i],[x,[m,"Maxthon"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer|sleipnir)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim(?:browser|boat|jet))[\/ ]?([\d\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|duckduckgo|klar|helio|(?=comodo_)?dragon)\/([-\w\.]+)/i,/(heytap|ovi|115)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[m,x],[/quark(?:pc)?\/([-\w\.]+)/i],[x,[m,"Quark"]],[/\bddg\/([\w\.]+)/i],[x,[m,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[x,[m,"UC"+re]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[x,[m,"WeChat"]],[/konqueror\/([\w\.]+)/i],[x,[m,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[x,[m,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[x,[m,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[x,[m,"Smart Lenovo "+re]],[/(avast|avg)\/([\w\.]+)/i],[[m,/(.+)/,"$1 Secure "+re],x],[/\bfocus\/([\w\.]+)/i],[x,[m,V+" Focus"]],[/\bopt\/([\w\.]+)/i],[x,[m,$+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[x,[m,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[x,[m,"Dolphin"]],[/coast\/([\w\.]+)/i],[x,[m,$+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[x,[m,"MIUI"+mn]],[/fxios\/([\w\.-]+)/i],[x,[m,V]],[/\bqihoobrowser\/?([\w\.]*)/i],[x,[m,"360"]],[/\b(qq)\/([\w\.]+)/i],[[m,/(.+)/,"$1Browser"],x],[/(oculus|sailfish|huawei|vivo|pico)browser\/([\w\.]+)/i],[[m,/(.+)/,"$1"+mn],x],[/samsungbrowser\/([\w\.]+)/i],[x,[m,ie+" Internet"]],[/metasr[\/ ]?([\d\.]+)/i],[x,[m,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[m,"Sogou Mobile"],x],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345(?=browser|chrome|explorer))\w*[\/ ]?v?([\w\.]+)/i],[m,x],[/(lbbrowser|rekonq)/i,/\[(linkedin)app\]/i],[m],[/ome\/([\w\.]+) \w* ?(iron) saf/i,/ome\/([\w\.]+).+qihu (360)[es]e/i],[x,m],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[m,Le],x],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/(daum)apps[\/ ]([\w\.]+)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[m,x],[/\bgsa\/([\w\.]+) .*safari\//i],[x,[m,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[x,[m,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[x,[m,X+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[m,X+" WebView"],x],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[x,[m,"Android "+re]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[m,x],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[x,[m,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[x,m],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[m,[x,he,fe]],[/(webkit|khtml)\/([\w\.]+)/i],[m,x],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[m,"Netscape"],x],[/(wolvic|librewolf)\/([\w\.]+)/i],[m,x],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[x,[m,V+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(amaya|dillo|doris|icab|ladybird|lynx|mosaic|netsurf|obigo|polaris|w3m|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/\b(links) \(([\w\.]+)/i],[m,[x,/_/g,"."]],[/(cobalt)\/([\w\.]+)/i],[m,[x,/master.|lts./,""]]],cpu:[[/\b((amd|x|x86[-_]?|wow|win)64)\b/i],[[S,"amd64"]],[/(ia32(?=;))/i,/\b((i[346]|x)86)(pc)?\b/i],[[S,"ia32"]],[/\b(aarch64|arm(v?[89]e?l?|_?64))\b/i],[[S,"arm64"]],[/\b(arm(v[67])?ht?n?[fl]p?)\b/i],[[S,"armhf"]],[/( (ce|mobile); ppc;|\/[\w\.]+arm\b)/i],[[S,"arm"]],[/((ppc|powerpc)(64)?)( mac|;|\))/i],[[S,/ower/,i,U]],[/ sun4\w[;\)]/i],[[S,"sparc"]],[/\b(avr32|ia64(?=;)|68k(?=\))|\barm(?=v([1-7]|[5-7]1)l?|;|eabi)|(irix|mips|sparc)(64)?\b|pa-risc)/i],[[S,U]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[f,[v,ie],[g,w]],[/\b((?:s[cgp]h|gt|sm)-(?![lr])\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]((?!sm-[lr])[-\w]+)/i,/sec-(sgh\w+)/i],[f,[v,ie],[g,b]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[f,[v,O],[g,b]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[f,[v,O],[g,w]],[/(macintosh);/i],[f,[v,O]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[f,[v,Z],[g,b]],[/\b((?:brt|eln|hey2?|gdi|jdn)-a?[lnw]09|(?:ag[rm]3?|jdn2|kob2)-a?[lw]0[09]hn)(?: bui|\)|;)/i],[f,[v,k],[g,w]],[/honor([-\w ]+)[;\)]/i],[f,[v,k],[g,b]],[/\b((?:ag[rs][2356]?k?|bah[234]?|bg[2o]|bt[kv]|cmr|cpn|db[ry]2?|jdn2|got|kob2?k?|mon|pce|scm|sht?|[tw]gr|vrd)-[ad]?[lw][0125][09]b?|605hw|bg2-u03|(?:gem|fdr|m2|ple|t1)-[7a]0[1-4][lu]|t1-a2[13][lw]|mediapad[\w\. ]*(?= bui|\)))\b(?!.+d\/s)/i],[f,[v,E],[g,w]],[/(?:huawei)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[f,[v,E],[g,b]],[/oid[^\)]+; (2[\dbc]{4}(182|283|rp\w{2})[cgl]|m2105k81a?c)(?: bui|\))/i,/\b((?:red)?mi[-_ ]?pad[\w- ]*)(?: bui|\))/i],[[f,/_/g," "],[v,ae],[g,w]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite|pro)?)(?: bui|\))/i,/ ([\w ]+) miui\/v?\d/i],[[f,/_/g," "],[v,ae],[g,b]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[f,[v,W],[g,b]],[/\b(opd2(\d{3}a?))(?: bui|\))/i],[f,[v,he,{OnePlus:["304","403","203"],"*":W}],[g,w]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[f,[v,"Vivo"],[g,b]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[f,[v,"Realme"],[g,b]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto(?! 360)[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[f,[v,q],[g,b]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[f,[v,q],[g,w]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[f,[v,A],[g,w]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv|watch)\w+)/i,/\blg-?([\d\w]+) bui/i],[f,[v,A],[g,b]],[/(ideatab[-\w ]+|602lv|d-42a|a101lv|a2109a|a3500-hv|s[56]000|pb-6505[my]|tb-?x?\d{3,4}(?:f[cu]|xu|[av])|yt\d?-[jx]?\d+[lfmx])( bui|;|\)|\/)/i,/lenovo ?(b[68]0[08]0-?[hf]?|tab(?:[\w- ]+?)|tb[\w-]{6,7})( bui|;|\)|\/)/i],[f,[v,M],[g,w]],[/(nokia) (t[12][01])/i],[v,f,[g,w]],[/(?:maemo|nokia).*(n900|lumia \d+|rm-\d+)/i,/nokia[-_ ]?(([-\w\. ]*))/i],[[f,/_/g," "],[g,b],[v,"Nokia"]],[/(pixel (c|tablet))\b/i],[f,[v,te],[g,w]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[f,[v,te],[g,b]],[/droid.+; (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[f,[v,ne],[g,b]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[f,"Xperia Tablet"],[v,ne],[g,w]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[f,[v,j],[g,b]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo(?!bc)\w\w)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[f,[v,N],[g,w]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[f,/(.+)/g,"Fire Phone $1"],[v,N],[g,b]],[/(playbook);[-\w\),; ]+(rim)/i],[f,v,[g,w]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[f,[v,H],[g,b]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[f,[v,G],[g,w]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[f,[v,G],[g,b]],[/(nexus 9)/i],[f,[v,"HTC"],[g,w]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[v,[f,/_/g," "],[g,b]],[/droid [\w\.]+; ((?:8[14]9[16]|9(?:0(?:48|60|8[01])|1(?:3[27]|66)|2(?:6[69]|9[56])|466))[gqswx])\w*(\)| bui)/i],[f,[v,"TCL"],[g,w]],[/(itel) ((\w+))/i],[[v,U],f,[g,he,{tablet:["p10001l","w7001"],"*":"mobile"}]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[f,[v,"Acer"],[g,w]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[f,[v,"Meizu"],[g,b]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[f,[v,"Ulefone"],[g,b]],[/; (energy ?\w+)(?: bui|\))/i,/; energizer ([\w ]+)(?: bui|\))/i],[f,[v,"Energizer"],[g,b]],[/; cat (b35);/i,/; (b15q?|s22 flip|s48c|s62 pro)(?: bui|\))/i],[f,[v,"Cat"],[g,b]],[/((?:new )?andromax[\w- ]+)(?: bui|\))/i],[f,[v,"Smartfren"],[g,b]],[/droid.+; (a(?:015|06[35]|142p?))/i],[f,[v,"Nothing"],[g,b]],[/; (x67 5g|tikeasy \w+|ac[1789]\d\w+)( b|\))/i,/archos ?(5|gamepad2?|([\w ]*[t1789]|hello) ?\d+[\w ]*)( b|\))/i],[f,[v,"Archos"],[g,w]],[/archos ([\w ]+)( b|\))/i,/; (ac[3-6]\d\w{2,8})( b|\))/i],[f,[v,"Archos"],[g,b]],[/(imo) (tab \w+)/i,/(infinix) (x1101b?)/i],[v,f,[g,w]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus(?! zenw)|dell|jolla|meizu|motorola|polytron|infinix|tecno|micromax|advan)[-_ ]?([-\w]*)/i,/; (hmd|imo) ([\w ]+?)(?: bui|\))/i,/(hp) ([\w ]+\w)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w ]+?)(?: bui|\)|\/)/i,/(oppo) ?([\w ]+) bui/i],[v,f,[g,b]],[/(kobo)\s(ereader|touch)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[v,f,[g,w]],[/(surface duo)/i],[f,[v,F],[g,w]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[f,[v,"Fairphone"],[g,b]],[/(u304aa)/i],[f,[v,"AT&T"],[g,b]],[/\bsie-(\w*)/i],[f,[v,"Siemens"],[g,b]],[/\b(rct\w+) b/i],[f,[v,"RCA"],[g,w]],[/\b(venue[\d ]{2,7}) b/i],[f,[v,"Dell"],[g,w]],[/\b(q(?:mv|ta)\w+) b/i],[f,[v,"Verizon"],[g,w]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[f,[v,"Barnes & Noble"],[g,w]],[/\b(tm\d{3}\w+) b/i],[f,[v,"NuVision"],[g,w]],[/\b(k88) b/i],[f,[v,"ZTE"],[g,w]],[/\b(nx\d{3}j) b/i],[f,[v,"ZTE"],[g,b]],[/\b(gen\d{3}) b.+49h/i],[f,[v,"Swiss"],[g,b]],[/\b(zur\d{3}) b/i],[f,[v,"Swiss"],[g,w]],[/\b((zeki)?tb.*\b) b/i],[f,[v,"Zeki"],[g,w]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[v,"Dragon Touch"],f,[g,w]],[/\b(ns-?\w{0,9}) b/i],[f,[v,"Insignia"],[g,w]],[/\b((nxa|next)-?\w{0,9}) b/i],[f,[v,"NextBook"],[g,w]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[v,"Voice"],f,[g,b]],[/\b(lvtel\-)?(v1[12]) b/i],[[v,"LvTel"],f,[g,b]],[/\b(ph-1) /i],[f,[v,"Essential"],[g,b]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[f,[v,"Envizen"],[g,w]],[/\b(trio[-\w\. ]+) b/i],[f,[v,"MachSpeed"],[g,w]],[/\btu_(1491) b/i],[f,[v,"Rotor"],[g,w]],[/((?:tegranote|shield t(?!.+d tv))[\w- ]*?)(?: b|\))/i],[f,[v,P],[g,w]],[/(sprint) (\w+)/i],[v,f,[g,b]],[/(kin\.[onetw]{3})/i],[[f,/\./g," "],[v,F],[g,b]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[f,[v,ge],[g,w]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[f,[v,ge],[g,b]],[/smart-tv.+(samsung)/i],[v,[g,C]],[/hbbtv.+maple;(\d+)/i],[[f,/^/,"SmartTV"],[v,ie],[g,C]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[v,A],[g,C]],[/(apple) ?tv/i],[v,[f,O+" TV"],[g,C]],[/crkey/i],[[f,X+"cast"],[v,te],[g,C]],[/droid.+aft(\w+)( bui|\))/i],[f,[v,N],[g,C]],[/(shield \w+ tv)/i],[f,[v,P],[g,C]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[f,[v,Z],[g,C]],[/(bravia[\w ]+)( bui|\))/i],[f,[v,ne],[g,C]],[/(mi(tv|box)-?\w+) bui/i],[f,[v,ae],[g,C]],[/Hbbtv.*(technisat) (.*);/i],[v,f,[g,C]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[v,Y],[f,Y],[g,C]],[/droid.+; ([\w- ]+) (?:android tv|smart[- ]?tv)/i],[f,[g,C]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[g,C]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[v,f,[g,y]],[/droid.+; (shield)( bui|\))/i],[f,[v,P],[g,y]],[/(playstation \w+)/i],[f,[v,ne],[g,y]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[f,[v,F],[g,y]],[/\b(sm-[lr]\d\d[0156][fnuw]?s?|gear live)\b/i],[f,[v,ie],[g,I]],[/((pebble))app/i,/(asus|google|lg|oppo) ((pixel |zen)?watch[\w ]*)( bui|\))/i],[v,f,[g,I]],[/(ow(?:19|20)?we?[1-3]{1,3})/i],[f,[v,W],[g,I]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[f,[v,O],[g,I]],[/(opwwe\d{3})/i],[f,[v,j],[g,I]],[/(moto 360)/i],[f,[v,q],[g,I]],[/(smartwatch 3)/i],[f,[v,ne],[g,I]],[/(g watch r)/i],[f,[v,A],[g,I]],[/droid.+; (wt63?0{2,3})\)/i],[f,[v,ge],[g,I]],[/droid.+; (glass) \d/i],[f,[v,te],[g,I]],[/(pico) (4|neo3(?: link|pro)?)/i],[v,f,[g,I]],[/; (quest( \d| pro)?)/i],[f,[v,Le],[g,I]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[v,[g,R]],[/(aeobc)\b/i],[f,[v,N],[g,R]],[/(homepod).+mac os/i],[f,[v,O],[g,R]],[/windows iot/i],[[g,R]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[f,[g,b]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[f,[g,w]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[g,w]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[g,b]],[/droid .+?; ([\w\. -]+)( bui|\))/i],[f,[v,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[x,[m,Q+"HTML"]],[/(arkweb)\/([\w\.]+)/i],[m,x],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[x,[m,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna|servo)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[m,x],[/ladybird\//i],[[m,"LibWeb"]],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[x,m]],os:[[/microsoft (windows) (vista|xp)/i],[m,x],[/(windows (?:phone(?: os)?|mobile|iot))[\/ ]?([\d\.\w ]*)/i],[m,[x,he,je]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[x,he,je],[m,"Windows"]],[/[adehimnop]{4,7}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[x,/_/g,"."],[m,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[m,pn],[x,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[x,m],[/(ubuntu) ([\w\.]+) like android/i],[[m,/(.+)/,"$1 Touch"],x],[/(android|bada|blackberry|kaios|maemo|meego|openharmony|qnx|rim tablet os|sailfish|series40|symbian|tizen|webos)\w*[-\/; ]?([\d\.]*)/i],[m,x],[/\(bb(10);/i],[x,[m,H]],[/(?:symbian ?os|symbos|s60(?=;)|series ?60)[-\/ ]?([\w\.]*)/i],[x,[m,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[x,[m,V+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[x,[m,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[x,[m,"watchOS"]],[/crkey\/([\d\.]+)/i],[x,[m,X+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[m,Ct],x],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux)(?: arm\w*| x86\w*| ?)([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[m,x],[/(sunos) ?([\w\.\d]*)/i],[[m,"Solaris"],x],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[m,x]]},Ze=function(Qe,ht){if(typeof Qe===d&&(ht=Qe,Qe=r),!(this instanceof Ze))return new Ze(Qe,ht).getResult();var qe=typeof n!==c&&n.navigator?n.navigator:r,wt=Qe||(qe&&qe.userAgent?qe.userAgent:i),ar=qe&&qe.userAgentData?qe.userAgentData:r,or=ht?Fn(ct,ht):ct,ft=qe&&qe.userAgent==wt;return this.getBrowser=function(){var Ve={};return Ve[m]=r,Ve[x]=r,ce.call(Ve,wt,or.browser),Ve[h]=J(Ve[x]),ft&&qe&&qe.brave&&typeof qe.brave.isBrave==l&&(Ve[m]="Brave"),Ve},this.getCPU=function(){var Ve={};return Ve[S]=r,ce.call(Ve,wt,or.cpu),Ve},this.getDevice=function(){var Ve={};return Ve[v]=r,Ve[f]=r,Ve[g]=r,ce.call(Ve,wt,or.device),ft&&!Ve[g]&&ar&&ar.mobile&&(Ve[g]=b),ft&&Ve[f]=="Macintosh"&&qe&&typeof qe.standalone!==c&&qe.maxTouchPoints&&qe.maxTouchPoints>2&&(Ve[f]="iPad",Ve[g]=w),Ve},this.getEngine=function(){var Ve={};return Ve[m]=r,Ve[x]=r,ce.call(Ve,wt,or.engine),Ve},this.getOS=function(){var Ve={};return Ve[m]=r,Ve[x]=r,ce.call(Ve,wt,or.os),ft&&!Ve[m]&&ar&&ar.platform&&ar.platform!="Unknown"&&(Ve[m]=ar.platform.replace(/chrome os/i,Ct).replace(/macos/i,pn)),Ve},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return wt},this.setUA=function(Ve){return wt=typeof Ve===u&&Ve.length>L?Y(Ve,L):Ve,this},this.setUA(wt),this};Ze.VERSION=s,Ze.BROWSER=se([m,x,h]),Ze.CPU=se([S]),Ze.DEVICE=se([f,v,g,y,b,C,w,I,R]),Ze.ENGINE=Ze.OS=se([m,x]),e.exports&&(t=e.exports=Ze),t.UAParser=Ze;var Zt=typeof n!==c&&(n.jQuery||n.Zepto);if(Zt&&!Zt.ua){var gn=new Ze;Zt.ua=gn.getResult(),Zt.ua.get=function(){return gn.getUA()},Zt.ua.set=function(Qe){gn.setUA(Qe);var ht=gn.getResult();for(var qe in ht)Zt.ua[qe]=ht[qe]}}})(typeof window=="object"?window:Eu)})(uw,uw.exports);var E7=uw.exports,Sp,_7=new Uint8Array(16);function P7(){if(!Sp&&(Sp=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!Sp))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Sp(_7)}const N7=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function I7(e){return typeof e=="string"&&N7.test(e)}var Jn=[];for(var tx=0;tx<256;++tx)Jn.push((tx+256).toString(16).substr(1));function A7(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=(Jn[e[t+0]]+Jn[e[t+1]]+Jn[e[t+2]]+Jn[e[t+3]]+"-"+Jn[e[t+4]]+Jn[e[t+5]]+"-"+Jn[e[t+6]]+Jn[e[t+7]]+"-"+Jn[e[t+8]]+Jn[e[t+9]]+"-"+Jn[e[t+10]]+Jn[e[t+11]]+Jn[e[t+12]]+Jn[e[t+13]]+Jn[e[t+14]]+Jn[e[t+15]]).toLowerCase();if(!I7(n))throw TypeError("Stringified UUID is invalid");return n}function Lo(e,t,n){e=e||{};var r=e.random||(e.rng||P7)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,A7(r)}var Zm={exports:{}};Zm.exports;(function(e,t){var n=200,r="__lodash_hash_undefined__",s=1,i=2,o=9007199254740991,l="[object Arguments]",c="[object Array]",d="[object AsyncFunction]",u="[object Boolean]",h="[object Date]",f="[object Error]",m="[object Function]",g="[object GeneratorFunction]",v="[object Map]",x="[object Number]",S="[object Null]",y="[object Object]",b="[object Promise]",w="[object Proxy]",C="[object RegExp]",I="[object Set]",R="[object String]",L="[object Symbol]",N="[object Undefined]",O="[object WeakMap]",G="[object ArrayBuffer]",H="[object DataView]",re="[object Float32Array]",X="[object Float64Array]",Q="[object Int8Array]",V="[object Int16Array]",te="[object Int32Array]",k="[object Uint8Array]",E="[object Uint8ClampedArray]",M="[object Uint16Array]",A="[object Uint32Array]",F=/[\\^$.*+?()[\]{}|]/g,q=/^\[object .+?Constructor\]$/,P=/^(?:0|[1-9]\d*)$/,j={};j[re]=j[X]=j[Q]=j[V]=j[te]=j[k]=j[E]=j[M]=j[A]=!0,j[l]=j[c]=j[G]=j[u]=j[H]=j[h]=j[f]=j[m]=j[v]=j[x]=j[y]=j[C]=j[I]=j[R]=j[O]=!1;var $=typeof Eu=="object"&&Eu&&Eu.Object===Object&&Eu,W=typeof self=="object"&&self&&self.Object===Object&&self,ie=$||W||Function("return this")(),Z=t&&!t.nodeType&&t,ne=Z&&!0&&e&&!e.nodeType&&e,ae=ne&&ne.exports===Z,ge=ae&&$.process,Le=function(){try{return ge&&ge.binding&&ge.binding("util")}catch{}}(),Ct=Le&&Le.isTypedArray;function pn(D,K){for(var ue=-1,Ie=D==null?0:D.length,Ft=0,rt=[];++ue<Ie;){var en=D[ue];K(en,ue,D)&&(rt[Ft++]=en)}return rt}function mn(D,K){for(var ue=-1,Ie=K.length,Ft=D.length;++ue<Ie;)D[Ft+ue]=K[ue];return D}function Fn(D,K){for(var ue=-1,Ie=D==null?0:D.length;++ue<Ie;)if(K(D[ue],ue,D))return!0;return!1}function se(D,K){for(var ue=-1,Ie=Array(D);++ue<D;)Ie[ue]=K(ue);return Ie}function Ee(D){return function(K){return D(K)}}function U(D,K){return D.has(K)}function J(D,K){return D==null?void 0:D[K]}function Y(D){var K=-1,ue=Array(D.size);return D.forEach(function(Ie,Ft){ue[++K]=[Ft,Ie]}),ue}function ce(D,K){return function(ue){return D(K(ue))}}function he(D){var K=-1,ue=Array(D.size);return D.forEach(function(Ie){ue[++K]=Ie}),ue}var fe=Array.prototype,je=Function.prototype,ct=Object.prototype,Ze=ie["__core-js_shared__"],Zt=je.toString,gn=ct.hasOwnProperty,Qe=function(){var D=/[^.]+$/.exec(Ze&&Ze.keys&&Ze.keys.IE_PROTO||"");return D?"Symbol(src)_1."+D:""}(),ht=ct.toString,qe=RegExp("^"+Zt.call(gn).replace(F,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),wt=ae?ie.Buffer:void 0,ar=ie.Symbol,or=ie.Uint8Array,ft=ct.propertyIsEnumerable,Ve=fe.splice,$n=ar?ar.toStringTag:void 0,sc=Object.getOwnPropertySymbols,Hf=wt?wt.isBuffer:void 0,FB=ce(Object.keys,Object),py=ic(ie,"DataView"),ru=ic(ie,"Map"),my=ic(ie,"Promise"),gy=ic(ie,"Set"),vy=ic(ie,"WeakMap"),su=ic(Object,"create"),$B=Ho(py),UB=Ho(ru),VB=Ho(my),BB=Ho(gy),zB=Ho(vy),MT=ar?ar.prototype:void 0,yy=MT?MT.valueOf:void 0;function Go(D){var K=-1,ue=D==null?0:D.length;for(this.clear();++K<ue;){var Ie=D[K];this.set(Ie[0],Ie[1])}}function GB(){this.__data__=su?su(null):{},this.size=0}function WB(D){var K=this.has(D)&&delete this.__data__[D];return this.size-=K?1:0,K}function HB(D){var K=this.__data__;if(su){var ue=K[D];return ue===r?void 0:ue}return gn.call(K,D)?K[D]:void 0}function qB(D){var K=this.__data__;return su?K[D]!==void 0:gn.call(K,D)}function KB(D,K){var ue=this.__data__;return this.size+=this.has(D)?0:1,ue[D]=su&&K===void 0?r:K,this}Go.prototype.clear=GB,Go.prototype.delete=WB,Go.prototype.get=HB,Go.prototype.has=qB,Go.prototype.set=KB;function Mi(D){var K=-1,ue=D==null?0:D.length;for(this.clear();++K<ue;){var Ie=D[K];this.set(Ie[0],Ie[1])}}function QB(){this.__data__=[],this.size=0}function JB(D){var K=this.__data__,ue=Kf(K,D);if(ue<0)return!1;var Ie=K.length-1;return ue==Ie?K.pop():Ve.call(K,ue,1),--this.size,!0}function YB(D){var K=this.__data__,ue=Kf(K,D);return ue<0?void 0:K[ue][1]}function XB(D){return Kf(this.__data__,D)>-1}function ZB(D,K){var ue=this.__data__,Ie=Kf(ue,D);return Ie<0?(++this.size,ue.push([D,K])):ue[Ie][1]=K,this}Mi.prototype.clear=QB,Mi.prototype.delete=JB,Mi.prototype.get=YB,Mi.prototype.has=XB,Mi.prototype.set=ZB;function Wo(D){var K=-1,ue=D==null?0:D.length;for(this.clear();++K<ue;){var Ie=D[K];this.set(Ie[0],Ie[1])}}function e6(){this.size=0,this.__data__={hash:new Go,map:new(ru||Mi),string:new Go}}function t6(D){var K=Qf(this,D).delete(D);return this.size-=K?1:0,K}function n6(D){return Qf(this,D).get(D)}function r6(D){return Qf(this,D).has(D)}function s6(D,K){var ue=Qf(this,D),Ie=ue.size;return ue.set(D,K),this.size+=ue.size==Ie?0:1,this}Wo.prototype.clear=e6,Wo.prototype.delete=t6,Wo.prototype.get=n6,Wo.prototype.has=r6,Wo.prototype.set=s6;function qf(D){var K=-1,ue=D==null?0:D.length;for(this.__data__=new Wo;++K<ue;)this.add(D[K])}function i6(D){return this.__data__.set(D,r),this}function a6(D){return this.__data__.has(D)}qf.prototype.add=qf.prototype.push=i6,qf.prototype.has=a6;function ka(D){var K=this.__data__=new Mi(D);this.size=K.size}function o6(){this.__data__=new Mi,this.size=0}function l6(D){var K=this.__data__,ue=K.delete(D);return this.size=K.size,ue}function c6(D){return this.__data__.get(D)}function d6(D){return this.__data__.has(D)}function u6(D,K){var ue=this.__data__;if(ue instanceof Mi){var Ie=ue.__data__;if(!ru||Ie.length<n-1)return Ie.push([D,K]),this.size=++ue.size,this;ue=this.__data__=new Wo(Ie)}return ue.set(D,K),this.size=ue.size,this}ka.prototype.clear=o6,ka.prototype.delete=l6,ka.prototype.get=c6,ka.prototype.has=d6,ka.prototype.set=u6;function h6(D,K){var ue=Jf(D),Ie=!ue&&_6(D),Ft=!ue&&!Ie&&xy(D),rt=!ue&&!Ie&&!Ft&&zT(D),en=ue||Ie||Ft||rt,Un=en?se(D.length,String):[],Qn=Un.length;for(var Ht in D)gn.call(D,Ht)&&!(en&&(Ht=="length"||Ft&&(Ht=="offset"||Ht=="parent")||rt&&(Ht=="buffer"||Ht=="byteLength"||Ht=="byteOffset")||S6(Ht,Qn)))&&Un.push(Ht);return Un}function Kf(D,K){for(var ue=D.length;ue--;)if($T(D[ue][0],K))return ue;return-1}function f6(D,K,ue){var Ie=K(D);return Jf(D)?Ie:mn(Ie,ue(D))}function iu(D){return D==null?D===void 0?N:S:$n&&$n in Object(D)?b6(D):E6(D)}function DT(D){return au(D)&&iu(D)==l}function OT(D,K,ue,Ie,Ft){return D===K?!0:D==null||K==null||!au(D)&&!au(K)?D!==D&&K!==K:p6(D,K,ue,Ie,OT,Ft)}function p6(D,K,ue,Ie,Ft,rt){var en=Jf(D),Un=Jf(K),Qn=en?c:Ta(D),Ht=Un?c:Ta(K);Qn=Qn==l?y:Qn,Ht=Ht==l?y:Ht;var Kr=Qn==y,Ds=Ht==y,lr=Qn==Ht;if(lr&&xy(D)){if(!xy(K))return!1;en=!0,Kr=!1}if(lr&&!Kr)return rt||(rt=new ka),en||zT(D)?LT(D,K,ue,Ie,Ft,rt):y6(D,K,Qn,ue,Ie,Ft,rt);if(!(ue&s)){var ps=Kr&&gn.call(D,"__wrapped__"),ms=Ds&&gn.call(K,"__wrapped__");if(ps||ms){var Ca=ps?D.value():D,Di=ms?K.value():K;return rt||(rt=new ka),Ft(Ca,Di,ue,Ie,rt)}}return lr?(rt||(rt=new ka),x6(D,K,ue,Ie,Ft,rt)):!1}function m6(D){if(!BT(D)||T6(D))return!1;var K=UT(D)?qe:q;return K.test(Ho(D))}function g6(D){return au(D)&&VT(D.length)&&!!j[iu(D)]}function v6(D){if(!C6(D))return FB(D);var K=[];for(var ue in Object(D))gn.call(D,ue)&&ue!="constructor"&&K.push(ue);return K}function LT(D,K,ue,Ie,Ft,rt){var en=ue&s,Un=D.length,Qn=K.length;if(Un!=Qn&&!(en&&Qn>Un))return!1;var Ht=rt.get(D);if(Ht&&rt.get(K))return Ht==K;var Kr=-1,Ds=!0,lr=ue&i?new qf:void 0;for(rt.set(D,K),rt.set(K,D);++Kr<Un;){var ps=D[Kr],ms=K[Kr];if(Ie)var Ca=en?Ie(ms,ps,Kr,K,D,rt):Ie(ps,ms,Kr,D,K,rt);if(Ca!==void 0){if(Ca)continue;Ds=!1;break}if(lr){if(!Fn(K,function(Di,qo){if(!U(lr,qo)&&(ps===Di||Ft(ps,Di,ue,Ie,rt)))return lr.push(qo)})){Ds=!1;break}}else if(!(ps===ms||Ft(ps,ms,ue,Ie,rt))){Ds=!1;break}}return rt.delete(D),rt.delete(K),Ds}function y6(D,K,ue,Ie,Ft,rt,en){switch(ue){case H:if(D.byteLength!=K.byteLength||D.byteOffset!=K.byteOffset)return!1;D=D.buffer,K=K.buffer;case G:return!(D.byteLength!=K.byteLength||!rt(new or(D),new or(K)));case u:case h:case x:return $T(+D,+K);case f:return D.name==K.name&&D.message==K.message;case C:case R:return D==K+"";case v:var Un=Y;case I:var Qn=Ie&s;if(Un||(Un=he),D.size!=K.size&&!Qn)return!1;var Ht=en.get(D);if(Ht)return Ht==K;Ie|=i,en.set(D,K);var Kr=LT(Un(D),Un(K),Ie,Ft,rt,en);return en.delete(D),Kr;case L:if(yy)return yy.call(D)==yy.call(K)}return!1}function x6(D,K,ue,Ie,Ft,rt){var en=ue&s,Un=FT(D),Qn=Un.length,Ht=FT(K),Kr=Ht.length;if(Qn!=Kr&&!en)return!1;for(var Ds=Qn;Ds--;){var lr=Un[Ds];if(!(en?lr in K:gn.call(K,lr)))return!1}var ps=rt.get(D);if(ps&&rt.get(K))return ps==K;var ms=!0;rt.set(D,K),rt.set(K,D);for(var Ca=en;++Ds<Qn;){lr=Un[Ds];var Di=D[lr],qo=K[lr];if(Ie)var GT=en?Ie(qo,Di,lr,K,D,rt):Ie(Di,qo,lr,D,K,rt);if(!(GT===void 0?Di===qo||Ft(Di,qo,ue,Ie,rt):GT)){ms=!1;break}Ca||(Ca=lr=="constructor")}if(ms&&!Ca){var Yf=D.constructor,Xf=K.constructor;Yf!=Xf&&"constructor"in D&&"constructor"in K&&!(typeof Yf=="function"&&Yf instanceof Yf&&typeof Xf=="function"&&Xf instanceof Xf)&&(ms=!1)}return rt.delete(D),rt.delete(K),ms}function FT(D){return f6(D,I6,w6)}function Qf(D,K){var ue=D.__data__;return k6(K)?ue[typeof K=="string"?"string":"hash"]:ue.map}function ic(D,K){var ue=J(D,K);return m6(ue)?ue:void 0}function b6(D){var K=gn.call(D,$n),ue=D[$n];try{D[$n]=void 0;var Ie=!0}catch{}var Ft=ht.call(D);return Ie&&(K?D[$n]=ue:delete D[$n]),Ft}var w6=sc?function(D){return D==null?[]:(D=Object(D),pn(sc(D),function(K){return ft.call(D,K)}))}:A6,Ta=iu;(py&&Ta(new py(new ArrayBuffer(1)))!=H||ru&&Ta(new ru)!=v||my&&Ta(my.resolve())!=b||gy&&Ta(new gy)!=I||vy&&Ta(new vy)!=O)&&(Ta=function(D){var K=iu(D),ue=K==y?D.constructor:void 0,Ie=ue?Ho(ue):"";if(Ie)switch(Ie){case $B:return H;case UB:return v;case VB:return b;case BB:return I;case zB:return O}return K});function S6(D,K){return K=K??o,!!K&&(typeof D=="number"||P.test(D))&&D>-1&&D%1==0&&D<K}function k6(D){var K=typeof D;return K=="string"||K=="number"||K=="symbol"||K=="boolean"?D!=="__proto__":D===null}function T6(D){return!!Qe&&Qe in D}function C6(D){var K=D&&D.constructor,ue=typeof K=="function"&&K.prototype||ct;return D===ue}function E6(D){return ht.call(D)}function Ho(D){if(D!=null){try{return Zt.call(D)}catch{}try{return D+""}catch{}}return""}function $T(D,K){return D===K||D!==D&&K!==K}var _6=DT(function(){return arguments}())?DT:function(D){return au(D)&&gn.call(D,"callee")&&!ft.call(D,"callee")},Jf=Array.isArray;function P6(D){return D!=null&&VT(D.length)&&!UT(D)}var xy=Hf||R6;function N6(D,K){return OT(D,K)}function UT(D){if(!BT(D))return!1;var K=iu(D);return K==m||K==g||K==d||K==w}function VT(D){return typeof D=="number"&&D>-1&&D%1==0&&D<=o}function BT(D){var K=typeof D;return D!=null&&(K=="object"||K=="function")}function au(D){return D!=null&&typeof D=="object"}var zT=Ct?Ee(Ct):g6;function I6(D){return P6(D)?h6(D):v6(D)}function A6(){return[]}function R6(){return!1}e.exports=N6})(Zm,Zm.exports);var R7=Zm.exports;const FO=of(R7);let $O=!0,UO=!0;function Ru(e,t,n){const r=e.match(t);return r&&r.length>=n&&parseFloat(r[n],10)}function Xl(e,t,n){if(!e.RTCPeerConnection)return;const r=e.RTCPeerConnection.prototype,s=r.addEventListener;r.addEventListener=function(o,l){if(o!==t)return s.apply(this,arguments);const c=d=>{const u=n(d);u&&(l.handleEvent?l.handleEvent(u):l(u))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(l,c),s.apply(this,[o,c])};const i=r.removeEventListener;r.removeEventListener=function(o,l){if(o!==t||!this._eventMap||!this._eventMap[t])return i.apply(this,arguments);if(!this._eventMap[t].has(l))return i.apply(this,arguments);const c=this._eventMap[t].get(l);return this._eventMap[t].delete(l),this._eventMap[t].size===0&&delete this._eventMap[t],Object.keys(this._eventMap).length===0&&delete this._eventMap,i.apply(this,[o,c])},Object.defineProperty(r,"on"+t,{get(){return this["_on"+t]},set(o){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),o&&this.addEventListener(t,this["_on"+t]=o)},enumerable:!0,configurable:!0})}function j7(e){return typeof e!="boolean"?new Error("Argument type: "+typeof e+". Please use a boolean."):($O=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function M7(e){return typeof e!="boolean"?new Error("Argument type: "+typeof e+". Please use a boolean."):(UO=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function VO(){if(typeof window=="object"){if($O)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function B0(e,t){UO&&console.warn(e+" is deprecated, please use "+t+" instead.")}function D7(e){const t={browser:null,version:null};if(typeof e>"u"||!e.navigator||!e.navigator.userAgent)return t.browser="Not a browser.",t;const{navigator:n}=e;if(n.mozGetUserMedia)t.browser="firefox",t.version=parseInt(Ru(n.userAgent,/Firefox\/(\d+)\./,1));else if(n.webkitGetUserMedia||e.isSecureContext===!1&&e.webkitRTCPeerConnection)t.browser="chrome",t.version=parseInt(Ru(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2));else if(e.RTCPeerConnection&&n.userAgent.match(/AppleWebKit\/(\d+)\./))t.browser="safari",t.version=parseInt(Ru(n.userAgent,/AppleWebKit\/(\d+)\./,1)),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype,t._safariVersion=Ru(n.userAgent,/Version\/(\d+(\.?\d+))/,1);else return t.browser="Not a supported browser.",t;return t}function WE(e){return Object.prototype.toString.call(e)==="[object Object]"}function BO(e){return WE(e)?Object.keys(e).reduce(function(t,n){const r=WE(e[n]),s=r?BO(e[n]):e[n],i=r&&!Object.keys(s).length;return s===void 0||i?t:Object.assign(t,{[n]:s})},{}):e}function hw(e,t,n){!t||n.has(t.id)||(n.set(t.id,t),Object.keys(t).forEach(r=>{r.endsWith("Id")?hw(e,e.get(t[r]),n):r.endsWith("Ids")&&t[r].forEach(s=>{hw(e,e.get(s),n)})}))}function HE(e,t,n){const r=n?"outbound-rtp":"inbound-rtp",s=new Map;if(t===null)return s;const i=[];return e.forEach(o=>{o.type==="track"&&o.trackIdentifier===t.id&&i.push(o)}),i.forEach(o=>{e.forEach(l=>{l.type===r&&l.trackId===o.id&&hw(e,l,s)})}),s}const qE=VO;function zO(e,t){const n=e&&e.navigator;if(!n.mediaDevices)return;const r=function(l){if(typeof l!="object"||l.mandatory||l.optional)return l;const c={};return Object.keys(l).forEach(d=>{if(d==="require"||d==="advanced"||d==="mediaSource")return;const u=typeof l[d]=="object"?l[d]:{ideal:l[d]};u.exact!==void 0&&typeof u.exact=="number"&&(u.min=u.max=u.exact);const h=function(f,m){return f?f+m.charAt(0).toUpperCase()+m.slice(1):m==="deviceId"?"sourceId":m};if(u.ideal!==void 0){c.optional=c.optional||[];let f={};typeof u.ideal=="number"?(f[h("min",d)]=u.ideal,c.optional.push(f),f={},f[h("max",d)]=u.ideal,c.optional.push(f)):(f[h("",d)]=u.ideal,c.optional.push(f))}u.exact!==void 0&&typeof u.exact!="number"?(c.mandatory=c.mandatory||{},c.mandatory[h("",d)]=u.exact):["min","max"].forEach(f=>{u[f]!==void 0&&(c.mandatory=c.mandatory||{},c.mandatory[h(f,d)]=u[f])})}),l.advanced&&(c.optional=(c.optional||[]).concat(l.advanced)),c},s=function(l,c){if(t.version>=61)return c(l);if(l=JSON.parse(JSON.stringify(l)),l&&typeof l.audio=="object"){const d=function(u,h,f){h in u&&!(f in u)&&(u[f]=u[h],delete u[h])};l=JSON.parse(JSON.stringify(l)),d(l.audio,"autoGainControl","googAutoGainControl"),d(l.audio,"noiseSuppression","googNoiseSuppression"),l.audio=r(l.audio)}if(l&&typeof l.video=="object"){let d=l.video.facingMode;d=d&&(typeof d=="object"?d:{ideal:d});const u=t.version<66;if(d&&(d.exact==="user"||d.exact==="environment"||d.ideal==="user"||d.ideal==="environment")&&!(n.mediaDevices.getSupportedConstraints&&n.mediaDevices.getSupportedConstraints().facingMode&&!u)){delete l.video.facingMode;let h;if(d.exact==="environment"||d.ideal==="environment"?h=["back","rear"]:(d.exact==="user"||d.ideal==="user")&&(h=["front"]),h)return n.mediaDevices.enumerateDevices().then(f=>{f=f.filter(g=>g.kind==="videoinput");let m=f.find(g=>h.some(v=>g.label.toLowerCase().includes(v)));return!m&&f.length&&h.includes("back")&&(m=f[f.length-1]),m&&(l.video.deviceId=d.exact?{exact:m.deviceId}:{ideal:m.deviceId}),l.video=r(l.video),qE("chrome: "+JSON.stringify(l)),c(l)})}l.video=r(l.video)}return qE("chrome: "+JSON.stringify(l)),c(l)},i=function(l){return t.version>=64?l:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[l.name]||l.name,message:l.message,constraint:l.constraint||l.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},o=function(l,c,d){s(l,u=>{n.webkitGetUserMedia(u,c,h=>{d&&d(i(h))})})};if(n.getUserMedia=o.bind(n),n.mediaDevices.getUserMedia){const l=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(c){return s(c,d=>l(d).then(u=>{if(d.audio&&!u.getAudioTracks().length||d.video&&!u.getVideoTracks().length)throw u.getTracks().forEach(h=>{h.stop()}),new DOMException("","NotFoundError");return u},u=>Promise.reject(i(u))))}}}function O7(e,t){if(!(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices)&&e.navigator.mediaDevices){if(typeof t!="function"){console.error("shimGetDisplayMedia: getSourceId argument is not a function");return}e.navigator.mediaDevices.getDisplayMedia=function(r){return t(r).then(s=>{const i=r.video&&r.video.width,o=r.video&&r.video.height,l=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:s,maxFrameRate:l||3}},i&&(r.video.mandatory.maxWidth=i),o&&(r.video.mandatory.maxHeight=o),e.navigator.mediaDevices.getUserMedia(r)})}}}function GO(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function WO(e){if(typeof e=="object"&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(n){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=n)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=r=>{r.stream.addEventListener("addtrack",s=>{let i;e.RTCPeerConnection.prototype.getReceivers?i=this.getReceivers().find(l=>l.track&&l.track.id===s.track.id):i={track:s.track};const o=new Event("track");o.track=s.track,o.receiver=i,o.transceiver={receiver:i},o.streams=[r.stream],this.dispatchEvent(o)}),r.stream.getTracks().forEach(s=>{let i;e.RTCPeerConnection.prototype.getReceivers?i=this.getReceivers().find(l=>l.track&&l.track.id===s.id):i={track:s};const o=new Event("track");o.track=s,o.receiver=i,o.transceiver={receiver:i},o.streams=[r.stream],this.dispatchEvent(o)})},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else Xl(e,"track",t=>(t.transceiver||Object.defineProperty(t,"transceiver",{value:{receiver:t.receiver}}),t))}function HO(e){if(typeof e=="object"&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(s,i){return{track:i,get dtmf(){return this._dtmf===void 0&&(i.kind==="audio"?this._dtmf=s.createDTMFSender(i):this._dtmf=null),this._dtmf},_pc:s}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const s=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(l,c){let d=s.apply(this,arguments);return d||(d=t(this,l),this._senders.push(d)),d};const i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(l){i.apply(this,arguments);const c=this._senders.indexOf(l);c!==-1&&this._senders.splice(c,1)}}const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(i){this._senders=this._senders||[],n.apply(this,[i]),i.getTracks().forEach(o=>{this._senders.push(t(this,o))})};const r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(i){this._senders=this._senders||[],r.apply(this,[i]),i.getTracks().forEach(o=>{const l=this._senders.find(c=>c.track===o);l&&this._senders.splice(this._senders.indexOf(l),1)})}}else if(typeof e=="object"&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const r=t.apply(this,[]);return r.forEach(s=>s._pc=this),r},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function qO(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[r,s,i]=arguments;if(arguments.length>0&&typeof r=="function")return t.apply(this,arguments);if(t.length===0&&(arguments.length===0||typeof r!="function"))return t.apply(this,[]);const o=function(c){const d={};return c.result().forEach(h=>{const f={id:h.id,timestamp:h.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[h.type]||h.type};h.names().forEach(m=>{f[m]=h.stat(m)}),d[f.id]=f}),d},l=function(c){return new Map(Object.keys(c).map(d=>[d,c[d]]))};if(arguments.length>=2){const c=function(d){s(l(o(d)))};return t.apply(this,[c,r])}return new Promise((c,d)=>{t.apply(this,[function(u){c(l(o(u)))},d])}).then(s,i)}}function KO(e){if(!(typeof e=="object"&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const n=e.RTCPeerConnection.prototype.getSenders;n&&(e.RTCPeerConnection.prototype.getSenders=function(){const i=n.apply(this,[]);return i.forEach(o=>o._pc=this),i});const r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){const i=r.apply(this,arguments);return i._pc=this,i}),e.RTCRtpSender.prototype.getStats=function(){const i=this;return this._pc.getStats().then(o=>HE(o,i.track,!0))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const n=e.RTCPeerConnection.prototype.getReceivers;n&&(e.RTCPeerConnection.prototype.getReceivers=function(){const s=n.apply(this,[]);return s.forEach(i=>i._pc=this),s}),Xl(e,"track",r=>(r.receiver._pc=r.srcElement,r)),e.RTCRtpReceiver.prototype.getStats=function(){const s=this;return this._pc.getStats().then(i=>HE(i,s.track,!1))}}if(!("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const r=arguments[0];let s,i,o;return this.getSenders().forEach(l=>{l.track===r&&(s?o=!0:s=l)}),this.getReceivers().forEach(l=>(l.track===r&&(i?o=!0:i=l),l.track===r)),o||s&&i?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):s?s.getStats():i?i.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function QO(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(o=>this._shimmedLocalStreams[o][0])};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(o,l){if(!l)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const c=t.apply(this,arguments);return this._shimmedLocalStreams[l.id]?this._shimmedLocalStreams[l.id].indexOf(c)===-1&&this._shimmedLocalStreams[l.id].push(c):this._shimmedLocalStreams[l.id]=[l,c],c};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(o){this._shimmedLocalStreams=this._shimmedLocalStreams||{},o.getTracks().forEach(d=>{if(this.getSenders().find(h=>h.track===d))throw new DOMException("Track already exists.","InvalidAccessError")});const l=this.getSenders();n.apply(this,arguments);const c=this.getSenders().filter(d=>l.indexOf(d)===-1);this._shimmedLocalStreams[o.id]=[o].concat(c)};const r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(o){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[o.id],r.apply(this,arguments)};const s=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(o){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},o&&Object.keys(this._shimmedLocalStreams).forEach(l=>{const c=this._shimmedLocalStreams[l].indexOf(o);c!==-1&&this._shimmedLocalStreams[l].splice(c,1),this._shimmedLocalStreams[l].length===1&&delete this._shimmedLocalStreams[l]}),s.apply(this,arguments)}}function JO(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return QO(e);const n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const u=n.apply(this);return this._reverseStreams=this._reverseStreams||{},u.map(h=>this._reverseStreams[h.id])};const r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(u){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},u.getTracks().forEach(h=>{if(this.getSenders().find(m=>m.track===h))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[u.id]){const h=new e.MediaStream(u.getTracks());this._streams[u.id]=h,this._reverseStreams[h.id]=u,u=h}r.apply(this,[u])};const s=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(u){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},s.apply(this,[this._streams[u.id]||u]),delete this._reverseStreams[this._streams[u.id]?this._streams[u.id].id:u.id],delete this._streams[u.id]},e.RTCPeerConnection.prototype.addTrack=function(u,h){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const f=[].slice.call(arguments,1);if(f.length!==1||!f[0].getTracks().find(v=>v===u))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(v=>v.track===u))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const g=this._streams[h.id];if(g)g.addTrack(u),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const v=new e.MediaStream([u]);this._streams[h.id]=v,this._reverseStreams[v.id]=h,this.addStream(v)}return this.getSenders().find(v=>v.track===u)};function i(d,u){let h=u.sdp;return Object.keys(d._reverseStreams||[]).forEach(f=>{const m=d._reverseStreams[f],g=d._streams[m.id];h=h.replace(new RegExp(g.id,"g"),m.id)}),new RTCSessionDescription({type:u.type,sdp:h})}function o(d,u){let h=u.sdp;return Object.keys(d._reverseStreams||[]).forEach(f=>{const m=d._reverseStreams[f],g=d._streams[m.id];h=h.replace(new RegExp(m.id,"g"),g.id)}),new RTCSessionDescription({type:u.type,sdp:h})}["createOffer","createAnswer"].forEach(function(d){const u=e.RTCPeerConnection.prototype[d],h={[d](){const f=arguments;return arguments.length&&typeof arguments[0]=="function"?u.apply(this,[g=>{const v=i(this,g);f[0].apply(null,[v])},g=>{f[1]&&f[1].apply(null,g)},arguments[2]]):u.apply(this,arguments).then(g=>i(this,g))}};e.RTCPeerConnection.prototype[d]=h[d]});const l=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?l.apply(this,arguments):(arguments[0]=o(this,arguments[0]),l.apply(this,arguments))};const c=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const d=c.get.apply(this);return d.type===""?d:i(this,d)}}),e.RTCPeerConnection.prototype.removeTrack=function(u){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!u._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(u._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let f;Object.keys(this._streams).forEach(m=>{this._streams[m].getTracks().find(v=>u.track===v)&&(f=this._streams[m])}),f&&(f.getTracks().length===1?this.removeStream(this._reverseStreams[f.id]):f.removeTrack(u.track),this.dispatchEvent(new Event("negotiationneeded")))}}function fw(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const r=e.RTCPeerConnection.prototype[n],s={[n](){return arguments[0]=new(n==="addIceCandidate"?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};e.RTCPeerConnection.prototype[n]=s[n]})}function YO(e,t){Xl(e,"negotiationneeded",n=>{const r=n.target;if(!((t.version<72||r.getConfiguration&&r.getConfiguration().sdpSemantics==="plan-b")&&r.signalingState!=="stable"))return n})}const KE=Object.freeze(Object.defineProperty({__proto__:null,fixNegotiationNeeded:YO,shimAddTrackRemoveTrack:JO,shimAddTrackRemoveTrackWithNative:QO,shimGetDisplayMedia:O7,shimGetSendersWithDtmf:HO,shimGetStats:qO,shimGetUserMedia:zO,shimMediaStream:GO,shimOnTrack:WO,shimPeerConnection:fw,shimSenderReceiverGetStats:KO},Symbol.toStringTag,{value:"Module"}));function XO(e,t){const n=e&&e.navigator,r=e&&e.MediaStreamTrack;if(n.getUserMedia=function(s,i,o){B0("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(s).then(i,o)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const s=function(o,l,c){l in o&&!(c in o)&&(o[c]=o[l],delete o[l])},i=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(o){return typeof o=="object"&&typeof o.audio=="object"&&(o=JSON.parse(JSON.stringify(o)),s(o.audio,"autoGainControl","mozAutoGainControl"),s(o.audio,"noiseSuppression","mozNoiseSuppression")),i(o)},r&&r.prototype.getSettings){const o=r.prototype.getSettings;r.prototype.getSettings=function(){const l=o.apply(this,arguments);return s(l,"mozAutoGainControl","autoGainControl"),s(l,"mozNoiseSuppression","noiseSuppression"),l}}if(r&&r.prototype.applyConstraints){const o=r.prototype.applyConstraints;r.prototype.applyConstraints=function(l){return this.kind==="audio"&&typeof l=="object"&&(l=JSON.parse(JSON.stringify(l)),s(l,"autoGainControl","mozAutoGainControl"),s(l,"noiseSuppression","mozNoiseSuppression")),o.apply(this,[l])}}}}function L7(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(r){if(!(r&&r.video)){const s=new DOMException("getDisplayMedia without video constraints is undefined");return s.name="NotFoundError",s.code=8,Promise.reject(s)}return r.video===!0?r.video={mediaSource:t}:r.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(r)})}function ZO(e){typeof e=="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function pw(e,t){if(typeof e!="object"||!(e.RTCPeerConnection||e.mozRTCPeerConnection))return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(s){const i=e.RTCPeerConnection.prototype[s],o={[s](){return arguments[0]=new(s==="addIceCandidate"?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),i.apply(this,arguments)}};e.RTCPeerConnection.prototype[s]=o[s]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[i,o,l]=arguments;return r.apply(this,[i||null]).then(c=>{if(t.version<53&&!o)try{c.forEach(d=>{d.type=n[d.type]||d.type})}catch(d){if(d.name!=="TypeError")throw d;c.forEach((u,h)=>{c.set(h,Object.assign({},u,{type:n[u.type]||u.type}))})}return c}).then(o,l)}}function eL(e){if(!(typeof e=="object"&&e.RTCPeerConnection&&e.RTCRtpSender)||e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const s=t.apply(this,[]);return s.forEach(i=>i._pc=this),s});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const s=n.apply(this,arguments);return s._pc=this,s}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function tL(e){if(!(typeof e=="object"&&e.RTCPeerConnection&&e.RTCRtpSender)||e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const r=t.apply(this,[]);return r.forEach(s=>s._pc=this),r}),Xl(e,"track",n=>(n.receiver._pc=n.srcElement,n)),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function nL(e){!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(n){B0("removeStream","removeTrack"),this.getSenders().forEach(r=>{r.track&&n.getTracks().includes(r.track)&&this.removeTrack(r)})})}function rL(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function sL(e){if(!(typeof e=="object"&&e.RTCPeerConnection))return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let r=arguments[1]&&arguments[1].sendEncodings;r===void 0&&(r=[]),r=[...r];const s=r.length>0;s&&r.forEach(o=>{if("rid"in o&&!/^[a-z0-9]{0,16}$/i.test(o.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in o&&!(parseFloat(o.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in o&&!(parseFloat(o.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const i=t.apply(this,arguments);if(s){const{sender:o}=i,l=o.getParameters();(!("encodings"in l)||l.encodings.length===1&&Object.keys(l.encodings[0]).length===0)&&(l.encodings=r,o.sendEncodings=r,this.setParametersPromises.push(o.setParameters(l).then(()=>{delete o.sendEncodings}).catch(()=>{delete o.sendEncodings})))}return i})}function iL(e){if(!(typeof e=="object"&&e.RTCRtpSender))return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const r=t.apply(this,arguments);return"encodings"in r||(r.encodings=[].concat(this.sendEncodings||[{}])),r})}function aL(e){if(!(typeof e=="object"&&e.RTCPeerConnection))return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}function oL(e){if(!(typeof e=="object"&&e.RTCPeerConnection))return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}const QE=Object.freeze(Object.defineProperty({__proto__:null,shimAddTransceiver:sL,shimCreateAnswer:oL,shimCreateOffer:aL,shimGetDisplayMedia:L7,shimGetParameters:iL,shimGetUserMedia:XO,shimOnTrack:ZO,shimPeerConnection:pw,shimRTCDataChannel:rL,shimReceiverGetStats:tL,shimRemoveStream:nL,shimSenderGetStats:eL},Symbol.toStringTag,{value:"Module"}));function lL(e){if(!(typeof e!="object"||!e.RTCPeerConnection)){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(r){this._localStreams||(this._localStreams=[]),this._localStreams.includes(r)||this._localStreams.push(r),r.getAudioTracks().forEach(s=>t.call(this,s,r)),r.getVideoTracks().forEach(s=>t.call(this,s,r))},e.RTCPeerConnection.prototype.addTrack=function(r,...s){return s&&s.forEach(i=>{this._localStreams?this._localStreams.includes(i)||this._localStreams.push(i):this._localStreams=[i]}),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(n){this._localStreams||(this._localStreams=[]);const r=this._localStreams.indexOf(n);if(r===-1)return;this._localStreams.splice(r,1);const s=n.getTracks();this.getSenders().forEach(i=>{s.includes(i.track)&&this.removeTrack(i)})})}}function cL(e){if(!(typeof e!="object"||!e.RTCPeerConnection)&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(n){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=n),this.addEventListener("track",this._onaddstreampoly=r=>{r.streams.forEach(s=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(s))return;this._remoteStreams.push(s);const i=new Event("addstream");i.stream=s,this.dispatchEvent(i)})})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(s){s.streams.forEach(i=>{if(r._remoteStreams||(r._remoteStreams=[]),r._remoteStreams.indexOf(i)>=0)return;r._remoteStreams.push(i);const o=new Event("addstream");o.stream=i,r.dispatchEvent(o)})}),t.apply(r,arguments)}}}function dL(e){if(typeof e!="object"||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,n=t.createOffer,r=t.createAnswer,s=t.setLocalDescription,i=t.setRemoteDescription,o=t.addIceCandidate;t.createOffer=function(d,u){const h=arguments.length>=2?arguments[2]:arguments[0],f=n.apply(this,[h]);return u?(f.then(d,u),Promise.resolve()):f},t.createAnswer=function(d,u){const h=arguments.length>=2?arguments[2]:arguments[0],f=r.apply(this,[h]);return u?(f.then(d,u),Promise.resolve()):f};let l=function(c,d,u){const h=s.apply(this,[c]);return u?(h.then(d,u),Promise.resolve()):h};t.setLocalDescription=l,l=function(c,d,u){const h=i.apply(this,[c]);return u?(h.then(d,u),Promise.resolve()):h},t.setRemoteDescription=l,l=function(c,d,u){const h=o.apply(this,[c]);return u?(h.then(d,u),Promise.resolve()):h},t.addIceCandidate=l}function uL(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const n=t.mediaDevices,r=n.getUserMedia.bind(n);t.mediaDevices.getUserMedia=s=>r(hL(s))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=(function(r,s,i){t.mediaDevices.getUserMedia(r).then(s,i)}).bind(t))}function hL(e){return e&&e.video!==void 0?Object.assign({},e,{video:BO(e.video)}):e}function fL(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(r,s){if(r&&r.iceServers){const i=[];for(let o=0;o<r.iceServers.length;o++){let l=r.iceServers[o];l.urls===void 0&&l.url?(B0("RTCIceServer.url","RTCIceServer.urls"),l=JSON.parse(JSON.stringify(l)),l.urls=l.url,delete l.url,i.push(l)):i.push(r.iceServers[o])}r.iceServers=i}return new t(r,s)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get(){return t.generateCertificate}})}function pL(e){typeof e=="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function mL(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(r){if(r){typeof r.offerToReceiveAudio<"u"&&(r.offerToReceiveAudio=!!r.offerToReceiveAudio);const s=this.getTransceivers().find(o=>o.receiver.track.kind==="audio");r.offerToReceiveAudio===!1&&s?s.direction==="sendrecv"?s.setDirection?s.setDirection("sendonly"):s.direction="sendonly":s.direction==="recvonly"&&(s.setDirection?s.setDirection("inactive"):s.direction="inactive"):r.offerToReceiveAudio===!0&&!s&&this.addTransceiver("audio",{direction:"recvonly"}),typeof r.offerToReceiveVideo<"u"&&(r.offerToReceiveVideo=!!r.offerToReceiveVideo);const i=this.getTransceivers().find(o=>o.receiver.track.kind==="video");r.offerToReceiveVideo===!1&&i?i.direction==="sendrecv"?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":i.direction==="recvonly"&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):r.offerToReceiveVideo===!0&&!i&&this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function gL(e){typeof e!="object"||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}const JE=Object.freeze(Object.defineProperty({__proto__:null,shimAudioContext:gL,shimCallbacksAPI:dL,shimConstraints:hL,shimCreateOfferLegacy:mL,shimGetUserMedia:uL,shimLocalStreamsAPI:lL,shimRTCIceServerUrls:fL,shimRemoteStreamsAPI:cL,shimTrackEventTransceiver:pL},Symbol.toStringTag,{value:"Module"}));var vL={exports:{}};(function(e){const t={};t.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},t.localCName=t.generateIdentifier(),t.splitLines=function(n){return n.trim().split(`
`).map(r=>r.trim())},t.splitSections=function(n){return n.split(`
m=`).map((s,i)=>(i>0?"m="+s:s).trim()+`\r
`)},t.getDescription=function(n){const r=t.splitSections(n);return r&&r[0]},t.getMediaSections=function(n){const r=t.splitSections(n);return r.shift(),r},t.matchPrefix=function(n,r){return t.splitLines(n).filter(s=>s.indexOf(r)===0)},t.parseCandidate=function(n){let r;n.indexOf("a=candidate:")===0?r=n.substring(12).split(" "):r=n.substring(10).split(" ");const s={foundation:r[0],component:{1:"rtp",2:"rtcp"}[r[1]]||r[1],protocol:r[2].toLowerCase(),priority:parseInt(r[3],10),ip:r[4],address:r[4],port:parseInt(r[5],10),type:r[7]};for(let i=8;i<r.length;i+=2)switch(r[i]){case"raddr":s.relatedAddress=r[i+1];break;case"rport":s.relatedPort=parseInt(r[i+1],10);break;case"tcptype":s.tcpType=r[i+1];break;case"ufrag":s.ufrag=r[i+1],s.usernameFragment=r[i+1];break;default:s[r[i]]===void 0&&(s[r[i]]=r[i+1]);break}return s},t.writeCandidate=function(n){const r=[];r.push(n.foundation);const s=n.component;s==="rtp"?r.push(1):s==="rtcp"?r.push(2):r.push(s),r.push(n.protocol.toUpperCase()),r.push(n.priority),r.push(n.address||n.ip),r.push(n.port);const i=n.type;return r.push("typ"),r.push(i),i!=="host"&&n.relatedAddress&&n.relatedPort&&(r.push("raddr"),r.push(n.relatedAddress),r.push("rport"),r.push(n.relatedPort)),n.tcpType&&n.protocol.toLowerCase()==="tcp"&&(r.push("tcptype"),r.push(n.tcpType)),(n.usernameFragment||n.ufrag)&&(r.push("ufrag"),r.push(n.usernameFragment||n.ufrag)),"candidate:"+r.join(" ")},t.parseIceOptions=function(n){return n.substring(14).split(" ")},t.parseRtpMap=function(n){let r=n.substring(9).split(" ");const s={payloadType:parseInt(r.shift(),10)};return r=r[0].split("/"),s.name=r[0],s.clockRate=parseInt(r[1],10),s.channels=r.length===3?parseInt(r[2],10):1,s.numChannels=s.channels,s},t.writeRtpMap=function(n){let r=n.payloadType;n.preferredPayloadType!==void 0&&(r=n.preferredPayloadType);const s=n.channels||n.numChannels||1;return"a=rtpmap:"+r+" "+n.name+"/"+n.clockRate+(s!==1?"/"+s:"")+`\r
`},t.parseExtmap=function(n){const r=n.substring(9).split(" ");return{id:parseInt(r[0],10),direction:r[0].indexOf("/")>0?r[0].split("/")[1]:"sendrecv",uri:r[1],attributes:r.slice(2).join(" ")}},t.writeExtmap=function(n){return"a=extmap:"+(n.id||n.preferredId)+(n.direction&&n.direction!=="sendrecv"?"/"+n.direction:"")+" "+n.uri+(n.attributes?" "+n.attributes:"")+`\r
`},t.parseFmtp=function(n){const r={};let s;const i=n.substring(n.indexOf(" ")+1).split(";");for(let o=0;o<i.length;o++)s=i[o].trim().split("="),r[s[0].trim()]=s[1];return r},t.writeFmtp=function(n){let r="",s=n.payloadType;if(n.preferredPayloadType!==void 0&&(s=n.preferredPayloadType),n.parameters&&Object.keys(n.parameters).length){const i=[];Object.keys(n.parameters).forEach(o=>{n.parameters[o]!==void 0?i.push(o+"="+n.parameters[o]):i.push(o)}),r+="a=fmtp:"+s+" "+i.join(";")+`\r
`}return r},t.parseRtcpFb=function(n){const r=n.substring(n.indexOf(" ")+1).split(" ");return{type:r.shift(),parameter:r.join(" ")}},t.writeRtcpFb=function(n){let r="",s=n.payloadType;return n.preferredPayloadType!==void 0&&(s=n.preferredPayloadType),n.rtcpFeedback&&n.rtcpFeedback.length&&n.rtcpFeedback.forEach(i=>{r+="a=rtcp-fb:"+s+" "+i.type+(i.parameter&&i.parameter.length?" "+i.parameter:"")+`\r
`}),r},t.parseSsrcMedia=function(n){const r=n.indexOf(" "),s={ssrc:parseInt(n.substring(7,r),10)},i=n.indexOf(":",r);return i>-1?(s.attribute=n.substring(r+1,i),s.value=n.substring(i+1)):s.attribute=n.substring(r+1),s},t.parseSsrcGroup=function(n){const r=n.substring(13).split(" ");return{semantics:r.shift(),ssrcs:r.map(s=>parseInt(s,10))}},t.getMid=function(n){const r=t.matchPrefix(n,"a=mid:")[0];if(r)return r.substring(6)},t.parseFingerprint=function(n){const r=n.substring(14).split(" ");return{algorithm:r[0].toLowerCase(),value:r[1].toUpperCase()}},t.getDtlsParameters=function(n,r){return{role:"auto",fingerprints:t.matchPrefix(n+r,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(n,r){let s="a=setup:"+r+`\r
`;return n.fingerprints.forEach(i=>{s+="a=fingerprint:"+i.algorithm+" "+i.value+`\r
`}),s},t.parseCryptoLine=function(n){const r=n.substring(9).split(" ");return{tag:parseInt(r[0],10),cryptoSuite:r[1],keyParams:r[2],sessionParams:r.slice(3)}},t.writeCryptoLine=function(n){return"a=crypto:"+n.tag+" "+n.cryptoSuite+" "+(typeof n.keyParams=="object"?t.writeCryptoKeyParams(n.keyParams):n.keyParams)+(n.sessionParams?" "+n.sessionParams.join(" "):"")+`\r
`},t.parseCryptoKeyParams=function(n){if(n.indexOf("inline:")!==0)return null;const r=n.substring(7).split("|");return{keyMethod:"inline",keySalt:r[0],lifeTime:r[1],mkiValue:r[2]?r[2].split(":")[0]:void 0,mkiLength:r[2]?r[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(n){return n.keyMethod+":"+n.keySalt+(n.lifeTime?"|"+n.lifeTime:"")+(n.mkiValue&&n.mkiLength?"|"+n.mkiValue+":"+n.mkiLength:"")},t.getCryptoParameters=function(n,r){return t.matchPrefix(n+r,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(n,r){const s=t.matchPrefix(n+r,"a=ice-ufrag:")[0],i=t.matchPrefix(n+r,"a=ice-pwd:")[0];return s&&i?{usernameFragment:s.substring(12),password:i.substring(10)}:null},t.writeIceParameters=function(n){let r="a=ice-ufrag:"+n.usernameFragment+`\r
a=ice-pwd:`+n.password+`\r
`;return n.iceLite&&(r+=`a=ice-lite\r
`),r},t.parseRtpParameters=function(n){const r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},i=t.splitLines(n)[0].split(" ");r.profile=i[2];for(let l=3;l<i.length;l++){const c=i[l],d=t.matchPrefix(n,"a=rtpmap:"+c+" ")[0];if(d){const u=t.parseRtpMap(d),h=t.matchPrefix(n,"a=fmtp:"+c+" ");switch(u.parameters=h.length?t.parseFmtp(h[0]):{},u.rtcpFeedback=t.matchPrefix(n,"a=rtcp-fb:"+c+" ").map(t.parseRtcpFb),r.codecs.push(u),u.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(u.name.toUpperCase());break}}}t.matchPrefix(n,"a=extmap:").forEach(l=>{r.headerExtensions.push(t.parseExtmap(l))});const o=t.matchPrefix(n,"a=rtcp-fb:* ").map(t.parseRtcpFb);return r.codecs.forEach(l=>{o.forEach(c=>{l.rtcpFeedback.find(u=>u.type===c.type&&u.parameter===c.parameter)||l.rtcpFeedback.push(c)})}),r},t.writeRtpDescription=function(n,r){let s="";s+="m="+n+" ",s+=r.codecs.length>0?"9":"0",s+=" "+(r.profile||"UDP/TLS/RTP/SAVPF")+" ",s+=r.codecs.map(o=>o.preferredPayloadType!==void 0?o.preferredPayloadType:o.payloadType).join(" ")+`\r
`,s+=`c=IN IP4 0.0.0.0\r
`,s+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,r.codecs.forEach(o=>{s+=t.writeRtpMap(o),s+=t.writeFmtp(o),s+=t.writeRtcpFb(o)});let i=0;return r.codecs.forEach(o=>{o.maxptime>i&&(i=o.maxptime)}),i>0&&(s+="a=maxptime:"+i+`\r
`),r.headerExtensions&&r.headerExtensions.forEach(o=>{s+=t.writeExtmap(o)}),s},t.parseRtpEncodingParameters=function(n){const r=[],s=t.parseRtpParameters(n),i=s.fecMechanisms.indexOf("RED")!==-1,o=s.fecMechanisms.indexOf("ULPFEC")!==-1,l=t.matchPrefix(n,"a=ssrc:").map(f=>t.parseSsrcMedia(f)).filter(f=>f.attribute==="cname"),c=l.length>0&&l[0].ssrc;let d;const u=t.matchPrefix(n,"a=ssrc-group:FID").map(f=>f.substring(17).split(" ").map(g=>parseInt(g,10)));u.length>0&&u[0].length>1&&u[0][0]===c&&(d=u[0][1]),s.codecs.forEach(f=>{if(f.name.toUpperCase()==="RTX"&&f.parameters.apt){let m={ssrc:c,codecPayloadType:parseInt(f.parameters.apt,10)};c&&d&&(m.rtx={ssrc:d}),r.push(m),i&&(m=JSON.parse(JSON.stringify(m)),m.fec={ssrc:c,mechanism:o?"red+ulpfec":"red"},r.push(m))}}),r.length===0&&c&&r.push({ssrc:c});let h=t.matchPrefix(n,"b=");return h.length&&(h[0].indexOf("b=TIAS:")===0?h=parseInt(h[0].substring(7),10):h[0].indexOf("b=AS:")===0?h=parseInt(h[0].substring(5),10)*1e3*.95-50*40*8:h=void 0,r.forEach(f=>{f.maxBitrate=h})),r},t.parseRtcpParameters=function(n){const r={},s=t.matchPrefix(n,"a=ssrc:").map(l=>t.parseSsrcMedia(l)).filter(l=>l.attribute==="cname")[0];s&&(r.cname=s.value,r.ssrc=s.ssrc);const i=t.matchPrefix(n,"a=rtcp-rsize");r.reducedSize=i.length>0,r.compound=i.length===0;const o=t.matchPrefix(n,"a=rtcp-mux");return r.mux=o.length>0,r},t.writeRtcpParameters=function(n){let r="";return n.reducedSize&&(r+=`a=rtcp-rsize\r
`),n.mux&&(r+=`a=rtcp-mux\r
`),n.ssrc!==void 0&&n.cname&&(r+="a=ssrc:"+n.ssrc+" cname:"+n.cname+`\r
`),r},t.parseMsid=function(n){let r;const s=t.matchPrefix(n,"a=msid:");if(s.length===1)return r=s[0].substring(7).split(" "),{stream:r[0],track:r[1]};const i=t.matchPrefix(n,"a=ssrc:").map(o=>t.parseSsrcMedia(o)).filter(o=>o.attribute==="msid");if(i.length>0)return r=i[0].value.split(" "),{stream:r[0],track:r[1]}},t.parseSctpDescription=function(n){const r=t.parseMLine(n),s=t.matchPrefix(n,"a=max-message-size:");let i;s.length>0&&(i=parseInt(s[0].substring(19),10)),isNaN(i)&&(i=65536);const o=t.matchPrefix(n,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substring(12),10),protocol:r.fmt,maxMessageSize:i};const l=t.matchPrefix(n,"a=sctpmap:");if(l.length>0){const c=l[0].substring(10).split(" ");return{port:parseInt(c[0],10),protocol:c[1],maxMessageSize:i}}},t.writeSctpDescription=function(n,r){let s=[];return n.protocol!=="DTLS/SCTP"?s=["m="+n.kind+" 9 "+n.protocol+" "+r.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+r.port+`\r
`]:s=["m="+n.kind+" 9 "+n.protocol+" "+r.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+r.port+" "+r.protocol+` 65535\r
`],r.maxMessageSize!==void 0&&s.push("a=max-message-size:"+r.maxMessageSize+`\r
`),s.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,22)},t.writeSessionBoilerplate=function(n,r,s){let i;const o=r!==void 0?r:2;return n?i=n:i=t.generateSessionId(),`v=0\r
o=`+(s||"thisisadapterortc")+" "+i+" "+o+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},t.getDirection=function(n,r){const s=t.splitLines(n);for(let i=0;i<s.length;i++)switch(s[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return s[i].substring(2)}return r?t.getDirection(r):"sendrecv"},t.getKind=function(n){return t.splitLines(n)[0].split(" ")[0].substring(2)},t.isRejected=function(n){return n.split(" ",2)[1]==="0"},t.parseMLine=function(n){const s=t.splitLines(n)[0].substring(2).split(" ");return{kind:s[0],port:parseInt(s[1],10),protocol:s[2],fmt:s.slice(3).join(" ")}},t.parseOLine=function(n){const s=t.matchPrefix(n,"o=")[0].substring(2).split(" ");return{username:s[0],sessionId:s[1],sessionVersion:parseInt(s[2],10),netType:s[3],addressType:s[4],address:s[5]}},t.isValidSDP=function(n){if(typeof n!="string"||n.length===0)return!1;const r=t.splitLines(n);for(let s=0;s<r.length;s++)if(r[s].length<2||r[s].charAt(1)!=="=")return!1;return!0},e.exports=t})(vL);var yL=vL.exports;const $c=of(yL),F7=ER({__proto__:null,default:$c},[yL]);function Xp(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(r){if(typeof r=="object"&&r.candidate&&r.candidate.indexOf("a=")===0&&(r=JSON.parse(JSON.stringify(r)),r.candidate=r.candidate.substring(2)),r.candidate&&r.candidate.length){const s=new t(r),i=$c.parseCandidate(r.candidate);for(const o in i)o in s||Object.defineProperty(s,o,{value:i[o]});return s.toJSON=function(){return{candidate:s.candidate,sdpMid:s.sdpMid,sdpMLineIndex:s.sdpMLineIndex,usernameFragment:s.usernameFragment}},s}return new t(r)},e.RTCIceCandidate.prototype=t.prototype,Xl(e,"icecandidate",n=>(n.candidate&&Object.defineProperty(n,"candidate",{value:new e.RTCIceCandidate(n.candidate),writable:"false"}),n))}function mw(e){!e.RTCIceCandidate||e.RTCIceCandidate&&"relayProtocol"in e.RTCIceCandidate.prototype||Xl(e,"icecandidate",t=>{if(t.candidate){const n=$c.parseCandidate(t.candidate.candidate);n.type==="relay"&&(t.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[n.priority>>24])}return t})}function Zp(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const n=function(l){if(!l||!l.sdp)return!1;const c=$c.splitSections(l.sdp);return c.shift(),c.some(d=>{const u=$c.parseMLine(d);return u&&u.kind==="application"&&u.protocol.indexOf("SCTP")!==-1})},r=function(l){const c=l.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(c===null||c.length<2)return-1;const d=parseInt(c[1],10);return d!==d?-1:d},s=function(l){let c=65536;return t.browser==="firefox"&&(t.version<57?l===-1?c=16384:c=2147483637:t.version<60?c=t.version===57?65535:65536:c=2147483637),c},i=function(l,c){let d=65536;t.browser==="firefox"&&t.version===57&&(d=65535);const u=$c.matchPrefix(l.sdp,"a=max-message-size:");return u.length>0?d=parseInt(u[0].substring(19),10):t.browser==="firefox"&&c!==-1&&(d=2147483637),d},o=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,t.browser==="chrome"&&t.version>=76){const{sdpSemantics:c}=this.getConfiguration();c==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const c=r(arguments[0]),d=s(c),u=i(arguments[0],c);let h;d===0&&u===0?h=Number.POSITIVE_INFINITY:d===0||u===0?h=Math.max(d,u):h=Math.min(d,u);const f={};Object.defineProperty(f,"maxMessageSize",{get(){return h}}),this._sctp=f}return o.apply(this,arguments)}}function em(e){if(!(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype))return;function t(r,s){const i=r.send;r.send=function(){const l=arguments[0],c=l.length||l.size||l.byteLength;if(r.readyState==="open"&&s.sctp&&c>s.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+s.sctp.maxMessageSize+" bytes)");return i.apply(r,arguments)}}const n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const s=n.apply(this,arguments);return t(s,this),s},Xl(e,"datachannel",r=>(t(r.channel,r.target),r))}function gw(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(n){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),n&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=n)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(n=>{const r=t[n];t[n]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=s=>{const i=s.target;if(i._lastConnectionState!==i.connectionState){i._lastConnectionState=i.connectionState;const o=new Event("connectionstatechange",s);i.dispatchEvent(o)}return s},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}})}function vw(e,t){if(!e.RTCPeerConnection||t.browser==="chrome"&&t.version>=71||t.browser==="safari"&&t._safariVersion>=13.1)return;const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(s){if(s&&s.sdp&&s.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const i=s.sdp.split(`
`).filter(o=>o.trim()!=="a=extmap-allow-mixed").join(`
`);e.RTCSessionDescription&&s instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:s.type,sdp:i}):s.sdp=i}return n.apply(this,arguments)}}function tm(e,t){if(!(e.RTCPeerConnection&&e.RTCPeerConnection.prototype))return;const n=e.RTCPeerConnection.prototype.addIceCandidate;!n||n.length===0||(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(t.browser==="chrome"&&t.version<78||t.browser==="firefox"&&t.version<68||t.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function nm(e,t){if(!(e.RTCPeerConnection&&e.RTCPeerConnection.prototype))return;const n=e.RTCPeerConnection.prototype.setLocalDescription;!n||n.length===0||(e.RTCPeerConnection.prototype.setLocalDescription=function(){let s=arguments[0]||{};if(typeof s!="object"||s.type&&s.sdp)return n.apply(this,arguments);if(s={type:s.type,sdp:s.sdp},!s.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":s.type="offer";break;default:s.type="answer";break}return s.sdp||s.type!=="offer"&&s.type!=="answer"?n.apply(this,[s]):(s.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(o=>n.apply(this,[o]))})}const $7=Object.freeze(Object.defineProperty({__proto__:null,removeExtmapAllowMixed:vw,shimAddIceCandidateNullOrEmpty:tm,shimConnectionState:gw,shimMaxMessageSize:Zp,shimParameterlessSetLocalDescription:nm,shimRTCIceCandidate:Xp,shimRTCIceCandidateRelayProtocol:mw,shimSendThrowTypeError:em},Symbol.toStringTag,{value:"Module"}));function U7({window:e}={},t={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const n=VO,r=D7(e),s={browserDetails:r,commonShim:$7,extractVersion:Ru,disableLog:j7,disableWarnings:M7,sdp:F7};switch(r.browser){case"chrome":if(!KE||!fw||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),s;if(r.version===null)return n("Chrome shim can not determine version, not shimming."),s;n("adapter.js shimming chrome."),s.browserShim=KE,tm(e,r),nm(e),zO(e,r),GO(e),fw(e,r),WO(e),JO(e,r),HO(e),qO(e),KO(e),YO(e,r),Xp(e),mw(e),gw(e),Zp(e,r),em(e),vw(e,r);break;case"firefox":if(!QE||!pw||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),s;n("adapter.js shimming firefox."),s.browserShim=QE,tm(e,r),nm(e),XO(e,r),pw(e,r),ZO(e),nL(e),eL(e),tL(e),rL(e),sL(e),iL(e),aL(e),oL(e),Xp(e),gw(e),Zp(e,r),em(e);break;case"safari":if(!JE||!t.shimSafari)return n("Safari shim is not included in this adapter release."),s;n("adapter.js shimming safari."),s.browserShim=JE,tm(e,r),nm(e),fL(e),mL(e),dL(e),lL(e),cL(e),pL(e),uL(e),gL(e),Xp(e),mw(e),Zp(e,r),em(e),vw(e,r);break;default:n("Unsupported browser!");break}return s}const YE=U7({window:typeof window>"u"?void 0:window});var xL={exports:{}};/*!
 * EventEmitter2
 * https://github.com/hij1nx/EventEmitter2
 *
 * Copyright (c) 2013 hij1nx
 * Licensed under the MIT license.
 */(function(e,t){(function(n){var r=Object.hasOwnProperty,s=Array.isArray?Array.isArray:function(E){return Object.prototype.toString.call(E)==="[object Array]"},i=10,o=typeof process=="object"&&typeof process.nextTick=="function",l=typeof Symbol=="function",c=typeof Reflect=="object",d=typeof setImmediate=="function",u=d?setImmediate:setTimeout,h=l?c&&typeof Reflect.ownKeys=="function"?Reflect.ownKeys:function(k){var E=Object.getOwnPropertyNames(k);return E.push.apply(E,Object.getOwnPropertySymbols(k)),E}:Object.keys;function f(){this._events={},this._conf&&m.call(this,this._conf)}function m(k){k&&(this._conf=k,k.delimiter&&(this.delimiter=k.delimiter),k.maxListeners!==n&&(this._maxListeners=k.maxListeners),k.wildcard&&(this.wildcard=k.wildcard),k.newListener&&(this._newListener=k.newListener),k.removeListener&&(this._removeListener=k.removeListener),k.verboseMemoryLeak&&(this.verboseMemoryLeak=k.verboseMemoryLeak),k.ignoreErrors&&(this.ignoreErrors=k.ignoreErrors),this.wildcard&&(this.listenerTree={}))}function g(k,E){var M="(node) warning: possible EventEmitter memory leak detected. "+k+" listeners added. Use emitter.setMaxListeners() to increase limit.";if(this.verboseMemoryLeak&&(M+=" Event name: "+E+"."),typeof process<"u"&&process.emitWarning){var A=new Error(M);A.name="MaxListenersExceededWarning",A.emitter=this,A.count=k,process.emitWarning(A)}else console.error(M),console.trace&&console.trace()}var v=function(k,E,M){var A=arguments.length;switch(A){case 0:return[];case 1:return[k];case 2:return[k,E];case 3:return[k,E,M];default:for(var F=new Array(A);A--;)F[A]=arguments[A];return F}};function x(k,E){for(var M={},A,F=k.length,q=0,P=0;P<F;P++)A=k[P],M[A]=P<q?E[P]:n;return M}function S(k,E,M){this._emitter=k,this._target=E,this._listeners={},this._listenersCount=0;var A,F;if((M.on||M.off)&&(A=M.on,F=M.off),E.addEventListener?(A=E.addEventListener,F=E.removeEventListener):E.addListener?(A=E.addListener,F=E.removeListener):E.on&&(A=E.on,F=E.off),!A&&!F)throw Error("target does not implement any known event API");if(typeof A!="function")throw TypeError("on method must be a function");if(typeof F!="function")throw TypeError("off method must be a function");this._on=A,this._off=F;var q=k._observers;q?q.push(this):k._observers=[this]}Object.assign(S.prototype,{subscribe:function(k,E,M){var A=this,F=this._target,q=this._emitter,P=this._listeners,j=function(){var $=v.apply(null,arguments),W={data:$,name:E,original:k};if(M){var ie=M.call(F,W);ie!==!1&&q.emit.apply(q,[W.name].concat($));return}q.emit.apply(q,[E].concat($))};if(P[k])throw Error("Event '"+k+"' is already listening");this._listenersCount++,q._newListener&&q._removeListener&&!A._onNewListener?(this._onNewListener=function($){$===E&&P[k]===null&&(P[k]=j,A._on.call(F,k,j))},q.on("newListener",this._onNewListener),this._onRemoveListener=function($){$===E&&!q.hasListeners($)&&P[k]&&(P[k]=null,A._off.call(F,k,j))},P[k]=null,q.on("removeListener",this._onRemoveListener)):(P[k]=j,A._on.call(F,k,j))},unsubscribe:function(k){var E=this,M=this._listeners,A=this._emitter,F,q,P=this._off,j=this._target,$;if(k&&typeof k!="string")throw TypeError("event must be a string");function W(){E._onNewListener&&(A.off("newListener",E._onNewListener),A.off("removeListener",E._onRemoveListener),E._onNewListener=null,E._onRemoveListener=null);var ie=L.call(A,E);A._observers.splice(ie,1)}if(k){if(F=M[k],!F)return;P.call(j,k,F),delete M[k],--this._listenersCount||W()}else{for(q=h(M),$=q.length;$-- >0;)k=q[$],P.call(j,k,M[k]);this._listeners={},this._listenersCount=0,W()}}});function y(k,E,M,A){var F=Object.assign({},E);if(!k)return F;if(typeof k!="object")throw TypeError("options must be an object");var q=Object.keys(k),P=q.length,j,$,W;function ie(ne){throw Error('Invalid "'+j+'" option value'+(ne?". Reason: "+ne:""))}for(var Z=0;Z<P;Z++){if(j=q[Z],!r.call(E,j))throw Error('Unknown "'+j+'" option');$=k[j],$!==n&&(W=M[j],F[j]=W?W($,ie):$)}return F}function b(k,E){return(typeof k!="function"||!k.hasOwnProperty("prototype"))&&E("value must be a constructor"),k}function w(k){var E="value must be type of "+k.join("|"),M=k.length,A=k[0],F=k[1];return M===1?function(q,P){if(typeof q===A)return q;P(E)}:M===2?function(q,P){var j=typeof q;if(j===A||j===F)return q;P(E)}:function(q,P){for(var j=typeof q,$=M;$-- >0;)if(j===k[$])return q;P(E)}}var C=w(["function"]),I=w(["object","function"]);function R(k,E,M){var A,F,q=0,P,j=new k(function($,W,ie){M=y(M,{timeout:0,overload:!1},{timeout:function(ge,Le){return ge*=1,(typeof ge!="number"||ge<0||!Number.isFinite(ge))&&Le("timeout must be a positive number"),ge}}),A=!M.overload&&typeof k.prototype.cancel=="function"&&typeof ie=="function";function Z(){F&&(F=null),q&&(clearTimeout(q),q=0)}var ne=function(ge){Z(),$(ge)},ae=function(ge){Z(),W(ge)};A?E(ne,ae,ie):(F=[function(ge){ae(ge||Error("canceled"))}],E(ne,ae,function(ge){if(P)throw Error("Unable to subscribe on cancel event asynchronously");if(typeof ge!="function")throw TypeError("onCancel callback must be a function");F.push(ge)}),P=!0),M.timeout>0&&(q=setTimeout(function(){var ge=Error("timeout");ge.code="ETIMEDOUT",q=0,j.cancel(ge),W(ge)},M.timeout))});return A||(j.cancel=function($){if(F){for(var W=F.length,ie=1;ie<W;ie++)F[ie]($);F[0]($),F=null}}),j}function L(k){var E=this._observers;if(!E)return-1;for(var M=E.length,A=0;A<M;A++)if(E[A]._target===k)return A;return-1}function N(k,E,M,A,F){if(!M)return null;if(A===0){var q=typeof E;if(q==="string"){var P,j,$=0,W=0,ie=this.delimiter,Z=ie.length;if((j=E.indexOf(ie))!==-1){P=new Array(5);do P[$++]=E.slice(W,j),W=j+Z;while((j=E.indexOf(ie,W))!==-1);P[$++]=E.slice(W),E=P,F=$}else E=[E],F=1}else q==="object"?F=E.length:(E=[E],F=1)}var ne=null,ae,ge,Le,Ct,pn,mn=E[A],Fn=E[A+1],se,Ee;if(A===F)M._listeners&&(typeof M._listeners=="function"?(k&&k.push(M._listeners),ne=[M]):(k&&k.push.apply(k,M._listeners),ne=[M]));else if(mn==="*"){for(se=h(M),j=se.length;j-- >0;)ae=se[j],ae!=="_listeners"&&(Ee=N(k,E,M[ae],A+1,F),Ee&&(ne?ne.push.apply(ne,Ee):ne=Ee));return ne}else if(mn==="**"){for(pn=A+1===F||A+2===F&&Fn==="*",pn&&M._listeners&&(ne=N(k,E,M,F,F)),se=h(M),j=se.length;j-- >0;)ae=se[j],ae!=="_listeners"&&(ae==="*"||ae==="**"?(M[ae]._listeners&&!pn&&(Ee=N(k,E,M[ae],F,F),Ee&&(ne?ne.push.apply(ne,Ee):ne=Ee)),Ee=N(k,E,M[ae],A,F)):ae===Fn?Ee=N(k,E,M[ae],A+2,F):Ee=N(k,E,M[ae],A,F),Ee&&(ne?ne.push.apply(ne,Ee):ne=Ee));return ne}else M[mn]&&(ne=N(k,E,M[mn],A+1,F));if(ge=M["*"],ge&&N(k,E,ge,A+1,F),Le=M["**"],Le)if(A<F)for(Le._listeners&&N(k,E,Le,F,F),se=h(Le),j=se.length;j-- >0;)ae=se[j],ae!=="_listeners"&&(ae===Fn?N(k,E,Le[ae],A+2,F):ae===mn?N(k,E,Le[ae],A+1,F):(Ct={},Ct[ae]=Le[ae],N(k,E,{"**":Ct},A+1,F)));else Le._listeners?N(k,E,Le,F,F):Le["*"]&&Le["*"]._listeners&&N(k,E,Le["*"],F,F);return ne}function O(k,E,M){var A=0,F=0,q,P=this.delimiter,j=P.length,$;if(typeof k=="string")if((q=k.indexOf(P))!==-1){$=new Array(5);do $[A++]=k.slice(F,q),F=q+j;while((q=k.indexOf(P,F))!==-1);$[A++]=k.slice(F)}else $=[k],A=1;else $=k,A=k.length;if(A>1){for(q=0;q+1<A;q++)if($[q]==="**"&&$[q+1]==="**")return}var W=this.listenerTree,ie;for(q=0;q<A;q++)if(ie=$[q],W=W[ie]||(W[ie]={}),q===A-1)return W._listeners?(typeof W._listeners=="function"&&(W._listeners=[W._listeners]),M?W._listeners.unshift(E):W._listeners.push(E),!W._listeners.warned&&this._maxListeners>0&&W._listeners.length>this._maxListeners&&(W._listeners.warned=!0,g.call(this,W._listeners.length,ie))):W._listeners=E,!0;return!0}function G(k,E,M,A){for(var F=h(k),q=F.length,P,j,$,W=k._listeners,ie;q-- >0;)j=F[q],P=k[j],j==="_listeners"?$=M:$=M?M.concat(j):[j],ie=A||typeof j=="symbol",W&&E.push(ie?$:$.join(this.delimiter)),typeof P=="object"&&G.call(this,P,E,$,ie);return E}function H(k){for(var E=h(k),M=E.length,A,F,q;M-- >0;)F=E[M],A=k[F],A&&(q=!0,F!=="_listeners"&&!H(A)&&delete k[F]);return q}function re(k,E,M){this.emitter=k,this.event=E,this.listener=M}re.prototype.off=function(){return this.emitter.off(this.event,this.listener),this};function X(k,E,M){if(M===!0)F=!0;else if(M===!1)A=!0;else{if(!M||typeof M!="object")throw TypeError("options should be an object or true");var A=M.async,F=M.promisify,q=M.nextTick,P=M.objectify}if(A||q||F){var j=E,$=E._origin||E;if(q&&!o)throw Error("process.nextTick is not supported");F===n&&(F=E.constructor.name==="AsyncFunction"),E=function(){var W=arguments,ie=this,Z=this.event;return F?q?Promise.resolve():new Promise(function(ne){u(ne)}).then(function(){return ie.event=Z,j.apply(ie,W)}):(q?process.nextTick:u)(function(){ie.event=Z,j.apply(ie,W)})},E._async=!0,E._origin=$}return[E,P?new re(this,k,E):this]}function Q(k){this._events={},this._newListener=!1,this._removeListener=!1,this.verboseMemoryLeak=!1,m.call(this,k)}Q.EventEmitter2=Q,Q.prototype.listenTo=function(k,E,M){if(typeof k!="object")throw TypeError("target musts be an object");var A=this;M=y(M,{on:n,off:n,reducers:n},{on:C,off:C,reducers:I});function F(q){if(typeof q!="object")throw TypeError("events must be an object");var P=M.reducers,j=L.call(A,k),$;j===-1?$=new S(A,k,M):$=A._observers[j];for(var W=h(q),ie=W.length,Z,ne=typeof P=="function",ae=0;ae<ie;ae++)Z=W[ae],$.subscribe(Z,q[Z]||Z,ne?P:P&&P[Z])}return s(E)?F(x(E)):F(typeof E=="string"?x(E.split(/\s+/)):E),this},Q.prototype.stopListeningTo=function(k,E){var M=this._observers;if(!M)return!1;var A=M.length,F,q=!1;if(k&&typeof k!="object")throw TypeError("target should be an object");for(;A-- >0;)F=M[A],(!k||F._target===k)&&(F.unsubscribe(E),q=!0);return q},Q.prototype.delimiter=".",Q.prototype.setMaxListeners=function(k){k!==n&&(this._maxListeners=k,this._conf||(this._conf={}),this._conf.maxListeners=k)},Q.prototype.getMaxListeners=function(){return this._maxListeners},Q.prototype.event="",Q.prototype.once=function(k,E,M){return this._once(k,E,!1,M)},Q.prototype.prependOnceListener=function(k,E,M){return this._once(k,E,!0,M)},Q.prototype._once=function(k,E,M,A){return this._many(k,1,E,M,A)},Q.prototype.many=function(k,E,M,A){return this._many(k,E,M,!1,A)},Q.prototype.prependMany=function(k,E,M,A){return this._many(k,E,M,!0,A)},Q.prototype._many=function(k,E,M,A,F){var q=this;if(typeof M!="function")throw new Error("many only accepts instances of Function");function P(){return--E===0&&q.off(k,P),M.apply(this,arguments)}return P._origin=M,this._on(k,P,A,F)},Q.prototype.emit=function(){if(!this._events&&!this._all)return!1;this._events||f.call(this);var k=arguments[0],E,M=this.wildcard,A,F,q,P,j;if(k==="newListener"&&!this._newListener&&!this._events.newListener)return!1;if(M&&(E=k,k!=="newListener"&&k!=="removeListener"&&typeof k=="object")){if(F=k.length,l){for(q=0;q<F;q++)if(typeof k[q]=="symbol"){j=!0;break}}j||(k=k.join(this.delimiter))}var $=arguments.length,W;if(this._all&&this._all.length)for(W=this._all.slice(),q=0,F=W.length;q<F;q++)switch(this.event=k,$){case 1:W[q].call(this,k);break;case 2:W[q].call(this,k,arguments[1]);break;case 3:W[q].call(this,k,arguments[1],arguments[2]);break;default:W[q].apply(this,arguments)}if(M)W=[],N.call(this,W,E,this.listenerTree,0,F);else if(W=this._events[k],typeof W=="function"){switch(this.event=k,$){case 1:W.call(this);break;case 2:W.call(this,arguments[1]);break;case 3:W.call(this,arguments[1],arguments[2]);break;default:for(A=new Array($-1),P=1;P<$;P++)A[P-1]=arguments[P];W.apply(this,A)}return!0}else W&&(W=W.slice());if(W&&W.length){if($>3)for(A=new Array($-1),P=1;P<$;P++)A[P-1]=arguments[P];for(q=0,F=W.length;q<F;q++)switch(this.event=k,$){case 1:W[q].call(this);break;case 2:W[q].call(this,arguments[1]);break;case 3:W[q].call(this,arguments[1],arguments[2]);break;default:W[q].apply(this,A)}return!0}else if(!this.ignoreErrors&&!this._all&&k==="error")throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");return!!this._all},Q.prototype.emitAsync=function(){if(!this._events&&!this._all)return!1;this._events||f.call(this);var k=arguments[0],E=this.wildcard,M,A,F,q,P,j;if(k==="newListener"&&!this._newListener&&!this._events.newListener)return Promise.resolve([!1]);if(E&&(M=k,k!=="newListener"&&k!=="removeListener"&&typeof k=="object")){if(q=k.length,l){for(P=0;P<q;P++)if(typeof k[P]=="symbol"){A=!0;break}}A||(k=k.join(this.delimiter))}var $=[],W=arguments.length,ie;if(this._all)for(P=0,q=this._all.length;P<q;P++)switch(this.event=k,W){case 1:$.push(this._all[P].call(this,k));break;case 2:$.push(this._all[P].call(this,k,arguments[1]));break;case 3:$.push(this._all[P].call(this,k,arguments[1],arguments[2]));break;default:$.push(this._all[P].apply(this,arguments))}if(E?(ie=[],N.call(this,ie,M,this.listenerTree,0)):ie=this._events[k],typeof ie=="function")switch(this.event=k,W){case 1:$.push(ie.call(this));break;case 2:$.push(ie.call(this,arguments[1]));break;case 3:$.push(ie.call(this,arguments[1],arguments[2]));break;default:for(F=new Array(W-1),j=1;j<W;j++)F[j-1]=arguments[j];$.push(ie.apply(this,F))}else if(ie&&ie.length){if(ie=ie.slice(),W>3)for(F=new Array(W-1),j=1;j<W;j++)F[j-1]=arguments[j];for(P=0,q=ie.length;P<q;P++)switch(this.event=k,W){case 1:$.push(ie[P].call(this));break;case 2:$.push(ie[P].call(this,arguments[1]));break;case 3:$.push(ie[P].call(this,arguments[1],arguments[2]));break;default:$.push(ie[P].apply(this,F))}}else if(!this.ignoreErrors&&!this._all&&k==="error")return arguments[1]instanceof Error?Promise.reject(arguments[1]):Promise.reject("Uncaught, unspecified 'error' event.");return Promise.all($)},Q.prototype.on=function(k,E,M){return this._on(k,E,!1,M)},Q.prototype.prependListener=function(k,E,M){return this._on(k,E,!0,M)},Q.prototype.onAny=function(k){return this._onAny(k,!1)},Q.prototype.prependAny=function(k){return this._onAny(k,!0)},Q.prototype.addListener=Q.prototype.on,Q.prototype._onAny=function(k,E){if(typeof k!="function")throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),E?this._all.unshift(k):this._all.push(k),this},Q.prototype._on=function(k,E,M,A){if(typeof k=="function")return this._onAny(k,E),this;if(typeof E!="function")throw new Error("on only accepts instances of Function");this._events||f.call(this);var F=this,q;return A!==n&&(q=X.call(this,k,E,A),E=q[0],F=q[1]),this._newListener&&this.emit("newListener",k,E),this.wildcard?(O.call(this,k,E,M),F):(this._events[k]?(typeof this._events[k]=="function"&&(this._events[k]=[this._events[k]]),M?this._events[k].unshift(E):this._events[k].push(E),!this._events[k].warned&&this._maxListeners>0&&this._events[k].length>this._maxListeners&&(this._events[k].warned=!0,g.call(this,this._events[k].length,k))):this._events[k]=E,F)},Q.prototype.off=function(k,E){if(typeof E!="function")throw new Error("removeListener only takes instances of Function");var M,A=[];if(this.wildcard){var F=typeof k=="string"?k.split(this.delimiter):k.slice();if(A=N.call(this,null,F,this.listenerTree,0),!A)return this}else{if(!this._events[k])return this;M=this._events[k],A.push({_listeners:M})}for(var q=0;q<A.length;q++){var P=A[q];if(M=P._listeners,s(M)){for(var j=-1,$=0,W=M.length;$<W;$++)if(M[$]===E||M[$].listener&&M[$].listener===E||M[$]._origin&&M[$]._origin===E){j=$;break}if(j<0)continue;return this.wildcard?P._listeners.splice(j,1):this._events[k].splice(j,1),M.length===0&&(this.wildcard?delete P._listeners:delete this._events[k]),this._removeListener&&this.emit("removeListener",k,E),this}else(M===E||M.listener&&M.listener===E||M._origin&&M._origin===E)&&(this.wildcard?delete P._listeners:delete this._events[k],this._removeListener&&this.emit("removeListener",k,E))}return this.listenerTree&&H(this.listenerTree),this},Q.prototype.offAny=function(k){var E=0,M=0,A;if(k&&this._all&&this._all.length>0){for(A=this._all,E=0,M=A.length;E<M;E++)if(k===A[E])return A.splice(E,1),this._removeListener&&this.emit("removeListenerAny",k),this}else{if(A=this._all,this._removeListener)for(E=0,M=A.length;E<M;E++)this.emit("removeListenerAny",A[E]);this._all=[]}return this},Q.prototype.removeListener=Q.prototype.off,Q.prototype.removeAllListeners=function(k){if(k===n)return!this._events||f.call(this),this;if(this.wildcard){var E=N.call(this,null,k,this.listenerTree,0),M,A;if(!E)return this;for(A=0;A<E.length;A++)M=E[A],M._listeners=null;this.listenerTree&&H(this.listenerTree)}else this._events&&(this._events[k]=null);return this},Q.prototype.listeners=function(k){var E=this._events,M,A,F,q,P;if(k===n){if(this.wildcard)throw Error("event name required for wildcard emitter");if(!E)return[];for(M=h(E),q=M.length,F=[];q-- >0;)A=E[M[q]],typeof A=="function"?F.push(A):F.push.apply(F,A);return F}else{if(this.wildcard){if(P=this.listenerTree,!P)return[];var j=[],$=typeof k=="string"?k.split(this.delimiter):k.slice();return N.call(this,j,$,P,0),j}return E?(A=E[k],A?typeof A=="function"?[A]:A:[]):[]}},Q.prototype.eventNames=function(k){var E=this._events;return this.wildcard?G.call(this,this.listenerTree,[],null,k):E?h(E):[]},Q.prototype.listenerCount=function(k){return this.listeners(k).length},Q.prototype.hasListeners=function(k){if(this.wildcard){var E=[],M=typeof k=="string"?k.split(this.delimiter):k.slice();return N.call(this,E,M,this.listenerTree,0),E.length>0}var A=this._events,F=this._all;return!!(F&&F.length||A&&(k===n?h(A).length:A[k]))},Q.prototype.listenersAny=function(){return this._all?this._all:[]},Q.prototype.waitFor=function(k,E){var M=this,A=typeof E;return A==="number"?E={timeout:E}:A==="function"&&(E={filter:E}),E=y(E,{timeout:0,filter:n,handleError:!1,Promise,overload:!1},{filter:C,Promise:b}),R(E.Promise,function(F,q,P){function j(){var $=E.filter;if(!($&&!$.apply(M,arguments)))if(M.off(k,j),E.handleError){var W=arguments[0];W?q(W):F(v.apply(null,arguments).slice(1))}else F(v.apply(null,arguments))}P(function(){M.off(k,j)}),M._on(k,j,!1)},{timeout:E.timeout,overload:E.overload})};function V(k,E,M){M=y(M,{Promise,timeout:0,overload:!1},{Promise:b});var A=M.Promise;return R(A,function(F,q,P){var j;if(typeof k.addEventListener=="function"){j=function(){F(v.apply(null,arguments))},P(function(){k.removeEventListener(E,j)}),k.addEventListener(E,j,{once:!0});return}var $=function(){W&&k.removeListener("error",W),F(v.apply(null,arguments))},W;E!=="error"&&(W=function(ie){k.removeListener(E,$),q(ie)},k.once("error",W)),P(function(){W&&k.removeListener("error",W),k.removeListener(E,$)}),k.once(E,$)},{timeout:M.timeout,overload:M.overload})}var te=Q.prototype;Object.defineProperties(Q,{defaultMaxListeners:{get:function(){return te._maxListeners},set:function(k){if(typeof k!="number"||k<0||Number.isNaN(k))throw TypeError("n must be a non-negative number");te._maxListeners=k},enumerable:!0},once:{value:V,writable:!0,configurable:!0}}),Object.defineProperties(te,{_maxListeners:{value:i,writable:!0,configurable:!0},_observers:{value:null,writable:!0,configurable:!0}}),e.exports=Q})()})(xL);var yv=xL.exports;const V7=of(yv);function Ws(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map(function(s){return"'"+s+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function Td(e){return!!e&&!!e[ds]}function Ml(e){var t;return!!e&&(function(n){if(!n||typeof n!="object")return!1;var r=Object.getPrototypeOf(n);if(r===null)return!0;var s=Object.hasOwnProperty.call(r,"constructor")&&r.constructor;return s===Object||typeof s=="function"&&Function.toString.call(s)===Q7}(e)||Array.isArray(e)||!!e[i_]||!!(!((t=e.constructor)===null||t===void 0)&&t[i_])||z0(e)||G0(e))}function _h(e,t,n){n===void 0&&(n=!1),Hd(e)===0?(n?Object.keys:Q0)(e).forEach(function(r){n&&typeof r=="symbol"||t(r,e[r],e)}):e.forEach(function(r,s){return t(s,r,e)})}function Hd(e){var t=e[ds];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:z0(e)?2:G0(e)?3:0}function yw(e,t){return Hd(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function B7(e,t){return Hd(e)===2?e.get(t):e[t]}function bL(e,t,n){var r=Hd(e);r===2?e.set(t,n):r===3?e.add(n):e[t]=n}function z7(e,t){return e===t?e!==0||1/e==1/t:e!=e&&t!=t}function z0(e){return q7&&e instanceof Map}function G0(e){return K7&&e instanceof Set}function Yo(e){return e.o||e.t}function W0(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=J7(e);delete t[ds];for(var n=Q0(t),r=0;r<n.length;r++){var s=n[r],i=t[s];i.writable===!1&&(i.writable=!0,i.configurable=!0),(i.get||i.set)&&(t[s]={configurable:!0,writable:!0,enumerable:i.enumerable,value:e[s]})}return Object.create(Object.getPrototypeOf(e),t)}function H0(e,t){return t===void 0&&(t=!1),q0(e)||Td(e)||!Ml(e)||(Hd(e)>1&&(e.set=e.add=e.clear=e.delete=G7),Object.freeze(e),t&&_h(e,function(n,r){return H0(r,!0)},!0)),e}function G7(){Ws(2)}function q0(e){return e==null||typeof e!="object"||Object.isFrozen(e)}function ki(e){var t=Y7[e];return t||Ws(18,e),t}function XE(){return Ph}function nx(e,t){t&&(ki("Patches"),e.u=[],e.s=[],e.v=t)}function eg(e){xw(e),e.p.forEach(W7),e.p=null}function xw(e){e===Ph&&(Ph=e.l)}function ZE(e){return Ph={p:[],l:Ph,h:e,m:!0,_:0}}function W7(e){var t=e[ds];t.i===0||t.i===1?t.j():t.g=!0}function rx(e,t){t._=t.p.length;var n=t.p[0],r=e!==void 0&&e!==n;return t.h.O||ki("ES5").S(t,e,r),r?(n[ds].P&&(eg(t),Ws(4)),Ml(e)&&(e=tg(t,e),t.l||ng(t,e)),t.u&&ki("Patches").M(n[ds].t,e,t.u,t.s)):e=tg(t,n,[]),eg(t),t.u&&t.v(t.u,t.s),e!==wL?e:void 0}function tg(e,t,n){if(q0(t))return t;var r=t[ds];if(!r)return _h(t,function(l,c){return e_(e,r,t,l,c,n)},!0),t;if(r.A!==e)return t;if(!r.P)return ng(e,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var s=r.i===4||r.i===5?r.o=W0(r.k):r.o,i=s,o=!1;r.i===3&&(i=new Set(s),s.clear(),o=!0),_h(i,function(l,c){return e_(e,r,s,l,c,n,o)}),ng(e,s,!1),n&&e.u&&ki("Patches").N(r,n,e.u,e.s)}return r.o}function e_(e,t,n,r,s,i,o){if(Td(s)){var l=tg(e,s,i&&t&&t.i!==3&&!yw(t.R,r)?i.concat(r):void 0);if(bL(n,r,l),!Td(l))return;e.m=!1}else o&&n.add(s);if(Ml(s)&&!q0(s)){if(!e.h.D&&e._<1)return;tg(e,s),t&&t.A.l||ng(e,s)}}function ng(e,t,n){n===void 0&&(n=!1),!e.l&&e.h.D&&e.m&&H0(t,n)}function sx(e,t){var n=e[ds];return(n?Yo(n):e)[t]}function t_(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=Object.getPrototypeOf(n)}}function bw(e){e.P||(e.P=!0,e.l&&bw(e.l))}function ix(e){e.o||(e.o=W0(e.t))}function ww(e,t,n){var r=z0(t)?ki("MapSet").F(t,n):G0(t)?ki("MapSet").T(t,n):e.O?function(s,i){var o=Array.isArray(s),l={i:o?1:0,A:i?i.A:XE(),P:!1,I:!1,R:{},l:i,t:s,k:null,o:null,j:null,C:!1},c=l,d=Sw;o&&(c=[l],d=ju);var u=Proxy.revocable(c,d),h=u.revoke,f=u.proxy;return l.k=f,l.j=h,f}(t,n):ki("ES5").J(t,n);return(n?n.A:XE()).p.push(r),r}function H7(e){return Td(e)||Ws(22,e),function t(n){if(!Ml(n))return n;var r,s=n[ds],i=Hd(n);if(s){if(!s.P&&(s.i<4||!ki("ES5").K(s)))return s.t;s.I=!0,r=n_(n,i),s.I=!1}else r=n_(n,i);return _h(r,function(o,l){s&&B7(s.t,o)===l||bL(r,o,t(l))}),i===3?new Set(r):r}(e)}function n_(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return W0(e)}var r_,Ph,K0=typeof Symbol<"u"&&typeof Symbol("x")=="symbol",q7=typeof Map<"u",K7=typeof Set<"u",s_=typeof Proxy<"u"&&Proxy.revocable!==void 0&&typeof Reflect<"u",wL=K0?Symbol.for("immer-nothing"):((r_={})["immer-nothing"]=!0,r_),i_=K0?Symbol.for("immer-draftable"):"__$immer_draftable",ds=K0?Symbol.for("immer-state"):"__$immer_state",Q7=""+Object.prototype.constructor,Q0=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols!==void 0?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,J7=Object.getOwnPropertyDescriptors||function(e){var t={};return Q0(e).forEach(function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)}),t},Y7={},Sw={get:function(e,t){if(t===ds)return e;var n=Yo(e);if(!yw(n,t))return function(s,i,o){var l,c=t_(i,o);return c?"value"in c?c.value:(l=c.get)===null||l===void 0?void 0:l.call(s.k):void 0}(e,n,t);var r=n[t];return e.I||!Ml(r)?r:r===sx(e.t,t)?(ix(e),e.o[t]=ww(e.A.h,r,e)):r},has:function(e,t){return t in Yo(e)},ownKeys:function(e){return Reflect.ownKeys(Yo(e))},set:function(e,t,n){var r=t_(Yo(e),t);if(r!=null&&r.set)return r.set.call(e.k,n),!0;if(!e.P){var s=sx(Yo(e),t),i=s==null?void 0:s[ds];if(i&&i.t===n)return e.o[t]=n,e.R[t]=!1,!0;if(z7(n,s)&&(n!==void 0||yw(e.t,t)))return!0;ix(e),bw(e)}return e.o[t]===n&&(n!==void 0||t in e.o)||Number.isNaN(n)&&Number.isNaN(e.o[t])||(e.o[t]=n,e.R[t]=!0),!0},deleteProperty:function(e,t){return sx(e.t,t)!==void 0||t in e.t?(e.R[t]=!1,ix(e),bw(e)):delete e.R[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=Yo(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r&&{writable:!0,configurable:e.i!==1||t!=="length",enumerable:r.enumerable,value:n[t]}},defineProperty:function(){Ws(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){Ws(12)}},ju={};_h(Sw,function(e,t){ju[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),ju.deleteProperty=function(e,t){return ju.set.call(this,e,t,void 0)},ju.set=function(e,t,n){return Sw.set.call(this,e[0],t,n,e[0])};var X7=function(){function e(n){var r=this;this.O=s_,this.D=!0,this.produce=function(s,i,o){if(typeof s=="function"&&typeof i!="function"){var l=i;i=s;var c=r;return function(v){var x=this;v===void 0&&(v=l);for(var S=arguments.length,y=Array(S>1?S-1:0),b=1;b<S;b++)y[b-1]=arguments[b];return c.produce(v,function(w){var C;return(C=i).call.apply(C,[x,w].concat(y))})}}var d;if(typeof i!="function"&&Ws(6),o!==void 0&&typeof o!="function"&&Ws(7),Ml(s)){var u=ZE(r),h=ww(r,s,void 0),f=!0;try{d=i(h),f=!1}finally{f?eg(u):xw(u)}return typeof Promise<"u"&&d instanceof Promise?d.then(function(v){return nx(u,o),rx(v,u)},function(v){throw eg(u),v}):(nx(u,o),rx(d,u))}if(!s||typeof s!="object"){if((d=i(s))===void 0&&(d=s),d===wL&&(d=void 0),r.D&&H0(d,!0),o){var m=[],g=[];ki("Patches").M(s,d,m,g),o(m,g)}return d}Ws(21,s)},this.produceWithPatches=function(s,i){if(typeof s=="function")return function(d){for(var u=arguments.length,h=Array(u>1?u-1:0),f=1;f<u;f++)h[f-1]=arguments[f];return r.produceWithPatches(d,function(m){return s.apply(void 0,[m].concat(h))})};var o,l,c=r.produce(s,i,function(d,u){o=d,l=u});return typeof Promise<"u"&&c instanceof Promise?c.then(function(d){return[d,o,l]}):[c,o,l]},typeof(n==null?void 0:n.useProxies)=="boolean"&&this.setUseProxies(n.useProxies),typeof(n==null?void 0:n.autoFreeze)=="boolean"&&this.setAutoFreeze(n.autoFreeze)}var t=e.prototype;return t.createDraft=function(n){Ml(n)||Ws(8),Td(n)&&(n=H7(n));var r=ZE(this),s=ww(this,n,void 0);return s[ds].C=!0,xw(r),s},t.finishDraft=function(n,r){var s=n&&n[ds],i=s.A;return nx(i,r),rx(void 0,i)},t.setAutoFreeze=function(n){this.D=n},t.setUseProxies=function(n){n&&!s_&&Ws(20),this.O=n},t.applyPatches=function(n,r){var s;for(s=r.length-1;s>=0;s--){var i=r[s];if(i.path.length===0&&i.op==="replace"){n=i.value;break}}s>-1&&(r=r.slice(s+1));var o=ki("Patches").$;return Td(n)?o(n,r):this.produce(n,function(l){return o(l,r)})},e}(),us=new X7,Z7=us.produce;us.produceWithPatches.bind(us);us.setAutoFreeze.bind(us);us.setUseProxies.bind(us);us.applyPatches.bind(us);us.createDraft.bind(us);us.finishDraft.bind(us);function eK(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(let r=0;r<n.length;r++)if(!Object.prototype.hasOwnProperty.call(t,n[r])||!Object.is(e[n[r]],t[n[r]]))return!1;return!0}function tK(e){let t;const n=new Set,r=(d,u)=>{const h=typeof d=="function"?d(t):d;if(h!==t){const f=t;t=u?h:Object.assign({},t,h),n.forEach(m=>m(t,f))}},s=()=>t,i=(d,u=s,h=Object.is)=>{let f=u(t);function m(){const g=u(t);if(!h(f,g)){const v=f;d(f=g,v)}}return n.add(m),()=>n.delete(m)},c={setState:r,getState:s,subscribe:(d,u,h)=>u||h?i(d,u,h):(n.add(d),()=>n.delete(d)),destroy:()=>n.clear()};return t=e(r,s,c),c}var SL={},kL={exports:{}},a_=kL.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return e.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return e.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return e.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=e.raddr!=null?" raddr %s rport %d":"%v%v",t+=e.tcptype!=null?" tcptype %s":"%v",e.generation!=null&&(t+=" generation %d"),t+=e["network-id"]!=null?" network-id %d":"%v",t+=e["network-cost"]!=null?" network-cost %d":"%v",t}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return e.attribute!=null&&(t+=" %s",e.value!=null&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return e.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(e.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=e.id!=null?"id=%s %s":"%v%s",t+=e.mediaClockValue!=null?"=%s":"",t+=e.rateNumerator!=null?" rate=%s":"",t+=e.rateDenominator!=null?"/%s":"",t}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(a_).forEach(function(e){var t=a_[e];t.forEach(function(n){n.reg||(n.reg=/(.*)/),n.format||(n.format="%s")})});var TL=kL.exports;(function(e){var t=function(l){return String(Number(l))===l?Number(l):l},n=function(l,c,d,u){if(u&&!d)c[u]=t(l[1]);else for(var h=0;h<d.length;h+=1)l[h+1]!=null&&(c[d[h]]=t(l[h+1]))},r=function(l,c,d){var u=l.name&&l.names;l.push&&!c[l.push]?c[l.push]=[]:u&&!c[l.name]&&(c[l.name]={});var h=l.push?{}:u?c[l.name]:c;n(d.match(l.reg),h,l.names,l.name),l.push&&c[l.push].push(h)},s=TL,i=RegExp.prototype.test.bind(/^([a-z])=(.*)/);e.parse=function(l){var c={},d=[],u=c;return l.split(/(\r\n|\r|\n)/).filter(i).forEach(function(h){var f=h[0],m=h.slice(2);f==="m"&&(d.push({rtp:[],fmtp:[]}),u=d[d.length-1]);for(var g=0;g<(s[f]||[]).length;g+=1){var v=s[f][g];if(v.reg.test(m))return r(v,u,m)}}),c.media=d,c};var o=function(l,c){var d=c.split(/=(.+)/,2);return d.length===2?l[d[0]]=t(d[1]):d.length===1&&c.length>1&&(l[d[0]]=void 0),l};e.parseParams=function(l){return l.split(/;\s?/).reduce(o,{})},e.parseFmtpConfig=e.parseParams,e.parsePayloads=function(l){return l.toString().split(" ").map(Number)},e.parseRemoteCandidates=function(l){for(var c=[],d=l.split(" ").map(t),u=0;u<d.length;u+=3)c.push({component:d[u],ip:d[u+1],port:d[u+2]});return c},e.parseImageAttributes=function(l){return l.split(" ").map(function(c){return c.substring(1,c.length-1).split(",").reduce(o,{})})},e.parseSimulcastStreamList=function(l){return l.split(";").map(function(c){return c.split(",").map(function(d){var u,h=!1;return d[0]!=="~"?u=t(d):(u=t(d.substring(1,d.length)),h=!0),{scid:u,paused:h}})})}})(SL);var ax=TL,nK=/%[sdv%]/g,rK=function(e){var t=1,n=arguments,r=n.length;return e.replace(nK,function(s){if(t>=r)return s;var i=n[t];switch(t+=1,s){case"%%":return"%";case"%s":return String(i);case"%d":return Number(i);case"%v":return""}})},vu=function(e,t,n){var r=t.format instanceof Function?t.format(t.push?n:n[t.name]):t.format,s=[e+"="+r];if(t.names)for(var i=0;i<t.names.length;i+=1){var o=t.names[i];t.name?s.push(n[t.name][o]):s.push(n[t.names[i]])}else s.push(n[t.name]);return rK.apply(null,s)},sK=["v","o","s","i","u","e","p","c","b","t","r","z","a"],iK=["i","c","b","a"],aK=function(e,t){t=t||{},e.version==null&&(e.version=0),e.name==null&&(e.name=" "),e.media.forEach(function(i){i.payloads==null&&(i.payloads="")});var n=t.outerOrder||sK,r=t.innerOrder||iK,s=[];return n.forEach(function(i){ax[i].forEach(function(o){o.name in e&&e[o.name]!=null?s.push(vu(i,o,e)):o.push in e&&e[o.push]!=null&&e[o.push].forEach(function(l){s.push(vu(i,o,l))})})}),e.media.forEach(function(i){s.push(vu("m",ax.m[0],i)),r.forEach(function(o){ax[o].forEach(function(l){l.name in i&&i[l.name]!=null?s.push(vu(o,l,i)):l.push in i&&i[l.push]!=null&&i[l.push].forEach(function(c){s.push(vu(o,l,c))})})})}),s.join(`\r
`)+`\r
`},Zl=SL,oK=aK,lK=oK,CL=Zl.parse;Zl.parseParams;Zl.parseFmtpConfig;Zl.parsePayloads;Zl.parseRemoteCandidates;Zl.parseImageAttributes;Zl.parseSimulcastStreamList;var cK=Object.defineProperty,dK=Object.defineProperties,uK=Object.getOwnPropertyDescriptors,rg=Object.getOwnPropertySymbols,hK=Object.getPrototypeOf,EL=Object.prototype.hasOwnProperty,_L=Object.prototype.propertyIsEnumerable,fK=Reflect.get,o_=(e,t,n)=>t in e?cK(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,de=(e,t)=>{for(var n in t||(t={}))EL.call(t,n)&&o_(e,n,t[n]);if(rg)for(var n of rg(t))_L.call(t,n)&&o_(e,n,t[n]);return e},Ke=(e,t)=>dK(e,uK(t)),l_=(e,t)=>{var n={};for(var r in e)EL.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&rg)for(var r of rg(e))t.indexOf(r)<0&&_L.call(e,r)&&(n[r]=e[r]);return n},pK=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),ho=(e,t,n)=>fK(hK(e),n,t),T=(e,t,n)=>new Promise((r,s)=>{var i=c=>{try{l(n.next(c))}catch(d){s(d)}},o=c=>{try{l(n.throw(c))}catch(d){s(d)}},l=c=>c.done?r(c.value):Promise.resolve(c.value).then(i,o);l((n=n.apply(e,t)).next())}),PL=pK((e,t)=>{t.exports={version:"0.12.39",license:"MIT",repository:{type:"git",url:"https://github.com/100mslive/web-sdks.git",directory:"packages/hms-video-store"},main:"dist/index.cjs.js",module:"dist/index.js",typings:"dist/index.d.ts",files:["dist","src"],engines:{node:">=12"},exports:{".":{require:"./dist/index.cjs.js",import:"./dist/index.js",default:"./dist/index.js"}},sideEffects:!1,scripts:{prestart:"rm -rf dist && yarn types:build",start:'concurrently "yarn dev" "yarn types"',dev:"node ../../scripts/dev","build:only":"node ../../scripts/build",build:"yarn build:only && yarn types:build",types:"tsc -w","types:build":"tsc -p tsconfig.json",format:"prettier --write src/**/*.ts",test:"jest --maxWorkers=1","test:watch":"jest --watch","test:coverage":"jest --coverage",lint:"eslint -c ../../.eslintrc .","lint:fix":"yarn lint --fix",prepare:"yarn build",size:"size-limit",analyze:"size-limit --why",docs:"rm -rf ./docs && typedoc && rm -f ./docs/README.md && mkdir ./docs/home &&mv ./docs/modules.md ./docs/home/content.md && node ../../scripts/docs-store && npx prettier --write './docs/**/*'"},name:"@100mslive/hms-video-store",author:"100ms",dependencies:{eventemitter2:"^6.4.9",immer:"^9.0.6","lodash.isequal":"^4.5.0",reselect:"4.0.0","sdp-transform":"^2.14.1","ua-parser-js":"^1.0.1",uuid:"^8.3.2","webrtc-adapter":"^8.0.0",zustand:"3.5.7"},devDependencies:{"@types/dom-screen-wake-lock":"^1.0.1","@types/lodash.isequal":"^4.5.8","@types/sdp-transform":"^2.4.4","@types/ua-parser-js":"^0.7.36","@types/uuid":"^8.3.0","jest-canvas-mock":"^2.3.1","jsdom-worker":"^0.3.0",tslib:"^2.2.0"},description:"@100mslive Core SDK which abstracts the complexities of webRTC while providing a reactive store for data management with a unidirectional data flow",keywords:["video","webrtc","conferencing","100ms"],gitHead:"42f8cd96ebaaca99872c8dae510b747e6ccd02fb"}}),mK=(e=>(e.Disconnected="Disconnected",e.Preview="Preview",e.Connecting="Connecting",e.Connected="Connected",e.Reconnecting="Reconnecting",e.Disconnecting="Disconnecting",e.Failed="Failed",e))(mK||{}),NL=()=>({room:{id:"",isConnected:!1,name:"",peers:[],localPeer:"",roomState:"Disconnected",recording:{browser:{running:!1},server:{running:!1},hls:{running:!1}},rtmp:{running:!1},hls:{running:!1,variants:[]},sessionId:""},peers:{},tracks:{},playlist:{audio:{list:{},selection:{id:"",hasPrevious:!1,hasNext:!1},progress:0,volume:0,currentTime:0,playbackRate:1},video:{list:{},selection:{id:"",hasPrevious:!1,hasNext:!1},progress:0,volume:0,currentTime:0,playbackRate:1}},messages:{byID:{},allIDs:[]},speakers:{},connectionQualities:{},settings:{audioInputDeviceId:"",audioOutputDeviceId:"",videoInputDeviceId:""},devices:{audioInput:[],audioOutput:[],videoInput:[]},roles:{},roleChangeRequests:[],errors:[],sessionStore:{},templateAppData:{},polls:{},whiteboards:{},hideLocalPeer:!1}),IL=()=>({peerStats:{},remoteTrackStats:{},localTrackStats:{},localPeer:{id:""}}),gK=(e=>(e.CHAT="chat",e))(gK||{}),vK=(e=>(e.INFO="info",e.ERROR="error",e))(vK||{}),fo=(e=>(e.PEER_JOINED="PEER_JOINED",e.PEER_LEFT="PEER_LEFT",e.PEER_LIST="PEER_LIST",e.NEW_MESSAGE="NEW_MESSAGE",e.ERROR="ERROR",e.RECONNECTING="RECONNECTING",e.RECONNECTED="RECONNECTED",e.TRACK_ADDED="TRACK_ADDED",e.TRACK_REMOVED="TRACK_REMOVED",e.TRACK_MUTED="TRACK_MUTED",e.TRACK_UNMUTED="TRACK_UNMUTED",e.TRACK_DEGRADED="TRACK_DEGRADED",e.TRACK_RESTORED="TRACK_RESTORED",e.TRACK_DESCRIPTION_CHANGED="TRACK_DESCRIPTION_CHANGED",e.ROLE_UPDATED="ROLE_UPDATED",e.CHANGE_TRACK_STATE_REQUEST="CHANGE_TRACK_STATE_REQUEST",e.CHANGE_MULTI_TRACK_STATE_REQUEST="CHANGE_MULTI_TRACK_STATE_REQUEST",e.ROOM_ENDED="ROOM_ENDED",e.REMOVED_FROM_ROOM="REMOVED_FROM_ROOM",e.DEVICE_CHANGE_UPDATE="DEVICE_CHANGE_UPDATE",e.PLAYLIST_TRACK_ENDED="PLAYLIST_TRACK_ENDED",e.NAME_UPDATED="NAME_UPDATED",e.METADATA_UPDATED="METADATA_UPDATED",e.POLL_CREATED="POLL_CREATED",e.POLL_STARTED="POLL_STARTED",e.POLL_STOPPED="POLL_STOPPED",e.POLL_VOTES_UPDATED="POLL_VOTES_UPDATED",e.POLLS_LIST="POLLS_LIST",e.HAND_RAISE_CHANGED="HAND_RAISE_CHANGED",e.TRANSCRIPTION_STATE_UPDATED="TRANSCRIPTION_STATE_UPDATED",e))(fo||{}),yK=(e=>(e.audio="audio",e.video="video",e))(yK||{});function bf(e,t){let n,r;if(t)for(let s of t.auxiliaryTracks){let i=e[s];xK(i)&&(r=J0(i)?i:r,n=Y0(i)?i:n)}return{video:n,audio:r}}function J0(e){return e&&e.type==="audio"}function Y0(e){return e&&e.type==="video"}function xK(e){return e&&e.source==="screen"}function AL(e){return e&&e.source==="audioplaylist"}function X0(e){return e&&e.source==="videoplaylist"}function bK(e){return e?!!(e!=null&&e.degraded):!1}function RL(e,t){return t&&e.tracks[t]?e.tracks[t].enabled:!1}function wK(e,t){return t&&e.tracks[t]?e.tracks[t].displayEnabled:!1}function jL(e){var t;let n=!1,r=!1,s=!1;return(t=e==null?void 0:e.publishParams)!=null&&t.allowed&&(n=e.publishParams.allowed.includes("video"),r=e.publishParams.allowed.includes("audio"),s=e.publishParams.allowed.includes("screen")),{video:n,audio:r,screen:s}}var SK=(e=>(e[e.VERBOSE=0]="VERBOSE",e[e.DEBUG=1]="DEBUG",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.TIME=4]="TIME",e[e.TIMEEND=5]="TIMEEND",e[e.ERROR=6]="ERROR",e[e.NONE=7]="NONE",e))(SK||{}),kK=typeof window<"u"&&typeof window.expect<"u",_=class{static v(t,...n){this.log(0,t,...n)}static d(t,...n){this.log(1,t,...n)}static i(t,...n){this.log(2,t,...n)}static w(t,...n){this.log(3,t,...n)}static e(t,...n){this.log(6,t,...n)}static time(t){this.log(4,"[HMSPerformanceTiming]",t)}static timeEnd(t){this.log(5,"[HMSPerformanceTiming]",t,t)}static cleanup(){performance.clearMarks(),performance.clearMeasures()}static log(t,n,...r){if(!(this.level.valueOf()>t.valueOf()))switch(t){case 0:{console.log(n,...r);break}case 1:{console.debug(n,...r);break}case 2:{console.info(n,...r);break}case 3:{console.warn(n,...r);break}case 6:{console.error(n,...r);break}case 4:{performance.mark(r[0]);break}case 5:{let s=r[0];try{let i=performance.measure(s,s);this.log(1,n,s,i==null?void 0:i.duration),performance.clearMarks(s),performance.clearMeasures(s)}catch(i){this.log(1,n,s,i)}break}}}};_.level=kK?7:0;var ML=class{constructor(e){this.tracks=new Array,this.nativeStream=e,this.id=e.id}updateId(e){this.id=e}},po=new E7.UAParser,Is=typeof window<"u",c_,Z0=typeof window>"u"&&!((c_=po.getBrowser().name)!=null&&c_.toLowerCase().includes("electron")),kw=()=>po.getDevice().type==="mobile",TK=()=>typeof document<"u"&&document.hidden,CK=()=>{var e;return((e=po.getOS().name)==null?void 0:e.toLowerCase())==="ios"},d_,u_,EK=(u_=(d_=po.getBrowser())==null?void 0:d_.name)==null?void 0:u_.toLowerCase().includes("safari"),h_,f_,DL=((f_=(h_=po.getBrowser())==null?void 0:h_.name)==null?void 0:f_.toLowerCase())==="firefox",_K=(e=>(e.CUSTOM="CUSTOM",e.LOCAL="LOCAL",e.HMS="HMS",e))(_K||{});function PK(){if(Is&&window){let e=window.location.hostname;return e==="localhost"||e==="127.0.0.1"?"LOCAL":e.includes("app.100ms.live")?"HMS":"CUSTOM"}return"CUSTOM"}var rm=PK(),Me={WebSocketConnectionErrors:{FAILED_TO_CONNECT:1e3,WEBSOCKET_CONNECTION_LOST:1003,ABNORMAL_CLOSE:1006},APIErrors:{INIT_CONFIG_NOT_AVAILABLE:2002,ENDPOINT_UNREACHABLE:2003,INVALID_TOKEN_FORMAT:2004},TracksErrors:{GENERIC_TRACK:3e3,CANT_ACCESS_CAPTURE_DEVICE:3001,DEVICE_NOT_AVAILABLE:3002,DEVICE_IN_USE:3003,DEVICE_LOST_MIDWAY:3004,NOTHING_TO_RETURN:3005,INVALID_VIDEO_SETTINGS:3006,CODEC_CHANGE_NOT_PERMITTED:3007,AUTOPLAY_ERROR:3008,OVER_CONSTRAINED:3009,NO_AUDIO_DETECTED:3010,SYSTEM_DENIED_PERMISSION:3011,CURRENT_TAB_NOT_SHARED:3012,AUDIO_PLAYBACK_ERROR:3013,SELECTED_DEVICE_MISSING:3014,NO_DATA:3015},WebrtcErrors:{CREATE_OFFER_FAILED:4001,CREATE_ANSWER_FAILED:4002,SET_LOCAL_DESCRIPTION_FAILED:4003,SET_REMOTE_DESCRIPTION_FAILED:4004,ICE_FAILURE:4005,ICE_DISCONNECTED:4006,STATS_FAILED:4007},WebsocketMethodErrors:{ALREADY_JOINED:5001,CANNOT_JOIN_PREVIEW_IN_PROGRESS:5002},GenericErrors:{NOT_CONNECTED:6e3,SIGNALLING:6001,UNKNOWN:6002,NOT_READY:6003,JSON_PARSING_FAILED:6004,TRACK_METADATA_MISSING:6005,RTC_TRACK_MISSING:6006,PEER_METADATA_MISSING:6007,INVALID_ROLE:6008,PREVIEW_IN_PROGRESS:6009,MISSING_MEDIADEVICES:6010,MISSING_RTCPEERCONNECTION:6011,LOCAL_STORAGE_ACCESS_DENIED:6012,VALIDATION_FAILED:6013},PlaylistErrors:{NO_ENTRY_TO_PLAY:8001,NO_ENTRY_IS_PLAYING:8002}},Ue=class OL extends Error{constructor(t,n,r,s,i,o=!1){super(s),this.code=t,this.name=n,this.message=s,this.description=i,this.isTerminal=o,Object.setPrototypeOf(this,OL.prototype),this.action=r.toString()}toAnalyticsProperties(){return{error_name:this.name,error_code:this.code,error_message:this.message,error_description:this.description,action:this.action,is_terminal:this.isTerminal}}addNativeError(t){this.nativeError=t}toString(){var t;return`{
        code: ${this.code};
        name: ${this.name};
        action: ${this.action};
        message: ${this.message};
        description: ${this.description};
        isTerminal: ${this.isTerminal};
        nativeError: ${(t=this.nativeError)==null?void 0:t.message};
      }`}},ur=class extends Ue{constructor(e,t,n,r,s,i){super(e,t,n,r,s,!1),this.code=e,this.name=t,this.message=r,this.description=s,this.trackType=i}toAnalyticsProperties(){return Ke(de({},super.toAnalyticsProperties()),{track_type:this.trackType})}toString(){var e;return`{
        code: ${this.code};
        name: ${this.name};
        action: ${this.action};
        message: ${this.message};
        description: ${this.description};
        isTerminal: ${this.isTerminal};
        nativeError: ${(e=this.nativeError)==null?void 0:e.message};
        trackType: ${this.trackType};
      }`}},NK=(e=>(e.AUDIO="audio",e.VIDEO="video",e.AUDIO_VIDEO="audio, video",e.SCREEN="screen",e))(NK||{});function p_(e){switch(e){case"join":return"JOIN";case"offer":return"PUBLISH";case"answer":return"SUBSCRIBE";case"track-update":return"TRACK";default:return"NONE"}}var IK=["join","offer","answer","trickle","on-error","JOIN"],oe={WebSocketConnectionErrors:{FailedToConnect(e,t=""){return new Ue(Me.WebSocketConnectionErrors.FAILED_TO_CONNECT,"WebsocketFailedToConnect",e,`[WS]: ${t}`,`[WS]: ${t}`)},WebSocketConnectionLost(e,t=""){return new Ue(Me.WebSocketConnectionErrors.WEBSOCKET_CONNECTION_LOST,"WebSocketConnectionLost",e,"Network connection lost",t)},AbnormalClose(e,t=""){return new Ue(Me.WebSocketConnectionErrors.ABNORMAL_CLOSE,"WebSocketAbnormalClose",e,"Websocket closed abnormally",t)}},APIErrors:{ServerErrors(e,t,n="",r=!0){return new Ue(e,"ServerErrors",t,`[${t}]: Server error ${n}`,n,r)},EndpointUnreachable(e,t=""){return new Ue(Me.APIErrors.ENDPOINT_UNREACHABLE,"EndpointUnreachable",e,`Endpoint is not reachable - ${t}`,t)},InvalidTokenFormat(e,t=""){return new Ue(Me.APIErrors.INVALID_TOKEN_FORMAT,"InvalidTokenFormat",e,`Token is not in proper JWT format - ${t}`,t,!0)},InitConfigNotAvailable(e,t=""){return new Ue(Me.APIErrors.INIT_CONFIG_NOT_AVAILABLE,"InitError",e,`[INIT]: ${t}`,`[INIT]: ${t}`)}},TracksErrors:{GenericTrack(e,t=""){return new ur(Me.TracksErrors.GENERIC_TRACK,"GenericTrack",e,`[TRACK]: ${t}`,`[TRACK]: ${t}`,"audio, video")},CantAccessCaptureDevice(e,t,n=""){return new ur(Me.TracksErrors.CANT_ACCESS_CAPTURE_DEVICE,"CantAccessCaptureDevice",e,`User denied permission to access capture device - ${t}`,n,t)},DeviceNotAvailable(e,t,n=""){return new ur(Me.TracksErrors.DEVICE_NOT_AVAILABLE,"DeviceNotAvailable",e,`[TRACK]: Capture device is no longer available - ${t}`,n,t)},DeviceInUse(e,t,n=""){return new ur(Me.TracksErrors.DEVICE_IN_USE,"DeviceInUse",e,`[TRACK]: Capture device is in use by another application - ${t}`,n,t)},DeviceLostMidway(e,t,n=""){return new ur(Me.TracksErrors.DEVICE_LOST_MIDWAY,"DeviceLostMidway",e,`Lost access to capture device midway - ${t}`,n,t)},NothingToReturn(e,t="",n="There is no media to return. Please select either video or audio or both."){return new ur(Me.TracksErrors.NOTHING_TO_RETURN,"NothingToReturn",e,n,t,"audio, video")},InvalidVideoSettings(e,t=""){return new ur(Me.TracksErrors.INVALID_VIDEO_SETTINGS,"InvalidVideoSettings",e,"Cannot enable simulcast when no video settings are provided",t,"video")},AutoplayBlocked(e,t=""){return new ur(Me.TracksErrors.AUTOPLAY_ERROR,"AutoplayBlocked",e,"Autoplay blocked because the user didn't interact with the document first",t,"audio")},CodecChangeNotPermitted(e,t=""){return new ur(Me.TracksErrors.CODEC_CHANGE_NOT_PERMITTED,"CodecChangeNotPermitted",e,"Codec can't be changed mid call.",t,"audio, video")},OverConstrained(e,t,n=""){return new ur(Me.TracksErrors.OVER_CONSTRAINED,"OverConstrained",e,`[TRACK]: Requested constraints cannot be satisfied with the device hardware - ${t}`,n,t)},NoAudioDetected(e,t="Please check the mic or use another audio input"){return new ur(Me.TracksErrors.NO_AUDIO_DETECTED,"NoAudioDetected",e,"No audio input detected from microphone",t,"audio")},SystemDeniedPermission(e,t,n=""){return new ur(Me.TracksErrors.SYSTEM_DENIED_PERMISSION,"SystemDeniedPermission",e,`Operating System denied permission to access capture device - ${t}`,n,t)},CurrentTabNotShared(){return new ur(Me.TracksErrors.CURRENT_TAB_NOT_SHARED,"CurrentTabNotShared","TRACK","The app requires you to share the current tab","You must screen share the current tab in order to proceed","screen")},AudioPlaybackError(e){return new ur(Me.TracksErrors.AUDIO_PLAYBACK_ERROR,"Audio playback error","TRACK",e,e,"audio")},SelectedDeviceMissing(e){return new ur(Me.TracksErrors.SELECTED_DEVICE_MISSING,"SelectedDeviceMissing","TRACK",`Could not detect selected ${e} device`,`Please check connection to the ${e} device`,e)},NoDataInTrack(e){return new ur(Me.TracksErrors.NO_DATA,"Track does not have any data","TRACK",e,"This could possibily due to another application taking priority over the access to camera or microphone or due to an incoming call","audio, video")}},WebrtcErrors:{CreateOfferFailed(e,t=""){return new Ue(Me.WebrtcErrors.CREATE_OFFER_FAILED,"CreateOfferFailed",e,`[${e.toString()}]: Failed to create offer. `,t)},CreateAnswerFailed(e,t=""){return new Ue(Me.WebrtcErrors.CREATE_ANSWER_FAILED,"CreateAnswerFailed",e,`[${e.toString()}]: Failed to create answer. `,t)},SetLocalDescriptionFailed(e,t=""){return new Ue(Me.WebrtcErrors.SET_LOCAL_DESCRIPTION_FAILED,"SetLocalDescriptionFailed",e,`[${e.toString()}]: Failed to set offer. `,t)},SetRemoteDescriptionFailed(e,t=""){return new Ue(Me.WebrtcErrors.SET_REMOTE_DESCRIPTION_FAILED,"SetRemoteDescriptionFailed",e,`[${e.toString()}]: Failed to set answer. `,t,!0)},ICEFailure(e,t="",n=!1){return new Ue(Me.WebrtcErrors.ICE_FAILURE,"ICEFailure",e,`[${e.toString()}]: Ice connection state FAILED`,t,n)},ICEDisconnected(e,t=""){return new Ue(Me.WebrtcErrors.ICE_DISCONNECTED,"ICEDisconnected",e,`[${e.toString()}]: Ice connection state DISCONNECTED`,t)},StatsFailed(e,t=""){return new Ue(Me.WebrtcErrors.STATS_FAILED,"StatsFailed",e,`Failed to WebRTC get stats - ${t}`,t)}},WebsocketMethodErrors:{ServerErrors(e,t,n){return new Ue(e,"ServerErrors",t,n,n,IK.includes(t))},AlreadyJoined(e,t=""){return new Ue(Me.WebsocketMethodErrors.ALREADY_JOINED,"AlreadyJoined",e,"[JOIN]: You have already joined this room.",t)},CannotJoinPreviewInProgress(e,t=""){return new Ue(Me.WebsocketMethodErrors.CANNOT_JOIN_PREVIEW_IN_PROGRESS,"CannotJoinPreviewInProgress",e,"[JOIN]: Cannot join if preview is in progress",t)}},GenericErrors:{NotConnected(e,t=""){return new Ue(Me.GenericErrors.NOT_CONNECTED,"NotConnected",e,"Client is not connected",t)},Signalling(e,t){return new Ue(Me.GenericErrors.SIGNALLING,"Signalling",e,`Unknown signalling error: ${e.toString()} ${t} `,t)},Unknown(e,t){return new Ue(Me.GenericErrors.UNKNOWN,"Unknown",e,`Unknown exception: ${t}`,t)},NotReady(e,t=""){return new Ue(Me.GenericErrors.NOT_READY,"NotReady",e,t,t)},JsonParsingFailed(e,t,n=""){return new Ue(Me.GenericErrors.JSON_PARSING_FAILED,"JsonParsingFailed",e,`Failed to parse JSON message - ${t}`,n)},TrackMetadataMissing(e,t=""){return new Ue(Me.GenericErrors.TRACK_METADATA_MISSING,"TrackMetadataMissing",e,"Track Metadata Missing",t)},RTCTrackMissing(e,t=""){return new Ue(Me.GenericErrors.RTC_TRACK_MISSING,"RTCTrackMissing",e,"RTC Track missing",t)},PeerMetadataMissing(e,t=""){return new Ue(Me.GenericErrors.PEER_METADATA_MISSING,"PeerMetadataMissing",e,"Peer Metadata Missing",t)},ValidationFailed(e,t){return new Ue(Me.GenericErrors.VALIDATION_FAILED,"ValidationFailed","VALIDATION",e,t?JSON.stringify(t):"")},InvalidRole(e,t){return new Ue(Me.GenericErrors.INVALID_ROLE,"InvalidRole",e,"Invalid role. Join with valid role",t,!0)},PreviewAlreadyInProgress(e,t=""){return new Ue(Me.GenericErrors.PREVIEW_IN_PROGRESS,"PreviewAlreadyInProgress",e,"[Preview]: Cannot join if preview is in progress",t)},LocalStorageAccessDenied(e="Access to localStorage has been denied"){return new Ue(Me.GenericErrors.LOCAL_STORAGE_ACCESS_DENIED,"LocalStorageAccessDenied","NONE","LocalStorageAccessDenied",e)},MissingMediaDevices(){return new Ue(Me.GenericErrors.MISSING_MEDIADEVICES,"MissingMediaDevices","JOIN","navigator.mediaDevices is undefined. 100ms SDK won't work on this website as WebRTC is not supported on HTTP endpoints(missing navigator.mediaDevices). Please ensure you're using the SDK either on localhost or a valid HTTPS endpoint.","",!0)},MissingRTCPeerConnection(){return new Ue(Me.GenericErrors.MISSING_RTCPEERCONNECTION,"MissingRTCPeerConnection","JOIN","RTCPeerConnection which is a core requirement for WebRTC call was not found, this could be due to an unsupported browser or browser extensions blocking WebRTC","",!0)}},MediaPluginErrors:{PlatformNotSupported(e,t=""){return new Ue(7001,"PlatformNotSupported",e,"Check HMS Docs to see the list of supported platforms",t)},InitFailed(e,t=""){return new Ue(7002,"InitFailed",e,"Plugin init failed",t)},ProcessingFailed(e,t=""){return new Ue(7003,"ProcessingFailed",e,"Plugin processing failed",t)},AddAlreadyInProgress(e,t=""){return new Ue(7004,"AddAlreadyInProgress",e,"Plugin add already in progress",t)},DeviceNotSupported(e,t=""){return new Ue(7005,"DeviceNotSupported",e,"Check HMS Docs to see the list of supported devices",t)}},PlaylistErrors:{NoEntryToPlay(e,t){return new Ue(Me.PlaylistErrors.NO_ENTRY_TO_PLAY,"NoEntryToPlay",e,"Reached end of playlist",t)},NoEntryPlaying(e,t){return new Ue(Me.PlaylistErrors.NO_ENTRY_IS_PLAYING,"NoEntryIsPlaying",e,"No entry is playing at this time",t)}}},AK=class{constructor(){this.valuesMap=new Map}getItem(e){return this.valuesMap.has(e)?String(this.valuesMap.get(e)):null}setItem(e,t){this.valuesMap.set(e,t)}removeItem(e){this.valuesMap.delete(e)}clear(){this.valuesMap.clear()}key(e){if(arguments.length===0)throw new TypeError("Failed to execute 'key' on 'Storage': 1 argument required, but only 0 present.");return Array.from(this.valuesMap.keys())[e]}get length(){return this.valuesMap.size}},RK=()=>{try{Is&&!localStorage&&(window.localStorage=new AK)}catch{_.e("Error initialising localStorage",oe.GenericErrors.LocalStorageAccessDenied())}},xv=class{constructor(e){this.key=e,this.storage=null}getStorage(){try{return Is&&!this.storage&&(RK(),this.storage=window.localStorage),this.storage}catch{return _.e("Error initialising localStorage",oe.GenericErrors.LocalStorageAccessDenied()),null}}get(){var e;let t=(e=this.getStorage())==null?void 0:e.getItem(this.key);return t?JSON.parse(t):void 0}set(e){var t;let n=JSON.stringify(e);(t=this.getStorage())==null||t.setItem(this.key,n)}clear(){var e;(e=this.getStorage())==null||e.removeItem(this.key)}},LL=()=>{let e,t=new xv("hms-analytics-deviceId"),n=t.get();return n?e=n:(e=Lo(),t.set(e)),e},FL="[VALIDATIONS]";function Co(e){return e!=null}var Tw=()=>{if(!Co(RTCPeerConnection)){let e=oe.GenericErrors.MissingRTCPeerConnection();throw _.e(FL,e),e}},Cw=()=>{if(!Co(navigator.mediaDevices)){let e=oe.GenericErrors.MissingMediaDevices();throw _.e(FL,e),e}},jK=e=>{if(!e.getPublishParams())throw oe.GenericErrors.NotConnected("VALIDATION","call addTrack after preview or join is successful")},m_=PL().version;function Ew(e="prod",t){let n="web",r=rm!=="LOCAL"&&e==="prod"?"prod":"debug";if(Z0)return g_({os:"web_nodejs",os_version:process.version,sdk:n,sdk_version:m_,env:r,domain:rm,is_prebuilt:!!(t!=null&&t.isPrebuilt),framework:"node",framework_version:process.version,framework_sdk_version:t==null?void 0:t.sdkVersion});let s=po.getOS(),i=po.getDevice(),o=po.getBrowser(),l=ox(`web_${s.name}`),c=s.version||"",d=ox(`${o.name}_${o.version}`),u=d;return i.type&&(u=`${ox(`${i.vendor}_${i.type}`)}/${d}`),g_({os:l,os_version:c,sdk:n,sdk_version:m_,device_model:u,env:r,domain:rm,is_prebuilt:!!(t!=null&&t.isPrebuilt),framework:t==null?void 0:t.type,framework_version:t==null?void 0:t.version,framework_sdk_version:t==null?void 0:t.sdkVersion})}function ox(e){return e.replace(/ /g,"_")}var g_=(e,t=",")=>Object.keys(e).filter(n=>Co(e[n])).map(n=>`${n}:${e[n]}`).join(t),Et=class{constructor({name:e,level:t,properties:n,includesPII:r,timestamp:s}){this.metadata={peer:{},userAgent:Ew()},this.name=e,this.level=t,this.includesPII=r||!1,this.properties=n||{},this.timestamp=s||new Date().getTime(),this.event_id=Lo(),this.device_id=LL()}toSignalParams(){return{name:this.name,info:Ke(de({},this.properties),{timestamp:this.timestamp,domain:rm}),timestamp:new Date().getTime()}}},Be=class{static connect(e,t,n=new Date,r=new Date,s){let i=this.eventNameFor("connect",e===void 0),o=e?2:1,l=this.getPropertiesWithError(Ke(de({},t),{[this.KEY_REQUESTED_AT]:n==null?void 0:n.getTime(),[this.KEY_RESPONDED_AT]:r==null?void 0:r.getTime(),endpoint:s}),e);return new Et({name:i,level:o,properties:l})}static disconnect(e,t){let n="disconnected",r=e?2:1,s=this.getPropertiesWithError(t,e);return new Et({name:n,level:r,properties:s})}static preview(e){var t=e,{error:n}=t,r=l_(t,["error"]);let s=this.eventNameFor("preview",n===void 0),i=n?2:1,o=this.getPropertiesWithError(r,n);return new Et({name:s,level:i,properties:o})}static join(e){var t=e,{error:n}=t,r=l_(t,["error"]);let s=this.eventNameFor("join",n===void 0),i=n?2:1,o=this.getPropertiesWithError(Ke(de({},r),{is_preview_called:!!r.is_preview_called}),n);return new Et({name:s,level:i,properties:o})}static publish({devices:e,settings:t,error:n}){let r=this.eventNameFor("publish",n===void 0),s=n?2:1,i=this.getPropertiesWithError({devices:e,audio:t==null?void 0:t.audio,video:t==null?void 0:t.video},n);return new Et({name:r,level:s,properties:i})}static hlsPlayerError(e){return new Et({name:"hlsPlayerError",level:2,properties:this.getErrorProperties(e)})}static subscribeFail(e){let t=this.eventNameFor("subscribe",!1),n=2,r=this.getErrorProperties(e);return new Et({name:t,level:n,properties:r})}static leave(){return new Et({name:"leave",level:1})}static autoplayError(){return new Et({name:"autoplayError",level:2})}static audioPlaybackError(e){return new Et({name:"audioPlaybackError",level:2,properties:this.getErrorProperties(e)})}static audioRecovered(e){return new Et({name:"audioRecovered",level:1,properties:{message:e}})}static permissionChange(e,t){return new Et({name:"permissionChanged",level:1,properties:{message:`Perrmission for ${e} changed to ${t}`}})}static deviceChange({isUserSelection:e,selection:t,type:n,devices:r,error:s}){let i=this.eventNameFor(s?"publish":`device.${n}`,s===void 0),o=s?2:1,l=this.getPropertiesWithError({selection:t,devices:r,isUserSelection:e},s);return new Et({name:i,level:o,properties:l})}static performance(e){let t="perf.stats",n=1,r=e.toAnalyticsProperties();return new Et({name:t,level:n,properties:r})}static rtcStats(e){let t="rtc.stats",n=1,r=e.toAnalyticsProperties();return new Et({name:t,level:n,properties:r})}static rtcStatsFailed(e){let t="rtc.stats.failed",n=2;return new Et({name:t,level:n,properties:this.getErrorProperties(e)})}static degradationStats(e,t){let n="video.degradation.stats",r=1,s={degradedAt:e.degradedAt,trackId:e.trackId};if(!t&&e.degradedAt instanceof Date){let i=new Date,o=i.valueOf()-e.degradedAt.valueOf();s=Ke(de({},s),{duration:o,restoredAt:i})}return new Et({name:n,level:r,properties:s})}static audioDetectionFail(e,t){let n=this.getPropertiesWithError({device:t},e),r=2,s="audiopresence.failed";return new Et({name:s,level:r,properties:n})}static previewNetworkQuality(e){return new Et({name:"perf.networkquality.preview",level:e.error?2:1,properties:e})}static publishStats(e){return new Et({name:"publisher.stats",level:1,properties:e})}static subscribeStats(e){return new Et({name:"subscriber.stats",level:1,properties:e})}static getKrispUsage(e){return new Et({name:"krisp.usage",level:1,properties:{duration:e}})}static krispStart(){return new Et({name:"krisp.start",level:1})}static krispStop(){return new Et({name:"krisp.stop",level:1})}static interruption({started:e,type:t,reason:n,deviceInfo:r}){return new Et({name:`${e?"interruption.start":"interruption.stop"}`,level:1,properties:de({reason:n,type:t},r)})}static eventNameFor(e,t){return`${e}.${t?"success":"failed"}`}static getPropertiesWithError(e,t){let n=this.getErrorProperties(t);return e=de(de({},n),e),e}static getErrorProperties(e){return e?e instanceof Ue?e.toAnalyticsProperties():{error_name:e.name,error_message:e.message,error_description:e.cause}:{}}};Be.KEY_REQUESTED_AT="requested_at",Be.KEY_RESPONDED_AT="responded_at";var $L=e=>e?`{
    trackId: ${e.id};
    kind: ${e.kind};
    enabled: ${e.enabled};
    muted: ${e.muted};
    readyState: ${e.readyState};
  }`:"",ek=class{constructor(e,t,n){this.logIdentifier="",this.isTrackNotPublishing=()=>this.nativeTrack.readyState==="ended"||this.nativeTrack.muted,this.stream=e,this.nativeTrack=t,this.source=n}get enabled(){return this.nativeTrack.enabled}get trackId(){return this.firstTrackId||this.sdpTrackId||this.nativeTrack.id}getMediaTrackSettings(){return this.nativeTrack.getSettings()}setEnabled(e){return T(this,null,function*(){this.nativeTrack.enabled=e})}setSdpTrackId(e){this.sdpTrackId=e}setFirstTrackId(e){this.firstTrackId=e}sendInterruptionEvent({started:e,reason:t}){return Be.interruption({started:e,type:this.type,reason:t,deviceInfo:{deviceId:this.nativeTrack.getSettings().deviceId,groupId:this.nativeTrack.getSettings().groupId}})}cleanup(){var e;_.d("[HMSTrack]","Stopping track",this.toString()),(e=this.nativeTrack)==null||e.stop()}toString(){var e;return`{
      streamId: ${this.stream.id};
      peerId: ${this.peerId};
      trackId: ${this.trackId};
      mid: ${((e=this.transceiver)==null?void 0:e.mid)||"-"};
      logIdentifier: ${this.logIdentifier};
      source: ${this.source};
      enabled: ${this.enabled};
      nativeTrack: ${$L(this.nativeTrack)};
    }`}},tk=class extends ek{constructor(e,t,n){if(super(e,t,n),this.type="audio",this.audioElement=null,t.kind!=="audio")throw new Error("Expected 'track' kind = 'audio'")}getVolume(){return this.audioElement?Math.floor(this.audioElement.volume*100):null}setVolume(e){return T(this,null,function*(){if(e<0||e>100)throw Error("Please pass a valid number between 0-100");yield this.subscribeToAudio(e===0?!1:this.enabled),this.audioElement&&(this.audioElement.volume=e/100)})}setAudioElement(e){_.d("[HMSAudioTrack]",this.logIdentifier,"adding audio element",`${this}`,e),this.audioElement=e}getAudioElement(){return this.audioElement}getOutputDevice(){return this.outputDevice}cleanup(){super.cleanup(),this.audioElement&&(this.audioElement.srcObject=null,this.audioElement.remove(),this.audioElement=null)}setOutputDevice(e){return T(this,null,function*(){var t;if(!e){_.d("[HMSAudioTrack]",this.logIdentifier,"device is null",`${this}`);return}if(!this.audioElement){_.d("[HMSAudioTrack]",this.logIdentifier,"no audio element to set output",`${this}`),this.outputDevice=e;return}try{typeof this.audioElement.setSinkId=="function"&&(DL||(yield(t=this.audioElement)==null?void 0:t.setSinkId(e.deviceId)),this.outputDevice=e)}catch(n){_.d("[HMSAudioTrack]","error in setSinkId",n)}})}subscribeToAudio(e){return T(this,null,function*(){this.stream instanceof ik&&(yield this.stream.setAudio(e,this.trackId,this.logIdentifier))})}},MK=class{constructor(){this.storage=new xv("hms-device-selection"),this.remember=!1,this.TAG="[HMSDeviceStorage]"}setDevices(e){this.devices=e}rememberDevices(e){this.remember=e}updateSelection(e,{deviceId:t,groupId:n}){if(!this.devices||!this.remember)return;let r=this.devices[e].find(i=>this.isSame({deviceId:t,groupId:n},i));if(!r){_.w(this.TAG,`Could not find device with deviceId: ${t}, groupId: ${n}`);return}let s=this.storage.get()||{};s[e]=r,this.storage.set(s)}getSelection(){if(this.remember)return this.storage.get()}cleanup(){this.remember=!1,this.devices=void 0}isSame(e,t){return e.deviceId===t.deviceId&&(e.groupId===t.groupId||!e.groupId)}},pa=new MK,DK=(e=>(e.TRANSFORM="TRANSFORM",e.ANALYZE="ANALYZE",e))(DK||{}),OK=(e=>(e.PLATFORM_NOT_SUPPORTED="PLATFORM_NOT_SUPPORTED",e.DEVICE_NOT_SUPPORTED="DEVICE_NOT_SUPPORTED",e))(OK||{}),Uc=class{static failure(e,t){let n="mediaPlugin.failed",r=2,s=de({plugin_name:e},t.toAnalyticsProperties());return new Et({name:n,level:r,properties:s})}static audioPluginFailure(e,t,n){let r="mediaPlugin.failed",s=2,i=de({plugin_name:e,sampleRate:t},n.toAnalyticsProperties());return new Et({name:r,level:s,properties:i})}static audioPluginStats({pluginName:e,duration:t,loadTime:n,sampleRate:r}){let s="mediaPlugin.stats",i=1,o={plugin_name:e,duration:t,load_time:n,sampleRate:r};return new Et({name:s,level:i,properties:o})}static added(e,t){let n="mediaPlugin.added",r=1,s={plugin_name:e,added_at:t};return new Et({name:n,level:r,properties:s})}static stats({pluginName:e,duration:t,loadTime:n,avgPreProcessingTime:r,avgProcessingTime:s,inputFrameRate:i,pluginFrameRate:o}){let l="mediaPlugin.stats",c=1,d={plugin_name:e,duration:t,load_time:n,avg_preprocessing_time:r,avg_processing_time:s,input_frame_rate:i,plugin_frame_rate:o};return new Et({name:l,level:c,properties:d})}},LK=class{constructor(e){this.eventBus=e,this.TAG="[AudioPluginsAnalytics]",this.initTime={},this.addedTimestamps={},this.pluginAdded={},this.pluginSampleRate={}}added(e,t){this.pluginAdded[e]=!0,this.addedTimestamps[e]=Date.now(),this.initTime[e]=0,this.pluginSampleRate[e]=t,this.eventBus.analytics.publish(Uc.added(e,this.addedTimestamps[e]))}removed(e){if(this.pluginAdded[e]){let t={pluginName:e,duration:Math.floor((Date.now()-this.addedTimestamps[e])/1e3),loadTime:this.initTime[e],sampleRate:this.pluginSampleRate[e]};this.eventBus.analytics.publish(Uc.audioPluginStats(t)),this.clean(e)}}failure(e,t){this.pluginAdded[e]&&(this.eventBus.analytics.publish(Uc.audioPluginFailure(e,this.pluginSampleRate[e],t)),this.clean(e))}initWithTime(e,t){return T(this,null,function*(){if(this.initTime[e]){_.i(this.TAG,`Plugin Already loaded ${e}, time it took: ${this.initTime[e]}`);return}let n;try{n=yield this.timeInMs(t),_.i(this.TAG,`Time taken for Plugin ${e} initialization : ${n}`)}catch(r){let s=oe.MediaPluginErrors.InitFailed("AUDIO_PLUGINS",`failed during initialization of plugin${r.message||r}`);throw _.e(this.TAG,s),this.failure(e,s),s}n&&(this.initTime[e]=n)})}timeInMs(e){return T(this,null,function*(){let t=Date.now();return yield e(),Math.floor(Date.now()-t)})}clean(e){delete this.addedTimestamps[e],delete this.initTime[e],delete this.pluginAdded[e],delete this.pluginSampleRate[e]}},FK=class{constructor(e,t,n){this.eventBus=t,this.TAG="[AudioPluginsManager]",this.pluginAddInProgress=!1,this.hmsTrack=e,this.pluginsMap=new Map,this.analytics=new LK(t),this.audioContext=qd.getAudioContext(),this.room=n}getPlugins(){return Array.from(this.pluginsMap.keys())}addPlugin(e){return T(this,null,function*(){var t,n;let r=(t=e.getName)==null?void 0:t.call(e);if(!r){_.w("no name provided by the plugin");return}if(this.pluginAddInProgress){let s=oe.MediaPluginErrors.AddAlreadyInProgress("AUDIO_PLUGINS","Add Plugin is already in Progress");throw this.analytics.added(r,this.audioContext.sampleRate),this.analytics.failure(r,s),_.w("can't add another plugin when previous add is in progress"),s}switch(e.getName()){case"HMSKrispPlugin":{if(!((n=this.room)!=null&&n.isNoiseCancellationEnabled)){let s="Krisp Noise Cancellation is not enabled for this room";if(this.pluginsMap.size===0)throw Error(s);_.w(this.TAG,s);return}this.eventBus.analytics.publish(Be.krispStart());break}}this.pluginAddInProgress=!0;try{yield this.addPluginInternal(e)}finally{this.pluginAddInProgress=!1}})}addPluginInternal(e){return T(this,null,function*(){var t,n;let r=(t=e.getName)==null?void 0:t.call(e);if(this.pluginsMap.get(r)){_.w(this.TAG,`plugin - ${r} already added.`);return}yield this.validateAndThrow(r,e),(n=e.setEventBus)==null||n.call(e,this.eventBus);try{this.pluginsMap.size===0?yield this.initAudioNodes():this.prevAudioNode&&this.prevAudioNode.disconnect(),this.analytics.added(r,this.audioContext.sampleRate),yield this.analytics.initWithTime(r,()=>T(this,null,function*(){return e.init()})),this.pluginsMap.set(r,e),yield this.processPlugin(e),yield this.connectToDestination(),yield this.updateProcessedTrack()}catch(s){throw _.e(this.TAG,"failed to add plugin",s),s}})}validatePlugin(e){return e.checkSupport(this.audioContext)}validateAndThrow(e,t){return T(this,null,function*(){let n=this.validatePlugin(t);if(n.isSupported)_.i(this.TAG,`plugin is supported,- ${t.getName()}`);else if(this.analytics.added(e,this.audioContext.sampleRate),n.errType==="PLATFORM_NOT_SUPPORTED"){let r=oe.MediaPluginErrors.PlatformNotSupported("AUDIO_PLUGINS","platform not supported, see docs");throw this.analytics.failure(e,r),yield this.cleanup(),r}else if(n.errType==="DEVICE_NOT_SUPPORTED"){let r=oe.MediaPluginErrors.DeviceNotSupported("AUDIO_PLUGINS","audio device not supported, see docs");throw this.analytics.failure(e,r),yield this.cleanup(),r}})}removePlugin(e){return T(this,null,function*(){switch(e.getName()){case"HMSKrispPlugin":{this.eventBus.analytics.publish(Be.krispStop());break}}yield this.removePluginInternal(e),this.pluginsMap.size===0?(yield this.cleanup(),_.i(this.TAG,"No plugins left, stopping plugins loop"),yield this.hmsTrack.setProcessedTrack(void 0)):yield this.reprocessPlugins()})}cleanup(){return T(this,null,function*(){var e,t,n;for(let r of this.pluginsMap.values())yield this.removePluginInternal(r);yield this.hmsTrack.setProcessedTrack(void 0),(e=this.sourceNode)==null||e.disconnect(),(t=this.prevAudioNode)==null||t.disconnect(),(n=this.outputTrack)==null||n.stop(),this.sourceNode=void 0,this.destinationNode=void 0,this.prevAudioNode=void 0,this.outputTrack=void 0})}closeContext(){return T(this,null,function*(){this.audioContext=void 0})}reprocessPlugins(){return T(this,null,function*(){if(this.pluginsMap.size===0||!this.sourceNode)return;let e=Array.from(this.pluginsMap.values());yield this.cleanup(),yield this.initAudioNodes();for(let t of e)yield this.addPlugin(t);yield this.updateProcessedTrack()})}initAudioNodes(){return T(this,null,function*(){if(this.audioContext){let e=new MediaStream([this.hmsTrack.nativeTrack]);this.sourceNode=this.audioContext.createMediaStreamSource(e),this.destinationNode||(this.destinationNode=this.audioContext.createMediaStreamDestination(),this.outputTrack=this.destinationNode.stream.getAudioTracks()[0])}})}updateProcessedTrack(){return T(this,null,function*(){try{yield this.hmsTrack.setProcessedTrack(this.outputTrack)}catch(e){throw _.e(this.TAG,"error in setting processed track",e),e}})}processPlugin(e){return T(this,null,function*(){try{let t=yield e.processAudioTrack(this.audioContext,this.prevAudioNode||this.sourceNode);this.prevAudioNode&&this.prevAudioNode.connect(t),this.prevAudioNode=t}catch(t){let n=e.getName();_.e(this.TAG,`error in processing plugin ${n}`,t),yield this.removePluginInternal(e)}})}connectToDestination(){return T(this,null,function*(){try{this.prevAudioNode&&this.destinationNode&&this.prevAudioNode.context===this.destinationNode.context&&this.prevAudioNode.connect(this.destinationNode)}catch(e){_.e(this.TAG,"error in connecting to destination node",e)}})}removePluginInternal(e){return T(this,null,function*(){var t;let n=(t=e.getName)==null?void 0:t.call(e);if(!this.pluginsMap.get(n)){_.w(this.TAG,`plugin - ${n} not found to remove.`);return}_.i(this.TAG,`removing plugin ${n}`),this.pluginsMap.delete(n),e.stop(),this.analytics.removed(n)})}},$K=["init_response_time","ws_connect_time","on_policy_change_time","local_audio_track_time","local_video_track_time","peer_list_time","room_state_time","join_response_time"],UK=class{constructor(){this.eventPerformanceMeasures={}}start(e){try{typeof performance<"u"&&performance.mark&&performance.mark(e)}catch(t){_.w("[AnalyticsTimer]",`Error marking performance for event ${e}`,{error:t})}}end(e){var t;try{typeof performance<"u"&&performance.measure&&(this.eventPerformanceMeasures[e]=performance.measure(e,e),_.d("[HMSPerformanceTiming]",e,(t=this.eventPerformanceMeasures[e])==null?void 0:t.duration))}catch(n){_.w("[AnalyticsTimer]",`Error in measuring performance for event ${e}`,{error:n})}}getTimeTaken(e){var t;return(t=this.eventPerformanceMeasures[e])==null?void 0:t.duration}getTimes(...e){return[...$K,...e].reduce((t,n)=>Ke(de({},t),{[n]:this.getTimeTaken(n)}),{})}cleanup(){this.eventPerformanceMeasures={}}};function VK(e,t){let n=e.toLowerCase(),r=oe.TracksErrors.GenericTrack("TRACK",e);return n.includes("device not found")?r=oe.TracksErrors.DeviceNotAvailable("TRACK",t,e):n.includes("permission denied")&&(r=oe.TracksErrors.CantAccessCaptureDevice("TRACK",t,e)),r}function BK(e,t=""){if(YE.browserDetails.browser==="chrome"&&e.name==="NotAllowedError"&&e.message.includes("denied by system"))return oe.TracksErrors.SystemDeniedPermission("TRACK",t,e.message);if(YE.browserDetails.browser==="firefox"&&e.name==="NotFoundError"){let n=oe.TracksErrors.SystemDeniedPermission("TRACK",t,e.message);return n.description=`Capture device is either blocked at Operating System level or not available - ${t}`,n}switch(e.name){case"OverconstrainedError":return oe.TracksErrors.OverConstrained("TRACK",t,e.constraint);case"NotAllowedError":return oe.TracksErrors.CantAccessCaptureDevice("TRACK",t,e.message);case"NotFoundError":return oe.TracksErrors.DeviceNotAvailable("TRACK",t,e.message);case"NotReadableError":return oe.TracksErrors.DeviceInUse("TRACK",t,e.message);case"TypeError":return oe.TracksErrors.NothingToReturn("TRACK",e.message);default:return VK(e.message,t)}}function Nh(e,t){let n=BK(e,t);return n.addNativeError(e),n}var zK=(e=>(e.SIP="sip",e.REGULAR="regular",e))(zK||{}),GK=(e=>(e.NONE="none",e.INITIALISED="initialised",e.STARTED="started",e.PAUSED="paused",e.RESUMED="resumed",e.STOPPED="stopped",e.FAILED="failed",e))(GK||{}),WK=(e=>(e.DVR="dvr",e.NO_DVR="no-dvr",e))(WK||{}),HK=(e=>(e.REGULAR="regular",e.SCREEN="screen",e.COMPOSITE="composite",e))(HK||{}),qK=(e=>(e.INITIALISED="initialised",e.STARTED="started",e.STOPPED="stopped",e.FAILED="failed",e))(qK||{}),KK=(e=>(e.CAPTION="caption",e))(KK||{}),QK={f:"high",h:"medium",q:"low"},JK=(e=>(e.VOICE="voice",e.MUSIC="music",e))(JK||{}),YK=(e=>(e.videoInput="videoInput",e.audioInput="audioInput",e.audioOutput="audioOutput",e))(YK||{}),Dl=class{constructor(){this._volume=1,this._codec="opus",this._maxBitrate=32,this._deviceId="default",this._audioMode="voice",this._advanced=[{autoGainControl:{exact:!0}},{noiseSuppression:{exact:!0}},{highpassFilter:{exact:!0}},{audioMirroring:{exact:!0}}]}volume(e){if(!(0<=e&&e<=1))throw Error("volume can only be in range [0.0, 1.0]");return this._volume=e,this}codec(e){return this._codec=e,this}maxBitrate(e){if(e&&e<=0)throw Error("maxBitrate should be >= 1");return this._maxBitrate=this._audioMode==="music"?320:e,this}deviceId(e){return this._deviceId=e,this}audioMode(e="voice"){return this._audioMode=e,this._audioMode==="music"?this._maxBitrate=320:this._maxBitrate=32,this}advanced(e){return this._advanced=e,this}build(){return new nk(this._volume,this._codec,this._maxBitrate,this._deviceId,this._advanced,this._audioMode)}},nk=class{constructor(e,t,n,r,s,i){this.volume=e,this.codec=t,this.maxBitrate=n,this.deviceId=r,this.advanced=s,this.audioMode=i,this.audioMode==="music"?this.maxBitrate=320:this.maxBitrate=32}toConstraints(){return{deviceId:this.deviceId==="default"?this.deviceId:{exact:this.deviceId},advanced:this.audioMode==="music"?[]:this.advanced}}toAnalyticsProperties(){return{audio_bitrate:this.maxBitrate,audio_codec:this.codec}}},Eo=class{constructor(){this._width=320,this._height=180,this._codec="vp8",this._maxFramerate=30,this._maxBitrate=150,this._advanced=[]}setWidth(e){return this._width=e,this}setHeight(e){return this._height=e,this}codec(e){return this._codec=e,this}maxFramerate(e){if(e&&e<=0)throw Error("maxFramerate should be >= 1");return this._maxFramerate=e,this}maxBitrate(e,t=!0){if(typeof e=="number"&&e<=0)throw Error("maxBitrate should be >= 1");return this._maxBitrate=e,!this._maxBitrate&&t&&(this._maxBitrate=15e4),this}deviceId(e){return this._deviceId=e,this}advanced(e){return this._advanced=e,this}facingMode(e){return this._facingMode=e,this}build(){return new rk(this._width,this._height,this._codec,this._maxFramerate,this._deviceId,this._advanced,this._maxBitrate,this._facingMode)}},rk=class{constructor(e,t,n,r,s,i,o,l){this.width=e,this.height=t,this.codec=n,this.maxFramerate=r,this.maxBitrate=o,this.deviceId=s,this.advanced=i,this.facingMode=l}toConstraints(e){let t="ideal";e&&(t="max");let n=this.improviseConstraintsAspect();return{width:{[t]:n.width},height:{[t]:n.height},frameRate:this.maxFramerate,deviceId:this.deviceId==="default"?this.deviceId:{exact:this.deviceId},facingMode:this.facingMode}}toAnalyticsProperties(){return{width:this.width,height:this.height,video_bitrate:this.maxBitrate,framerate:this.maxFramerate,video_codec:this.codec,facingMode:this.facingMode}}improviseConstraintsAspect(){return kw()&&this.height&&this.width&&this.height>this.width?{width:this.height,height:this.width}:{width:this.width,height:this.height}}},sg=class{constructor(){this._video=new Eo().build(),this._audio=new Dl().build(),this._screen=new Eo().build(),this._simulcast=!1}video(e){return this._video=e,this}audio(e){return this._audio=e,this}screen(e){return this._screen=e,this}simulcast(e){return this._simulcast=e,this}build(){if(this._audio===null&&this._video===null)throw oe.TracksErrors.NothingToReturn("TRACK");if(this._video===null&&this._simulcast)throw oe.TracksErrors.InvalidVideoSettings("TRACK","Cannot enable simulcast when no video settings are provided");return new _w(this._video,this._audio,this._simulcast,this._screen||void 0)}},_w=class{constructor(e,t,n,r=null){this.video=e,this.audio=t,this.simulcast=n,this.screen=r}toAnalyticsProperties(){let e={audio_enabled:this.audio!==null,video_enabled:this.video!==null};return this.audio&&(e=de(de({},this.audio.toAnalyticsProperties()),e)),this.video&&(e=de(de({},this.video.toAnalyticsProperties()),e)),e}},XK=32e3,qd={audioContext:null,getAudioContext(){return this.audioContext||(this.audioContext=DL?new AudioContext:new AudioContext({sampleRate:XK})),this.audioContext},resumeContext(){return T(this,null,function*(){try{return yield this.getAudioContext().resume()}catch(e){_.e("AudioContext",e)}})}},ZK=(e=>(e.SPEAKERPHONE="SPEAKERPHONE",e.WIRED="WIRED",e.BLUETOOTH="BLUETOOTH",e.EARPIECE="EARPIECE",e))(ZK||{}),eQ=e=>{if(!e)return _.w("[DeviceManager]:","No device label provided"),"SPEAKERPHONE";let t=e.toLowerCase();return t.includes("speakerphone")?"SPEAKERPHONE":t.includes("wired")?"WIRED":/airpods|buds|wireless|bluetooth/gi.test(t)?"BLUETOOTH":t.includes("earpiece")?"EARPIECE":"SPEAKERPHONE"},lx={isAudioMuted:!1,isVideoMuted:!1,audioInputDeviceId:"default",audioOutputDeviceId:"default",videoDeviceId:"default",audioMode:"voice"},Li,kp,Ih=class Pw{constructor(t,n,r,s,i){this.store=t,this.observer=n,this.deviceManager=r,this.eventBus=s,this.analyticsTimer=i,this.TAG="[LocalTrackManager]",this.setScreenCaptureHandleConfig()}getTracksToPublish(){return T(this,arguments,function*(t=lx){let n=this.getAVTrackSettings(t);if(!n)return[];let r=!!n.audio,s=!!n.video,i=[],{videoTrack:o,audioTrack:l}=yield this.updateCurrentLocalTrackSettings(n),c=(o==null?void 0:o.stream)||(l==null?void 0:l.stream),d=!!(o&&this.store.getTrackById(o.trackId)),u=!!(l&&this.store.getTrackById(l.trackId));if(d&&u)return[];let h={audio:r&&!l&&(t.isAudioMuted?"empty":!0),video:s&&!o&&(t.isVideoMuted?"empty":!0)};h.audio&&this.analyticsTimer.start("local_audio_track_time"),h.video&&this.analyticsTimer.start("local_video_track_time");try{_.d(this.TAG,"Init Local Tracks",{fetchTrackOptions:h}),i=yield this.getLocalTracks(h,n,c)}catch(f){i=yield this.retryGetLocalTracks(f,n,h,c)}return h.audio&&this.analyticsTimer.end("local_audio_track_time"),h.video&&this.analyticsTimer.end("local_video_track_time"),o&&s&&!d&&i.push(o),l&&r&&!u&&i.push(l),i})}getLocalTracks(){return T(this,arguments,function*(t={audio:!0,video:!0},n,r){try{let s=yield this.getNativeLocalTracks(t,n);return this.createHMSLocalTracks(s,n,r)}catch(s){throw this.eventBus.analytics.publish(Be.publish({devices:this.deviceManager.getDevices(),error:s,settings:n})),s}})}getNativeLocalTracks(){return T(this,arguments,function*(t={audio:!1,video:!1},n){let r=new _w(t.video===!0?n.video:null,t.audio===!0?n.audio:null,n.simulcast),s=[];return(r.audio||r.video)&&s.push(...yield this.getAVTracks(r)),s.push(...this.getEmptyTracks(t)),s})}optimizeScreenShareConstraint(t,n){return T(this,null,function*(){var r,s,i;if(typeof n.video=="boolean"||!((r=n.video)!=null&&r.width)||!((s=n.video)!=null&&s.height))return;let o=this.store.getPublishParams();if(!o||!((i=o.allowed)!=null&&i.includes("screen")))return;let l=document.createElement("video");l.srcObject=t,l.addEventListener("loadedmetadata",()=>T(this,null,function*(){let{videoWidth:c,videoHeight:d}=l,u=o.screen,h=u.width*u.height,f=c/d,m=u.width/u.height;if(f>m){let g=n.video,v=f/m,x=Math.sqrt(v);c*d>h?(g.width=c/x,g.height=d/x):(g.height=d*x,g.width=c*x),yield t.getVideoTracks()[0].applyConstraints(g)}}))})}getLocalScreen(t,n=!1){return T(this,null,function*(){var r;let s=yield this.getOrDefaultScreenshareConfig(t),i=this.getScreenshareSettings(s.videoOnly),o={video:Ke(de({},i==null?void 0:i.video.toConstraints(!0)),{displaySurface:s.displaySurface}),preferCurrentTab:s.preferCurrentTab,selfBrowserSurface:s.selfBrowserSurface,surfaceSwitching:s.surfaceSwitching,systemAudio:s.systemAudio};if(i!=null&&i.audio){let m=(r=i==null?void 0:i.audio)==null?void 0:r.toConstraints();delete m.advanced,o.audio=Ke(de({},m),{autoGainControl:!1,noiseSuppression:!1,googAutoGainControl:!1,echoCancellation:!1})}else t!=null&&t.forceCurrentTab&&t.preferCurrentTab&&t.cropElement&&(o.audio={echoCancellation:!0,noiseSuppression:!0});let l;try{_.d("retrieving screenshare with ",{config:s},{constraints:o}),l=yield navigator.mediaDevices.getDisplayMedia(o),n&&(yield this.optimizeScreenShareConstraint(l,o))}catch(m){_.w(this.TAG,"error in getting screenshare - ",m);let g=Nh(m,"screen");throw this.eventBus.analytics.publish(Be.publish({error:g,devices:this.deviceManager.getDevices(),settings:new _w(i==null?void 0:i.video,i==null?void 0:i.audio,!1)})),g}let c=[],d=new Bc(l),u=l.getVideoTracks()[0],h=new Ss(d,u,"screen",this.eventBus,i==null?void 0:i.video,this.store.getRoom());h.setSimulcastDefinitons(this.store.getSimulcastDefinitionsForPeer(this.store.getLocalPeer(),"screen"));try{let m=this.validateCurrentTabCapture(h,s.forceCurrentTab);h.isCurrentTab=m,yield h.cropTo(s.cropTarget)}catch(m){throw l.getTracks().forEach(g=>g.stop()),m}c.push(h);let f=l.getAudioTracks()[0];if(f){let m=new wl(d,f,"screen",this.eventBus,i==null?void 0:i.audio,this.store.getRoom());c.push(m)}return _.v(this.TAG,"getLocalScreen",c),c})}setScreenCaptureHandleConfig(t){var n;!((n=navigator.mediaDevices)!=null&&n.setCaptureHandleConfig)||this.isInIframe()||(t=t||{},Object.assign(t,{handle:Lo(),exposeOrigin:!1,permittedOrigins:[window.location.origin]}),_.d("setting capture handle - ",t.handle),navigator.mediaDevices.setCaptureHandleConfig(t),this.captureHandleIdentifier=t.handle)}validateCurrentTabCapture(t,n){let r=t.getCaptureHandle(),s=!!(this.captureHandleIdentifier&&(r==null?void 0:r.handle)===this.captureHandleIdentifier);if(n&&!s)throw _.e(this.TAG,"current tab was not shared with forceCurrentTab as true"),oe.TracksErrors.CurrentTabNotShared();return s}requestPermissions(){return T(this,null,function*(){try{(yield navigator.mediaDevices.getUserMedia({audio:!0,video:!0})).getTracks().forEach(t=>t.stop())}catch(t){_.e(this.TAG,t)}})}static getEmptyVideoTrack(t){var n,r,s;let i=((n=t==null?void 0:t.getSettings())==null?void 0:n.width)||320,o=((r=t==null?void 0:t.getSettings())==null?void 0:r.height)||240,l=1;Li||(Li=document.createElement("canvas"),Li.width=i,Li.height=o,(s=Li.getContext("2d"))==null||s.fillRect(0,0,i,o)),kp||(kp=setInterval(()=>{let d=Li==null?void 0:Li.getContext("2d");d&&d.fillRect(0,0,1,1)},1e3/l));let c=Li.captureStream(l).getVideoTracks()[0];return c.enabled=!1,c}static getEmptyAudioTrack(){let t=qd.getAudioContext(),n=t.createOscillator(),r=t.createMediaStreamDestination();n.connect(r),n.start();let s=r.stream.getAudioTracks()[0];return s.enabled=!1,s}static cleanup(){clearInterval(kp),kp=void 0,Li=void 0}getAVTracks(t){return T(this,null,function*(){try{let n=yield navigator.mediaDevices.getUserMedia({audio:t.audio?t.audio.toConstraints():!1,video:t.video?t.video.toConstraints():!1});return n.getVideoTracks().concat(n.getAudioTracks())}catch(n){yield this.deviceManager.init();let r=!!(!this.deviceManager.hasWebcamPermission&&t.video),s=!!(!this.deviceManager.hasMicrophonePermission&&t.audio),i=this.getErrorType(r,s);throw Nh(n,i)}})}getAVTrackSettings(t){let n=this.getAudioSettings(t),r=this.getVideoSettings(t);return!n&&!r?null:new sg().video(r).audio(n).build()}isInIframe(){try{return window.self!==window.top}catch{return!0}}retryGetLocalTracks(t,n,r,s){return T(this,null,function*(){if(t instanceof Ue&&t.action==="TRACK"){this.observer.onFailure(t);let i=t.code===Me.TracksErrors.OVER_CONSTRAINED,o=t.message.includes("audio"),l=t.message.includes("video");if(i){let c=new sg().video(new rk).audio(new nk).build();_.w(this.TAG,"Fetch AV Tracks failed with overconstrained error",{fetchTrackOptions:r},{error:t});try{return yield this.getLocalTracks(r,c,s)}catch(d){let u=d instanceof Ue?d.nativeError:d,h=d;if((u==null?void 0:u.name)==="OverconstrainedError"){let f=oe.TracksErrors.GenericTrack("TRACK","Overconstrained error after dropping all constraints");f.addNativeError(u),h=f}return yield this.retryGetLocalTracks(h,n,r,s)}}r.audio=o?"empty":r.audio,r.video=l?"empty":r.video,_.w(this.TAG,"Fetch AV Tracks failed",{fetchTrackOptions:r},t);try{return yield this.getLocalTracks(r,n,s)}catch(c){return _.w(this.TAG,"Fetch empty tacks failed",c),r.audio=r.audio&&"empty",r.video=r.video&&"empty",this.observer.onFailure(c),yield this.getLocalTracks(r,n,s)}}else return _.w(this.TAG,"Fetch AV Tracks failed - unknown exception",t),this.observer.onFailure(t),[]})}getErrorType(t,n){return t&&n?"audio, video":t?"video":n?"audio":"audio, video"}getEmptyTracks(t){let n=[];return t.audio==="empty"&&n.push(Pw.getEmptyAudioTrack()),t.video==="empty"&&n.push(Pw.getEmptyVideoTrack()),n}updateCurrentLocalTrackSettings(t){return T(this,null,function*(){let n=this.store.getLocalPeerTracks(),r=n.find(l=>l.type==="video"&&l.source==="regular"),s=n.find(l=>l.type==="audio"&&l.source==="regular"),i=n.find(l=>l.type==="video"&&l.source==="screen");t!=null&&t.video&&(yield r==null?void 0:r.setSettings(t.video)),t!=null&&t.audio&&(yield s==null?void 0:s.setSettings(t.audio));let o=this.getScreenshareSettings(!0);return o!=null&&o.video&&(yield i==null?void 0:i.setSettings(o==null?void 0:o.video)),{videoTrack:r,audioTrack:s}})}getAudioSettings(t){var n;let r=this.store.getPublishParams();if(!r||!((n=r.allowed)!=null&&n.includes("audio")))return null;let s=this.store.getLocalPeer(),i=s==null?void 0:s.audioTrack,o=(i==null?void 0:i.settings.deviceId)||t.audioInputDeviceId;return new Dl().codec(r.audio.codec).maxBitrate(r.audio.bitRate).deviceId(o||lx.audioInputDeviceId).build()}getVideoSettings(t){var n;let r=this.store.getPublishParams();if(!r||!((n=r.allowed)!=null&&n.includes("video")))return null;let s=this.store.getLocalPeer(),i=s==null?void 0:s.videoTrack,o=(i==null?void 0:i.settings.deviceId)||t.videoDeviceId,l=r.video;return new Eo().codec(l.codec).maxBitrate(l.bitRate).maxFramerate(l.frameRate).setWidth(l.width).setHeight(l.height).deviceId(o||lx.videoDeviceId).build()}getScreenshareSettings(t=!1){var n;let r=this.store.getPublishParams();if(!r||!((n=r.allowed)!=null&&n.includes("screen")))return null;let s=r.screen;return{video:new Eo().maxBitrate(s.bitRate,!1).codec(s.codec).maxFramerate(s.frameRate).setWidth(s.width).setHeight(s.height).build(),audio:t?void 0:new Dl().build()}}getOrDefaultScreenshareConfig(t){return T(this,null,function*(){var n;let r=Object.assign({videoOnly:!1,audioOnly:!1,forceCurrentTab:!1,preferCurrentTab:!1,selfBrowserSurface:"exclude",surfaceSwitching:"include",systemAudio:"exclude",displaySurface:"monitor"},t||{});return r.forceCurrentTab&&(r.videoOnly=!0,r.preferCurrentTab=!0,r.selfBrowserSurface="include",r.surfaceSwitching="exclude"),r.preferCurrentTab&&(r.selfBrowserSurface="include",r.displaySurface=void 0),r.cropElement&&(n=window.CropTarget)!=null&&n.fromElement&&(r.cropTarget=yield window.CropTarget.fromElement(r.cropElement)),r})}createHMSLocalTracks(t,n,r){let s=t.find(l=>l.kind==="video"),i=t.find(l=>l.kind==="audio");r?t.forEach(l=>r==null?void 0:r.nativeStream.addTrack(l)):r=new Bc(new MediaStream(t));let o=[];if(i&&n!=null&&n.audio){let l=new wl(r,i,"regular",this.eventBus,n.audio,this.store.getRoom());o.push(l)}if(s&&n!=null&&n.video){let l=new Ss(r,s,"regular",this.eventBus,n.video,this.store.getRoom());l.setSimulcastDefinitons(this.store.getSimulcastDefinitionsForPeer(this.store.getLocalPeer(),"regular")),o.push(l)}return o}};function v_(e){return T(this,null,function*(){try{let t=e?e.toConstraints():!1;return(yield navigator.mediaDevices.getUserMedia({audio:t})).getAudioTracks()[0]}catch(t){throw Nh(t,"audio")}})}function y_(e){return T(this,null,function*(){try{let t=e?e.toConstraints():!1;return(yield navigator.mediaDevices.getUserMedia({video:t})).getVideoTracks()[0]}catch(t){throw Nh(t,"video")}})}function Vc(e){return"canvas"in e||e.label==="MediaStreamAudioDestinationNode"||e.label===""}var UL=(e,t)=>{if(!navigator.permissions){_.d("Permissions API not supported");return}navigator.permissions.query({name:e}).then(n=>{t(n.state),n.onchange=()=>{_.d(`${e} permission changed`,n.state),t(n.state)}}).catch(n=>{_.e(`${e} not supported`,n.message)})},sk=class{constructor(e=1/0){this.capacity=e,this.storage=[]}size(){return this.storage.length}toList(){return this.storage.slice(0)}enqueue(e){this.size()===this.capacity&&this.dequeue(),this.storage.push(e)}dequeue(){return this.storage.shift()}aggregate(e){return e(this.storage)}},VL=`(function workerSetup() {
  function ticker() {
    self.postMessage('tick');
  }
  self.onmessage = function (event) {
    const [data, time] = event.data;
    switch (data) {
      case 'start':
        setTimeout(ticker, time);
        break;
      default:
        break;
    }
  };
})()`;function ma(e){if(e<0)throw Error("`ms` should be a positive integer");return new Promise(t=>{setTimeout(t,e)})}function bv(e){if(e<0)throw Error("`ms` should be a positive integer");if(typeof Worker>"u")return ma(e);let t=new Worker(URL.createObjectURL(new Blob([VL],{type:"application/javascript"})));return t.postMessage(["start",e]),new Promise(n=>{t.onmessage=r=>{r.data==="tick"&&(n(),t.terminate())}})}function tQ(){if(typeof Worker>"u")return{sleep:t=>ma(t)};let e=new Worker(URL.createObjectURL(new Blob([VL],{type:"application/javascript"})));return{sleep:t=>(e.postMessage(["start",t]),new Promise(n=>{e.onmessage=r=>{r.data==="tick"&&n()}}))}}function BL(e,t=300){let n;return function(...r){clearTimeout(n),n=void 0;let s=this;n=setTimeout(()=>{e.apply(s,r)},t)}}var nQ=35,rQ=5,sQ=class{constructor(e,t,n){this.track=e,this.audioLevelEvent=t,this.silenceEvent=n,this.TAG="[TrackAudioLevelMonitor]",this.audioLevel=0,this.isMonitored=!1,this.interval=100,this.historyInterval=700,this.history=new sk(this.historyInterval/this.interval),this.detectSilence=()=>T(this,null,function*(){let r=0;for(;this.isMonitored;){if(this.track.enabled)if(this.isSilentThisInstant()){if(r++,r>50){this.silenceEvent.publish({track:this.track});break}}else break;yield ma(20)}});try{let r=new MediaStream([this.track.nativeTrack]);this.analyserNode=this.createAnalyserNodeForStream(r);let s=this.analyserNode.frequencyBinCount;this.dataArray=new Uint8Array(s)}catch(r){_.w(this.TAG,"Unable to initialize AudioContext",r)}}start(){this.stop(),this.isMonitored=!0,_.d(this.TAG,"Starting track Monitor",`${this.track}`),this.loop().then(()=>_.d(this.TAG,"Stopping track Monitor",`${this.track}`))}stop(){if(!this.analyserNode){_.d(this.TAG,"AudioContext not initialized");return}this.sendAudioLevel(0),this.isMonitored=!1}loop(){return T(this,null,function*(){for(;this.isMonitored;)this.sendAudioLevel(this.getMaxAudioLevelOverPeriod()),yield ma(this.interval)})}sendAudioLevel(e=0){if(e=e>nQ?e:0,Math.abs(this.audioLevel-e)>rQ){this.audioLevel=e;let t={track:this.track,audioLevel:this.audioLevel};this.audioLevelEvent.publish(t)}}getMaxAudioLevelOverPeriod(){if(!this.analyserNode){_.d(this.TAG,"AudioContext not initialized");return}let e=this.calculateAudioLevel();return e!==void 0&&this.history.enqueue(e),this.history.aggregate(t=>Math.max(...t))}calculateAudioLevel(){if(!this.analyserNode||!this.dataArray){_.d(this.TAG,"AudioContext not initialized");return}this.analyserNode.getByteTimeDomainData(this.dataArray);let e=.009,t=e;for(let r of this.dataArray)t=Math.max(t,(r-128)/128);let n=(Math.log(e)-Math.log(t))/Math.log(e);return Math.ceil(Math.min(Math.max(n*100,0),100))}isSilentThisInstant(){if(!this.analyserNode||!this.dataArray){_.d(this.TAG,"AudioContext not initialized");return}return this.analyserNode.getByteTimeDomainData(this.dataArray),this.dataArray.every(e=>e===128||e===0)}createAnalyserNodeForStream(e){let t=qd.getAudioContext(),n=t.createMediaStreamSource(e),r=t.createAnalyser();return r.fftSize=2048,n.connect(r),r}};function x_(e,t){return function(n){return!FO(e[n],t[n])}}var wl=class sm extends tk{constructor(t,n,r,s,i=new Dl().build(),o){super(t,n,r),this.eventBus=s,this.room=o,this.TAG="[HMSLocalAudioTrack]",this.tracksCreated=new Set,this.isPublished=!1,this.handleVisibilityChange=()=>T(this,null,function*(){if(!this.shouldReacquireTrack()){_.d(this.TAG,`visibiltiy: ${document.visibilityState}`,`${this}`);return}if(document.visibilityState==="hidden")this.eventBus.analytics.publish(this.sendInterruptionEvent({started:!0,reason:"visibility-change"}));else{if(this.eventBus.analytics.publish(this.sendInterruptionEvent({started:!1,reason:"visibility-change"})),this.permissionState&&this.permissionState!=="granted"){_.d(this.TAG,"On visibile not replacing track as permission is not granted");return}_.d(this.TAG,"On visibile replacing track as it is not publishing");try{yield this.replaceTrackWith(this.settings)}catch(l){this.eventBus.error.publish(l)}}}),this.trackPermissions=()=>{UL("microphone",l=>{this.permissionState=l,this.eventBus.analytics.publish(Be.permissionChange(this.type,l)),l==="denied"&&this.eventBus.localAudioEnabled.publish({enabled:!1,track:this})})},this.handleTrackMute=()=>{_.d(this.TAG,"muted natively");let l=document.visibilityState==="hidden"?"visibility-change":"incoming-call";this.eventBus.analytics.publish(this.sendInterruptionEvent({started:!0,reason:l})),this.eventBus.localAudioEnabled.publish({enabled:!1,track:this})},this.handleTrackUnmute=()=>T(this,null,function*(){_.d(this.TAG,"unmuted natively");let l=document.visibilityState==="hidden"?"visibility-change":"incoming-call";this.eventBus.analytics.publish(this.sendInterruptionEvent({started:!1,reason:l}));try{yield this.setEnabled(this.enabled,!0),this.eventBus.localAudioUnmutedNatively.publish()}catch(c){this.eventBus.error.publish(c)}}),this.replaceSenderTrack=()=>T(this,null,function*(){if(!this.transceiver||this.transceiver.direction!=="sendonly"){_.d(this.TAG,`transceiver for ${this.trackId} not available or not connected yet`);return}yield this.transceiver.sender.replaceTrack(this.processedTrack||this.nativeTrack)}),this.shouldReacquireTrack=()=>Vc(this.nativeTrack)||this.isTrackNotPublishing(),this.handleSettingsChange=l=>T(this,null,function*(){let c=this.stream,d=x_(l,this.settings);(d("maxBitrate")||d("audioMode"))&&l.maxBitrate&&(yield c.setMaxBitrateAndFramerate(this,l)),(d("advanced")||d("audioMode"))&&(yield this.replaceTrackWith(l))}),this.handleDeviceChange=(l,c=!1)=>T(this,null,function*(){if(x_(l,this.settings)("deviceId")){this.manuallySelectedDeviceId=c?this.manuallySelectedDeviceId:l.deviceId,_.d(this.TAG,"device change","manual selection:",this.manuallySelectedDeviceId,"new device:",l.deviceId),yield this.replaceTrackWith(l);let d=this.nativeTrack.getSettings().groupId;!c&&l.deviceId&&(pa.updateSelection("audioInput",{deviceId:l.deviceId,groupId:d}),this.eventBus.deviceChange.publish({isUserSelection:!0,type:"audioInput",selection:{deviceId:l.deviceId,groupId:d}}))}}),t.tracks.push(this),this.addTrackEventListeners(n),this.trackPermissions(),this.settings=i,i.deviceId!==n.getSettings().deviceId&&!Vc(n)&&(this.settings=this.buildNewSettings({deviceId:n.getSettings().deviceId})),this.pluginsManager=new FK(this,s,o),this.setFirstTrackId(n.id),r==="regular"&&document.addEventListener("visibilitychange",this.handleVisibilityChange)}clone(t){let n=this.nativeTrack.clone();t.nativeStream.addTrack(n);let r=new sm(t,n,this.source,this.eventBus,this.settings,this.room);return r.peerId=this.peerId,this.pluginsManager.pluginsMap.size>0&&this.pluginsManager.pluginsMap.forEach(s=>{r.addPlugin(s).catch(i=>_.e(this.TAG,"Plugin add failed while migrating",s,i))}),r}getManuallySelectedDeviceId(){return this.manuallySelectedDeviceId}resetManuallySelectedDeviceId(){this.manuallySelectedDeviceId=void 0}updateTrack(t){return T(this,null,function*(){t.enabled=this.enabled,yield this.stream.replaceStreamTrack(this.nativeTrack,t),this.nativeTrack=t,yield this.replaceSenderTrack(),this.audioLevelMonitor&&this.initAudioLevelMonitor()})}replaceTrackWith(t){return T(this,null,function*(){let n=this.nativeTrack;n==null||n.stop(),this.removeTrackEventListeners(n),this.tracksCreated.forEach(r=>r.stop()),this.tracksCreated.clear();try{let r=yield v_(t);this.addTrackEventListeners(r),this.tracksCreated.add(r),_.d(this.TAG,"replaceTrack, Previous track stopped",n,"newTrack",r),yield this.updateTrack(r)}catch(r){let s=r;if(s.code===Me.TracksErrors.CANT_ACCESS_CAPTURE_DEVICE||s.code===Me.TracksErrors.SYSTEM_DENIED_PERMISSION){let o=yield Ih.getEmptyAudioTrack();throw this.addTrackEventListeners(o),this.tracksCreated.add(o),yield this.updateTrack(o),s}let i=yield v_(this.settings);throw this.addTrackEventListeners(i),this.tracksCreated.add(i),yield this.updateTrack(i),this.isPublished&&this.eventBus.analytics.publish(Be.publish({error:r})),r}try{yield this.pluginsManager.reprocessPlugins()}catch(r){this.eventBus.audioPluginFailed.publish(r)}})}setEnabled(t,n=!1){return T(this,null,function*(){t===this.enabled&&!n||(t&&this.shouldReacquireTrack()&&(yield this.replaceTrackWith(this.settings)),yield ho(sm.prototype,this,"setEnabled").call(this,t),t&&(this.settings=this.buildNewSettings({deviceId:this.nativeTrack.getSettings().deviceId})),this.eventBus.localAudioEnabled.publish({enabled:t,track:this}))})}isPublishedTrackId(t){return this.publishedTrackId===t}setSettings(t,n=!1){return T(this,null,function*(){let r=this.buildNewSettings(t);if(Vc(this.nativeTrack)){this.settings=r;return}yield this.handleDeviceChange(r,n),yield this.handleSettingsChange(r),this.settings=r})}getPlugins(){return this.pluginsManager.getPlugins()}addPlugin(t){return T(this,null,function*(){return this.pluginsManager.addPlugin(t)})}removePlugin(t){return T(this,null,function*(){return this.pluginsManager.removePlugin(t)})}validatePlugin(t){return this.pluginsManager.validatePlugin(t)}setProcessedTrack(t){return T(this,null,function*(){t?t!==this.processedTrack&&(this.processedTrack=t):this.processedTrack=void 0,yield this.replaceSenderTrack()})}initAudioLevelMonitor(){this.audioLevelMonitor&&this.destroyAudioLevelMonitor(),_.d(this.TAG,"Monitor Audio Level for",this,this.getMediaTrackSettings().deviceId),this.audioLevelMonitor=new sQ(this,this.eventBus.trackAudioLevelUpdate,this.eventBus.localAudioSilence),this.audioLevelMonitor.start(),this.audioLevelMonitor.detectSilence()}destroyAudioLevelMonitor(){var t;(t=this.audioLevelMonitor)==null||t.stop(),this.audioLevelMonitor=void 0}cleanup(){return T(this,null,function*(){var t;ho(sm.prototype,this,"cleanup").call(this),yield this.pluginsManager.cleanup(),yield this.pluginsManager.closeContext(),this.transceiver=void 0,(t=this.processedTrack)==null||t.stop(),this.tracksCreated.forEach(n=>n.stop()),this.tracksCreated.clear(),this.isPublished=!1,this.destroyAudioLevelMonitor(),document.removeEventListener("visibilitychange",this.handleVisibilityChange)})}getTrackIDBeingSent(){return this.processedTrack?this.processedTrack.id:this.nativeTrack.id}getTrackBeingSent(){return this.processedTrack||this.nativeTrack}addTrackEventListeners(t){t.addEventListener("mute",this.handleTrackMute),t.addEventListener("unmute",this.handleTrackUnmute)}removeTrackEventListeners(t){t.removeEventListener("mute",this.handleTrackMute),t.removeEventListener("unmute",this.handleTrackUnmute)}buildNewSettings(t){let{volume:n,codec:r,maxBitrate:s,deviceId:i,advanced:o,audioMode:l}=de(de({},this.settings),t);return new nk(n,r,s,i,o,l)}},Cd=class zL extends tk{setEnabled(t){return T(this,null,function*(){t!==this.enabled&&(yield ho(zL.prototype,this,"setEnabled").call(this,t),yield this.subscribeToAudio(t))})}},GL=class extends ek{constructor(e,t,n){if(super(e,t,n),this.type="video",this.sinkCount=0,this.handleTrackUnmute=()=>{this.getSinks().forEach(r=>this.reTriggerPlay({videoElement:r}))},this.reTriggerPlay=({videoElement:r})=>{setTimeout(()=>{r.play().catch(s=>{_.w("[HMSVideoTrack]","failed to play",s.message)})},0)},t.kind!=="video")throw new Error("Expected 'track' kind = 'video'")}setVideoHandler(e){this.videoHandler=e}hasSinks(){return this.sinkCount>0}getSinks(){return this.videoHandler.getVideoElements()||[]}attach(e){this.videoHandler.addVideoElement(e)}detach(e){this.videoHandler.removeVideoElement(e)}addSink(e){this.addSinkInternal(e,this.nativeTrack)}removeSink(e){e.srcObject!==null&&(e.srcObject=null,this.reduceSinkCount())}cleanup(){super.cleanup(),this.videoHandler.cleanup()}addSinkInternal(e,t){let n=e.srcObject;if(n!==null&&n instanceof MediaStream){let s=n.getVideoTracks()[0];if((s==null?void 0:s.id)===t.id){if(!s.muted&&s.readyState==="live")return;this.reduceSinkCount()}else this.reduceSinkCount()}this.addPropertiesToElement(e);let r=new MediaStream([t]);e.srcObject=r,this.reTriggerPlay({videoElement:e}),this.sinkCount++}reduceSinkCount(){this.sinkCount>0&&this.sinkCount--}addPropertiesToElement(e){EK||(e.autoplay=!0),e.playsInline=!0,e.muted=!0,e.controls=!1}},ig={none:-1,low:0,medium:1,high:2},iQ=.5,aQ=(e,t)=>{let n="high",r=t.width>t.height?"width":"height",s=[...e].sort((o,l)=>ig[o.layer]-ig[l.layer]),i=t[r]*((window==null?void 0:window.devicePixelRatio)||1);for(let o=0;o<s.length;o++){let{resolution:l,layer:c}=s[o],d=l[r];if(i<=d){n=c;break}else{let u=s[o+1],h=u?u.resolution[r]:Number.POSITIVE_INFINITY;if((i-d)/(h-d)<iQ){n=c;break}}}return n},oQ=class{constructor(){this.TAG="[HMSIntersectionObserverWrapper]",this.listeners=new WeakMap,this.observe=(e,t)=>{var n;this.createObserver(),this.unobserve(e),(n=this.intersectionObserver)==null||n.observe(e),this.listeners.set(e,t)},this.unobserve=e=>{var t;(t=this.intersectionObserver)==null||t.unobserve(e),this.listeners.delete(e)},this.createObserver=()=>{this.isSupported()&&!this.intersectionObserver&&(this.intersectionObserver=new IntersectionObserver(this.handleIntersection))},this.handleIntersection=e=>{var t;for(let n of e)(t=this.listeners.get(n.target))==null||t(n)},this.createObserver()}isSupported(){let e=Is&&typeof window.IntersectionObserver<"u";return e||_.w(this.TAG,"IntersectionObserver is not supported, fallback will be used instead"),e}},lQ=new oQ,cQ=class{constructor(){this.TAG="[HMSResizeObserverWrapper]",this.listeners=new WeakMap,this.observe=(e,t,n={box:"border-box"})=>{var r;this.createObserver(),this.unobserve(e),(r=this.resizeObserver)==null||r.observe(e,n),this.listeners.set(e,t)},this.unobserve=e=>{var t;(t=this.resizeObserver)==null||t.unobserve(e),this.listeners.delete(e)},this.createObserver=()=>{this.isSupported()&&!this.resizeObserver&&(this.resizeObserver=new ResizeObserver(BL(this.handleResize,300)))},this.handleResize=e=>{var t;for(let n of e)(t=this.listeners.get(n.target))==null||t(n)},this.createObserver()}isSupported(){let e=Is&&typeof window.ResizeObserver<"u";return e||_.w(this.TAG,"Resize Observer is not supported"),e}},dQ=new cQ,WL=class{constructor(e){this.track=e,this.TAG="[VideoElementManager]",this.videoElements=new Set,this.entries=new WeakMap,this.handleIntersection=t=>T(this,null,function*(){let n=getComputedStyle(t.target).visibility==="visible";this.track.enabled&&(t.isIntersecting&&n||!document.contains(t.target))?(_.d(this.TAG,"add sink intersection",`${this.track}`,this.id),this.entries.set(t.target,t.boundingClientRect),yield this.selectMaxLayer(),yield this.track.addSink(t.target)):(_.d(this.TAG,"remove sink intersection",`${this.track}`,this.id),yield this.track.removeSink(t.target))}),this.handleResize=t=>T(this,null,function*(){!this.track.enabled||!(this.track instanceof os)||(this.entries.set(t.target,t.contentRect),yield this.selectMaxLayer())}),this.cleanup=()=>{this.videoElements.forEach(t=>{var n,r;t.srcObject=null,(n=this.resizeObserver)==null||n.unobserve(t),(r=this.intersectionObserver)==null||r.unobserve(t)}),this.videoElements.clear(),this.resizeObserver=void 0,this.intersectionObserver=void 0},this.init(),this.id=Lo()}updateSinks(e=!1){for(let t of this.videoElements)this.track.enabled?this.track.addSink(t,e):this.track.removeSink(t,e)}addVideoElement(e){return T(this,null,function*(){var t;this.videoElements.has(e)||(this.init(),_.d(this.TAG,`Adding video element for ${this.track}`,this.id),this.videoElements.add(e),this.videoElements.size>=10&&_.w(this.TAG,`${this.track}`,`the track is added to ${this.videoElements.size} video elements, while this may be intentional, it's likely that there is a bug leading to unnecessary creation of video elements in the UI`),(t=this.intersectionObserver)!=null&&t.isSupported()?this.intersectionObserver.observe(e,this.handleIntersection):Is&&(this.isElementInViewport(e)?this.track.addSink(e):this.track.removeSink(e)),this.resizeObserver?this.resizeObserver.observe(e,this.handleResize):this.track instanceof os&&(yield this.track.setPreferredLayer(this.track.getPreferredLayer())))})}removeVideoElement(e){var t,n;this.track.removeSink(e),this.videoElements.delete(e),this.entries.delete(e),(t=this.resizeObserver)==null||t.unobserve(e),(n=this.intersectionObserver)==null||n.unobserve(e),_.d(this.TAG,`Removing video element for ${this.track}`)}getVideoElements(){return Array.from(this.videoElements)}init(){Is&&(this.resizeObserver=dQ,this.intersectionObserver=lQ)}isElementInViewport(e){let t=e.offsetTop,n=e.offsetLeft,r=e.offsetWidth,s=e.offsetHeight,{hidden:i}=e,{opacity:o,display:l}=getComputedStyle(e);for(;e.offsetParent;)e=e.offsetParent,t+=e.offsetTop,n+=e.offsetLeft;return t<window.pageYOffset+window.innerHeight&&n<window.pageXOffset+window.innerWidth&&t+s>window.pageYOffset&&n+r>window.pageXOffset&&!i&&(o!==""?parseFloat(o)>0:!0)&&l!=="none"}selectMaxLayer(){return T(this,null,function*(){if(!(this.track instanceof os)||this.videoElements.size===0)return;let e;for(let t of this.videoElements){let n=this.entries.get(t);if(!n)continue;let{width:r,height:s}=n;if(r===0||s===0)continue;let i=aQ(this.track.getSimulcastDefinitions(),{width:r,height:s});e?e=ig[i]>ig[e]?i:e:e=i}e&&(_.d(this.TAG,`selecting max layer ${e} for the track`,`${this.track}`),yield this.track.setPreferredLayer(e))})}},uQ=(e=>(e.TRANSFORM="TRANSFORM",e.ANALYZE="ANALYZE",e))(uQ||{}),hQ=(e=>(e["2D"]="2d",e.WEBGL="webgl",e.WEBGL2="webgl2",e))(hQ||{}),b_=class{constructor(){this.total=0,this.count=0}add(e){this.count++,this.total+=e}getAvg(){return Math.floor(this.total/this.count)}reset(){this.total=0,this.count=0}},HL=class{constructor(e){this.eventBus=e,this.TAG="[VideoPluginsAnalytics]",this.initTime={},this.preProcessingAvgs=new b_,this.addedTimestamps={},this.processingAvgs={},this.pluginAdded={},this.pluginInputFrameRate={},this.pluginFrameRate={}}added(e,t,n){this.pluginAdded[e]=!0,this.addedTimestamps[e]=Date.now(),this.initTime[e]=0,this.processingAvgs[e]=new b_,t&&(this.pluginInputFrameRate[e]=t,this.pluginFrameRate[e]=n||t),this.eventBus.analytics.publish(Uc.added(e,this.addedTimestamps[e]))}removed(e){var t;if(this.pluginAdded[e]){let n={pluginName:e,duration:Math.floor((Date.now()-this.addedTimestamps[e])/1e3),loadTime:this.initTime[e],avgPreProcessingTime:this.preProcessingAvgs.getAvg(),avgProcessingTime:(t=this.processingAvgs[e])==null?void 0:t.getAvg(),inputFrameRate:this.pluginInputFrameRate[e],pluginFrameRate:this.pluginFrameRate[e]};this.eventBus.analytics.publish(Uc.stats(n)),this.clean(e)}}failure(e,t){this.pluginAdded[e]&&(this.eventBus.analytics.publish(Uc.failure(e,t)),this.clean(e))}initWithTime(e,t){return T(this,null,function*(){if(this.initTime[e]){_.i(this.TAG,`Plugin Already loaded ${e}, time it took: ${this.initTime[e]}`);return}let n;try{n=yield this.timeInMs(t),_.i(this.TAG,`Time taken for Plugin ${e} initialization : ${n}`)}catch(r){let s=oe.MediaPluginErrors.InitFailed("VIDEO_PLUGINS",`failed during initialization of plugin${r.message||r}`);throw _.e(this.TAG,s),this.failure(e,s),s}n&&(this.initTime[e]=n)})}preProcessWithTime(e){return T(this,null,function*(){let t=yield this.timeInMs(e);this.preProcessingAvgs.add(t)})}processWithTime(e,t){return T(this,null,function*(){var n;let r;try{r=yield this.timeInMs(t)}catch(s){let i=oe.MediaPluginErrors.ProcessingFailed("VIDEO_PLUGINS",`Failed during processing of plugin${s.message||s}`);throw _.e(this.TAG,i),this.failure(e,i),i}r&&((n=this.processingAvgs[e])==null||n.add(r))})}timeInMs(e){return T(this,null,function*(){let t=Date.now();return yield e(),Math.floor(Date.now()-t)})}clean(e){delete this.addedTimestamps[e],delete this.initTime[e],delete this.processingAvgs[e],delete this.pluginAdded[e],delete this.pluginInputFrameRate[e],delete this.pluginFrameRate[e]}},w_=24,fQ=320,pQ=240,mQ=class{constructor(e,t){this.TAG="[VideoPluginsManager]",this.pluginsLoopRunning=!1,this.pluginsLoopState="paused",this.pluginAddInProgress=!1,this.reusableWorker=tQ(),this.hmsTrack=e,this.pluginsMap=new Map,this.pluginNumFramesToSkip={},this.pluginNumFramesSkipped={},this.analytics=new HL(t),this.canvases=new Array}getPlugins(){return Array.from(this.pluginsMap.keys())}addPlugin(e,t){return T(this,null,function*(){var n;if(this.pluginAddInProgress){let r=(n=e.getName)==null?void 0:n.call(e);if(!r||r===""){_.w("no name provided by the plugin");return}let s=oe.MediaPluginErrors.AddAlreadyInProgress("VIDEO_PLUGINS","Add Plugin is already in Progress");throw this.analytics.failure(r,s),_.w("can't add another plugin when previous add is in progress"),s}this.pluginAddInProgress=!0;try{yield this.addPluginInternal(e,t)}finally{this.pluginAddInProgress=!1}})}addPluginInternal(e,t){return T(this,null,function*(){var n,r;let s=(n=e.getName)==null?void 0:n.call(e);if(!s||s===""){_.w("no name provided by the plugin");return}if(this.pluginsMap.has(s)){_.w(this.TAG,`plugin - ${e.getName()} already added.`);return}let i=this.hmsTrack.getMediaTrackSettings().frameRate||w_,o=0;t&&t>0?(_.i(this.TAG,`adding plugin ${e.getName()} with framerate ${t}`),t<i&&(o=Math.ceil(i/t)-1),this.analytics.added(s,i,t)):(_.i(this.TAG,`adding plugin ${e.getName()}`),this.analytics.added(s,i)),_.i(this.TAG,"numFrames to skip processing",o),this.pluginNumFramesToSkip[s]=o,this.pluginNumFramesSkipped[s]=o,this.validateAndThrow(s,e);try{if(yield this.analytics.initWithTime(s,()=>T(this,null,function*(){return yield e.init()})),this.pluginsMap.set(s,e),this.pluginsMap.size+1>this.canvases.length)for(let l=this.canvases.length;l<=this.pluginsMap.size;l++)this.canvases[l]=document.createElement("canvas");yield this.startPluginsLoop((r=e.getContextType)==null?void 0:r.call(e))}catch(l){throw _.e(this.TAG,"failed to add plugin",l),yield this.removePlugin(e),l}})}validatePlugin(e){return e.checkSupport()}validateAndThrow(e,t){let n=this.validatePlugin(t);if(n.isSupported)_.i(this.TAG,`plugin is supported,- ${t.getName()}`);else{let r;switch(n.errType){case"PLATFORM_NOT_SUPPORTED":throw r=oe.MediaPluginErrors.PlatformNotSupported("VIDEO_PLUGINS","platform not supported, see docs"),this.analytics.failure(e,r),r;case"DEVICE_NOT_SUPPORTED":throw r=oe.MediaPluginErrors.DeviceNotSupported("VIDEO_PLUGINS","video device not supported, see docs"),this.analytics.failure(e,r),r}}}removePlugin(e){return T(this,null,function*(){let t=e.getName();if(!this.pluginsMap.get(t)){_.w(this.TAG,`plugin - ${t} not found to remove.`);return}_.i(this.TAG,`removing plugin ${t}`),this.removePluginEntry(t),this.pluginsMap.size===0&&(_.i(this.TAG,"No plugins left, stopping plugins loop"),yield this.stopPluginsLoop()),e.stop(),this.analytics.removed(t)})}removePluginEntry(e){this.pluginsMap.delete(e),this.pluginNumFramesToSkip[e]&&delete this.pluginNumFramesToSkip[e],this.pluginNumFramesSkipped[e]&&delete this.pluginNumFramesSkipped[e]}waitForRestart(){return T(this,null,function*(){if(!(!this.pluginsLoopRunning||this.pluginsLoopState==="running"))for(;this.pluginsLoopState==="paused";)yield bv(100)})}cleanup(){return T(this,null,function*(){var e;for(let t of this.pluginsMap.values())yield this.removePlugin(t);(e=this.outputTrack)==null||e.stop()})}initElementsAndStream(e){this.inputCanvas||(this.inputCanvas=document.createElement("canvas")),this.outputCanvas=document.createElement("canvas"),this.inputVideo||(this.inputVideo=document.createElement("video")),this.inputCanvas.getContext("2d"),this.outputCanvas.getContext(e||"2d");let t=this.outputCanvas.captureStream();this.outputTrack=t.getVideoTracks()[0]}startPluginsLoop(e){return T(this,null,function*(){if(!this.pluginsLoopRunning){this.initElementsAndStream(e),this.pluginsLoopRunning=!0;try{yield this.hmsTrack.setProcessedTrack(this.outputTrack)}catch(t){throw this.pluginsLoopRunning=!1,_.e(this.TAG,"error in setting processed track",t),t}this.pluginsLoop().then(()=>{_.d(this.TAG,"processLoop stopped")})}})}stopPluginsLoop(){return T(this,null,function*(){var e;this.pluginsLoopRunning=!1,yield this.hmsTrack.setProcessedTrack(void 0),this.resetCanvases(),(e=this.outputTrack)==null||e.stop(),this.inputVideo&&(this.inputVideo.srcObject=null,this.inputVideo=void 0)})}pluginsLoop(){return T(this,null,function*(){for(;this.pluginsLoopRunning;){let e=this.hmsTrack.getMediaTrackSettings().frameRate||w_,t=Math.floor(1e3/e);if(!this.hmsTrack.enabled||this.hmsTrack.nativeTrack.readyState==="ended"){this.pluginsLoopState==="running"&&this.resetCanvases(),this.pluginsLoopState="paused",yield this.reusableWorker.sleep(t);continue}let n=0;try{yield this.analytics.preProcessWithTime(()=>T(this,null,function*(){return yield this.doPreProcessing()}));let r=Date.now();yield this.processFramesThroughPlugins(),n=Math.floor(Date.now()-r),n>t&&(n=t)}catch(r){_.e(this.TAG,"error in plugins loop",r)}this.pluginsLoopState="running",yield this.reusableWorker.sleep(t-n)}})}doPreProcessing(){return T(this,null,function*(){yield this.addTrackToVideo(),yield this.updateInputCanvas()})}processFramesThroughPlugins(){return T(this,null,function*(){this.canvases[0]=this.inputCanvas;let e=0;for(let t of this.pluginsMap.values()){let n=t.getName();if(t){try{let r=this.checkIfSkipRequired(n);if(t.getPluginType()==="TRANSFORM"){let s=(i,o)=>T(this,null,function*(){try{yield t.processVideoFrame(i,o,r)}catch(l){_.e(this.TAG,`error in processing plugin ${n}`,l)}});if(r)e===this.pluginsMap.size-1?yield s(this.canvases[e],this.outputCanvas):yield s(this.canvases[e],this.canvases[e+1]);else{let i=this.canvases[e],o=this.canvases[e+1];e===this.pluginsMap.size-1?yield this.analytics.processWithTime(n,()=>T(this,null,function*(){return s(i,this.outputCanvas)})):yield this.analytics.processWithTime(n,()=>T(this,null,function*(){return s(i,o)}))}}else t.getPluginType()==="ANALYZE"&&!r&&(yield this.analytics.processWithTime(n,()=>T(this,null,function*(){return yield t.processVideoFrame(this.inputCanvas)})))}catch(r){_.e(this.TAG,`error in processing plugin ${n}`,r),yield this.removePlugin(t)}e++}}})}addTrackToVideo(){return T(this,null,function*(){var e;if(!this.inputVideo)return;let t=this.inputVideo.srcObject;t!==null&&t instanceof MediaStream&&((e=t.getVideoTracks()[0])==null?void 0:e.id)===this.hmsTrack.nativeTrack.id||(this.inputVideo.pause(),this.inputVideo.srcObject=new MediaStream([this.hmsTrack.nativeTrack]),this.inputVideo.muted=!0,this.inputVideo.playsInline=!0,yield this.inputVideo.play())})}updateInputCanvas(){return T(this,null,function*(){if(!this.inputCanvas||!this.inputVideo)return;let{width:e=fQ,height:t=pQ}=this.hmsTrack.getMediaTrackSettings();this.inputCanvas.height!==t&&(this.inputCanvas.height=t),this.inputCanvas.width!==e&&(this.inputCanvas.width=e),this.inputCanvas.getContext("2d").drawImage(this.inputVideo,0,0,e,t)})}resetCanvases(){if(!this.outputCanvas||!this.inputCanvas)return;let e=this.inputCanvas.getContext("2d");e&&(e.fillStyle="rgb(0, 0, 0)",e.fillRect(0,0,this.outputCanvas.width,this.outputCanvas.height)),this.canvases=[]}checkIfSkipRequired(e){let t=!1;return this.pluginNumFramesSkipped[e]<this.pluginNumFramesToSkip[e]?(this.pluginNumFramesSkipped[e]++,t=!0):(t=!1,this.pluginNumFramesSkipped[e]=0),t}},gQ=class{constructor(e,t){this.TAG="[MediaStreamPluginsManager]",this.plugins=new Set,this.analytics=new HL(e),this.room=t}addPlugins(e){e.forEach(t=>{var n;switch(t.getName()){case"HMSEffectsPlugin":if(!((n=this.room)!=null&&n.isEffectsEnabled)){let r="Effects Virtual Background is not enabled for this room";if(this.plugins.size===0)throw Error(r);_.w(this.TAG,r);return}break}this.plugins.add(t)})}removePlugins(e){e.forEach(t=>{t.stop(),this.analytics.removed(t.getName()),this.plugins.delete(t)})}applyPlugins(e){let t=e;for(let n of this.plugins){let r=n.getName();try{t=n.apply(t),this.analytics.added(r)}catch(s){this.analytics.failure(r,s),_.e("Could not apply plugin",s,r)}}return t}getPlugins(){return Array.from(this.plugins).map(e=>e.getName())}cleanup(){return T(this,null,function*(){this.removePlugins(Array.from(this.plugins))})}};function S_(e,t){return function(n){return!FO(e[n],t[n])}}var Ss=class im extends GL{constructor(t,n,r,s,i=new Eo().build(),o){super(t,n,r),this.eventBus=s,this.room=o,this._layerDefinitions=[],this.TAG="[HMSLocalVideoTrack]",this.enabledStateBeforeBackground=!1,this.isCurrentTab=!1,this.isPublished=!1,this.replaceSenderTrack=l=>T(this,null,function*(){if(!this.transceiver||this.transceiver.direction!=="sendonly"){_.d(this.TAG,`transceiver for ${this.trackId} not available or not connected yet`);return}yield this.transceiver.sender.replaceTrack(l)}),this.buildNewSettings=l=>{let{width:c,height:d,codec:u,maxFramerate:h,maxBitrate:f,deviceId:m,advanced:g,facingMode:v}=de(de({},this.settings),l);return new rk(c,d,u,h,m,g,f,v)},this.handleSettingsChange=l=>T(this,null,function*(){let c=this.stream,d=S_(l,this.settings);if(d("maxBitrate")&&l.maxBitrate&&(yield c.setMaxBitrateAndFramerate(this)),d("width")||d("height")||d("advanced"))if(this.source==="video"){let u=yield this.replaceTrackWith(l);yield this.replaceSender(u,this.enabled),this.nativeTrack=u,yield this.processPlugins(),this.videoHandler.updateSinks()}else yield this.nativeTrack.applyConstraints(l.toConstraints())}),this.handleDeviceChange=(l,c=!1)=>T(this,null,function*(){if(S_(l,this.settings)("deviceId")&&this.source==="regular"){if(this.enabled){delete l.facingMode;let u=yield this.replaceTrackWith(l);yield this.replaceSender(u,this.enabled),this.nativeTrack=u,yield this.processPlugins(),this.videoHandler.updateSinks()}let d=this.nativeTrack.getSettings().groupId;!c&&l.deviceId&&(pa.updateSelection("videoInput",{deviceId:l.deviceId,groupId:d}),this.eventBus.deviceChange.publish({isUserSelection:!0,type:"video",selection:{deviceId:l.deviceId,groupId:d}}))}}),this.trackPermissions=()=>{UL("camera",l=>{this.eventBus.analytics.publish(Be.permissionChange(this.type,l)),l==="denied"&&this.eventBus.localVideoEnabled.publish({enabled:!1,track:this})})},this.handleTrackMute=()=>{_.d(this.TAG,"muted natively",document.visibilityState);let l=document.visibilityState==="hidden"?"visibility-change":"incoming-call";this.eventBus.analytics.publish(this.sendInterruptionEvent({started:!0,reason:l})),this.eventBus.localVideoEnabled.publish({enabled:!1,track:this})},this.handleTrackUnmuteNatively=()=>T(this,null,function*(){_.d(this.TAG,"unmuted natively");let l=document.visibilityState==="hidden"?"visibility-change":"incoming-call";this.eventBus.analytics.publish(this.sendInterruptionEvent({started:!1,reason:l})),this.handleTrackUnmute(),this.eventBus.localVideoEnabled.publish({enabled:this.enabled,track:this}),this.eventBus.localVideoUnmutedNatively.publish(),yield this.setEnabled(this.enabled)}),this.removeOrReplaceProcessedTrack=l=>T(this,null,function*(){l?l!==this.processedTrack&&(this.processedTrack=l):this.processedTrack=void 0,yield this.replaceSenderTrack(this.processedTrack||this.nativeTrack)}),this.handleVisibilityChange=()=>T(this,null,function*(){if(document.visibilityState==="hidden")this.enabledStateBeforeBackground=this.enabled,this.enabled&&(yield this.setEnabled(!1)),this.eventBus.analytics.publish(this.sendInterruptionEvent({started:!0,reason:"visibility-change"}));else{if(this.eventBus.analytics.publish(this.sendInterruptionEvent({started:!1,reason:"visibility-change"})),this.permissionState&&this.permissionState!=="granted"){_.d(this.TAG,"On visibile not replacing track as permission is not granted");return}if(_.d(this.TAG,"visibility visible, restoring track state",this.enabledStateBeforeBackground),this.enabledStateBeforeBackground)try{yield this.setEnabled(!0)}catch(l){this.eventBus.error.publish(l)}}}),this.addTrackEventListeners(n),this.trackPermissions(),t.tracks.push(this),this.setVideoHandler(new WL(this)),this.settings=i,i.deviceId!==n.getSettings().deviceId&&n.enabled&&(this.settings=this.buildNewSettings({deviceId:n.getSettings().deviceId})),this.pluginsManager=new mQ(this,s),this.mediaStreamPluginsManager=new gQ(s,o),this.setFirstTrackId(this.trackId),this.eventBus.localAudioUnmutedNatively.subscribe(this.handleTrackUnmute),Is&&r==="regular"&&kw()&&document.addEventListener("visibilitychange",this.handleVisibilityChange)}clone(t){let n=this.nativeTrack.clone();t.nativeStream.addTrack(n);let r=new im(t,n,this.source,this.eventBus,this.settings,this.room);return r.peerId=this.peerId,this.pluginsManager.pluginsMap.size>0&&this.pluginsManager.pluginsMap.forEach(s=>{r.addPlugin(s).catch(i=>_.e(this.TAG,"Plugin add failed while migrating",s,i))}),this.mediaStreamPluginsManager.plugins.size>0&&r.addStreamPlugins(Array.from(this.mediaStreamPluginsManager.plugins)),r}setSimulcastDefinitons(t){this._layerDefinitions=t}getSimulcastDefinitions(){return this._layerDefinitions}setEnabled(t){return T(this,null,function*(){var n;if(t!==this.enabled){if(this.source==="regular"){let r;t?r=yield this.replaceTrackWith(this.settings):r=yield this.replaceTrackWithBlank(),yield this.replaceSender(r,t),(n=this.nativeTrack)==null||n.stop(),this.nativeTrack=r,yield ho(im.prototype,this,"setEnabled").call(this,t),t&&(yield this.pluginsManager.waitForRestart(),yield this.processPlugins(),this.settings=this.buildNewSettings({deviceId:r.getSettings().deviceId})),this.videoHandler.updateSinks()}this.eventBus.localVideoEnabled.publish({enabled:t,track:this})}})}processPlugins(){return T(this,null,function*(){try{if(this.pluginsManager.getPlugins().length>0)return;if(this.mediaStreamPluginsManager.getPlugins().length>0){let t=this.mediaStreamPluginsManager.applyPlugins(new MediaStream([this.nativeTrack])).getVideoTracks()[0];yield this.setProcessedTrack(t)}else yield this.setProcessedTrack();this.videoHandler.updateSinks()}catch(t){console.error("error in processing plugin(s)",t)}})}addStreamPlugins(t){return T(this,null,function*(){if(this.pluginsManager.getPlugins().length>0)throw Error("Plugins of type HMSMediaStreamPlugin and HMSVideoPlugin cannot be used together");this.mediaStreamPluginsManager.addPlugins(t),yield this.processPlugins()})}removeStreamPlugins(t){return T(this,null,function*(){this.mediaStreamPluginsManager.removePlugins(t),yield this.processPlugins()})}isPublishedTrackId(t){return this.publishedTrackId===t}addSink(t){this.addSinkInternal(t,this.processedTrack||this.nativeTrack)}setSettings(t,n=!1){return T(this,null,function*(){let r=this.buildNewSettings(t);if(yield this.handleDeviceChange(r,n),!this.enabled||Vc(this.nativeTrack)){this.settings=r;return}else yield this.pluginsManager.waitForRestart();yield this.handleSettingsChange(r),this.settings=r})}getPlugins(){return this.mediaStreamPluginsManager.getPlugins().length>0?this.mediaStreamPluginsManager.getPlugins():this.pluginsManager.getPlugins()}addPlugin(t,n){return T(this,null,function*(){if(this.mediaStreamPluginsManager.getPlugins().length>0)throw Error("Plugins of type HMSVideoPlugin and HMSMediaStreamPlugin cannot be used together");return this.pluginsManager.addPlugin(t,n)})}removePlugin(t){return T(this,null,function*(){return this.pluginsManager.removePlugin(t)})}validatePlugin(t){return this.pluginsManager.validatePlugin(t)}cleanup(){return T(this,null,function*(){var t;this.eventBus.localAudioUnmutedNatively.unsubscribe(this.handleTrackUnmute),this.removeTrackEventListeners(this.nativeTrack),yield this.mediaStreamPluginsManager.cleanup(),yield this.pluginsManager.cleanup(),ho(im.prototype,this,"cleanup").call(this),this.transceiver=void 0,(t=this.processedTrack)==null||t.stop(),this.isPublished=!1,Is&&kw()&&document.removeEventListener("visibilitychange",this.handleVisibilityChange)})}cropTo(t){return T(this,null,function*(){if(t&&this.source==="screen")try{this.nativeTrack.cropTo&&(yield this.nativeTrack.cropTo(t))}catch(n){throw _.e(this.TAG,"failed to crop screenshare capture - ",n),oe.TracksErrors.GenericTrack("TRACK","failed to crop screenshare capture")}})}getCaptureHandle(){if(this.nativeTrack.getCaptureHandle)return this.nativeTrack.getCaptureHandle()}setProcessedTrack(t){return T(this,null,function*(){if(!this.nativeTrack.enabled){this.processedTrack=t;return}yield this.removeOrReplaceProcessedTrack(t),this.videoHandler.updateSinks()})}getTrackIDBeingSent(){return this.getTrackBeingSent().id}getTrackBeingSent(){return this.enabled?this.processedTrack||this.nativeTrack:this.nativeTrack}switchCamera(){return T(this,null,function*(){var t;let n=this.getMediaTrackSettings().facingMode;if(!n||this.source!=="regular"){_.d(this.TAG,"facingMode not supported");return}let r=n==="environment"?"user":"environment";(t=this.nativeTrack)==null||t.stop();let s=yield this.replaceTrackWith(this.buildNewSettings({facingMode:r,deviceId:void 0}));yield this.replaceSender(s,this.enabled),this.nativeTrack=s,yield this.processPlugins(),this.videoHandler.updateSinks(),this.settings=this.buildNewSettings({deviceId:this.nativeTrack.getSettings().deviceId,facingMode:r}),pa.updateSelection("videoInput",{deviceId:this.settings.deviceId,groupId:this.nativeTrack.getSettings().groupId})})}replaceTrackWith(t){return T(this,null,function*(){let n=this.nativeTrack;this.removeTrackEventListeners(n),n==null||n.stop();try{let r=yield y_(t);return this.addTrackEventListeners(r),_.d(this.TAG,"replaceTrack, Previous track stopped",n,"newTrack",r),this.settings.deviceId==="default"&&(this.settings=this.buildNewSettings({deviceId:this.nativeTrack.getSettings().deviceId})),r}catch(r){let s=r;if(s.code===Me.TracksErrors.CANT_ACCESS_CAPTURE_DEVICE||s.code===Me.TracksErrors.SYSTEM_DENIED_PERMISSION){let o=yield this.replaceTrackWithBlank();throw this.addTrackEventListeners(o),yield this.replaceSender(o,this.enabled),this.nativeTrack=o,this.videoHandler.updateSinks(),s}let i=yield y_(this.settings);throw this.addTrackEventListeners(i),yield this.replaceSender(i,this.enabled),this.nativeTrack=i,yield this.processPlugins(),this.videoHandler.updateSinks(),this.isPublished&&this.eventBus.analytics.publish(Be.publish({error:s})),s}})}replaceTrackWithBlank(){return T(this,null,function*(){let t=this.nativeTrack,n=Ih.getEmptyVideoTrack(t);return this.removeTrackEventListeners(t),this.addTrackEventListeners(n),t==null||t.stop(),_.d(this.TAG,"replaceTrackWithBlank, Previous track stopped",t,"newTrack",n),n})}replaceSender(t,n){return T(this,null,function*(){n?yield this.replaceSenderTrack(this.processedTrack||t):yield this.replaceSenderTrack(t),this.stream.replaceStreamTrack(this.nativeTrack,t)})}addTrackEventListeners(t){t.addEventListener("mute",this.handleTrackMute),t.addEventListener("unmute",this.handleTrackUnmuteNatively)}removeTrackEventListeners(t){t.removeEventListener("mute",this.handleTrackMute),t.removeEventListener("unmute",this.handleTrackUnmuteNatively)}},yu="renegotiation-callback-id",qL="ion-sfu",xu="SUBSCRIBE_ICE_CONNECTION_CALLBACK_ID",vQ="https://event.100ms.live/v2/client/report",yQ="https://event-nonprod.100ms.live/v2/client/report",ag=Math.pow(2,31)-1,vn={DEVICE_CHANGE:"device-change",LOCAL_AUDIO_ENABLED:"local-audio-enabled",LOCAL_VIDEO_ENABLED:"local-video-enabled",LOCAL_VIDEO_UNMUTED_NATIVELY:"local-video-unmuted-natively",LOCAL_AUDIO_UNMUTED_NATIVELY:"local-audio-unmuted-natively",STATS_UPDATE:"stats-update",TRACK_DEGRADED:"track-degraded",TRACK_RESTORED:"track-restored",TRACK_AUDIO_LEVEL_UPDATE:"track-audio-level-update",LOCAL_AUDIO_SILENCE:"local-audio-silence",ANALYTICS:"analytics",AUDIO_PLUGIN_FAILED:"audio-plugin-failed",POLICY_CHANGE:"policy-change",LOCAL_ROLE_UPDATE:"local-role-update",AUDIO_TRACK_UPDATE:"audio-track-update",AUDIO_TRACK_ADDED:"audio-track-added",AUDIO_TRACK_REMOVED:"audio-track-removed",AUTOPLAY_ERROR:"autoplay-error",LEAVE:"leave",ERROR:"error"},xQ="2.5",bQ="20250115",Cc="_handraise",k_=1e3,T_=64,wQ="https://whiteboard.100ms.live",SQ="https://whiteboard-qa.100ms.live",os=class am extends GL{constructor(t,n,r,s){super(t,n,r),this._degraded=!1,this._degradedAt=null,this._layerDefinitions=[],this.history=new kQ,this.preferredLayer="high",this.disableNoneLayerRequest=!1,this.disableNoneLayerRequest=!!s,this.setVideoHandler(new WL(this))}setTrackId(t){this.bizTrackId=t}get trackId(){return this.bizTrackId||super.trackId}get degraded(){return this._degraded}get degradedAt(){return this._degradedAt}setEnabled(t){return T(this,null,function*(){t!==this.enabled&&(ho(am.prototype,this,"setEnabled").call(this,t),this.videoHandler.updateSinks(!0))})}setPreferredLayer(t){return T(this,null,function*(){if(t==="none"){_.w("layer none will be ignored");return}if(this.preferredLayer=t,!!this.shouldSendVideoLayer(t,"preferLayer")){if(!this.hasSinks()){_.d(`[Remote Track] ${this.logIdentifier}
        streamId=${this.stream.id} 
        trackId=${this.trackId}
        saving ${t}, source=${this.source}
        Track does not have any sink`);return}yield this.requestLayer(t,"preferLayer"),this.pushInHistory(`uiPreferLayer-${t}`)}})}getSimulcastLayer(){return this.stream.getSimulcastLayer()}getLayer(){return this.stream.getVideoLayer()}getPreferredLayer(){return this.preferredLayer}getPreferredLayerDefinition(){return this._layerDefinitions.find(t=>t.layer===this.preferredLayer)}replaceTrack(t){this.nativeTrack=t.nativeTrack,t.transceiver&&(this.transceiver=t.transceiver,this.stream.updateId(t.stream.id)),this.videoHandler.updateSinks()}addSink(t,n=!0){return T(this,null,function*(){Vc(this.nativeTrack)?yield this.requestLayer(this.preferredLayer,"addSink"):(ho(am.prototype,this,"addSink").call(this,t),n&&(yield this.updateLayer("addSink"))),this.pushInHistory("uiSetLayer-high")})}removeSink(t,n=!0){return T(this,null,function*(){ho(am.prototype,this,"removeSink").call(this,t),n&&(yield this.updateLayer("removeSink")),this._degraded=!1,this.pushInHistory("uiSetLayer-none")})}getSimulcastDefinitions(){return[...this._layerDefinitions]}setSimulcastDefinitons(t){this._layerDefinitions=t}setLayerFromServer(t){this._degraded=this.getDegradationValue(t),this._degradedAt=this._degraded?new Date:this._degradedAt;let n=t.current_layer;return _.d(`[Remote Track] ${this.logIdentifier} 
      streamId=${this.stream.id} 
      trackId=${this.trackId}
      layer update from sfu
      currLayer=${t.current_layer}
      preferredLayer=${t.expected_layer}
      sub_degraded=${t.subscriber_degraded}
      pub_degraded=${t.publisher_degraded}
      isDegraded=${this._degraded}`),this.stream.setVideoLayerLocally(n,this.logIdentifier,"setLayerFromServer"),this.pushInHistory(`sfuLayerUpdate-${n}`),this._degraded}getDegradationValue(t){return this.enabled&&(t.publisher_degraded||t.subscriber_degraded)&&t.current_layer==="none"}updateLayer(t){return T(this,null,function*(){let n=this.preferredLayer;this.enabled&&this.hasSinks()?n=this.preferredLayer:this.disableNoneLayerRequest||(n="none"),this.shouldSendVideoLayer(n,t)&&(yield this.requestLayer(n,t))})}pushInHistory(t){}requestLayer(t,n){return T(this,null,function*(){try{let r=yield this.stream.setVideoLayer(t,this.trackId,this.logIdentifier,n);return _.d(`[Remote Track] ${this.logIdentifier} 
      streamId=${this.stream.id}
      trackId=${this.trackId}
      Requested layer ${t}, source=${n}`),r}catch(r){throw _.d(`[Remote Track] ${this.logIdentifier} 
      streamId=${this.stream.id}
      trackId=${this.trackId}
      Failed to set layer ${t}, source=${n}
      error=${r.message}`),r}})}shouldSendVideoLayer(t,n){let r=this.getLayer();return this.degraded&&t==="none"?!0:r===t?(_.d(`[Remote Track] ${this.logIdentifier}`,`Not sending update, already on layer ${t}, source=${n}`),!1):!0}},kQ=class{constructor(){this.history=[]}push(e){e.time=new Date().toISOString().split("T")[1],this.history.push(e)}},Bc=class extends ML{constructor(){super(...arguments),this.TAG="[HMSLocalStream]",this.connection=null}setConnection(e){this.connection=e}addTransceiver(e,t){let n=this.connection.addTransceiver(e.getTrackBeingSent(),{streams:[this.nativeStream],direction:"sendonly",sendEncodings:this.getTrackEncodings(e,t)});return this.setPreferredCodec(n,e.nativeTrack.kind),e.transceiver=n,n}setMaxBitrateAndFramerate(e,t){return T(this,null,function*(){var n;yield(n=this.connection)==null?void 0:n.setMaxBitrateAndFramerate(e,t)})}setPreferredCodec(e,t){}replaceStreamTrack(e,t){this.nativeStream.addTrack(t),this.nativeStream.removeTrack(e)}removeSender(e){var t,n;if(!this.connection||this.connection.connectionState==="closed"){_.d(this.TAG,"publish connection is not initialised or closed");return}let r=(t=e.transceiver)==null?void 0:t.sender;if(!r){_.w(this.TAG,`No sender found for trackId=${e.trackId}`);return}(n=this.connection)==null||n.removeTrack(r);let s=this.tracks.indexOf(e);s!==-1?this.tracks.splice(s,1):_.w(this.TAG,`Cannot find ${e.trackId} in locally stored tracks`)}getTrackEncodings(e,t){let n=[];if(e instanceof Ss)if(t.length>0)_.d(this.TAG,"Simulcast enabled with layers",t),n.push(...t);else{let r={active:this.nativeStream.active};e.settings.maxBitrate&&!Z0&&(r.maxBitrate=e.settings.maxBitrate),n.push(r)}return n}},ik=class extends ML{constructor(e,t){super(e),this.audio=!0,this.video="none",this.connection=t}setAudio(e,t,n){return T(this,null,function*(){this.audio!==e&&(this.audio=e,_.d(`[Remote stream] ${n||""} 
    streamId=${this.id}
    trackId=${t}
    subscribing audio - ${this.audio}`),yield this.connection.sendOverApiDataChannelWithResponse({params:{subscribed:this.audio,track_id:t},method:"prefer-audio-track-state"}))})}setVideoLayerLocally(e,t,n){this.video=e,_.d(`[Remote stream] ${t}
    streamId=${this.id}
    source: ${n}
    Setting layer field to=${e}`)}setVideoLayer(e,t,n,r){return _.d(`[Remote stream] ${n} 
      streamId=${this.id}
      trackId=${t} 
      source: ${r} request ${e} layer`),this.setVideoLayerLocally(e,n,r),this.connection.sendOverApiDataChannelWithResponse({params:{max_spatial_layer:this.video,track_id:t},method:"prefer-video-track-state"})}getSimulcastLayer(){return this.video}getVideoLayer(){return this.video}isAudioSubscribed(){return this.audio}},TQ=(e,t,n,r)=>T(void 0,null,function*(){var s;let i,o={};if((s=t.transceiver)!=null&&s.sender.track){try{i=yield t.transceiver.sender.getStats();let l={},c={},d={};i==null||i.forEach(u=>{switch(u.type){case"outbound-rtp":c[u.id]=u;break;case"remote-inbound-rtp":d[u.ssrc]=u;break;case"codec":l[u.id]=u.mimeType;break;default:break}}),Object.keys(de({},c)).forEach(u=>{var h,f;let m=(h=c[u])==null?void 0:h.codecId,g=m?l[m]:void 0,v;g&&(v=g.substring(g.indexOf("/")+1));let x=Ke(de({},c[u]),{rid:(f=c[u])==null?void 0:f.rid}),S=d[x.ssrc];o[u]=Ke(de({},x),{bitrate:wv("bytesSent",x,r==null?void 0:r[u]),packetsLost:S==null?void 0:S.packetsLost,jitter:S==null?void 0:S.jitter,roundTripTime:S==null?void 0:S.roundTripTime,totalRoundTripTime:S==null?void 0:S.totalRoundTripTime,peerName:n,peerID:t.peerId,enabled:t.enabled,codec:v})})}catch(l){e.analytics.publish(Be.rtcStatsFailed(oe.WebrtcErrors.StatsFailed("TRACK",`Error getting local track stats ${t.trackId} - ${l.message}`))),_.w("[HMSWebrtcStats]","Error in getting local track stats",t,l,l.name)}return o}}),CQ=(e,t,n,r)=>T(void 0,null,function*(){var s;let i;try{i=yield(s=t.transceiver)==null?void 0:s.receiver.getStats()}catch(d){e.analytics.publish(Be.rtcStatsFailed(oe.WebrtcErrors.StatsFailed("TRACK",`Error getting remote track stats ${t.trackId} - ${d.message}`))),_.w("[HMSWebrtcStats]","Error in getting remote track stats",t,d)}let o=EQ(i),l=wv("bytesReceived",o,r),c=Nw("packetsLost",o,r);return o!=null&&o.remote&&Object.assign(o.remote,{packetsLostRate:Nw("packetsLost",o.remote,r==null?void 0:r.remote)}),o&&Ke(de({},o),{bitrate:l,packetsLostRate:c,peerID:t.peerId,enabled:t.enabled,peerName:n,codec:o.codec})}),EQ=e=>{let t,n,r={};e==null||e.forEach(o=>{switch(o.type){case"inbound-rtp":t=o;break;case"outbound-rtp":t=o;break;case"remote-inbound-rtp":n=o;break;case"codec":r[o.id]=o.mimeType;break}});let s=t!=null&&t.codecId?r[t.codecId]:void 0,i;return s&&(i=s.substring(s.indexOf("/")+1)),t&&Object.assign(t,{remote:n,codec:i})},C_=(e,t,n)=>{let r=_Q(t),s=wv(e==="publish"?"bytesSent":"bytesReceived",r,n&&n[e]);return r&&Object.assign(r,{bitrate:s})},_Q=e=>{let t;return e==null||e.forEach(n=>{n.type==="transport"&&(t=e==null?void 0:e.get(n.selectedCandidatePairId))}),t||e==null||e.forEach(n=>{n.type==="candidate-pair"&&n.selected&&(t=n)}),t},PQ=e=>{let t={packetsLost:0,jitter:0};return e==null||e.forEach(n=>{n.packetsLost&&(t.packetsLost+=n.packetsLost),n.jitter>t.jitter&&(t.jitter=n.jitter)}),t},NQ=(e,t)=>Array.from(new Set(e.concat(t))),wv=(e,t,n)=>Nw(e,t,n)*8,Nw=(e,t,n)=>{let r=t&&t[e],s=n?n[e]:null;return[t,n,Co(r),Co(s)].every(i=>!!i)?KL(r,s,t==null?void 0:t.timestamp,n==null?void 0:n.timestamp)*1e3:0},KL=(e,t,n,r)=>Co(e)&&Co(t)&&n&&r?(e-t)/(n-r):0,IQ=class{constructor(e,t,n,r){this.store=e,this.eventBus=t,this.publishConnection=n,this.subscribeConnection=r,this.TAG="[HMSWebrtcStats]",this.peerStats={},this.remoteTrackStats={},this.localTrackStats={},this.getLocalPeerStats=()=>this.peerStats[this.localPeerID],this.getRemoteTrackStats=i=>this.remoteTrackStats[i],this.getAllRemoteTracksStats=()=>this.remoteTrackStats,this.getLocalTrackStats=()=>this.localTrackStats,this.updateStats=()=>T(this,null,function*(){yield this.updateLocalPeerStats(),yield this.updateLocalTrackStats(),yield this.updateRemoteTrackStats()}),this.updateLocalPeerStats=()=>T(this,null,function*(){var i,o,l,c;let d=this.getLocalPeerStats(),u;try{u=yield(i=this.publishConnection)==null?void 0:i.getStats()}catch(y){this.eventBus.analytics.publish(Be.rtcStatsFailed(oe.WebrtcErrors.StatsFailed("PUBLISH",y.message))),_.w(this.TAG,"Error in getting publish stats",y)}let h=u&&C_("publish",u,d),f;try{f=yield(o=this.subscribeConnection)==null?void 0:o.getStats()}catch(y){this.eventBus.analytics.publish(Be.rtcStatsFailed(oe.WebrtcErrors.StatsFailed("SUBSCRIBE",y.message))),_.w(this.TAG,"Error in getting subscribe stats",y)}let m=f&&C_("subscribe",f,d),{packetsLost:g,jitter:v}=PQ(f),x=KL(g,(l=d==null?void 0:d.subscribe)==null?void 0:l.packetsLost,m==null?void 0:m.timestamp,(c=d==null?void 0:d.subscribe)==null?void 0:c.timestamp),S=m&&Object.assign(m,{packetsLostRate:x,jitter:v,packetsLost:g});this.peerStats[this.localPeerID]={publish:h,subscribe:S}}),this.updateRemoteTrackStats=()=>T(this,null,function*(){var i;let o=Array.from(this.store.getTracksMap().values()).filter(c=>c instanceof os||c instanceof Cd),l=o.map(c=>c.trackId);Object.keys(this.remoteTrackStats).forEach(c=>{l.includes(c)||delete this.remoteTrackStats[c]});for(let c of o){let d=c.peerId&&((i=this.store.getPeerById(c.peerId))==null?void 0:i.name),u=this.getRemoteTrackStats(c.trackId),h=yield CQ(this.eventBus,c,d,u);h&&(this.remoteTrackStats[c.trackId]=h)}}),this.updateLocalTrackStats=()=>T(this,null,function*(){var i;let o=this.store.getLocalPeerTracks().reduce((c,d)=>(c[d.getTrackIDBeingSent()]=d,c),{}),l=NQ(Object.keys(this.localTrackStats),Object.keys(o));for(let c of l){let d=o[c];if(d){let u=(i=this.store.getLocalPeer())==null?void 0:i.name,h=yield TQ(this.eventBus,d,u,this.localTrackStats[c]);h&&(this.localTrackStats[c]=h)}else delete this.localTrackStats[c]}});var s;this.localPeerID=(s=this.store.getLocalPeer())==null?void 0:s.peerId}setPeerConnections({publish:e,subscribe:t}){this.publishConnection=e,this.subscribeConnection=t}getPublishPeerConnection(){return this.publishConnection}getSubscribePeerConnection(){return this.subscribeConnection}},AQ=class{constructor(e,t){this.store=e,this.eventBus=t,this.TAG="[HMSWebrtcInternals]",this.interval=1e3,this.isMonitored=!1,this.handleStatsUpdate=()=>T(this,null,function*(){var n;yield(n=this.hmsStats)==null?void 0:n.updateStats(),this.hmsStats&&this.eventBus.statsUpdate.publish(this.hmsStats)})}getCurrentStats(){return this.hmsStats}getPublishPeerConnection(){var e;return(e=this.hmsStats)==null?void 0:e.getPublishPeerConnection()}getSubscribePeerConnection(){var e;return(e=this.hmsStats)==null?void 0:e.getSubscribePeerConnection()}onStatsChange(e){return this.eventBus.statsUpdate.subscribe(e),()=>{this.eventBus.statsUpdate.unsubscribe(e)}}setPeerConnections({publish:e,subscribe:t}){this.hmsStats?this.hmsStats.setPeerConnections({publish:e,subscribe:t}):this.hmsStats=new IQ(this.store,this.eventBus,e,t)}start(){return T(this,null,function*(){if(this.isMonitored){_.d(this.TAG,"Already started");return}this.stop(),this.isMonitored=!0,_.d(this.TAG,"Starting Webrtc Stats Monitor"),this.startLoop().then(()=>_.d(this.TAG,"Stopping Webrtc Stats Monitor")).catch(e=>{this.eventBus.analytics.publish(Be.rtcStatsFailed(oe.WebrtcErrors.StatsFailed("PUBLISH",e.message))),_.e(this.TAG,e.message)})})}stop(){this.isMonitored=!1}startLoop(){return T(this,null,function*(){for(;this.isMonitored;)yield this.handleStatsUpdate(),yield ma(this.interval)})}cleanup(){this.stop(),this.eventBus.statsUpdate.removeAllListeners()}},QL=class{constructor({peerId:e,name:t,isLocal:n,customerUserId:r,metadata:s,role:i,joinedAt:o,groups:l,realtime:c,type:d}){this.customerUserId="",this.metadata="",this.auxiliaryTracks=[],this.name=t,this.peerId=e,this.isLocal=n,this.customerUserId=r,this.metadata=s,this.joinedAt=o,this.groups=l,this.realtime=c,this.type=d,i&&(this.role=i)}get isHandRaised(){var e;return!!((e=this.groups)!=null&&e.includes(Cc))}updateRole(e){this.role=e}updateName(e){this.name=e}updateNetworkQuality(e){this.networkQuality=e}updateMetadata(e){this.metadata=e}updateGroups(e){this.groups=e}toString(){var e,t,n,r;return`{
      name: ${this.name};
      role: ${(e=this.role)==null?void 0:e.name};
      peerId: ${this.peerId};
      customerUserId: ${this.customerUserId};
      ${this.audioTrack?`audioTrack: ${(t=this.audioTrack)==null?void 0:t.trackId};`:""}
      ${this.videoTrack?`videoTrack: ${(n=this.videoTrack)==null?void 0:n.trackId};`:""}
      groups: ${(r=this.groups)==null?void 0:r.join()}
    }`}},JL=class{};JL.makePeerId=()=>Lo();var YL=class extends QL{constructor(e){super(Ke(de({},e),{peerId:JL.makePeerId(),isLocal:!0})),this.isLocal=!0,this.auxiliaryTracks=[],this.asRole=e.asRole}isInPreview(){return!!this.asRole}toString(){var e,t,n;return`{
      name: ${this.name};
      role: ${(e=this.role)==null?void 0:e.name};
      peerId: ${this.peerId};
      customerUserId: ${this.customerUserId};
      ${this.asRole?`asRole: ${this.asRole.name};`:""}
      ${this.audioTrack?`audioTrack: ${(t=this.audioTrack)==null?void 0:t.trackId};`:""}
      ${this.videoTrack?`videoTrack: ${(n=this.videoTrack)==null?void 0:n.trackId};`:""}
    }`}},RQ=class extends QL{constructor(e){super(Ke(de({},e),{isLocal:!1})),this.isLocal=!1,this.auxiliaryTracks=[],this.fromRoomState=!1,this.fromRoomState=!!e.fromRoomState}},zc=(e,t)=>new RQ({peerId:e.peer_id,name:e.info.name,role:t.getPolicyForRole(e.role),customerUserId:e.info.user_id,metadata:e.info.data,groups:e.groups,type:e.info.type}),jQ=class{constructor(e,t,n){this.transport=e,this.store=t,this.options=n,this.isEnd=!1,this.iterator=null,this.total=0,this.defaultPaginationLimit=10}validateConnection(){if(!this.transport||!this.store)throw Error("Use usePaginatedParticipants or hmsActions.getPeerListIterator after preview or join has happened")}hasNext(){return!this.isEnd}getTotal(){return this.total}findPeers(){return T(this,null,function*(){var e;this.validateConnection();let t=yield this.transport.signal.findPeers(Ke(de({},this.options||{}),{limit:((e=this.options)==null?void 0:e.limit)||this.defaultPaginationLimit}));return this.updateState(t),this.processPeers(t.peers)})}next(){return T(this,null,function*(){var e;this.validateConnection();let t;return!this.iterator&&!this.isEnd?yield this.findPeers():this.iterator?(t=yield this.transport.signal.peerIterNext({iterator:this.iterator,limit:((e=this.options)==null?void 0:e.limit)||this.defaultPaginationLimit}),this.updateState(t),this.processPeers(t.peers)):[]})}processPeers(e){let t=[];return e.forEach(n=>{let r=zc(n,this.store);t.push(r)}),t}updateState(e){this.isEnd=e.eof,this.total=e.total,e.iterator&&(this.iterator=e.iterator)}},XL=class{constructor(e){this.TAG="[AudioContextManager]",this.audioContext=new AudioContext,this.source=this.audioContext.createMediaElementSource(e),this.source.connect(this.audioContext.destination)}resumeContext(){return T(this,null,function*(){this.audioContext.state==="suspended"&&(yield this.audioContext.resume(),_.d(this.TAG,"AudioContext is resumed"))})}getAudioTrack(){return this.destinationNode&&this.source.disconnect(this.destinationNode),this.destinationNode=this.audioContext.createMediaStreamDestination(),this.source.connect(this.destinationNode),this.destinationNode.stream.getAudioTracks()[0]}cleanup(){this.audioContext.state!=="closed"&&this.audioContext.close().catch(e=>{_.d(this.TAG,"AudioContext close error",e.message)})}},ak=class extends yv.EventEmitter2{on(e,t){return super.on(e,t)}off(e,t){return super.off(e,t)}emit(e,t){return super.emit(e,t)}listeners(e){return super.listeners(e)}},MQ=class extends ak{constructor(){super(...arguments),this.audioElement=null,this.TAG="[PlaylistAudioManager]",this.seeked=!1}play(e){return T(this,null,function*(){return this.audioElement=this.getAudioElement(),new Promise((t,n)=>{this.audioElement=this.getAudioElement(),this.audioElement.src=e,this.seeked=!1,this.audioElement.onerror=()=>{let r=`Error loading ${e}`;_.e(this.TAG,r),this.stop(),n(r)},this.audioElement.oncanplaythrough=()=>T(this,null,function*(){try{if(!this.audioElement)return;if(this.audioContextManager.resumeContext(),this.track)this.seeked?this.seeked=!1:(yield this.audioElement.play(),t([this.track]));else{yield this.audioElement.play();let r=this.audioContextManager.getAudioTrack();this.track=r,t([r])}}catch(r){_.e(this.TAG,"Error playing audio",e,r.message),n(r)}}),this.audioElement.onseeked=()=>{this.seeked=!0}})})}getTracks(){return this.track?[this.track.id]:[]}getElement(){return this.audioElement||(this.audioElement=this.getAudioElement()),this.audioElement}stop(){var e,t,n;(e=this.audioElement)==null||e.pause(),(t=this.audioElement)==null||t.removeAttribute("src"),this.audioElement=null,(n=this.audioContextManager)==null||n.cleanup(),this.track=void 0}getAudioElement(){if(this.audioElement)return this.audioElement;let e=document.createElement("audio");return e.crossOrigin="anonymous",e.addEventListener("timeupdate",t=>this.emit("progress",t)),e.addEventListener("ended",()=>{this.emit("ended",null)}),this.audioContextManager=new XL(e),e}},DQ=class extends ak{constructor(){super(...arguments),this.TAG="[PlaylistVideoManager]",this.videoElement=null,this.canvasContext=null,this.tracks=[],this.DEFAUL_FPS=24,this.seeked=!1,this.drawImage=()=>{var e,t,n;this.videoElement&&!this.videoElement.paused&&!this.videoElement.ended&&((n=this.canvasContext)==null||n.drawImage(this.videoElement,0,0,(e=this.canvas)==null?void 0:e.width,(t=this.canvas)==null?void 0:t.height),this.timer=setTimeout(()=>{this.drawImage()},1e3/this.DEFAUL_FPS))}}play(e){return this.videoElement=this.getVideoElement(),this.createCanvas(),new Promise((t,n)=>{this.videoElement=this.getVideoElement(),this.videoElement.src=e,this.seeked=!1,this.videoElement.onerror=()=>{let r=`Error loading ${e}`;_.e(this.TAG,r),this.stop(),n(r)},this.videoElement.oncanplaythrough=()=>T(this,null,function*(){var r,s,i;try{if(!this.videoElement)return;if(this.canvas.width=this.videoElement.videoWidth,this.canvas.height=this.videoElement.videoHeight,this.tracks.length===0){this.clearCanvasAndTracks();let o=this.canvas.captureStream();if(!o){_.e(this.TAG,"Browser does not support captureStream");return}this.videoElement.onplay=this.drawImage,yield this.audioContextManager.resumeContext(),yield this.videoElement.play();let l=this.audioContextManager.getAudioTrack();o.addTrack(l),o.getTracks().forEach(c=>{this.tracks.push(c)}),t(this.tracks)}else this.seeked?(this.seeked=!1,(i=this.canvasContext)==null||i.drawImage(this.videoElement,0,0,(r=this.canvas)==null?void 0:r.width,(s=this.canvas)==null?void 0:s.height)):(yield this.videoElement.play(),t(this.tracks))}catch(o){_.e(this.TAG,"Error playing video",e,o.message),n(o)}}),this.videoElement.onseeked=()=>{this.seeked=!0}})}getTracks(){return this.tracks.map(e=>e.id)}getElement(){return this.videoElement||(this.videoElement=this.getVideoElement()),this.videoElement}stop(){var e,t,n;(e=this.videoElement)==null||e.pause(),(t=this.videoElement)==null||t.removeAttribute("src"),this.videoElement=null,(n=this.audioContextManager)==null||n.cleanup(),this.clearCanvasAndTracks()}clearCanvasAndTracks(){var e;this.tracks=[],(e=this.canvasContext)==null||e.clearRect(0,0,this.canvas.width,this.canvas.height),clearTimeout(this.timer)}getVideoElement(){if(this.videoElement)return this.videoElement;let e=document.createElement("video");return e.crossOrigin="anonymous",e.addEventListener("timeupdate",t=>this.emit("progress",t)),e.addEventListener("ended",()=>{this.emit("ended",null)}),this.audioContextManager=new XL(e),e}createCanvas(){this.canvas||(this.canvas=document.createElement("canvas"),this.canvasContext=this.canvas.getContext("2d"))}},Tp={audio:{list:[],currentIndex:-1,isAutoplayOn:!0},video:{list:[],currentIndex:-1,isAutoplayOn:!0}},OQ=class extends ak{constructor(e,t){super(),this.sdk=e,this.eventBus=t,this.state={audio:de({},Tp.audio),video:de({},Tp.video)},this.TAG="[PlaylistManager]",this.handlePausePlaylist=n=>T(this,[n],function*({enabled:r,track:s}){var i;if(r)return;let o;s.source==="audioplaylist"&&(o="audio"),s.source==="videoplaylist"&&(o="video"),o&&((i=this.getElement(o))==null||i.pause())}),this.addTrack=(n,r)=>T(this,null,function*(){yield this.sdk.addTrack(n,r),_.d(this.TAG,"Playlist track added",$L(n))}),this.removeTrack=n=>T(this,null,function*(){yield this.sdk.removeTrack(n,!0),_.d(this.TAG,"Playlist track removed",n)}),this.audioManager=new MQ,this.videoManager=new DQ,this.addListeners()}getList(e="audio"){return this.state[e].list}setList(e){if(!e||e.length===0){_.w(this.TAG,"Please pass in a list of HMSPlaylistItem's");return}e.forEach(t=>{this.state[t.type].list.find(n=>n.id===t.id)||this.state[t.type].list.push(t)})}clearList(e){return T(this,null,function*(){this.isPlaying(e)&&(yield this.stop(e)),this.state[e].list=[]})}removeItem(e,t){return T(this,null,function*(){let{list:n,currentIndex:r}=this.state[t],s=n.findIndex(i=>e===i.id);return s>-1?(r===s&&this.isPlaying(t)&&(yield this.stop(t)),n.splice(s,1),!0):!1})}seek(e,t="audio"){let{currentIndex:n}=this.state[t];if(n===-1)throw oe.PlaylistErrors.NoEntryToPlay("PLAYLIST","No item is currently playing");let r=this.getElement(t);if(r){let s=Math.max(r.currentTime+e,0);r.currentTime=Math.min(s,r.duration)}}seekTo(e,t="audio"){let{currentIndex:n}=this.state[t];if(n===-1)throw oe.PlaylistErrors.NoEntryToPlay("PLAYLIST","No item is currently playing");if(e<0)throw Error("value cannot be negative");let r=this.getElement(t);r&&(r.currentTime=Math.min(e,r.duration))}setVolume(e,t="audio"){if(e<0||e>100)throw Error("Please pass a valid number between 0-100");let n=this.getElement(t);n&&(n.volume=e*.01)}getVolume(e="audio"){let t=this.getElement(e);return t?Math.floor(t.volume*100):0}getCurrentTime(e="audio"){let t=this.getElement(e);return(t==null?void 0:t.currentTime)||0}getCurrentIndex(e="audio"){return this.state[e].currentIndex}getCurrentProgress(e="audio"){var t;let{list:n,currentIndex:r}=this.state[e],s=(t=n[r])==null?void 0:t.url,i=this.getElement(e);return!s||!i?0:Math.floor(100*(i.currentTime/i.duration))}getCurrentSelection(e="audio"){let{list:t,currentIndex:n}=this.state[e];if(n!==-1)return t[n]}isPlaying(e="audio"){let t=this.getElement(e);return!!t&&!t.paused}setIsAutoplayOn(e="audio",t){this.state[e].isAutoplayOn=t}getPlaybackRate(e="audio"){let t=this.getElement(e);return t?t.playbackRate:1}setPlaybackRate(e="audio",t){if(t<.25||t>2)throw Error("Please pass a value between 0.25 and 2.0");let n=this.getElement(e);n&&(n.playbackRate=t)}setEnabled(e,t){return T(this,arguments,function*(n,{id:r,type:s="audio"}){let i=this.state[s].list.findIndex(l=>l.id===r);if(!r||i===-1){_.w(this.TAG,"Pass a valid id");return}let o=this.state[s].list[i].url;n?yield this.play(o,s):yield this.pause(o,s),this.state[s].currentIndex=i,this.setDuration(s)})}playNext(){return T(this,arguments,function*(e="audio"){let{list:t,currentIndex:n}=this.state[e];if(n>=t.length-1)throw oe.PlaylistErrors.NoEntryToPlay("PLAYLIST","Reached end of playlist");yield this.play(t[n+1].url,e),this.state[e].currentIndex=n+1,this.setDuration(e)})}playPrevious(){return T(this,arguments,function*(e="audio"){let{list:t,currentIndex:n}=this.state[e];if(n<=0)throw oe.PlaylistErrors.NoEntryToPlay("PLAYLIST","Reached start of playlist");yield this.play(t[n-1].url,e),this.state[e].currentIndex=n-1,this.setDuration(e)})}stop(){return T(this,arguments,function*(e="audio"){var t;let n=e==="audio"?this.audioManager:this.videoManager;(t=n.getElement())==null||t.pause(),yield this.removeTracks(e),n.stop(),this.state[e].currentIndex=-1})}cleanup(){this.state={audio:de({},Tp.audio),video:de({},Tp.video)},this.eventBus.localAudioEnabled.unsubscribe(this.handlePausePlaylist),this.eventBus.localVideoEnabled.unsubscribe(this.handlePausePlaylist),this.audioManager.stop(),this.videoManager.stop()}onProgress(e){this.videoManager.on("progress",()=>{try{e({type:"video",progress:this.getCurrentProgress("video")})}catch{_.e(this.TAG,"Error in onProgress callback")}}),this.audioManager.on("progress",()=>{try{e({type:"audio",progress:this.getCurrentProgress("audio")})}catch{_.e(this.TAG,"Error in onProgress callback")}})}onNewTrackStart(e){this.on("newTrackStart",e)}onPlaylistEnded(e){this.on("playlistEnded",e)}onCurrentTrackEnded(e){this.on("currentTrackEnded",e)}getElement(e="audio"){return e==="audio"?this.audioManager.getElement():this.videoManager.getElement()}removeTracks(){return T(this,arguments,function*(e="audio"){let t=(e==="audio"?this.audioManager:this.videoManager).getTracks();for(let n of t)yield this.removeTrack(n)})}play(e){return T(this,arguments,function*(t,n="audio"){let r=n==="audio"?this.audioManager:this.videoManager,s=r.getElement();if(this.isItemCurrentlyPlaying(t,n)){_.w(this.TAG,`The ${n} is currently playing`);return}if(s!=null&&s.src.includes(t))yield s.play();else{s==null||s.pause();let i=yield r.play(t);for(let o of i)yield this.addTrack(o,n==="audio"?"audioplaylist":"videoplaylist")}})}isItemCurrentlyPlaying(e,t){let n=this.getElement(t);return!!(n&&!n.paused&&n.src.includes(e))}setDuration(e="audio"){let t=this.getElement(e),{list:n,currentIndex:r}=this.state[e];n[r]&&(n[r].duration=(t==null?void 0:t.duration)||0),this.emit("newTrackStart",n[r])}pause(e){return T(this,arguments,function*(t,n="audio"){let r=this.getElement(n);r&&!r.paused&&r.src.includes(t)?(r.pause(),_.d(this.TAG,"paused url",t)):_.w(this.TAG,"The passed in url is not currently playing")})}addListeners(){this.audioManager.on("ended",()=>this.handleEnded("audio")),this.videoManager.on("ended",()=>this.handleEnded("video")),this.eventBus.localAudioEnabled.subscribe(this.handlePausePlaylist),this.eventBus.localVideoEnabled.subscribe(this.handlePausePlaylist)}handleEnded(){return T(this,arguments,function*(e="audio"){let{list:t,currentIndex:n,isAutoplayOn:r}=this.state[e];n===t.length-1?(yield this.stop(e),this.emit("playlistEnded",e)):r?this.playNext(e):yield this.pause(t[n].url,e),this.emit("currentTrackEnded",t[n])})}},Dn=e=>e.room,LQ=e=>e.errors;me(LQ,e=>e.length===0?null:e.at(-1));me(Dn,e=>e.id);var js=e=>e.peers,ZL=e=>e.messages.byID,e2=e=>e.messages.allIDs,fn=e=>e.tracks,FQ=e=>e.settings,$Q=e=>e.appData,UQ=e=>e.speakers,Zs=me([Dn],e=>e&&e.isConnected);me([Zs,Dn],(e,t)=>e?t.peerCount!==void 0?t.peerCount||1:t.peers.length:Math.max(t.peerCount!==void 0?t.peerCount:t.peers.length-1,0));var VQ=e=>e.hideLocalPeer,Kd=me([Dn,js,VQ],(e,t,n)=>n?e.peers.filter(r=>e.localPeer!==r).map(r=>t[r]):e.peers.map(r=>t[r])),BQ=me(fn,e=>Object.values(e)),As=me(Dn,js,(e,t)=>t[e.localPeer]),Gc=me(Dn,e=>e.localPeer);me(As,e=>e==null?void 0:e.name);me(As,e=>e==null?void 0:e.roleName);var ea=me(As,e=>e==null?void 0:e.audioTrack),Gs=me(As,e=>e==null?void 0:e.videoTrack),zQ=me(As,e=>e==null?void 0:e.auxiliaryTracks),GQ=me([ea,Gs,zQ],(e,t,n)=>{let r=n?[...n]:[];return e&&r.unshift(e),t&&r.unshift(t),r});me(Kd,e=>e.filter(t=>!t.isLocal));me(js,UQ,(e,t)=>{let n=Object.entries(t).sort((r,s)=>{var i,o;let l=((i=r[1])==null?void 0:i.audioLevel)||0;return(((o=s[1])==null?void 0:o.audioLevel)||0)>l?1:-1});if(n.length>0&&n[0][1].audioLevel&&n[0][1].audioLevel>0){let r=n[0][1].peerID;if(r in e)return e[r]}return null});var ok=e=>{let t=As(e);return RL(e,t==null?void 0:t.audioTrack)},Iw=e=>{let t=As(e);return RL(e,t==null?void 0:t.videoTrack)},WQ=e=>{let t=As(e);return wK(e,t==null?void 0:t.videoTrack)},og=me(As,fn,(e,t)=>{let{video:n,audio:r}=bf(t,e);return!!(n||r)}),HQ=me(js,fn,(e,t)=>{let n;for(let r in e){let s=e[r],{video:i,audio:o}=bf(t,s);if(i)return s;o&&!n&&(n=s)}return n});me(HQ,e=>!!e);me(js,fn,(e,t)=>{for(let n in e){let r=e[n],{audio:s,video:i}=bf(t,r);if(!i&&s)return r}});me(js,fn,(e,t)=>{let n=[],r=[];for(let s in e){let i=e[s],{video:o,audio:l}=bf(t,i);o?n.push(i):l&&r.push(i)}return n.concat(r)});me(js,fn,(e,t)=>{for(let n in t){let r=t[n];if(X0(r)&&Y0(r)&&r.peerId)return e[r.peerId]}});me(js,fn,(e,t)=>{for(let n in t){let r=t[n];if(AL(r)&&r.peerId)return e[r.peerId]}});me(BQ,e=>e.filter(bK));me(e2,e=>e.length);me(ZL,e=>Object.values(e).filter(t=>!t.read).length);var Qd=me(e2,ZL,(e,t)=>{let n=[];return e.forEach(r=>{n.push(t[r])}),n}),qQ=me(Qd,e=>e.filter(t=>{var n;return!t.recipientPeer&&!(t.recipientRoles&&((n=t.recipientRoles)==null?void 0:n.length)>0)}));me(qQ,e=>e.filter(t=>!t.read).length);var yi=me([Dn],e=>e&&e.roomState),KQ=me(yi,e=>e==="Preview");me(Dn,e=>e.roomState!=="Disconnected");me(Dn,e=>!e.transcriptions||e.transcriptions.length<=0?!1:e.transcriptions.some(t=>t.mode==="caption"&&t.state==="started"));var Ed=e=>e.roles;me([Ed],e=>Object.keys(e));var lk=me([As,Ed],(e,t)=>e!=null&&e.roleName?t[e.roleName]:null),QQ=e=>{var t;return(t=e.preview)==null?void 0:t.asRole},JQ=me([QQ,Ed],(e,t)=>e?t[e]:null);me([lk],e=>{var t;return(t=e==null?void 0:e.subscribeParams)!=null&&t.subscribeToRoles?e.subscribeParams.subscribeToRoles.length>0:!1});var YQ=me(lk,e=>e==null?void 0:e.permissions);me(Dn,e=>e.recording);me(Dn,e=>e.rtmp);me(Dn,e=>e.hls);me(Dn,e=>e.transcriptions);me(Dn,e=>e.sessionId);me(Dn,e=>e.startedAt);me(Dn,e=>!!e.isLargeRoom);me(Dn,e=>!!e.isEffectsEnabled);me(Dn,e=>!!e.isVBEnabled);me(Dn,e=>e.effectsKey);var XQ=e=>e.polls;me(Kd,e=>e.filter(t=>t.isHandRaised));var ZQ=e=>e.whiteboards;me(ZQ,e=>Object.values(e)[0]);var t2=(e="audio")=>t=>t.playlist[e].list,ck=(e="audio")=>t=>t.playlist[e].selection,n2=(e="audio")=>me(t2(e),t=>Object.values(t)),r2=(e="audio")=>me(t2(e),ck(e),(t,n)=>{if(n.id)return t[n.id]}),eJ={selection:ck("audio"),list:n2("audio"),selectedItem:r2("audio")},tJ={selection:ck("video"),list:n2("video"),selectedItem:r2("video")};function xr(e){return t=>n=>e(n,t)}var bu="HMS-Store:",Je=class{static v(e,...t){this.log(0,e,...t)}static d(...e){this.log(1,...e)}static i(...e){this.log(2,...e)}static w(...e){this.log(3,...e)}static e(...e){this.log(6,...e)}static time(e){this.log(4,"[HMSPerformanceTiming]",e)}static timeEnd(e){this.log(5,"[HMSPerformanceTiming]",e,e)}static cleanup(){performance.clearMarks(),performance.clearMeasures()}static log(e,...t){if(!(this.level.valueOf()>e.valueOf()))switch(e){case 0:{console.log(bu,...t);break}case 1:{console.debug(bu,...t);break}case 2:{console.info(bu,...t);break}case 3:{console.warn(bu,...t);break}case 6:{console.error(bu,...t);break}case 4:{performance.mark(t[1]);break}case 5:{let n=t[0],r=t[1];try{let s=performance.measure(r,r);this.log(1,n,r,s==null?void 0:s.duration),performance.clearMarks(r),performance.clearMeasures(r)}catch(s){this.log(1,n,r,s)}break}}}};Je.level=0;var dk=(e,t)=>t,wf=(e,t)=>t,s2=(e,t)=>t,nJ=(e,t)=>t,rJ=(e,t)=>t,Fo=me([js,dk],(e,t)=>t?e[t]:null),sJ=me([fn,wf],(e,t)=>t?e[t]:null),iJ=me([fn,wf],(e,t)=>{if(!t)return null;let n=e[t];return(n==null?void 0:n.type)==="video"?n:null});me([fn,wf],(e,t)=>{if(!t)return null;let n=e[t];return(n==null?void 0:n.type)==="audio"?n:null});me([fn,wf],(e,t)=>{if(!t)return null;let n=e[t];return(n==null?void 0:n.type)==="audio"&&(n==null?void 0:n.source)==="screen"?n:null});me([fn,wf],(e,t)=>{if(!t)return null;let n=e[t];return(n==null?void 0:n.type)==="video"&&(n==null?void 0:n.source)==="screen"?n:null});var aJ=me([XQ,rJ],(e,t)=>t?e[t]:null),Vi=xr(Fo);xr(me([$Q,nJ],(e,t)=>{if(e)return t?e[t]:e}));xr(me(Fo,e=>e==null?void 0:e.name));xr(me(Fo,e=>e==null?void 0:e.type));var i2=xr(sJ),oJ=xr(iJ),lJ=xr((e,t)=>{let n=Fo(e,t);if(n&&n.audioTrack&&n.audioTrack!=="")return e.tracks[n.audioTrack]}),a2=(e,t)=>t?e.speakers[t]:null;xr(me(a2,e=>(e==null?void 0:e.audioLevel)||0));var cJ=(e,t)=>{let n=lJ(t)(e);return a2(e,n==null?void 0:n.id)};xr(me(cJ,e=>(e==null?void 0:e.audioLevel)||0));xr(me(fn,Fo,(e,t)=>{let n=t==null?void 0:t.auxiliaryTracks.find(r=>{let s=e[r];return X0(s)&&Y0(s)});return n?e[n]:void 0}));xr(me(fn,Fo,(e,t)=>{let n=t==null?void 0:t.auxiliaryTracks.find(r=>{let s=e[r];return X0(s)&&J0(s)});return n?e[n]:void 0}));xr(me(fn,Fo,(e,t)=>{let n=t==null?void 0:t.auxiliaryTracks.find(r=>{let s=e[r];return AL(s)&&J0(s)});return n?e[n]:void 0}));xr(me(fn,Fo,(e,t)=>bf(e,t)));var dJ=me([Qd,Gc,dk],(e,t,n)=>{if(n)return e.filter(r=>{var s;return!r.recipientPeer&&!((s=r.recipientRoles)!=null&&s.length)||r.sender&&![t,n].includes(r.sender)?!1:[t,n].includes(r.recipientPeer)})}),uJ=me([Qd,s2],(e,t)=>{if(t)return e.filter(n=>{var r,s;return(r=n.recipientRoles)!=null&&r.length?(s=n.recipientRoles)==null?void 0:s.includes(t):!1})}),hJ=me(Qd,e=>e.filter(t=>{var n;return!t.recipientPeer&&!((n=t.recipientRoles)!=null&&n.length)}));me([uJ,s2],e=>e?e.filter(t=>!t.read).length:0);me([dJ,dk],e=>e?e.filter(t=>!t.read).length:0);me(hJ,e=>e.filter(t=>!t.read).length);var fJ=xr(aJ);me([js,fn],(e,t)=>Object.values(e).map(n=>{var r;return{peer:n,isAudioEnabled:n.audioTrack?(r=t[n.audioTrack])==null?void 0:r.enabled:!1}}));var pJ=e=>e.roleChangeRequests[0]||null;me([pJ,js,Ed],(e,t,n)=>e?{requestedBy:e.requestedBy?t[e.requestedBy]:void 0,role:n[e.roleName],token:e.token}:null);me([lk],e=>jL(e));me([JQ],e=>jL(e));me([Gs,fn],(e,t)=>{let n=null;return e&&(n=t[e]),(n==null?void 0:n.plugins)||[]});me([ea,fn],(e,t)=>{let n=null;return e&&(n=t[e]),(n==null?void 0:n.plugins)||[]});var o2={0:"PEER_JOINED",1:"PEER_LEFT",8:"ROLE_UPDATED",10:"NAME_UPDATED",11:"METADATA_UPDATED",12:"HAND_RAISE_CHANGED"},Aw={0:"TRACK_ADDED",1:"TRACK_REMOVED",2:"TRACK_MUTED",3:"TRACK_UNMUTED",5:"TRACK_DEGRADED",6:"TRACK_RESTORED",4:"TRACK_DESCRIPTION_CHANGED"},l2={0:"POLL_CREATED",1:"POLL_STARTED",2:"POLL_STOPPED",4:"POLL_VOTES_UPDATED",3:"POLLS_LIST"},mJ={TRANSCRIPTION_STATE_UPDATED:"TRANSCRIPTION_STATE_UPDATED"},cx="hmsNotification",gJ=class{constructor(e){this.id=0,this.onNotification=(t,n)=>{let r=s=>{if(n){let i;if(Array.isArray(n)?i=n.includes(s.type):i=n===s.type,!i)return}t(s)};return this.eventEmitter.addListener(cx,r),()=>{this.eventEmitter.removeListener(cx,r)}},this.store=e,this.eventEmitter=new yv.EventEmitter2({maxListeners:Object.keys(fo).length})}sendPlaylistTrackEnded(e){let t=this.createNotification("PLAYLIST_TRACK_ENDED",e,"info");this.emitEvent(t)}sendDeviceChange(e){var t;let n=this.createNotification("DEVICE_CHANGE_UPDATE",e,e.error?"error":"info",`Selected ${e.type} device - ${(t=e.selection)==null?void 0:t.label}`);this.emitEvent(n)}sendLeaveRoom(e){var t;let n=(t=e.requestedBy)==null?void 0:t.name,r=this.createNotification(e.roomEnded||!n?"ROOM_ENDED":"REMOVED_FROM_ROOM",e,"info",`${e.roomEnded?"Room ended":"Removed from room"} ${n?`by ${n}`:""}`);this.emitEvent(r)}sendPeerList(e){if(e.length===0)return;let t=this.createNotification("PEER_LIST",e,"info");this.emitEvent(t)}sendPeerUpdate(e,t){let n=this.store.getState(Vi(t==null?void 0:t.id))||t,r=o2[e];if(r&&n){let s=this.createNotification(r,n,"info");this.emitEvent(s)}}sendTrackUpdate(e,t){let n=this.store.getState(i2(t)),r=Aw[e];if(r){let s=this.createNotification(r,n,"info");this.emitEvent(s)}}sendMessageReceived(e){let t=this.createNotification("NEW_MESSAGE",e,"info");this.emitEvent(t)}sendError(e){let t=this.createNotification("ERROR",e,"error");this.emitEvent(t)}sendReconnecting(e){let t=this.createNotification("RECONNECTING",e,"error");this.emitEvent(t)}sendReconnected(){let e=this.createNotification("RECONNECTED",null,"info");this.emitEvent(e)}sendChangeTrackStateRequest(e){let t=this.createNotification("CHANGE_TRACK_STATE_REQUEST",e,"info");this.emitEvent(t)}sendChangeMultiTrackStateRequest(e){let t=this.createNotification("CHANGE_MULTI_TRACK_STATE_REQUEST",e,"info");this.emitEvent(t)}sendPollUpdate(e,t){let n=l2[e],r=this.store.getState(fJ(t));if(n){let s=this.createNotification(n,r,"info");this.emitEvent(s)}}sendTranscriptionUpdate(e){let t=this.createNotification(mJ.TRANSCRIPTION_STATE_UPDATED,e,"info");this.emitEvent(t)}emitEvent(e){this.eventEmitter.emit(cx,e)}createNotification(e,t,n,r=""){return this.id++,{id:this.id,type:e,message:r,data:t,severity:n}}},vJ=class{constructor(e){this.queuedUpdates={},this.timers={},this.DEFAULT_INTERVAL_MS=50,this.store=e}setState(e,t,n=this.DEFAULT_INTERVAL_MS){this.queuedUpdates[t]=this.queuedUpdates[t]||[],this.queuedUpdates[t].push(e),!this.timers[t]&&(window?this.timers[t]=window.setTimeout(()=>this.setStateBatched(t),n):this.setStateBatched(t))}setStateBatched(e){var t;if(((t=this.queuedUpdates[e])==null?void 0:t.length)>0){let n=r=>{this.queuedUpdates[e].forEach(s=>{try{s(r)}catch(i){Je.w("failed to update store",i)}})};console.time(`timed-${e}`),this.store.namedSetState(n,e),console.timeEnd(`timed-${e}`)}delete this.queuedUpdates[e],window&&this.timers[e]&&(window.clearTimeout(this.timers[e]),delete this.timers[e])}};function yJ(e){return e instanceof Cd||e instanceof os}var xJ=(e,t)=>{let n=Sf(Object.keys(e),Object.keys(t));for(let r of n){let s=e[r],i=t[r];_d(s,i)?(Ks(s.auxiliaryTracks,i.auxiliaryTracks)&&(i.auxiliaryTracks=s.auxiliaryTracks),s.groups&&Ks(s.groups,i.groups)&&(i.groups=s.groups),Object.assign(s,i)):uk(s,i)?delete e[r]:Sv(s,i)&&(e[r]=i)}},bJ=(e,t)=>{let n=Sf(Object.keys(e),Object.keys(t));for(let r of n){let s=e[r],i=t[r];_d(s,i)?(c2(s,i),Object.assign(s,i)):uk(s,i)?delete e[r]:Sv(s,i)&&(e[r]=i)}},wJ=(e,t)=>{let n=Sf(Object.keys(e),Object.keys(t));for(let r of n){let s=e[r],i=t[r];_d(s,i)?(s.questions&&Ks(s.questions,i.questions)&&(i.questions=s.questions),Object.assign(s,i)):Sv(s,i)&&(e[r]=i)}},E_=(e,t)=>{let n=Sf(Object.keys(e),Object.keys(t));for(let r of n){let s=e[r],i=t[r];_d(s,i)?Object.assign(s,i):uk(s,i)?delete e[r]:Sv(s,i)&&(e[r]=i)}},SJ=(e,t,n)=>{let r=n.reduce((i,o)=>(i[o.firstTrackId]=Object.values(t[o.getTrackIDBeingSent()]||{}).sort((l,c)=>!l.rid||!c.rid?0:l.rid<c.rid?-1:1),i),{}),s=Sf(Object.keys(e),Object.keys(r));for(let i of s){if(!r[i]){delete e[i];continue}e[i]=r[i]}},c2=(e,t)=>{e.plugins&&Ks(e.plugins,t.plugins)&&(t.plugins=e.plugins),e.type==="video"&&e.layerDefinitions&&Ks(e.layerDefinitions,t.layerDefinitions)&&(t.layerDefinitions=e.layerDefinitions)},_d=(e,t)=>e&&t,uk=(e,t)=>e&&!t,Sv=(e,t)=>!e&&t,Ks=(e,t)=>{if(e===t||e.length===0&&(t==null?void 0:t.length)===0)return!0;if(!e||!t||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0},Sf=(e,t)=>{let n=new Set;for(let r of e)n.add(r);for(let r of t)n.add(r);return Array.from(n)},Gt=class Ma{static convertPeer(t){var n,r,s;return{id:t.peerId,name:t.name,roleName:(n=t.role)==null?void 0:n.name,isLocal:t.isLocal,videoTrack:(r=t.videoTrack)==null?void 0:r.trackId,audioTrack:(s=t.audioTrack)==null?void 0:s.trackId,auxiliaryTracks:t.auxiliaryTracks.map(i=>i.trackId),customerUserId:t.customerUserId,metadata:t.metadata,joinedAt:t.joinedAt,groups:t.groups,isHandRaised:t.isHandRaised,type:t.type}}static convertTrack(t,n){let r={id:t.trackId,source:t.source,type:t.type,enabled:t.enabled,displayEnabled:t.enabled,peerId:t.peerId||n};return this.enrichTrack(r,t),r}static enrichTrack(t,n){let r=n.getMediaTrackSettings();n instanceof Cd&&(t.volume=n.getVolume()||0),Ma.updateDeviceID(t,n),Ma.enrichLocalTrack(t,n),t.type==="video"&&(t.source==="screen"?(t.displaySurface=r.displaySurface,Ma.enrichScreenTrack(t,n)):t.source==="regular"&&(t.facingMode=r.facingMode),t.height=r.height,t.width=r.width,Ma.enrichVideoTrack(t,n)),Ma.enrichPluginsDetails(t,n)}static enrichLocalTrack(t,n){(n instanceof Ss||n instanceof wl)&&(t.isPublished=n.isPublished)}static updateDeviceID(t,n){var r;n instanceof Ss||n instanceof wl?t.deviceID=n.settings.deviceId:t.deviceID=(r=n.getMediaTrackSettings())==null?void 0:r.deviceId}static enrichVideoTrack(t,n){n instanceof os&&(t.layer=n.getLayer(),t.preferredLayer=n.getPreferredLayer(),t.degraded=n.degraded),(n instanceof os||n instanceof Ss)&&(Ks(n.getSimulcastDefinitions(),t.layerDefinitions)||(t.layerDefinitions=n.getSimulcastDefinitions()))}static enrichScreenTrack(t,n){var r,s;if(n instanceof Ss){let i=(r=n.getCaptureHandle)==null?void 0:r.call(n);(i==null?void 0:i.handle)!==((s=t.captureHandle)==null?void 0:s.handle)&&(t.captureHandle=i),n.isCurrentTab&&(t.displaySurface="selfBrowser")}}static enrichPluginsDetails(t,n){(n instanceof Ss||n instanceof wl)&&(Ks(n.getPlugins(),t.plugins)||(t.plugins=n.getPlugins()))}static convertRoom(t,n){let{recording:r,rtmp:s,hls:i,transcriptions:o}=Ma.convertRecordingStreamingState(t.recording,t.rtmp,t.hls,t.transcriptions);return{id:t.id,name:t.name,localPeer:n,recording:r,rtmp:s,hls:i,transcriptions:o,sessionId:t.sessionId,startedAt:t.startedAt,joinedAt:t.joinedAt,peerCount:t.peerCount,isLargeRoom:t.large_room_optimization,isEffectsEnabled:t.isEffectsEnabled,disableNoneLayerRequest:t.disableNoneLayerRequest,isVBEnabled:t.isVBEnabled,effectsKey:t.effectsKey,isHipaaEnabled:t.isHipaaEnabled,isNoiseCancellationEnabled:t.isNoiseCancellationEnabled}}static convertMessage(t,n){var r,s,i,o;return{sender:(r=t.peer)==null?void 0:r.peer_id,senderName:(s=t.peer)==null?void 0:s.info.name,senderRole:(i=t.peer)==null?void 0:i.role,senderUserId:(o=t.peer)==null?void 0:o.info.user_id,recipientPeer:t.private?n:void 0,recipientRoles:t.roles,time:new Date(t.timestamp),type:t.info.type,message:t.info.message,id:t.message_id}}static convertRoles(t){let n={};return t&&t.forEach(r=>{n[r.name]=r}),n}static convertRoleChangeRequest(t){var n;return{requestedBy:(n=t.requestedBy)==null?void 0:n.peerId,roleName:t.role.name,token:t.token}}static convertException(t){let n="trackType"in t,r={code:t.code,action:t.action,name:t.name,message:t.message,description:t.description,isTerminal:t.isTerminal,nativeError:t.nativeError,timestamp:new Date};return n&&(r.trackType=t==null?void 0:t.trackType),r}static convertDeviceChangeUpdate(t){let n={devices:t.devices,selection:t.selection,type:t.type};return t.error&&(n.error=this.convertException(t.error)),n}static convertPlaylist(t){let n=this.getConvertedPlaylistType(t,"audio"),r=this.getConvertedPlaylistType(t,"video");return{audio:n,video:r}}static convertPlaylistItem(t,n){let r=n.type,s=t.getCurrentSelection(r),i=t.isPlaying(r),o=n.url===(s==null?void 0:s.url);return Ke(de({},n),{type:n.type,selected:o,playing:o&&i})}static getConvertedPlaylistType(t,n){let r={},s=t.getCurrentSelection(n),i=t.getCurrentProgress(n),o=t.getVolume(n),l=t.getList(n),c=t.getCurrentIndex(n);return t.getList(n).forEach(d=>{r[d.id]=Ma.convertPlaylistItem(t,d)}),{list:r,selection:{id:s==null?void 0:s.id,hasPrevious:c>0,hasNext:c<l.length-1},progress:i,volume:o,currentTime:t.getCurrentTime(n),playbackRate:t.getPlaybackRate(n)}}static convertRecordingStreamingState(t,n,r,s){var i;return{recording:{browser:de({running:!1},t==null?void 0:t.browser),server:de({running:!1},t==null?void 0:t.server),hls:de({running:!1},t==null?void 0:t.hls)},rtmp:de({running:!1},n),hls:{variants:((i=r==null?void 0:r.variants)==null?void 0:i.map(o=>o))||[],running:!!(r!=null&&r.running),error:r==null?void 0:r.error},transcriptions:s||[]}}},__=class{constructor(e,t,n,r){this.playlistManager=e,this.syncPlaylistState=n,this.store=r,this.type=t}play(e){return T(this,null,function*(){if(!e){Je.w("Please pass id to play");return}yield this.playlistManager.setEnabled(!0,{id:e,type:this.type})})}pause(){return T(this,null,function*(){let e=this.type==="audio"?eJ:tJ,t=this.store.getState(e.selection);if(!t.id){Je.w("No item is currently playing to pause");return}yield this.playlistManager.setEnabled(!1,{id:t.id,type:this.type})})}playNext(){return T(this,null,function*(){yield this.playlistManager.playNext(this.type)})}playPrevious(){return T(this,null,function*(){yield this.playlistManager.playPrevious(this.type)})}seek(e){this.playlistManager.seek(e,this.type),this.syncPlaylistState(`seekOn${this.type}Playlist`)}seekTo(e){this.playlistManager.seekTo(e,this.type),this.syncPlaylistState(`seekToOn${this.type}Playlist`)}setVolume(e){this.playlistManager.setVolume(e,this.type),this.syncPlaylistState(`setVolumeOn${this.type}Playlist`)}setList(e){this.playlistManager.setList(e),this.syncPlaylistState(`setListOn${this.type}Playlist`)}stop(){return T(this,null,function*(){yield this.playlistManager.stop(this.type),this.syncPlaylistState(`stop${this.type}Playlist`)})}setIsAutoplayOn(e){this.playlistManager.setIsAutoplayOn(this.type,e)}setPlaybackRate(e){this.playlistManager.setPlaybackRate(this.type,e),this.syncPlaylistState(`set${this.type}PlaybackRate`)}removeItem(e){return T(this,null,function*(){let t=yield this.playlistManager.removeItem(e,this.type);return t&&this.syncPlaylistState(`remove${this.type}PlaylistItem`),t})}clearList(){return T(this,null,function*(){yield this.playlistManager.clearList(this.type),this.syncPlaylistState(`clear${this.type}Playlist`)})}},kJ=class{constructor(e,t){this.sdk=e,this.setLocally=t}get sdkSessionStore(){return this.sdk.getSessionStore()}set(e,t){return T(this,null,function*(){let{value:n}=yield this.sdkSessionStore.set(String(e),t);this.setLocally({key:e,value:n})})}observe(e){return T(this,null,function*(){let t=Array.isArray(e)?e.map(n=>String(n)):[String(e)];yield this.sdkSessionStore.observe(t)})}unobserve(e){return T(this,null,function*(){let t=Array.isArray(e)?e.map(n=>String(n)):[String(e)];yield this.sdkSessionStore.unobserve(t)})}},TJ=class{constructor(e,t){this.TAG="[BeamSpeakerLabelsLogger]",this.intervalMs=100,this.shouldMonitor=!1,this.hasStarted=!1,this.unsubs=[],this.analysers={},this.store=e,this.actions=t}start(){return T(this,null,function*(){if(this.hasStarted)return;this.hasStarted=!0,Je.d("starting audio level monitor for remote peers",this.store);let e=this.store.getState(Zs);Je.d("starting audio levels is connected to room",e),e&&(yield this.monitorAudioLevels());let t=this.store.subscribe(this.monitorAudioLevels.bind(this),Zs);this.unsubs.push(t)})}stop(){return T(this,null,function*(){this.hasStarted&&(this.hasStarted=!1,this.shouldMonitor=!1,this.unsubs.forEach(e=>e()),Je.d("stopped audio level monitor for remote peers"))})}monitorAudioLevels(){return T(this,null,function*(){if(!this.store.getState(Zs)){this.shouldMonitor&&(Je.i("room no longer connected, stopping audio level monitoring for remote"),this.shouldMonitor=!1);return}if(this.shouldMonitor)return;Je.i("monitoring audio levels"),this.shouldMonitor=!0;let e=()=>{this.shouldMonitor?(this.logAllPeersAudioLevels(),setTimeout(e,this.intervalMs)):Je.i("stopped monitoring audio levels")};setTimeout(e,1e3)})}logAllPeersAudioLevels(){return T(this,null,function*(){var e;if(!window.__triggerBeamEvent__)return;let t=this.store.getState(Kd),n=t.filter(s=>!!s.audioTrack);Je.d(this.TAG,"Peers Without audio track",t.filter(s=>!s.audioTrack).map(s=>s.id).join(","));let r=[];for(let s of n){let i=this.actions.getTrackById(s.audioTrack||""),o=(e=i==null?void 0:i.stream)==null?void 0:e.nativeStream;if(s.joinedAt&&o){let l=yield this.getAudioLevel(s,o);Je.d(this.TAG,s.id,l),l.level>0&&r.push(l)}}if(r.length>0){let s={event:"app-audio-level",data:r};Je.d("logging audio levels",JSON.stringify(r)),window.__triggerBeamEvent__(JSON.stringify(s))}})}getAudioLevel(e,t){return T(this,null,function*(){this.analysers[t.id]||(this.analysers[t.id]=this.createAnalyserNode(t));let n=this.analysers[t.id],r=this.calculateAudioLevel(n);return{peerId:e.id,peerName:e.name,level:r}})}createAnalyserNode(e){this.audioContext||(this.audioContext=new AudioContext);let t=this.audioContext.createAnalyser();return this.audioContext.createMediaStreamSource(e).connect(t),t}calculateAudioLevel(e){let t=new Uint8Array(e.fftSize);e.getByteTimeDomainData(t);let n=.009,r=n;for(let i of t)r=Math.max(r,(i-128)/128);let s=(Math.log(n)-Math.log(r))/Math.log(n);return Math.ceil(Math.min(Math.max(s*100,0),100))}},CJ=2e4,EJ=1e4,wu={name:"diagnostics-role",priority:1,publishParams:{allowed:["audio","video"],audio:{bitRate:32,codec:"opus"},video:{bitRate:100,codec:"vp8",frameRate:30,height:720,width:1280},screen:{bitRate:100,codec:"vp8",frameRate:10,height:1080,width:1920}},subscribeParams:{subscribeToRoles:[],maxSubsBitRate:3200},permissions:{browserRecording:!1,changeRole:!1,endRoom:!1,hlsStreaming:!1,mute:!1,pollRead:!1,pollWrite:!1,removeOthers:!1,rtmpStreaming:!1,unmute:!1}},_J="https://100ms.live/test-audio.wav",PJ=class{constructor(){this.networkScores=[],this.lastPushedAt=0}pushScore(e){!e||e<0||(this.networkScores.length===0?(this.networkScores.push(e),this.lastPushedAt=Date.now()):this.addPendingCQSTillNow())}addPendingCQSTillNow(){if(this.networkScores.length>0){let e=(Date.now()-this.lastPushedAt)/1e3;for(;e>0;)this.networkScores.push(this.networkScores[this.networkScores.length-1]),e-=1;this.lastPushedAt=Date.now()}}getCQS(){return this.networkScores.reduce((e,t)=>e+t,0)/this.networkScores.length}},NJ=e=>!!e&&!isNaN(e),Qr=e=>e[e.length-1],Na=(e,t)=>{let n=e.filter(r=>NJ(t(r)));return n.reduce((r,s)=>r+(t(s)||0),0)/n.length},IJ=class{constructor(e){this.sdk=e,this.peerStatsList=[],this.localAudioTrackStatsList=[],this.localVideoTrackStatsList=[],this.remoteAudioTrackStatsList=[],this.remoteVideoTrackStatsList=[]}handleStatsUpdate(e){return T(this,null,function*(){var t,n,r,s,i,o,l,c;let d=e.getLocalPeerStats();d&&this.peerStatsList.push(d);let u=(r=(n=(t=this.sdk.getLocalPeer())==null?void 0:t.audioTrack)==null?void 0:n.nativeTrack)==null?void 0:r.id,h=(o=(i=(s=this.sdk.getLocalPeer())==null?void 0:s.videoTrack)==null?void 0:i.nativeTrack)==null?void 0:o.id,f=e.getLocalTrackStats();f&&(u&&this.localAudioTrackStatsList.push(f[u]),h&&this.localVideoTrackStatsList.push(f[h]));let m=yield(c=(l=this.sdk.getWebrtcInternals())==null?void 0:l.getSubscribePeerConnection())==null?void 0:c.getStats();m==null||m.forEach(g=>{if(g.type==="inbound-rtp"){let v=g.kind==="audio"?this.remoteAudioTrackStatsList:this.remoteVideoTrackStatsList,x=wv("bytesReceived",g,Qr(v));v.push(Ke(de({},g),{bitrate:x}))}})})}buildReport(){var e,t,n,r,s,i,o,l,c,d;let u=(e=Qr(this.peerStatsList))==null?void 0:e.publish,h=(t=Qr(this.peerStatsList))==null?void 0:t.subscribe,f=u!=null&&u.responsesReceived?((u==null?void 0:u.totalRoundTripTime)||0)/u.responsesReceived:0,m=h!=null&&h.responsesReceived?((h==null?void 0:h.totalRoundTripTime)||0)/h.responsesReceived:0,g=Number(((f+m)/2*1e3).toFixed(2)),v=((n=Qr(this.remoteAudioTrackStatsList))==null?void 0:n.packetsReceived)||0,x=((r=Qr(this.remoteVideoTrackStatsList))==null?void 0:r.packetsReceived)||0,S=this.localAudioTrackStatsList.map(L=>L?Na(Object.values(L),N=>N.bitrate):0),y=this.localVideoTrackStatsList.map(L=>L?Na(Object.values(L),N=>N.bitrate):0),b=((s=Qr(this.remoteAudioTrackStatsList))==null?void 0:s.jitter)||0,w=((i=Qr(this.remoteVideoTrackStatsList))==null?void 0:i.jitter)||0,C=Math.max(b,w),I=Qr(this.localAudioTrackStatsList),R=Qr(this.localVideoTrackStatsList);return{combined:{roundTripTime:g,packetsReceived:v+x,packetsLost:(h==null?void 0:h.packetsLost)||0,bytesSent:(u==null?void 0:u.bytesSent)||0,bytesReceived:(h==null?void 0:h.bytesReceived)||0,bitrateSent:Na(this.peerStatsList,L=>{var N;return(N=L.publish)==null?void 0:N.bitrate}),bitrateReceived:Na(this.peerStatsList,L=>{var N;return(N=L.subscribe)==null?void 0:N.bitrate}),jitter:C},audio:{roundTripTime:g,packetsReceived:v,packetsLost:((o=Qr(this.remoteAudioTrackStatsList))==null?void 0:o.packetsLost)||0,bytesReceived:((l=Qr(this.remoteAudioTrackStatsList))==null?void 0:l.bytesReceived)||0,bitrateSent:Na(S,L=>L),bitrateReceived:Na(this.remoteAudioTrackStatsList,L=>L.bitrate),bytesSent:I?Object.values(I).reduce((L,N)=>L+(N.bytesSent||0),0):0,jitter:b},video:{roundTripTime:g,packetsLost:((c=Qr(this.remoteVideoTrackStatsList))==null?void 0:c.packetsLost)||0,bytesReceived:((d=Qr(this.remoteVideoTrackStatsList))==null?void 0:d.bytesReceived)||0,packetsReceived:x,bitrateSent:Na(y,L=>L),bitrateReceived:Na(this.remoteVideoTrackStatsList,L=>L.bitrate),bytesSent:R?Object.values(R).reduce((L,N)=>L+(N.bytesSent||0),0):0,jitter:w}}}},AJ=(e=>(e[e.STARTING=0]="STARTING",e[e.INIT_FETCHED=1]="INIT_FETCHED",e[e.SIGNAL_CONNECTED=2]="SIGNAL_CONNECTED",e[e.ICE_ESTABLISHED=3]="ICE_ESTABLISHED",e[e.MEDIA_CAPTURED=4]="MEDIA_CAPTURED",e[e.MEDIA_PUBLISHED=5]="MEDIA_PUBLISHED",e[e.COMPLETED=6]="COMPLETED",e))(AJ||{}),P_,N_,RJ=class{constructor(e,t,n,r,s=CJ){this.sdk=e,this.sdkListener=t,this.progressCallback=n,this.completionCallback=r,this.connectivityDuration=s,this.wsConnected=!1,this.initConnected=!1,this.isPublishICEConnected=!1,this.isSubscribeICEConnected=!1,this.gatheredPublishICECandidates=[],this.gatheredSubscribeICECandidates=[],this.errors=[],this.isAudioTrackCaptured=!1,this.isVideoTrackCaptured=!1,this.isAudioTrackPublished=!1,this.isVideoTrackPublished=!1,this.cqsCalculator=new PJ,this.timestamp=Date.now(),this.onRoomUpdate=this.sdkListener.onRoomUpdate.bind(this.sdkListener),this.onPeerUpdate=this.sdkListener.onPeerUpdate.bind(this.sdkListener),this.onMessageReceived=this.sdkListener.onMessageReceived.bind(this.sdkListener),this.onReconnected=this.sdkListener.onReconnected.bind(this.sdkListener),this.onRoleChangeRequest=this.sdkListener.onRoleChangeRequest.bind(this.sdkListener),this.onRoleUpdate=this.sdkListener.onRoleUpdate.bind(this.sdkListener),this.onChangeTrackStateRequest=this.sdkListener.onChangeTrackStateRequest.bind(this.sdkListener),this.onChangeMultiTrackStateRequest=this.sdkListener.onChangeMultiTrackStateRequest.bind(this.sdkListener),this.onRemovedFromRoom=this.sdkListener.onRemovedFromRoom.bind(this.sdkListener),this.onNetworkQuality=(P_=this.sdkListener.onNetworkQuality)==null?void 0:P_.bind(this.sdkListener),this.onPreview=this.sdkListener.onPreview.bind(this.sdkListener),this.onDeviceChange=(N_=this.sdkListener.onDeviceChange)==null?void 0:N_.bind(this.sdkListener),this.onSessionStoreUpdate=this.sdkListener.onSessionStoreUpdate.bind(this.sdkListener),this.onPollsUpdate=this.sdkListener.onPollsUpdate.bind(this.sdkListener),this.onWhiteboardUpdate=this.sdkListener.onWhiteboardUpdate.bind(this.sdkListener),this.handleConnectionQualityUpdate=i=>{let o=i.find(l=>{var c,d;return l.peerID===((d=(c=this.sdk)==null?void 0:c.store.getLocalPeer())==null?void 0:d.peerId)});this.cqsCalculator.pushScore(o==null?void 0:o.downlinkQuality)},this.statsCollector=new IJ(e),this.state=0}get state(){return this._state}set state(e){var t;e===void 0||this._state!==void 0&&e<this._state||(this._state=e,(t=this.progressCallback)==null||t.call(this,e))}onICESuccess(e){e?this.isPublishICEConnected=!0:this.isSubscribeICEConnected=!0,this.isPublishICEConnected&&this.isSubscribeICEConnected&&(this.state=3)}onSelectedICECandidatePairChange(e,t){t?this.selectedPublishICECandidate=e:this.selectedSubscribeICECandidate=e}onICECandidate(e,t){t?this.gatheredPublishICECandidates.push(e):this.gatheredSubscribeICECandidates.push(e)}onMediaPublished(e){switch(e.type){case"audio":this.isAudioTrackPublished=!0;break;case"video":this.isVideoTrackPublished=!0;break}this.isVideoTrackPublished&&this.isAudioTrackPublished&&(this.state=5)}onInitSuccess(e){this.websocketURL=e,this.initConnected=!0,this.state=1}onSignallingSuccess(){this.wsConnected=!0,this.state=2}onJoin(e){var t,n;this.sdkListener.onJoin(e),(t=this.sdk.getWebrtcInternals())==null||t.onStatsChange(r=>this.statsCollector.handleStatsUpdate(r)),(n=this.sdk.getWebrtcInternals())==null||n.start(),this.cleanupTimer=window.setTimeout(()=>{this.cleanupAndReport()},this.connectivityDuration)}onError(e){this.sdkListener.onError(e),this.errors.push(e),e!=null&&e.isTerminal&&this.cleanupAndReport()}onTrackUpdate(e,t,n){if(this.sdkListener.onTrackUpdate(e,t,n),n.isLocal&&e===0){switch(t.type){case"audio":this.isAudioTrackCaptured=!0;break;case"video":this.isVideoTrackCaptured=!0;break}this.isVideoTrackCaptured&&this.isAudioTrackCaptured&&(this.state=4)}}onReconnecting(e){this.sdkListener.onReconnecting(e),this.cqsCalculator.addPendingCQSTillNow()}cleanupAndReport(){var e;clearTimeout(this.cleanupTimer),this.cleanupTimer=void 0,this.state===5&&(this.state=6),(e=this.completionCallback)==null||e.call(this,this.buildReport()),this.sdk.leave()}buildReport(){this.cqsCalculator.addPendingCQSTillNow();let e=this.cqsCalculator.getCQS(),t=this.statsCollector.buildReport();return{testTimestamp:this.timestamp,connectivityState:this.state,errors:this.errors,signallingReport:{isConnected:this.wsConnected,isInitConnected:this.initConnected,websocketUrl:this.websocketURL},mediaServerReport:{stats:t,connectionQualityScore:e,isPublishICEConnected:this.isPublishICEConnected,isSubscribeICEConnected:this.isSubscribeICEConnected,publishICECandidatePairSelected:this.selectedPublishICECandidate,subscribeICECandidatePairSelected:this.selectedSubscribeICECandidate,publishIceCandidatesGathered:this.gatheredPublishICECandidates,subscribeIceCandidatesGathered:this.gatheredSubscribeICECandidates}}}},d2=class{constructor(e){this.recording={server:{running:!1},browser:{running:!1},hls:{running:!1}},this.rtmp={running:!1},this.hls={running:!1,variants:[]},this.transcriptions=[],this.id=e}},u2=(e,t,n)=>T(void 0,null,function*(){let r=Error("something went wrong during fetch");for(let s=0;s<4;s++)try{let i=yield fetch(e,t),o=yield i.clone().json();if(n&&n.length&&!i.ok&&n.includes(o.code))throw oe.APIErrors.ServerErrors(o.code,"GET_TOKEN",o.message,!1);return i}catch(i){r=i}throw["Failed to fetch","NetworkError"].some(s=>r.message.includes(s))?oe.APIErrors.EndpointUnreachable("GET_TOKEN",r.message):r}),jJ=class{constructor(e,t){this.sdk=e,this.sdkListener=t,this.recordedAudio=_J,this.sdk.setIsDiagnostics(!0),this.initSdkWithLocalPeer()}get localPeer(){var e;return(e=this.sdk)==null?void 0:e.store.getLocalPeer()}checkBrowserSupport(){Cw(),Tw()}requestPermission(e){return T(this,null,function*(){try{let t=yield navigator.mediaDevices.getUserMedia(e);return t.getTracks().forEach(n=>n.stop()),yield this.sdk.deviceManager.init(!0),{audio:t.getAudioTracks().length>0,video:t.getVideoTracks().length>0}}catch(t){throw Nh(t,this.sdk.localTrackManager.getErrorType(!!e.video,!!e.audio))}})}startCameraCheck(e){return T(this,null,function*(){var t,n,r,s;if(this.initSdkWithLocalPeer(),!this.localPeer)throw new Error("Local peer not found");this.sdk.store.setSimulcastEnabled(!1),this.localPeer.role=Ke(de({},wu),{publishParams:Ke(de({},wu.publishParams),{allowed:["video"]})});let i=new sg().video(new Eo().deviceId(e||"default").build()).build(),o=yield(t=this.sdk)==null?void 0:t.localTrackManager.getLocalTracks({audio:!1,video:!0},i),l=o==null?void 0:o.find(c=>c.type==="video");if(!l)throw new Error("No video track found");(n=this.sdk)==null||n.deviceManager.init(!0),this.localPeer.videoTrack=l,(s=(r=this.sdk)==null?void 0:r.listener)==null||s.onPeerUpdate(9,[this.localPeer])})}stopCameraCheck(){var e,t;(t=(e=this.localPeer)==null?void 0:e.videoTrack)==null||t.cleanup(),this.localPeer&&(this.localPeer.videoTrack=void 0)}startMicCheck(e){return T(this,arguments,function*({inputDevice:t,onError:n,onStop:r,time:s=EJ}){var i,o,l,c;this.initSdkWithLocalPeer(f=>{this.stopMicCheck(),n==null||n(f)});let d=yield this.getLocalAudioTrack(t);if((i=this.sdk)==null||i.deviceManager.init(!0),!this.localPeer)throw new Error("Local peer not found");if(!d)throw new Error("No audio track found");this.localPeer.audioTrack=d,(o=this.sdk)==null||o.initPreviewTrackAudioLevelMonitor(),(c=(l=this.sdk)==null?void 0:l.listener)==null||c.onPeerUpdate(9,[this.localPeer]),this.mediaRecorder=new MediaRecorder(d.stream.nativeStream);let u=[];this.mediaRecorder.ondataavailable=function(f){u.push(f.data)},this.mediaRecorder.onstop=()=>{var f,m;let g=new Blob(u,{type:(f=this.mediaRecorder)==null?void 0:f.mimeType});this.recordedAudio=URL.createObjectURL(g),(m=this.onStopMicCheck)==null||m.call(this)},this.mediaRecorder.start();let h=setTimeout(()=>{this.stopMicCheck()},s);this.onStopMicCheck=()=>{clearTimeout(h),r==null||r()}})}stopMicCheck(){var e,t,n;(e=this.mediaRecorder)==null||e.stop(),(n=(t=this.localPeer)==null?void 0:t.audioTrack)==null||n.cleanup(),this.localPeer&&(this.localPeer.audioTrack=void 0)}getRecordedAudio(){return this.recordedAudio}startConnectivityCheck(e,t,n,r){return T(this,null,function*(){if(!this.sdk)throw new Error("SDK not found");this.connectivityCheck=new RJ(this.sdk,this.sdkListener,e,t,r);let s=yield this.getAuthToken(n);yield this.sdk.leave(),yield this.sdk.join({authToken:s,userName:"diagnostics-test"},this.connectivityCheck),this.sdk.addConnectionQualityListener({onConnectionQualityUpdate:i=>{var o;(o=this.connectivityCheck)==null||o.handleConnectionQualityUpdate(i)}})})}stopConnectivityCheck(){return T(this,null,function*(){var e;return(e=this.connectivityCheck)==null?void 0:e.cleanupAndReport()})}initSdkWithLocalPeer(e){var t,n,r;this.sdkListener&&((t=this.sdk)==null||t.initStoreAndManagers(Ke(de({},this.sdkListener),{onError:o=>{e==null||e(o),this.sdkListener.onError(o)}})));let s=new YL({name:"diagnostics-peer",role:wu,type:"regular"});(n=this.sdk)==null||n.store.addPeer(s);let i=new d2("diagnostics-room");this.sdk.store.setRoom(i),this.sdkListener.onRoomUpdate("ROOM_PEER_COUNT_UPDATED",i),(r=this.sdk)==null||r.deviceManager.init(!0)}getAuthToken(e){return T(this,null,function*(){let t=new URL("https://api.100ms.live/v2/diagnostics/token");e&&t.searchParams.append("region",e);let n=yield u2(t.toString(),{method:"GET"},[429,500,501,502,503,504,505,506,507,508,509,510,511]),r=yield n.json();if(!n.ok)throw oe.APIErrors.ServerErrors(r.code,"GET_TOKEN",r.message,!1);let{token:s}=r;if(!s)throw Error(r.message);return s})}getLocalAudioTrack(e){return T(this,null,function*(){var t;if(!this.localPeer)return;this.localPeer.role=Ke(de({},wu),{publishParams:Ke(de({},wu.publishParams),{allowed:["audio"]})});let n=new sg().audio(new Dl().deviceId(e||"default").build()).build(),r=yield(t=this.sdk)==null?void 0:t.localTrackManager.getLocalTracks({audio:!0,video:!1},n);return r==null?void 0:r.find(s=>s.type==="audio")})}},MJ=class{constructor(e,t,n){this.isRoomJoinCalled=!1,this.ignoredMessageTypes=[],this.setProgress=({type:r,progress:s})=>{this.setState(i=>{i.playlist[r].progress=s,i.playlist[r].currentTime=this.sdk.getPlaylistManager().getCurrentTime(r)},"playlistProgress")},this.syncPlaylistState=r=>{this.setState(s=>{Object.assign(s.playlist,Gt.convertPlaylist(this.sdk.getPlaylistManager()))},r)},this.sendPeerUpdateNotification=(r,s)=>{let i=this.store.getState(Vi(s.peerId)),o=o2[r]||"peerUpdate";if(r===8)this.syncRoomState(o),this.updateMidCallPreviewRoomState(r,s);else if([0,1].includes(r))this.syncRoomState(o),i||(i=this.store.getState(Vi(s.peerId)));else if([12,13,14].includes(r))this.syncRoomState(o),i||(i=this.store.getState(Vi(s.peerId)));else{let l=Gt.convertPeer(s);this.setState(c=>{let d=c.peers[l.id];_d(d,l)&&(Ks(d.auxiliaryTracks,l.auxiliaryTracks)&&(d.auxiliaryTracks=l.auxiliaryTracks),Object.assign(d,l)),i=l},o)}this.hmsNotifications.sendPeerUpdate(r,i)},this.getSDKHMSPeer=r=>this.sdk.getPeerMap()[r],this.setState=(r,s)=>this.store.namedSetState(r,s),this.store=e,this.sdk=t,this.hmsNotifications=n,this.sessionStore=new kJ(this.sdk,this.setSessionStoreValueLocally.bind(this)),this.actionBatcher=new vJ(e)}submitSessionFeedback(e,t){return this.sdk.submitSessionFeedback(e,t)}getLocalTrack(e){return this.sdk.store.getLocalPeerTracks().find(t=>t.trackId===e)}get interactivityCenter(){return this.sdk.getInteractivityCenter()}setPlaylistSettings(e){this.sdk.updatePlaylistSettings(e)}refreshDevices(){return T(this,null,function*(){yield this.sdk.refreshDevices()})}unblockAudio(){return T(this,null,function*(){yield this.sdk.getAudioOutput().unblockAutoplay()})}setVolume(e,t){return T(this,null,function*(){t?yield this.setTrackVolume(e,t):(yield this.sdk.getAudioOutput().setVolume(e),this.syncRoomState("setOutputVolume"))})}setAudioOutputDevice(e){return T(this,null,function*(){(yield this.sdk.getAudioOutput().setDevice(e))&&this.setState(t=>{t.settings.audioOutputDeviceId=e},"setAudioOutputDevice")})}setPreferredLayer(e,t){return T(this,null,function*(){var n;let r=this.getTrackById(e);if(r)if(r instanceof os){if(t==="none"){Je.d("layer none will be ignored");return}if(((n=this.store.getState(oJ(e)))==null?void 0:n.preferredLayer)===t){Je.d(`preferred layer is already ${t}`);return}this.setState(s=>{let i=s.tracks[e];i&&(i.preferredLayer=t)},"setPreferredLayer"),yield r.setPreferredLayer(t)}else Je.d(`track ${e} is not a remote video track`);else this.logPossibleInconsistency(`track ${e} not present, unable to set preffer layer`)})}getNativeTrackById(e){var t;return(t=this.sdk.store.getTrackById(e))==null?void 0:t.nativeTrack}getTrackById(e){return this.sdk.store.getTrackById(e)}getAuthTokenByRoomCode(e,t){return this.sdk.getAuthTokenByRoomCode(e,t)}preview(e){return T(this,null,function*(){let t=this.store.getState(yi);if(t==="Preview"||t==="Connecting"){this.logPossibleInconsistency("attempting to call preview while room is in preview/connecting");return}try{t!=="Connected"&&this.setState(n=>{n.room.roomState="Connecting"},"connecting"),yield this.sdkPreviewWithListeners(e)}catch(n){throw Je.e("Cannot show preview. Failed to connect to room - ",n),n}})}cancelMidCallPreview(){return T(this,null,function*(){return this.sdk.cancelMidCallPreview()})}join(e){return T(this,null,function*(){if(this.isRoomJoinCalled){this.logPossibleInconsistency("room join is called again");return}try{this.isRoomJoinCalled=!0,this.setState(t=>{t.room.roomState="Connecting"},"join"),yield this.sdkJoinWithListeners(e)}catch(t){throw this.isRoomJoinCalled=!1,Je.e("Failed to connect to room - ",t),t}})}leave(){return T(this,null,function*(){let e=this.store.getState(Zs),t=!0;e||(t=!1,this.logPossibleInconsistency("room leave is called when no room is connected"));let n=this.store.getState(yi);return this.setState(r=>{r.room.roomState="Disconnecting"},"leaving"),this.sdk.leave(t).then(()=>{this.resetState("leave"),this.beamSpeakerLabelsLogger&&this.beamSpeakerLabelsLogger.stop().catch(Je.e),Je.i("left room")}).catch(r=>{Je.e("error in leaving room - ",r),this.setState(s=>{s.room.roomState=n},"revertLeave")})})}setScreenShareEnabled(e,t){return T(this,null,function*(){typeof t=="boolean"&&(t={audioOnly:t});try{e?yield this.startScreenShare(t):yield this.stopScreenShare()}catch(n){throw this.hmsNotifications.sendError(Gt.convertException(n)),n}})}addTrack(e,t="regular"){return T(this,null,function*(){yield this.sdk.addTrack(e,t),this.syncRoomState("addTrack")})}removeTrack(e){return T(this,null,function*(){yield this.sdk.removeTrack(e),this.syncRoomState("removeTrack")})}setLocalAudioEnabled(e){return T(this,null,function*(){let t=this.store.getState(ea);t&&(yield this.setEnabledTrack(t,e))})}setLocalVideoEnabled(e){return T(this,null,function*(){let t=this.store.getState(Gs);t&&(yield this.setEnabledTrack(t,e))})}setEnabledTrack(e,t){return T(this,null,function*(){var n;if(((n=this.store.getState().tracks[e])==null?void 0:n.enabled)===t){this.logPossibleInconsistency(`local track[${e}] enabled state - ${t}`);return}this.setState(s=>{s.tracks[e]?s.tracks[e].displayEnabled=t:this.logPossibleInconsistency("track id not found for setEnabled")},"displayEnabled");try{yield this.setEnabledSDKTrack(e,t),this.syncRoomState("setEnabled")}catch(s){throw this.setState(i=>{i.tracks[e].displayEnabled=!t},"rollbackDisplayEnabled"),this.hmsNotifications.sendError(Gt.convertException(s)),s}let r=t?3:2;this.hmsNotifications.sendTrackUpdate(r,e)})}autoSelectAudioOutput(e){return T(this,null,function*(){yield this.sdk.autoSelectAudioOutput(e)})}setAudioSettings(e){return T(this,null,function*(){let t=this.store.getState(ea);t&&(yield this.setSDKLocalAudioTrackSettings(t,e),this.syncRoomState("setAudioSettings"))})}setVideoSettings(e){return T(this,null,function*(){let t=this.store.getState(Gs);t&&(yield this.setSDKLocalVideoTrackSettings(t,e),this.syncRoomState("setVideoSettings"))})}switchCamera(){return T(this,null,function*(){let e=this.store.getState(Gs);if(e){let t=this.sdk.store.getLocalPeerTracks().find(n=>n.trackId===e);t&&(yield t.switchCamera(),this.syncRoomState("switchCamera"))}})}sendMessage(e){this.sendBroadcastMessage(e)}sendBroadcastMessage(e,t){return T(this,null,function*(){let{message_id:n,timestamp:r}=yield this.sdk.sendBroadcastMessage(e,t);this.updateMessageInStore({message:e,type:t,id:n,time:r})})}sendGroupMessage(e,t,n){return T(this,null,function*(){let r=this.store.getState(Ed),s=t.map(l=>r[l]),{message_id:i,timestamp:o}=yield this.sdk.sendGroupMessage(e,s,n);this.updateMessageInStore({message:e,recipientRoles:t,type:n,id:i,time:o})})}sendDirectMessage(e,t,n){return T(this,null,function*(){let{message_id:r,timestamp:s}=yield this.sdk.sendDirectMessage(e,t,n);this.updateMessageInStore({message:e,recipientPeer:t,type:n,id:r,time:s})})}updateMessageInStore(e){var t;if(!e.message)throw Je.w("sendMessage","Failed to send message",e),Error(`sendMessage Failed - ${JSON.stringify(e)}`);if(e.type&&this.ignoredMessageTypes.includes(e.type))return;let n=this.sdk.getLocalPeer(),r={read:!0,id:e.id,time:new Date(e.time),message:e.message,type:e.type||"chat",recipientPeer:e.recipientPeer,recipientRoles:e.recipientRoles,senderName:n==null?void 0:n.name,sender:n==null?void 0:n.peerId,senderRole:(t=n==null?void 0:n.role)==null?void 0:t.name,ignored:!1};this.setState(s=>{s.messages.byID[r.id]=r,s.messages.allIDs.push(r.id)},"newMessage")}setMessageRead(e,t){this.setState(n=>{t?n.messages.byID[t]?n.messages.byID[t].read=e:this.logPossibleInconsistency("no message with id is found"):n.messages.allIDs.forEach(r=>{n.messages.byID[r].read=e})},"setMessageRead")}attachVideo(e,t){return T(this,null,function*(){if(this.localAndVideoUnmuting(e))return new Promise(n=>{let r=this.store.subscribe(s=>T(this,null,function*(){s&&(yield this.attachVideoInternal(e,t),r(),n())}),Iw)});yield this.attachVideoInternal(e,t)})}detachVideo(e,t){return T(this,null,function*(){let n=this.getTrackById(e);(n==null?void 0:n.type)==="video"?yield this.sdk.detachVideo(n,t):(t&&(t.srcObject=null),Je.d("possible inconsistency detected - no video track found to remove sink"))})}addPluginToVideoTrack(e,t){return T(this,null,function*(){return this.addRemoveVideoPlugin(e,"add",t)})}addPluginsToVideoStream(e){return T(this,null,function*(){return this.addRemoveMediaStreamVideoPlugins(e,"add")})}removePluginsFromVideoStream(e){return T(this,null,function*(){return this.addRemoveMediaStreamVideoPlugins(e,"remove")})}addPluginToAudioTrack(e){return T(this,null,function*(){return this.addRemoveAudioPlugin(e,"add")})}validateVideoPluginSupport(e){let t={};if(t.isSupported=!1,!e)return Je.w("no plugin passed in for checking support"),t.errMsg="no plugin passed in for checking support",t;let n=this.store.getState(Gs);if(!n)return Je.w("video Track not added to local peer yet"),t.errMsg="call this function only after local peer has video track",t;let r=this.getTrackById(n);return r?t=r.validatePlugin(e):(Je.w(`track ${n} not present, unable to validate plugin`),t.errMsg=`track ${n} not present, unable to validate plugin`),t}validateAudioPluginSupport(e){let t={};if(t.isSupported=!1,!e)return Je.w('no plugin passed in for checking support"'),t.errMsg='no plugin passed in for checking support"',t;let n=this.store.getState(ea);if(!n)return Je.w("audio track not added to local peer yet"),t.errMsg="call this function only after local peer has audio track",t;let r=this.getTrackById(n);return r?t=r.validatePlugin(e):(Je.w(`track ${n} not present, unable to validate plugin`),t.errMsg=`track ${n} not present, unable to validate plugin`),t}removePluginFromVideoTrack(e){return T(this,null,function*(){return this.addRemoveVideoPlugin(e,"remove")})}removePluginFromAudioTrack(e){return T(this,null,function*(){return this.addRemoveAudioPlugin(e,"remove")})}changeRole(e,t,n=!1){return T(this,null,function*(){yield this.sdk.changeRoleOfPeer(e,t,n)})}changeRoleOfPeer(e,t,n=!1){return T(this,null,function*(){yield this.sdk.changeRoleOfPeer(e,t,n)})}changeRoleOfPeersWithRoles(e,t){return T(this,null,function*(){let n=this.sdk.getRoles().filter(r=>e.includes(r.name));yield this.sdk.changeRoleOfPeersWithRoles(n,t)})}acceptChangeRole(e){return T(this,null,function*(){let t=e.requestedBy?this.getSDKHMSPeer(e.requestedBy.id):void 0;t||Je.w(`peer for which role change is requested no longer available - ${e.requestedBy}`);let n={requestedBy:t,role:e.role,token:e.token};yield this.sdk.acceptChangeRole(n),this.removeRoleChangeRequest(e)})}raiseLocalPeerHand(){return T(this,null,function*(){yield this.sdk.raiseLocalPeerHand()})}lowerLocalPeerHand(){return T(this,null,function*(){yield this.sdk.lowerLocalPeerHand()})}raiseRemotePeerHand(e){return T(this,null,function*(){yield this.sdk.raiseRemotePeerHand(e)})}lowerRemotePeerHand(e){return T(this,null,function*(){yield this.sdk.lowerRemotePeerHand(e)})}getPeer(e){return T(this,null,function*(){let t=yield this.sdk.getPeer(e);if(t)return Gt.convertPeer(t)})}findPeerByName(e){return T(this,null,function*(){let{offset:t,peers:n,eof:r}=yield this.sdk.findPeerByName(e);return{offset:t,eof:r,peers:n.map(s=>Gt.convertPeer(s))}})}getPeerListIterator(e){let t=this.sdk.getPeerListIterator(e);return{hasNext:()=>t.hasNext(),next:()=>T(this,null,function*(){return(yield t.next()).map(n=>Gt.convertPeer(n))}),findPeers:()=>T(this,null,function*(){return(yield t.findPeers()).map(n=>Gt.convertPeer(n))}),getTotal:()=>t.getTotal()}}initAppData(e){this.setState(t=>{t.appData=e},"initAppData")}setAppData(e,t,n){let r=(t==null?void 0:t.constructor.name)==="Object";this.setState(s=>{if(s.appData)n&&r?Object.assign(s.appData[e],t):s.appData[e]=t;else{let i={[e]:t};s.appData=i}},`setAppData-${e}`)}rejectChangeRole(e){this.removeRoleChangeRequest(e)}endRoom(e,t){return T(this,null,function*(){let n=this.store.getState(YQ);if(!(n!=null&&n.endRoom)){Je.w("You are not allowed to perform this action - endRoom");return}let r=this.store.getState(yi);this.setState(s=>{s.room.roomState="Disconnecting"},"endingRoom");try{yield this.sdk.endRoom(e,t),this.resetState("endRoom")}catch(s){Je.e("error in ending room - ",s),this.setState(i=>{i.room.roomState=r},"revertEndRoom")}})}removePeer(e,t){return T(this,null,function*(){var n;let r=(n=this.sdk.getLocalPeer())==null?void 0:n.peerId;e!==r&&(yield this.sdk.removePeer(e,t))})}startRTMPOrRecording(e){return T(this,null,function*(){yield this.sdk.startRTMPOrRecording(e)})}stopRTMPAndRecording(){return T(this,null,function*(){yield this.sdk.stopRTMPAndRecording()})}startHLSStreaming(e){return T(this,null,function*(){yield this.sdk.startHLSStreaming(e)})}stopHLSStreaming(e){return T(this,null,function*(){yield this.sdk.stopHLSStreaming(e)})}startTranscription(e){return T(this,null,function*(){yield this.sdk.startTranscription(e)})}stopTranscription(e){return T(this,null,function*(){yield this.sdk.stopTranscription(e)})}sendHLSTimedMetadata(e){return T(this,null,function*(){yield this.sdk.sendHLSTimedMetadata(e)})}changeName(e){return T(this,null,function*(){yield this.sdk.changeName(e)})}changeMetadata(e){return T(this,null,function*(){typeof e!="string"&&(e=JSON.stringify(e)),yield this.sdk.changeMetadata(e)})}setSessionMetadata(e){return T(this,null,function*(){yield this.sdk.setSessionMetadata(e),this.setState(t=>{t.sessionMetadata=e},"setSessionMetadata"),this.setSessionStoreValueLocally({key:"default",value:e},"setSessionMetadata")})}populateSessionMetadata(){return T(this,null,function*(){let e=yield this.sdk.getSessionMetadata();this.setState(t=>{t.sessionMetadata=e},"populateSessionMetadata"),this.setSessionStoreValueLocally({key:"default",value:e},"populateSessionmetadata")})}setRemoteTrackEnabled(e,t){return T(this,null,function*(){if(typeof e=="string"){let n=this.getTrackById(e);n&&yJ(n)?yield this.sdk.changeTrackState(n,t):this.logPossibleInconsistency(`No remote track with ID ${e} found for change track state`)}else Array.isArray(e)&&e.forEach(n=>this.setRemoteTrackEnabled(n,t))})}setRemoteTracksEnabled(e){return T(this,null,function*(){let t={enabled:e.enabled,type:e.type,source:e.source};if(e.roles){let n=this.store.getState(Ed);t.roles=e.roles.map(r=>n[r])}yield this.sdk.changeMultiTrackState(t)})}setLogLevel(e){Je.level=e,this.sdk.setLogLevel(e)}setFrameworkInfo(e){this.sdk.setFrameworkInfo(e)}ignoreMessageTypes(e,t=!1){if(t)this.ignoredMessageTypes=e;else for(let n of e)this.ignoredMessageTypes.includes(n)||this.ignoredMessageTypes.push(n)}enableBeamSpeakerLabelsLogging(){return T(this,null,function*(){this.beamSpeakerLabelsLogger||(Je.i("enabling beam speaker labels logging"),this.beamSpeakerLabelsLogger=new TJ(this.store,this),yield this.beamSpeakerLabelsLogger.start())})}initDiagnostics(){let e=new jJ(this.sdk,{onJoin:this.onJoin.bind(this),onPreview:this.onPreview.bind(this),onRoomUpdate:this.onRoomUpdate.bind(this),onPeerUpdate:this.onPeerUpdate.bind(this),onTrackUpdate:this.onTrackUpdate.bind(this),onMessageReceived:this.onMessageReceived.bind(this),onError:this.onError.bind(this),onReconnected:this.onReconnected.bind(this),onReconnecting:this.onReconnecting.bind(this),onRoleChangeRequest:this.onRoleChangeRequest.bind(this),onRoleUpdate:this.onRoleUpdate.bind(this),onDeviceChange:this.onDeviceChange.bind(this),onChangeTrackStateRequest:this.onChangeTrackStateRequest.bind(this),onChangeMultiTrackStateRequest:this.onChangeMultiTrackStateRequest.bind(this),onRemovedFromRoom:this.onRemovedFromRoom.bind(this),onNetworkQuality:this.onNetworkQuality.bind(this),onSessionStoreUpdate:this.onSessionStoreUpdate.bind(this),onPollsUpdate:this.onPollsUpdate.bind(this),onWhiteboardUpdate:this.onWhiteboardUpdate.bind(this)});return this.sdk.addAudioListener({onAudioLevelUpdate:this.onAudioLevelUpdate.bind(this)}),this.sdk.addConnectionQualityListener({onConnectionQualityUpdate:this.onConnectionQualityUpdate.bind(this)}),e}resetState(e="resetState"){this.isRoomJoinCalled=!1,Je.cleanup(),this.setState(t=>{Object.assign(t,NL())},e)}getDebugInfo(){return this.sdk.getDebugInfo()}sdkJoinWithListeners(e){return T(this,null,function*(){yield this.sdk.join(e,{onJoin:this.onJoin.bind(this),onPreview:this.onPreview.bind(this),onRoomUpdate:this.onRoomUpdate.bind(this),onPeerUpdate:this.onPeerUpdate.bind(this),onTrackUpdate:this.onTrackUpdate.bind(this),onMessageReceived:this.onMessageReceived.bind(this),onError:this.onError.bind(this),onReconnected:this.onReconnected.bind(this),onReconnecting:this.onReconnecting.bind(this),onRoleChangeRequest:this.onRoleChangeRequest.bind(this),onRoleUpdate:this.onRoleUpdate.bind(this),onDeviceChange:this.onDeviceChange.bind(this),onChangeTrackStateRequest:this.onChangeTrackStateRequest.bind(this),onChangeMultiTrackStateRequest:this.onChangeMultiTrackStateRequest.bind(this),onRemovedFromRoom:this.onRemovedFromRoom.bind(this),onNetworkQuality:this.onNetworkQuality.bind(this),onSessionStoreUpdate:this.onSessionStoreUpdate.bind(this),onPollsUpdate:this.onPollsUpdate.bind(this),onWhiteboardUpdate:this.onWhiteboardUpdate.bind(this),onSFUMigration:this.onSFUMigration.bind(this)}),this.sdk.addAudioListener({onAudioLevelUpdate:this.onAudioLevelUpdate.bind(this)}),this.sdk.addConnectionQualityListener({onConnectionQualityUpdate:this.onConnectionQualityUpdate.bind(this)})})}onSFUMigration(){this.syncRoomState("SFUMigration")}onRemovedFromRoom(e){var t;let n=this.store.getState(Vi((t=e.requestedBy)==null?void 0:t.peerId));this.hmsNotifications.sendLeaveRoom(Ke(de({},e),{requestedBy:n||void 0}));let r=e.roomEnded||!n?"roomEnded":"removedFromRoom";Je.i(`resetting state after peer removed ${r}`,e),this.resetState(r)}onDeviceChange(e){let t=e.devices;if(!t)return;let n=this.store.getState(As);if(this.setState(r=>{Ks(r.devices.audioInput,t.audioInput)||(r.devices.audioInput=t.audioInput),Ks(r.devices.videoInput,t.videoInput)||(r.devices.videoInput=t.videoInput),Ks(r.devices.audioOutput,t.audioOutput)||(r.devices.audioOutput=t.audioOutput);let s=this.sdk.getLocalPeer();n!=null&&n.id&&s&&Object.assign(r.settings,this.getMediaSettings(s))},"deviceChange"),e.selection&&!e.internal){let r=Gt.convertDeviceChangeUpdate(e);this.hmsNotifications.sendDeviceChange(r)}}sdkPreviewWithListeners(e){return T(this,null,function*(){yield this.sdk.preview(e,{onPreview:this.onPreview.bind(this),onError:this.onError.bind(this),onReconnected:this.onReconnected.bind(this),onReconnecting:this.onReconnecting.bind(this),onDeviceChange:this.onDeviceChange.bind(this),onRoomUpdate:this.onRoomUpdate.bind(this),onPeerUpdate:this.onPeerUpdate.bind(this),onNetworkQuality:this.onNetworkQuality.bind(this),onTrackUpdate:this.onTrackUpdate.bind(this)}),this.sdk.addAudioListener({onAudioLevelUpdate:this.onAudioLevelUpdate.bind(this)})})}onNetworkQuality(e){this.setState(t=>{var n;let r=t.room.localPeer||((n=this.sdk.getLocalPeer())==null?void 0:n.peerId);r&&(t.connectionQualities[r]={peerID:r,downlinkQuality:e})},"ConnectionQuality")}onSessionStoreUpdate(e){this.setSessionStoreValueLocally(e,"sessionStoreUpdate")}onPollsUpdate(e,t){let n=l2[e];this.setState(r=>{let s=t.reduce((i,o)=>{var l;return i[o.id]=Ke(de({},o),{questions:(l=o.questions)==null?void 0:l.map(c=>{var d,u;return Ke(de({},c),{answer:c.answer?de({},c.answer):void 0,options:(d=c.options)==null?void 0:d.map(h=>de({},h)),responses:(u=c.responses)==null?void 0:u.map(h=>de({},h))})})}),i},{});wJ(r.polls,s)},n),t.forEach(r=>this.hmsNotifications.sendPollUpdate(e,r.id))}onWhiteboardUpdate(e){this.setState(t=>{t.whiteboards[e.id]=e},"whiteboardUpdate")}startScreenShare(e){return T(this,null,function*(){this.store.getState(og)?this.logPossibleInconsistency("start screenshare is called while it's on"):(yield this.sdk.startScreenShare(()=>this.syncRoomState("screenshareStopped"),e),this.syncRoomState("startScreenShare"))})}stopScreenShare(){return T(this,null,function*(){this.store.getState(og)?(yield this.sdk.stopScreenShare(),this.syncRoomState("stopScreenShare")):this.logPossibleInconsistency("stop screenshare is called while it's not on")})}attachVideoInternal(e,t){return T(this,null,function*(){let n=this.getTrackById(e);n||(n=this.getLocalTrack(e)),n&&n.type==="video"?yield this.sdk.attachVideo(n,t):this.logPossibleInconsistency("no video track found to add sink")})}syncRoomState(e){e=`${e}_fullSync`,Je.time(`store-sync-${e}`);let t={},n=[],r={},s={},i={},o,l=this.sdk.getPeers();for(let f of l){let m=Gt.convertPeer(f);t[m.id]=m,n.push(m.id),i[m.id]={peerID:m.id,downlinkQuality:f.networkQuality||-1};let g=[f.audioTrack,f.videoTrack,...f.auxiliaryTracks];for(let v of g){if(!v)continue;let x=Gt.convertTrack(v);r[x.id]=x}if(f.isLocal){let v=f;o=this.getPreviewFields(v),Object.assign(s,this.getMediaSettings(v))}}let c=this.sdk.getRecordingState(),d=this.sdk.getRTMPState(),u=this.sdk.getHLSState(),h=this.sdk.getTranscriptionState();this.setState(f=>{var m;f.room.peers=n;let g=f.peers,v=f.tracks;xJ(g,t),bJ(v,r),Object.assign(f.settings,s),f.room.isConnected&&Object.assign(f.connectionQualities,i),(m=f.preview)!=null&&m.localPeer&&o!=null&&o.localPeer?Object.assign(f.preview,o):f.preview=o,Object.assign(f.roles,Gt.convertRoles(this.sdk.getRoles())),Object.assign(f.playlist,Gt.convertPlaylist(this.sdk.getPlaylistManager())),Object.assign(f.room,Gt.convertRecordingStreamingState(c,d,u,h)),Object.assign(f.templateAppData,this.sdk.getTemplateAppData())},e),Je.timeEnd(`store-sync-${e}`)}onPreview(e){this.setState(t=>{var n;Object.assign(t.room,Gt.convertRoom(e,(n=this.sdk.getLocalPeer())==null?void 0:n.peerId)),t.room.roomState="Preview"},"previewStart"),this.syncRoomState("previewSync")}onJoin(e){let t=this.sdk.getPlaylistManager();this.audioPlaylist=new __(t,"audio",this.syncPlaylistState.bind(this),this.store),this.videoPlaylist=new __(t,"video",this.syncRoomState.bind(this),this.store),this.syncRoomState("joinSync"),this.setState(n=>{var r;Object.assign(n.room,Gt.convertRoom(e,(r=this.sdk.getLocalPeer())==null?void 0:r.peerId)),n.room.isConnected=!0,n.room.roomState="Connected"},"joined"),t.onProgress(this.setProgress),t.onNewTrackStart(n=>{this.syncPlaylistState(`${n.type}PlaylistUpdate`)}),t.onPlaylistEnded(n=>{this.syncPlaylistState(`${n}PlaylistEnded`)}),t.onCurrentTrackEnded(n=>{this.hmsNotifications.sendPlaylistTrackEnded(Gt.convertPlaylistItem(t,n)),this.syncPlaylistState(`${n.type}PlaylistItemEnded`)})}onRoomUpdate(e,t){this.setState(n=>{var r;Object.assign(n.room,Gt.convertRoom(t,(r=this.sdk.getLocalPeer())==null?void 0:r.peerId))},e),e==="TRANSCRIPTION_STATE_UPDATED"&&this.hmsNotifications.sendTranscriptionUpdate(t.transcriptions)}onPeerUpdate(e,t){if(![4,5].includes(e)){if(Array.isArray(t)){let n=this.store.getState(js),r=t.filter(s=>!n[s.peerId]);if(this.syncRoomState("peersJoined"),this.store.getState(Zs)){let s=[];for(let i of t){let o=this.store.getState(Vi(i.peerId));o&&s.push(o)}this.hmsNotifications.sendPeerList(s)}else r.forEach(s=>{let i=this.store.getState(Vi(s.peerId));i&&this.hmsNotifications.sendPeerUpdate(0,i)});return}this.sendPeerUpdateNotification(e,t)}}onTrackUpdate(e,t,n){if(e===1)this.hmsNotifications.sendTrackUpdate(e,t.trackId),this.handleTrackRemove(t,n);else if([0,1].includes(e)){let r=Aw[e];this.syncRoomState(r),this.hmsNotifications.sendTrackUpdate(e,t.trackId)}else{let r=Aw[e]||"trackUpdate",s=Gt.convertTrack(t);this.setState(i=>{let o=i.tracks[s.id];_d(o,s)&&(c2(o,s),Object.assign(o,s))},r),this.hmsNotifications.sendTrackUpdate(e,t.trackId)}}onMessageReceived(e){let t=Gt.convertMessage(e,this.store.getState(Gc));t.read=!1,t.ignored=this.ignoredMessageTypes.includes(t.type),t.type==="hms_transcript"&&(t.ignored=!0),this.putMessageInStore(t),this.hmsNotifications.sendMessageReceived(t)}putMessageInStore(e){e.ignored||this.actionBatcher.setState(t=>{t.messages.byID[e.id]=e,t.messages.allIDs.push(e.id)},"newMessage",150)}onAudioLevelUpdate(e){this.setState(t=>{let n={};e.forEach(s=>{if(!s.track||!s.peer)return;let i=s.track.trackId;n[i]=s.audioLevel,t.speakers[i]||(t.speakers[i]={audioLevel:s.audioLevel,peerID:s.peer.peerId,trackID:i})});let r=Object.entries(t.speakers);for(let[s,i]of r)i.audioLevel=n[s]||0,i.audioLevel===0&&delete t.speakers[s]},"audioLevel")}onConnectionQualityUpdate(e){this.setState(t=>{e.forEach(n=>{let r=n.peerID;r&&(t.connectionQualities[r]?Object.assign(t.connectionQualities[r],n):t.connectionQualities[r]=n)})},"connectionQuality")}onChangeTrackStateRequest(e){var t;let n=this.store.getState(Vi((t=e.requestedBy)==null?void 0:t.peerId)),r=this.getStoreLocalTrackIDfromSDKTrack(e.track),s=this.store.getState(i2(r));if(!s)return this.logPossibleInconsistency(`Not found track for which track state change was requested, ${e.track}`);e.enabled||this.syncRoomState("changeTrackStateRequest"),this.hmsNotifications.sendChangeTrackStateRequest({requestedBy:n||void 0,track:s,enabled:e.enabled})}onChangeMultiTrackStateRequest(e){var t;let n=this.store.getState(Vi((t=e.requestedBy)==null?void 0:t.peerId));e.enabled||this.syncRoomState("changeMultiTrackStateRequest");let r=[],s=this.store.getState(fn);for(let i of e.tracks){let o=this.getStoreLocalTrackIDfromSDKTrack(i);o&&s[o]&&r.push(s[o])}this.hmsNotifications.sendChangeMultiTrackStateRequest({requestedBy:n||void 0,tracks:r,enabled:e.enabled,type:e.type,source:e.source})}onReconnected(){this.syncRoomState("reconnectedSync"),this.hmsNotifications.sendReconnected(),this.setState(e=>{e.room.roomState=e.room.isConnected?"Connected":"Preview"},"reconnected")}onReconnecting(e){let t=Gt.convertException(e);Je.e("Reconnection: received error from sdk",t),this.hmsNotifications.sendReconnecting(t),this.setState(n=>{n.room.roomState="Reconnecting",n.errors.push(t)},"reconnecting")}onError(e){let t=Gt.convertException(e);t.isTerminal?(this.leave().then(()=>Je.e("error from SDK, left room.")),this.setState(n=>{n.room.roomState="Failed",n.errors.push(t)},"errorTerminal")):this.store.getState().errors.length<50&&this.setState(n=>{n.errors.push(t)},"error"),this.syncRoomState("errorSync"),this.hmsNotifications.sendError(t),Je.e("received error from sdk",t instanceof Ue?`${t}`:t)}handleTrackRemove(e,t){this.setState(n=>{let r=n.peers[t.peerId],s=n.tracks,i=e.trackId;if(r)if(i===r.audioTrack)delete r.audioTrack;else if(i===r.videoTrack)delete r.videoTrack;else{let o=r.auxiliaryTracks.indexOf(i);o>-1&&r.auxiliaryTracks.splice(o,1)}delete s[i]},"trackRemoved")}setEnabledSDKTrack(e,t){return T(this,null,function*(){let n=this.getLocalTrack(e);n?yield n.setEnabled(t):this.logPossibleInconsistency(`track ${e} not present, unable to enabled/disable`)})}setSDKLocalVideoTrackSettings(e,t){return T(this,null,function*(){let n=this.getLocalTrack(e);n?yield n.setSettings(t):this.logPossibleInconsistency(`local track ${e} not present, unable to set settings`)})}setSDKLocalAudioTrackSettings(e,t){return T(this,null,function*(){let n=this.getLocalTrack(e);n?yield n.setSettings(t):this.logPossibleInconsistency(`local track ${e} not present, unable to set settings`)})}getMediaSettings(e){var t;let n=this.store.getState(FQ),r=e.audioTrack,s=e.videoTrack;return{audioInputDeviceId:(r==null?void 0:r.settings.deviceId)||n.audioInputDeviceId,videoInputDeviceId:(s==null?void 0:s.settings.deviceId)||n.videoInputDeviceId,audioOutputDeviceId:(t=this.sdk.getAudioOutput().getDevice())==null?void 0:t.deviceId,audioMode:(r==null?void 0:r.settings.audioMode)||"voice"}}getPreviewFields(e){var t,n;if(!e.isInPreview())return;let r=Gt.convertPeer(e);return{localPeer:r.id,audioTrack:r.audioTrack,videoTrack:r.videoTrack,asRole:((t=e.asRole)==null?void 0:t.name)||((n=e.role)==null?void 0:n.name)}}setTrackVolume(e,t){return T(this,null,function*(){let n=this.getTrackById(t);n?n instanceof tk?(yield n.setVolume(e),this.setState(r=>{let s=r.tracks[t];s&&s.type==="audio"&&(s.volume=e)},"trackVolume")):Je.w(`track ${t} is not an audio track`):this.logPossibleInconsistency(`track ${t} not present, unable to set volume`)})}localAndVideoUnmuting(e){let t=this.store.getState(As);if((t==null?void 0:t.videoTrack)!==e)return!1;let n=this.store.getState(WQ),r=this.store.getState(Iw);return n&&!r}logPossibleInconsistency(e){Je.w("possible inconsistency detected - ",e)}addRemoveVideoPlugin(e,t,n){return T(this,null,function*(){if(!e){Je.w("Invalid plugin received in store");return}let r=this.store.getState(Gs);if(r){let s=this.getLocalTrack(r);s?(t==="add"?yield s.addPlugin(e,n):t==="remove"&&(yield s.removePlugin(e)),this.syncRoomState(`${t}VideoPlugin`)):this.logPossibleInconsistency(`track ${r} not present, unable to ${t} plugin`)}})}addRemoveMediaStreamVideoPlugins(e,t){return T(this,null,function*(){if(e.length===0){Je.w("Invalid plugin received in store");return}let n=this.store.getState(Gs);if(n){let r=this.getLocalTrack(n);r?(t==="add"?yield r.addStreamPlugins(e):t==="remove"&&(yield r.removeStreamPlugins(e)),this.syncRoomState(`${t}MediaStreamPlugin`)):this.logPossibleInconsistency(`track ${n} not present, unable to ${t} plugin`)}})}addRemoveAudioPlugin(e,t){return T(this,null,function*(){try{if(!e){Je.w("Invalid plugin received in store");return}let n=this.store.getState(ea);if(n){let r=this.getLocalTrack(n);r?(t==="add"?yield r.addPlugin(e):t==="remove"&&(yield r.removePlugin(e)),this.syncRoomState(`${t}AudioPlugin`)):this.logPossibleInconsistency(`track ${n} not present, unable to ${t} plugin`)}}catch(n){console.error(n)}})}onRoleChangeRequest(e){this.setState(t=>{t.roleChangeRequests.length===0&&t.roleChangeRequests.push(Gt.convertRoleChangeRequest(e))},"roleChangeRequest")}removeRoleChangeRequest(e){this.setState(t=>{let n=t.roleChangeRequests.findIndex(r=>r.token===e.token);n!==-1&&t.roleChangeRequests.splice(n,1)},"removeRoleChangeRequest")}onRoleUpdate(){this.syncRoomState("roleUpdate")}getStoreLocalTrackIDfromSDKTrack(e){return this.store.getState(GQ).find(t=>{var n;return((n=this.getTrackById(t))==null?void 0:n.trackId)===e.trackId})}updateMidCallPreviewRoomState(e,t){t.isLocal&&e===8&&this.store.getState(KQ)&&this.setState(n=>{n.room.roomState="Connected"},"midCallPreviewCompleted")}setSessionStoreValueLocally(e,t="setSessionStore"){let n=Array.isArray(e)?e:[e];this.setState(r=>{n.forEach(s=>{r.sessionStore[s.key]=s.value})},t)}hasActiveElements(e){let t=Object.keys(this.store.getState().whiteboards).length>0,n=Object.keys(this.store.getState().polls).length>0,r=Object.keys(this.store.getState().peers).length>0,s=e.getState().remoteTrackStats;return r&&(t||n||Object.values(s).some(i=>i&&typeof i.bitrate=="number"&&i.bitrate>0))}},h2=e=>Is?`${e} ${document.title}`:e,DJ=class{constructor(e,t){this.eventBus=e,this.listener=t,this.TAG="[NetworkTestManager]",this.controller=new AbortController,this.start=n=>T(this,null,function*(){var r;if(!n)return;let{url:s,timeout:i,scoreMap:o}=n,l=this.controller.signal,c=Date.now(),d=0,u=ma(i).then(()=>{this.controller.abort()});try{let h=(r=(yield fetch(`${s}?${Date.now()}`,{signal:l})).body)==null?void 0:r.getReader();if(!h)throw Error("unable to process request");let f=()=>T(this,null,function*(){if(h)try{let m=!1;for(;!m;){let{value:g,done:v}=yield h.read();m=v,g&&(d+=g.byteLength,this.sendScore({scoreMap:o,downloadedSize:d,startTime:c}))}}catch(m){m.name!=="AbortError"&&_.d(this.TAG,m)}});return Promise.race([f(),u]).then(()=>{this.sendScore({scoreMap:o,downloadedSize:d,startTime:c,finished:!0})}).catch(m=>{_.d(this.TAG,m),this.updateScoreToListener(0),this.eventBus.analytics.publish(Be.previewNetworkQuality({error:m.message}))})}catch(h){h.name!=="AbortError"?(_.d(this.TAG,h),this.updateScoreToListener(0),this.eventBus.analytics.publish(Be.previewNetworkQuality({error:h.message}))):_.d(this.TAG,h)}}),this.stop=()=>{this.controller.signal.aborted||this.controller.abort()},this.sendScore=({scoreMap:n,downloadedSize:r,startTime:s,finished:i=!1})=>{let o=(Date.now()-s)/1e3,l=r/1024/o*8,c=-1;for(let d in n){let u=n[d];l>=u.low&&(!u.high||l<=u.high)&&(c=Number(d))}this.updateScoreToListener(c),i&&this.eventBus.analytics.publish(Be.previewNetworkQuality({score:c,downLink:l.toFixed(2)}))}}updateScoreToListener(e){var t,n;e!==this.score&&(this.score=e,(n=(t=this.listener)==null?void 0:t.onNetworkQuality)==null||n.call(t,e))}},OJ=class{constructor(e,t,n,r,s,i){this.store=e,this.transport=t,this.deviceManager=n,this.publish=r,this.removeAuxiliaryTrack=s,this.listener=i,this.handleLocalPeerRoleUpdate=o=>T(this,[o],function*({oldRole:l,newRole:c}){var d;let u=this.store.getLocalPeer();u&&(yield this.diffRolesAndPublishTracks({oldRole:l,newRole:c}),(d=this.listener)==null||d.onPeerUpdate(8,u))}),this.diffRolesAndPublishTracks=o=>T(this,[o],function*({oldRole:l,newRole:c}){var d,u,h,f,m,g;let v=new Set(l.publishParams.allowed),x=new Set(c.publishParams.allowed),S=this.removeTrack(v,x,"video"),y=this.removeTrack(v,x,"audio"),b=this.removeTrack(v,x,"screen"),w=this.hasSimulcastDifference((d=l.publishParams.simulcast)==null?void 0:d.video,(u=c.publishParams.simulcast)==null?void 0:u.video),C=this.hasSimulcastDifference((h=l.publishParams.simulcast)==null?void 0:h.screen,(f=c.publishParams.simulcast)==null?void 0:f.screen),I=(g=(m=this.store.getLocalPeer())==null?void 0:m.videoTrack)==null?void 0:g.enabled;yield this.removeAudioTrack(y),yield this.removeVideoTracks(S||w),yield this.removeScreenTracks(b||C);let R=this.getSettings();w&&(R.isVideoMuted=!I),yield this.publish(R),yield this.syncDevices(R,c)})}syncDevices(e,t){return T(this,null,function*(){(!e.isAudioMuted||!e.isVideoMuted)&&t.publishParams.allowed.length>0&&(yield this.deviceManager.init(!0))})}removeVideoTracks(e){return T(this,null,function*(){var t;if(!e)return;let n=this.store.getLocalPeer();n!=null&&n.videoTrack&&(n.videoTrack.isPublished?yield this.transport.unpublish([n.videoTrack]):yield n.videoTrack.cleanup(),(t=this.listener)==null||t.onTrackUpdate(1,n.videoTrack,n),n.videoTrack=void 0),yield this.removeAuxTracks(r=>r.source!=="screen"&&r.type==="video")})}removeAudioTrack(e){return T(this,null,function*(){var t;if(!e)return;let n=this.store.getLocalPeer();n!=null&&n.audioTrack&&(n.audioTrack.isPublished?yield this.transport.unpublish([n.audioTrack]):yield n.audioTrack.cleanup(),(t=this.listener)==null||t.onTrackUpdate(1,n.audioTrack,n),n.audioTrack=void 0),yield this.removeAuxTracks(r=>r.source!=="screen"&&r.type==="audio")})}removeScreenTracks(e){return T(this,null,function*(){e&&(yield this.removeAuxTracks(t=>t.source==="screen"))})}removeAuxTracks(e){return T(this,null,function*(){let t=this.store.getLocalPeer();if(t!=null&&t.auxiliaryTracks){let n=[...t.auxiliaryTracks];for(let r of n)e(r)&&(yield this.removeAuxiliaryTrack(r.trackId))}})}removeTrack(e,t,n){return e.has(n)&&!t.has(n)}hasSimulcastDifference(e,t){var n,r,s;return!e&&!t?!1:((n=e==null?void 0:e.layers)==null?void 0:n.length)!==((r=t==null?void 0:t.layers)==null?void 0:r.length)?!0:!!((s=e==null?void 0:e.layers)!=null&&s.some(i=>{var o;let l=(o=t==null?void 0:t.layers)==null?void 0:o.find(c=>c.rid===i.rid);return(l==null?void 0:l.maxBitrate)!==i.maxBitrate||(l==null?void 0:l.maxFramerate)!==i.maxFramerate}))}getSettings(){let{isAudioMuted:e,isVideoMuted:t}=this.getMutedStatus(),{audioInputDeviceId:n,audioOutputDeviceId:r}=this.getAudioDeviceSettings(),s=this.getVideoInputDeviceId();return{isAudioMuted:e,isVideoMuted:t,audioInputDeviceId:n,audioOutputDeviceId:r,videoDeviceId:s}}getMutedStatus(){var e,t,n;let r=(e=this.store.getConfig())==null?void 0:e.settings;return{isAudioMuted:(t=r==null?void 0:r.isAudioMuted)!=null?t:!0,isVideoMuted:(n=r==null?void 0:r.isVideoMuted)!=null?n:!0}}getAudioDeviceSettings(){var e,t,n;let r=(e=this.store.getConfig())==null?void 0:e.settings,s=((t=this.deviceManager.currentSelection.audioInput)==null?void 0:t.deviceId)||(r==null?void 0:r.audioInputDeviceId)||"default",i=((n=this.deviceManager.currentSelection.audioOutput)==null?void 0:n.deviceId)||(r==null?void 0:r.audioOutputDeviceId)||"default";return{audioInputDeviceId:s,audioOutputDeviceId:i}}getVideoInputDeviceId(){var e,t;let n=(e=this.store.getConfig())==null?void 0:e.settings;return((t=this.deviceManager.currentSelection.videoInput)==null?void 0:t.deviceId)||(n==null?void 0:n.videoDeviceId)||"default"}},LJ=class{constructor(){this.TAG="[HTTPAnalyticsTransport]",this.failedEvents=new xv("client-events"),this.isConnected=!0,this.env=null,this.websocketURL=""}setEnv(e){this.env=e,this.flushFailedEvents()}setWebsocketEndpoint(e){this.websocketURL=e}sendEvent(e){if(!this.env){this.addEventToStorage(e);return}let t={event:e.name,payload:e.properties,event_id:String(e.timestamp),peer:e.metadata.peer,timestamp:e.timestamp,device_id:e.device_id,cluster:{websocket_url:this.websocketURL}},n=this.env==="prod"?vQ:yQ;fetch(n,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.metadata.token}`,user_agent_v2:e.metadata.userAgent},body:JSON.stringify(t)}).then(r=>{if(r.status===401){this.removeFromStorage(e);return}if(r.status!==200)throw Error(r.statusText);this.removeFromStorage(e)}).catch(r=>{_.v(this.TAG,"Failed to send event",r,e),this.addEventToStorage(e)})}flushFailedEvents(){let e=this.failedEvents.get();e==null||e.forEach(t=>this.sendEvent(t))}addEventToStorage(e){let t=this.failedEvents.get()||[];t.find(n=>n.timestamp===e.timestamp)||(t.length===100&&t.shift(),t.push(e),this.failedEvents.set(t))}removeFromStorage(e){let t=this.failedEvents.get()||[],n=t.findIndex(r=>r.timestamp===e.timestamp);n>-1&&(t.splice(n,1),this.failedEvents.set(t))}},Ah=new LJ,I_=class{constructor(e){this.type=e.type,this.source=e.source||"regular",this.description="",e instanceof ek?(this.mute=!e.enabled,this.track_id=e.publishedTrackId,this.stream_id=e.stream.id):(this.mute=e.mute,this.track_id=e.track_id,this.stream_id=e.stream_id)}},FJ=class{constructor(){this.TAG="[Store]:",this.knownRoles={},this.peers={},this.tracks=new Map,this.peerTrackStates={},this.speakers=[],this.roleDetailsArrived=!1,this.env="prod",this.simulcastEnabled=!1,this.userAgent=Ew(this.env),this.polls=new Map,this.whiteboards=new Map,this.addPermissionToRole=(e,t,n,r)=>{var s;if(!this.knownRoles[e]){_.d(this.TAG,`role ${e} is not present in given roles`,this.knownRoles);return}let i=this.knownRoles[e].permissions;t==="transcriptions"&&r?i[t]=Ke(de({},i[t]),{[r]:[n]}):t==="whiteboard"&&(i[t]||(i[t]=[]),(s=i[t])==null||s.push(n))},this.addWhiteboardPluginToRole=e=>{var t,n,r;let s=e==null?void 0:e.permissions;(t=s==null?void 0:s.admin)==null||t.forEach(i=>this.addPermissionToRole(i,"whiteboard","admin")),(n=s==null?void 0:s.reader)==null||n.forEach(i=>this.addPermissionToRole(i,"whiteboard","read")),(r=s==null?void 0:s.writer)==null||r.forEach(i=>this.addPermissionToRole(i,"whiteboard","write"))},this.addTranscriptionsPluginToRole=(e=[])=>{var t,n;for(let r of e)(n=(t=r.permissions)==null?void 0:t.admin)==null||n.forEach(s=>this.addPermissionToRole(s,"transcriptions","admin",r.mode))},this.handleNoiseCancellationPlugin=e=>{this.room&&(this.room.isNoiseCancellationEnabled=!!(e!=null&&e.enabled)&&!!this.room.isNoiseCancellationEnabled)}}getConfig(){return this.config}setSimulcastEnabled(e){this.simulcastEnabled=e}removeRemoteTracks(){this.tracks.forEach(e=>{(e instanceof Cd||e instanceof os)&&(this.removeTrack(e),delete this.peerTrackStates[e.trackId])})}getEnv(){return this.env}getPublishParams(){let e=this.getLocalPeer(),t=(e==null?void 0:e.asRole)||(e==null?void 0:e.role);return t==null?void 0:t.publishParams}getRoom(){return this.room}getPolicyForRole(e){return this.knownRoles[e]}getKnownRoles(){return this.knownRoles}getTemplateAppData(){return this.templateAppData}getLocalPeer(){if(this.localPeerId&&this.peers[this.localPeerId])return this.peers[this.localPeerId]}getRemotePeers(){return Object.values(this.peers).filter(e=>!e.isLocal)}getPeers(){return Object.values(this.peers)}getPeerMap(){return this.peers}getPeerById(e){if(this.peers[e])return this.peers[e]}getTracksMap(){return this.tracks}getTracks(){return Array.from(this.tracks.values())}getVideoTracks(){return this.getTracks().filter(e=>e.type==="video")}getRemoteVideoTracks(){return this.getTracks().filter(e=>e instanceof os)}getAudioTracks(){return this.getTracks().filter(e=>e.type==="audio")}getPeerTracks(e){let t=e?this.peers[e]:void 0,n=[];return t!=null&&t.videoTrack&&n.push(t.videoTrack),t!=null&&t.audioTrack&&n.push(t.audioTrack),n.concat((t==null?void 0:t.auxiliaryTracks)||[])}getLocalPeerTracks(){return this.getPeerTracks(this.localPeerId)}hasTrack(e){return this.tracks.has(e)}getTrackById(e){var t,n;let r=Array.from(this.tracks.values()).find(i=>i.trackId===e);if(r)return r;let s=this.getLocalPeer();if(s){if((t=s.audioTrack)!=null&&t.isPublishedTrackId(e))return s.audioTrack;if((n=s.videoTrack)!=null&&n.isPublishedTrackId(e))return s.videoTrack}}getPeerByTrackId(e){let t=Array.from(this.tracks.values()).find(n=>n.trackId===e);return t!=null&&t.peerId?this.peers[t.peerId]:void 0}getSpeakers(){return this.speakers}getSpeakerPeers(){return this.speakers.map(e=>e.peer)}getUserAgent(){return this.userAgent}createAndSetUserAgent(e){this.userAgent=Ew(this.env,e)}setRoom(e){this.room=e}setKnownRoles(e){var t,n;if(this.knownRoles=e.known_roles,this.addPluginsToRoles(e.plugins),this.roleDetailsArrived=!0,this.templateAppData=e.app_data,!this.simulcastEnabled)return;let r=(t=this.knownRoles[e.name])==null?void 0:t.publishParams;this.videoLayers=this.convertSimulcastLayers((n=r.simulcast)==null?void 0:n.video),this.updatePeersPolicy()}hasRoleDetailsArrived(){return this.roleDetailsArrived}setConfig(e){var t,n,r;if(pa.rememberDevices(!!e.rememberDeviceSelection),e.rememberDeviceSelection){let s=pa.getSelection();s&&(e.settings||(e.settings={}),(t=s.audioInput)!=null&&t.deviceId&&(e.settings.audioInputDeviceId=e.settings.audioInputDeviceId||s.audioInput.deviceId),(n=s.audioOutput)!=null&&n.deviceId&&(e.settings.audioOutputDeviceId=e.settings.audioOutputDeviceId||s.audioOutput.deviceId),(r=s.videoInput)!=null&&r.deviceId&&(e.settings.videoDeviceId=e.settings.videoDeviceId||s.videoInput.deviceId))}e.autoManageVideo=e.autoManageVideo!==!1,e.autoManageWakeLock=e.autoManageWakeLock!==!1,this.config=e,this.setEnv()}addPeer(e){this.peers[e.peerId]=e,e.isLocal&&(this.localPeerId=e.peerId)}addTrack(e){this.tracks.set(e,e)}getTrackState(e){return this.peerTrackStates[e]}setTrackState(e){this.peerTrackStates[e.trackInfo.track_id]=e}removeTrackState(e){delete this.peerTrackStates[e]}removePeer(e){this.localPeerId===e&&(this.localPeerId=void 0),delete this.peers[e]}removeTrack(e){this.tracks.delete(e)}updateSpeakers(e){this.speakers=e}updateAudioOutputVolume(e){return T(this,null,function*(){for(let t of this.getAudioTracks())yield t.setVolume(e)})}updateAudioOutputDevice(e){return T(this,null,function*(){let t=[];this.getAudioTracks().forEach(n=>{n instanceof Cd&&t.push(n.setOutputDevice(e))}),yield Promise.all(t)})}getSimulcastLayers(e){var t;return!this.simulcastEnabled||!["screen","regular"].includes(e)?[]:e==="screen"?[]:((t=this.videoLayers)==null?void 0:t.layers)||[]}convertSimulcastLayers(e){if(e)return Ke(de({},e),{layers:(e.layers||[]).map(t=>Ke(de({},t),{maxBitrate:t.maxBitrate*1e3}))})}getSimulcastDefinitionsForPeer(e,t){var n,r,s;if([!e||!e.role,t==="screen",!this.simulcastEnabled].some(d=>!!d))return[];let i=this.getPolicyForRole(e.role.name).publishParams,o,l,c;return t==="regular"?(o=(n=i.simulcast)==null?void 0:n.video,l=i.video.width,c=i.video.height):t==="screen"&&(o=(r=i.simulcast)==null?void 0:r.screen,l=i.screen.width,c=i.screen.height),((s=o==null?void 0:o.layers)==null?void 0:s.map(d=>{let u=QK[d.rid],h={width:Math.floor(l/d.scaleResolutionDownBy),height:Math.floor(c/d.scaleResolutionDownBy)};return{layer:u,resolution:h}}))||[]}setPoll(e){this.polls.set(e.id,e)}getPoll(e){return this.polls.get(e)}setWhiteboard(e){this.whiteboards.set(e.id,e)}getWhiteboards(){return this.whiteboards}getWhiteboard(e){return e?this.whiteboards.get(e):this.whiteboards.values().next().value}getErrorListener(){return this.errorListener}cleanup(){let e=this.getTracks();for(let t of e)t.cleanup();this.room=void 0,this.config=void 0,this.localPeerId=void 0,this.roleDetailsArrived=!1}setErrorListener(e){this.errorListener=e}updatePeersPolicy(){this.getPeers().forEach(e=>{var t;if(!e.role){(t=this.errorListener)==null||t.onError(oe.GenericErrors.InvalidRole("VALIDATION",""));return}e.role=this.getPolicyForRole(e.role.name)})}addPluginsToRoles(e){e&&Object.keys(e).forEach(t=>{let n=t;switch(n){case"whiteboard":{this.addWhiteboardPluginToRole(e[n]);break}case"transcriptions":{this.addTranscriptionsPluginToRole(e[n]);break}case"noiseCancellation":{this.handleNoiseCancellationPlugin(e[n]);break}}})}setEnv(){var e;let t=((e=this.config)==null?void 0:e.initEndpoint).split("https://")[1],n="prod";t.startsWith("prod")?n="prod":t.startsWith("qa")?n="qa":t.startsWith("dev")&&(n="dev"),this.env=n,Ah.setEnv(n)}},$J=class{constructor(){this.TAG="[WakeLockManager]",this.wakeLock=null,this.acquireLock=()=>T(this,null,function*(){yield this.requestWakeLock(),document==null||document.addEventListener("visibilitychange",this.visibilityHandler)}),this.cleanup=()=>T(this,null,function*(){if(this.wakeLock&&!this.wakeLock.released)try{yield this.wakeLock.release(),_.d(this.TAG,"Wake lock released")}catch(e){let t=e;_.w(this.TAG,"Error while releasing wake lock",`name=${t.name}, message=${t.message}`)}document==null||document.removeEventListener("visibilitychange",this.visibilityHandler),this.wakeLock=null}),this.visibilityHandler=()=>T(this,null,function*(){(document==null?void 0:document.visibilityState)==="visible"&&(!this.wakeLock||this.wakeLock.released)&&(_.d(this.TAG,"Re-acquiring wake lock due to visibility change"),yield this.requestWakeLock())}),this.requestWakeLock=()=>T(this,null,function*(){try{if(!("wakeLock"in navigator)){_.d(this.TAG,"Wake lock feature not supported");return}this.wakeLock=yield navigator.wakeLock.request("screen"),_.d(this.TAG,"Wake lock acquired")}catch(e){let t=e;_.w(this.TAG,"Error acquiring wake lock",`name=${t.name}, message=${t.message}`)}})}},UJ=class{constructor(e){this.store=e,this.bufferSize=100,this.TAG="[AnalyticsEventsService]",this.transport=null,this.pendingEvents=[],this.level=1}setTransport(e){this.transport=e}reset(){this.transport=null,this.pendingEvents=[]}queue(e){if(e.level>=this.level&&(this.pendingEvents.push(e),this.pendingEvents.length>this.bufferSize)){let t=this.pendingEvents.shift();_.d(this.TAG,"Max buffer size reached","Removed event to accommodate new events",t)}return this}flushFailedClientEvents(){Ah.flushFailedEvents()}flush(){var e;try{for(;this.pendingEvents.length>0;){let t=this.pendingEvents.shift();t&&(t.metadata.peer.peer_id=(e=this.store.getLocalPeer())==null?void 0:e.peerId,t.metadata.userAgent=this.store.getUserAgent(),this.transport&&this.transport.transportProvider.isConnected?this.transport.sendEvent(t):this.sendClientEventOnHTTP(t))}}catch(t){_.w(this.TAG,"Flush Failed",t)}}sendClientEventOnHTTP(e){var t,n,r,s;let i=this.store.getRoom(),o=this.store.getLocalPeer();e.metadata.token=(t=this.store.getConfig())==null?void 0:t.authToken,e.metadata.peer={session_id:i==null?void 0:i.sessionId,room_id:i==null?void 0:i.id,room_name:i==null?void 0:i.name,template_id:i==null?void 0:i.templateId,joined_at:(n=i==null?void 0:i.joinedAt)==null?void 0:n.getTime(),session_started_at:(r=i==null?void 0:i.startedAt)==null?void 0:r.getTime(),role:(s=o==null?void 0:o.role)==null?void 0:s.name,user_name:o==null?void 0:o.name,user_data:o==null?void 0:o.metadata,peer_id:o==null?void 0:o.peerId},Ah.sendEvent(e)}},A_={autoplayFailed:void 0,initialized:!1,autoplayCheckPromise:void 0},VJ=class{constructor(e,t,n){this.store=e,this.deviceManager=t,this.eventBus=n,this.autoPausedTracks=new Set,this.TAG="[AudioSinkManager]:",this.volume=100,this.state=de({},A_),this.handleAudioPaused=r=>T(this,null,function*(){_.d(this.TAG,"Audio Paused",r.target.id);let s=this.store.getTrackById(r.target.id);s&&this.autoPausedTracks.add(s)}),this.handleTrackUpdate=({track:r})=>{_.d(this.TAG,"Track updated",`${r}`)},this.handleTrackAdd=r=>T(this,[r],function*({track:s,peer:i,callListener:o=!0}){var l,c;let d=document.createElement("audio");d.style.display="none",d.id=s.trackId,d.addEventListener("pause",this.handleAudioPaused),d.onerror=()=>T(this,null,function*(){var u,h;_.e(this.TAG,"error on audio element",d.error);let f=oe.TracksErrors.AudioPlaybackError(`Audio playback error for track - ${s.trackId} code - ${(u=d==null?void 0:d.error)==null?void 0:u.code}`);this.eventBus.analytics.publish(Be.audioPlaybackError(f)),((h=d==null?void 0:d.error)==null?void 0:h.code)===MediaError.MEDIA_ERR_DECODE&&(this.removeAudioElement(d,s),yield ma(500),yield this.handleTrackAdd({track:s,peer:i,callListener:!1}),this.state.autoplayFailed||this.eventBus.analytics.publish(Be.audioRecovered("Audio recovered after media decode error")))}),s.setAudioElement(d),yield s.setVolume(this.volume),_.d(this.TAG,"Audio track added",`${s}`),this.init(),(l=this.audioSink)==null||l.append(d),this.outputDevice&&(yield s.setOutputDevice(this.outputDevice)),d.srcObject=new MediaStream([s.nativeTrack]),o&&((c=this.listener)==null||c.onTrackUpdate(0,s,i)),yield this.handleAutoplayError(s)}),this.handleAutoplayError=r=>T(this,null,function*(){if(this.state.autoplayFailed===void 0&&(this.state.autoplayCheckPromise||(this.state.autoplayCheckPromise=new Promise(s=>{this.playAudioFor(r).then(s)})),yield this.state.autoplayCheckPromise),this.state.autoplayFailed){this.autoPausedTracks.add(r);return}yield this.playAudioFor(r)}),this.handleAudioDeviceChange=r=>T(this,null,function*(){r.isUserSelection||r.error||!r.selection||r.type==="video"||(yield this.unpauseAudioTracks())}),this.handleTrackRemove=r=>{this.autoPausedTracks.delete(r);let s=document.getElementById(r.trackId);s&&this.removeAudioElement(s,r),this.audioSink&&this.audioSink.childElementCount===0&&(this.state.autoplayCheckPromise=void 0,this.state.autoplayFailed=void 0),_.d(this.TAG,"Audio track removed",`${r}`)},this.unpauseAudioTracks=()=>T(this,null,function*(){let r=[];this.autoPausedTracks.forEach(s=>{r.push(this.playAudioFor(s))}),yield Promise.all(r)}),this.removeAudioElement=(r,s)=>{r&&(_.d(this.TAG,"removing audio element",`${s}`),r.removeEventListener("pause",this.handleAudioPaused),r.srcObject=null,r.remove(),s.setAudioElement(null))},this.eventBus.audioTrackAdded.subscribe(this.handleTrackAdd),this.eventBus.audioTrackRemoved.subscribe(this.handleTrackRemove),this.eventBus.audioTrackUpdate.subscribe(this.handleTrackUpdate),this.eventBus.deviceChange.subscribe(this.handleAudioDeviceChange),this.eventBus.localVideoUnmutedNatively.subscribe(this.unpauseAudioTracks),this.eventBus.localAudioUnmutedNatively.subscribe(this.unpauseAudioTracks)}setListener(e){this.listener=e}get outputDevice(){return this.deviceManager.outputDevice}getVolume(){return this.volume}setVolume(e){return T(this,null,function*(){yield this.store.updateAudioOutputVolume(e),this.volume=e})}unblockAutoplay(){return T(this,null,function*(){this.autoPausedTracks.size>0&&(yield this.unpauseAudioTracks()),yield qd.resumeContext()})}init(e){if(this.state.initialized||this.audioSink)return;this.state.initialized=!0;let t=document.createElement("div");t.id=`HMS-SDK-audio-sink-${Lo()}`,(e&&document.getElementById(e)||document.body).append(t),this.audioSink=t,_.d(this.TAG,"audio sink created",this.audioSink)}cleanup(){var e;(e=this.audioSink)==null||e.remove(),this.audioSink=void 0,this.eventBus.audioTrackAdded.unsubscribe(this.handleTrackAdd),this.eventBus.audioTrackRemoved.unsubscribe(this.handleTrackRemove),this.eventBus.audioTrackUpdate.unsubscribe(this.handleTrackUpdate),this.eventBus.deviceChange.unsubscribe(this.handleAudioDeviceChange),this.eventBus.localVideoUnmutedNatively.unsubscribe(this.unpauseAudioTracks),this.eventBus.localAudioUnmutedNatively.unsubscribe(this.unpauseAudioTracks),this.autoPausedTracks=new Set,this.state=de({},A_)}playAudioFor(e){return T(this,null,function*(){let t=e.getAudioElement();if(!t){_.w(this.TAG,"No audio element found on track",e.trackId);return}try{yield t.play(),this.state.autoplayFailed=!1,this.autoPausedTracks.delete(e),_.d(this.TAG,"Played track",`${e}`)}catch(n){this.autoPausedTracks.add(e),_.w(this.TAG,"Failed to play track",`${e}`,n);let r=n;if(!this.state.autoplayFailed&&r.name==="NotAllowedError"){this.state.autoplayFailed=!0;let s=oe.TracksErrors.AutoplayBlocked("AUTOPLAY","");s.addNativeError(r),this.eventBus.analytics.publish(Be.autoplayError()),this.eventBus.autoplayError.publish(s)}}})}},BJ=class{constructor(e){this.eventBus=e,this.pluginUsage=new Map,this.pluginLastAddedAt=new Map,this.getPluginUsage=t=>{if(this.pluginUsage.has(t)||this.pluginUsage.set(t,0),this.pluginLastAddedAt.has(t)){let n=this.pluginLastAddedAt.get(t)||0,r=n?Date.now()-n:0;this.pluginUsage.set(t,(this.pluginUsage.get(t)||0)+r),this.pluginLastAddedAt.delete(t)}return this.pluginUsage.get(t)},this.updatePluginUsageData=t=>{var n;let r=((n=t.properties)==null?void 0:n.plugin_name)||"";switch(t.name){case"mediaPlugin.toggled.on":case"mediaPlugin.added":{let s=t.properties.added_at||Date.now();this.pluginLastAddedAt.set(r,s);break}case"mediaPlugin.toggled.off":case"mediaPlugin.stats":{if(this.pluginLastAddedAt.has(r)){let s=t.properties.duration||(Date.now()-(this.pluginLastAddedAt.get(r)||0))/1e3;this.pluginUsage.set(r,(this.pluginUsage.get(r)||0)+Math.max(s,0)*1e3),this.pluginLastAddedAt.delete(r)}break}}},this.cleanup=()=>{this.pluginLastAddedAt.clear(),this.pluginUsage.clear()},this.eventBus.analytics.subscribe(t=>this.updatePluginUsageData(t))}},zJ=class{constructor(e,t){this.store=e,this.eventBus=t,this.audioInput=[],this.audioOutput=[],this.videoInput=[],this.hasWebcamPermission=!1,this.hasMicrophonePermission=!1,this.currentSelection={audioInput:void 0,videoInput:void 0,audioOutput:void 0},this.TAG="[Device Manager]:",this.initialized=!1,this.videoInputChanged=!1,this.audioInputChanged=!1,this.earpieceSelected=!1,this.timer=null,this.updateOutputDevice=(r,s)=>T(this,null,function*(){let i=this.audioOutput.find(o=>o.deviceId===r);return i&&(this.outputDevice=i,yield this.store.updateAudioOutputDevice(i),this.eventBus.analytics.publish(Be.deviceChange({isUserSelection:s,selection:{audioOutput:i},devices:this.getDevices(),type:"audioOutput"})),pa.updateSelection("audioOutput",{deviceId:i.deviceId,groupId:i.groupId})),i}),this.getCurrentSelection=()=>{var r,s;let i=this.store.getLocalPeer(),o=this.createIdentifier((r=i==null?void 0:i.audioTrack)==null?void 0:r.getMediaTrackSettings()),l=this.createIdentifier((s=i==null?void 0:i.videoTrack)==null?void 0:s.getMediaTrackSettings()),c=this.audioInput.find(u=>this.createIdentifier(u)===o),d=this.videoInput.find(u=>this.createIdentifier(u)===l);return{audioInput:c,videoInput:d,audioOutput:this.outputDevice}},this.computeChange=(r,s)=>r.length!==s.length?!0:s.some(i=>!r.includes(this.createIdentifier(i))),this.enumerateDevices=()=>T(this,null,function*(){try{let r=yield navigator.mediaDevices.enumerateDevices(),s=this.videoInput.map(this.createIdentifier),i=this.audioInput.map(this.createIdentifier);this.audioInput=[],this.audioOutput=[],this.videoInput=[],r.forEach(o=>{o.kind==="audioinput"&&o.label?(this.hasMicrophonePermission=!0,this.audioInput.push(o)):o.kind==="audiooutput"?this.audioOutput.push(o):o.kind==="videoinput"&&o.label&&(this.hasWebcamPermission=!0,this.videoInput.push(o))}),this.videoInputChanged=this.computeChange(s,this.videoInput),this.audioInputChanged=this.computeChange(i,this.audioInput),pa.setDevices({videoInput:[...this.videoInput],audioInput:[...this.audioInput],audioOutput:[...this.audioOutput]}),this.logDevices("Enumerate Devices")}catch(r){_.e(this.TAG,"Failed enumerating devices",r)}}),this.updateToActualDefaultDevice=()=>T(this,null,function*(){var r,s,i,o,l;let c=this.store.getLocalPeer();if(!((s=(r=this.store.getConfig())==null?void 0:r.settings)!=null&&s.videoDeviceId)&&c!=null&&c.videoTrack&&(yield c.videoTrack.setSettings({deviceId:(i=this.videoInput[0])==null?void 0:i.deviceId},!0)),!((l=(o=this.store.getConfig())==null?void 0:o.settings)!=null&&l.audioInputDeviceId)&&c!=null&&c.audioTrack){let d=()=>{var u;let h=this.audioInput.find(f=>!f.label.toLowerCase().includes("iphone"));return CK()&&h?h==null?void 0:h.deviceId:(u=this.getNewAudioInputDevice())==null?void 0:u.deviceId};d()&&(yield c.audioTrack.setSettings({deviceId:d()},!0))}}),this.handleDeviceChange=BL(()=>T(this,null,function*(){yield this.enumerateDevices(),this.logDevices("After Device Change");let r=this.store.getLocalPeer();yield this.setOutputDevice(!0),yield this.handleAudioInputDeviceChange(r==null?void 0:r.audioTrack),yield this.handleVideoInputDeviceChange(r==null?void 0:r.videoTrack),this.eventBus.analytics.publish(Be.deviceChange({selection:this.getCurrentSelection(),type:"change",devices:this.getDevices()}))}),500).bind(this),this.handleAudioInputDeviceChange=r=>T(this,null,function*(){if(!r){_.d(this.TAG,"No Audio track on local peer");return}if(!this.audioInputChanged){_.d(this.TAG,"No Change in AudioInput Device");return}let s=this.getNewAudioInputDevice();if(!s||!s.deviceId){this.eventBus.analytics.publish(Be.deviceChange({selection:{audioInput:s},error:oe.TracksErrors.SelectedDeviceMissing("audio"),devices:this.getDevices(),type:"audioInput"})),_.e(this.TAG,"Audio device not found");return}let{settings:i}=r,o=new Dl().codec(i.codec).maxBitrate(i.maxBitrate).deviceId(s.deviceId).audioMode(i.audioMode).build();try{yield r.setSettings(o,!0),this.eventBus.deviceChange.publish({devices:this.getDevices(),selection:s,type:"audioInput"}),this.logDevices("Audio Device Change Success")}catch(l){_.e(this.TAG,"[Audio Device Change]",l),this.eventBus.analytics.publish(Be.deviceChange({selection:{audioInput:s},devices:this.getDevices(),type:"audioInput",error:l})),this.eventBus.deviceChange.publish({error:l,selection:s,type:"audioInput",devices:this.getDevices()})}}),this.handleVideoInputDeviceChange=r=>T(this,null,function*(){if(!r){_.d(this.TAG,"No video track on local peer");return}if(!this.videoInputChanged){_.d(this.TAG,"No Change in VideoInput Device");return}let s=this.videoInput[0];if(!s||!s.deviceId){this.eventBus.analytics.publish(Be.deviceChange({selection:{videoInput:s},error:oe.TracksErrors.SelectedDeviceMissing("video"),devices:this.getDevices(),type:"video"})),_.e(this.TAG,"Video device not found");return}let{settings:i}=r,o=new Eo().codec(i.codec).maxBitrate(i.maxBitrate).maxFramerate(i.maxFramerate).setWidth(i.width).setHeight(i.height).deviceId(s.deviceId).build();try{yield r.setSettings(o,!0),this.eventBus.deviceChange.publish({devices:this.getDevices(),selection:s,type:"video"}),this.logDevices("Video Device Change Success")}catch(l){_.e(this.TAG,"[Video Device Change]",l),this.eventBus.analytics.publish(Be.deviceChange({selection:{videoInput:s},devices:this.getDevices(),type:"video",error:l})),this.eventBus.deviceChange.publish({error:l,type:"video",selection:s,devices:this.getDevices()})}}),this.startPollingForDevices=()=>T(this,null,function*(){let{earpiece:r}=this.categorizeAudioInputDevices();r&&(this.timer=setTimeout(()=>{T(this,null,function*(){yield this.enumerateDevices(),yield this.autoSelectAudioOutput(),this.startPollingForDevices()})},5e3))}),this.autoSelectAudioOutput=r=>T(this,null,function*(){var s,i;let{bluetoothDevice:o,earpiece:l,speakerPhone:c,wired:d}=this.categorizeAudioInputDevices(),u=(s=this.store.getLocalPeer())==null?void 0:s.audioTrack;if(!u||!l)return;let h=this.getManuallySelectedAudioDevice(),f=(h==null?void 0:h.deviceId)||(o==null?void 0:o.deviceId)||(d==null?void 0:d.deviceId)||(c==null?void 0:c.deviceId);if(!(!r&&u.settings.deviceId===f&&this.earpieceSelected))try{(!this.earpieceSelected||r)&&((o==null?void 0:o.deviceId)===f?this.earpieceSelected=!0:(_.d(this.TAG,"selecting earpiece"),yield u.setSettings({deviceId:l==null?void 0:l.deviceId},!0),r&&(yield ma(r)),this.earpieceSelected=!0)),yield u.setSettings({deviceId:f},!0);let m=(i=this.audioInput.find(g=>g.deviceId===f))==null?void 0:i.groupId;this.eventBus.deviceChange.publish({isUserSelection:!1,type:"audioInput",selection:{deviceId:f,groupId:m},devices:this.getDevices(),internal:!0})}catch(m){this.eventBus.error.publish(m)}});let n=({enabled:r,track:s})=>r&&s.source==="regular";this.eventBus.localVideoEnabled.waitFor(n).then(()=>{this.videoInput.length===0&&this.init(!0)}),this.eventBus.localAudioEnabled.waitFor(n).then(()=>{this.audioInput.length===0&&this.init(!0)}),this.eventBus.deviceChange.subscribe(({type:r,isUserSelection:s,selection:i})=>{if(s){let o=r==="video"?"videoInput":r,l=this[o].find(c=>this.createIdentifier(c)===this.createIdentifier(i));this.eventBus.analytics.publish(Be.deviceChange({selection:{[o]:l},devices:this.getDevices(),type:r,isUserSelection:s}))}})}init(e=!1,t=!0){return T(this,null,function*(){this.initialized&&!e||(!this.initialized&&navigator.mediaDevices.addEventListener("devicechange",this.handleDeviceChange),this.initialized=!0,yield this.enumerateDevices(),e||(yield this.updateToActualDefaultDevice(),this.startPollingForDevices()),yield this.autoSelectAudioOutput(),this.logDevices("Init"),yield this.setOutputDevice(),this.eventBus.deviceChange.publish({devices:this.getDevices()}),t&&this.eventBus.analytics.publish(Be.deviceChange({selection:this.getCurrentSelection(),type:"list",devices:this.getDevices()})))})}getDevices(){return{audioInput:this.audioInput,audioOutput:this.audioOutput,videoInput:this.videoInput}}cleanup(){this.timer&&(clearTimeout(this.timer),this.timer=null),this.initialized=!1,this.earpieceSelected=!1,this.audioInput=[],this.audioOutput=[],this.videoInput=[],this.outputDevice=void 0,navigator.mediaDevices.removeEventListener("devicechange",this.handleDeviceChange)}createIdentifier(e){return e?`${e.deviceId}${e.groupId}`:""}getNewAudioInputDevice(){var e,t;let n=this.getManuallySelectedAudioDevice();if(n)return n;(t=(e=this.store.getLocalPeer())==null?void 0:e.audioTrack)==null||t.resetManuallySelectedDeviceId();let r=this.audioInput.find(s=>s.deviceId==="default");return r?this.audioInput.find(s=>s.deviceId!=="default"&&r.label.includes(s.label)):this.audioInput[0]}setOutputDevice(e=!1){return T(this,null,function*(){let t=this.getNewAudioInputDevice(),n=this.createIdentifier(this.outputDevice);this.outputDevice=this.getAudioOutputDeviceMatchingInput(t),this.outputDevice||(this.outputDevice=this.audioOutput.find(r=>this.createIdentifier(r)===n),this.outputDevice||(this.outputDevice=this.audioOutput.find(r=>r.deviceId==="default")||this.audioOutput[0])),yield this.store.updateAudioOutputDevice(this.outputDevice),e&&n!==this.createIdentifier(this.outputDevice)&&(this.eventBus.analytics.publish(Be.deviceChange({selection:{audioOutput:this.outputDevice},devices:this.getDevices(),type:"audioOutput"})),this.eventBus.deviceChange.publish({selection:this.outputDevice,type:"audioOutput",devices:this.getDevices()}))})}getManuallySelectedAudioDevice(){let e=this.store.getLocalPeer(),t=e==null?void 0:e.audioTrack;return this.audioInput.find(n=>n.deviceId===(t==null?void 0:t.getManuallySelectedDeviceId()))}categorizeAudioInputDevices(){let e=null,t=null,n=null,r=null;for(let s of this.audioInput){let i=eQ(s.label);i==="SPEAKERPHONE"?t=s:i==="WIRED"?n=s:i==="BLUETOOTH"?e=s:i==="EARPIECE"&&(r=s)}return{bluetoothDevice:e,speakerPhone:t,wired:n,earpiece:r}}getAudioOutputDeviceMatchingInput(e){var t,n;let r=((n=(t=this.store.getConfig())==null?void 0:t.settings)==null?void 0:n.speakerAutoSelectionBlacklist)||[];if(r==="all"||!e)return;let s=e.label.toLowerCase()||"";if(r.some(l=>s.includes(l.toLowerCase())))return;let i=this.audioOutput.find(l=>e.deviceId!=="default"&&l.label===e.label);if(i)return i;let o=this.audioOutput.find(l=>l.groupId===e.groupId);if(o&&this.audioOutput[0].deviceId==="default"&&o.groupId===this.audioOutput[0].groupId)return o}logDevices(e=""){_.d(this.TAG,e,JSON.stringify({videoInput:[...this.videoInput],audioInput:[...this.audioInput],audioOutput:[...this.audioOutput],selected:this.getCurrentSelection()},null,4))}},GJ=class{constructor(e,t){this.deviceManager=e,this.audioSinkManager=t}getVolume(){return this.audioSinkManager.getVolume()}setVolume(e){if(e<0||e>100)throw Error("Please pass a valid number between 0-100");this.audioSinkManager.setVolume(e)}getDevice(){return this.deviceManager.outputDevice}setDevice(e){return this.deviceManager.updateOutputDevice(e,!0)}unblockAutoplay(){return T(this,null,function*(){yield this.audioSinkManager.unblockAutoplay(),yield qd.resumeContext()})}},f2=class{static handleError(e){if(e.status===404)throw oe.APIErrors.EndpointUnreachable("FEEDBACK",e.statusText);if(e.status>=400)throw oe.APIErrors.ServerErrors(e.status,"FEEDBACK",e==null?void 0:e.statusText)}static sendFeedback(e){return T(this,arguments,function*({token:t,eventEndpoint:n="https://event.100ms.live",info:r,feedback:s}){_.d(this.TAG,`sendFeedback: feedbackEndpoint=${n} peerId=${r.peer.peer_id} session=${r.peer.session_id} `);let i=new URL("v2/client/feedback",n),o=Ke(de({},r),{payload:s});try{let l=yield fetch(i,{headers:{Authorization:`Bearer ${t}`},body:JSON.stringify(o),method:"POST"});try{this.handleError(l);return}catch(c){throw _.e(this.TAG,"error",c.message,l.status),c instanceof Ue?c:oe.APIErrors.ServerErrors(l.status,"FEEDBACK",c.message)}}catch(l){let c=l;throw["Failed to fetch","NetworkError","ECONNRESET"].some(d=>c.message.includes(d))?oe.APIErrors.EndpointUnreachable("FEEDBACK",c.message):c}})}};f2.TAG="[FeedbackService]";var yn=class{constructor(e,t){this.eventName=e,this.eventEmitter=t,this.publish=n=>{this.eventEmitter.emit(this.eventName,n)},this.subscribe=n=>{this.eventEmitter.on(this.eventName,n)},this.subscribeOnce=n=>{this.eventEmitter.once(this.eventName,n)},this.unsubscribe=n=>{this.eventEmitter.off(this.eventName,n)},this.waitFor=n=>this.eventEmitter.waitFor(this.eventName,{filter:n}),this.removeAllListeners=()=>{this.eventEmitter.removeAllListeners(this.eventName)}}},WJ=class{constructor(){this.eventEmitter=new yv.EventEmitter2,this.analytics=new yn(vn.ANALYTICS,this.eventEmitter),this.deviceChange=new yn(vn.DEVICE_CHANGE,this.eventEmitter),this.localAudioEnabled=new yn(vn.LOCAL_AUDIO_ENABLED,this.eventEmitter),this.localVideoEnabled=new yn(vn.LOCAL_VIDEO_ENABLED,this.eventEmitter),this.localVideoUnmutedNatively=new yn(vn.LOCAL_VIDEO_UNMUTED_NATIVELY,this.eventEmitter),this.localAudioUnmutedNatively=new yn(vn.LOCAL_AUDIO_UNMUTED_NATIVELY,this.eventEmitter),this.statsUpdate=new yn(vn.STATS_UPDATE,this.eventEmitter),this.trackDegraded=new yn(vn.TRACK_DEGRADED,this.eventEmitter),this.trackRestored=new yn(vn.TRACK_RESTORED,this.eventEmitter),this.trackAudioLevelUpdate=new yn(vn.TRACK_AUDIO_LEVEL_UPDATE,this.eventEmitter),this.audioPluginFailed=new yn(vn.AUDIO_PLUGIN_FAILED,this.eventEmitter),this.localAudioSilence=new yn(vn.LOCAL_AUDIO_SILENCE,this.eventEmitter),this.policyChange=new yn(vn.POLICY_CHANGE,this.eventEmitter),this.localRoleUpdate=new yn(vn.LOCAL_ROLE_UPDATE,this.eventEmitter),this.audioTrackUpdate=new yn(vn.AUDIO_TRACK_UPDATE,this.eventEmitter),this.audioTrackAdded=new yn(vn.AUDIO_TRACK_ADDED,this.eventEmitter),this.audioTrackRemoved=new yn(vn.AUDIO_TRACK_REMOVED,this.eventEmitter),this.autoplayError=new yn(vn.AUTOPLAY_ERROR,this.eventEmitter),this.leave=new yn(vn.LEAVE,this.eventEmitter),this.error=new yn(vn.ERROR,this.eventEmitter)}},HJ=class{constructor(e,t,n){this.store=e,this.listener=t,this.audioListener=n}handleActiveSpeakers(e){var t,n,r;let s=e["speaker-list"],i=s.map(l=>({audioLevel:l.level,peer:this.store.getPeerById(l.peer_id),track:this.store.getTrackById(l.track_id)}));(t=this.audioListener)==null||t.onAudioLevelUpdate(i),this.store.updateSpeakers(i);let o=s[0];if(o){let l=this.store.getPeerById(o.peer_id);(n=this.listener)==null||n.onPeerUpdate(4,l)}else(r=this.listener)==null||r.onPeerUpdate(5,null)}},qJ=class{constructor(e){this.listener=e,this.TAG="[BroadcastManager]"}handleNotification(e,t){e==="on-broadcast"&&this.handleBroadcast(t)}handleBroadcast(e){var t,n;_.d(this.TAG,`Received Message from sender=${(t=e==null?void 0:e.peer)==null?void 0:t.peer_id}: ${e}`),(n=this.listener)==null||n.onMessageReceived(e)}},KJ=class{constructor(e,t){this.store=e,this.listener=t}handleQualityUpdate(e){var t;let n=e.peers.map(r=>{let s=this.store.getPeerById(r.peer_id);return s&&s.updateNetworkQuality(r.downlink_score),{peerID:r.peer_id,downlinkQuality:r.downlink_score}});(t=this.listener)==null||t.onConnectionQualityUpdate(n)}},p2=class{constructor(e,t,n){this.store=e,this.eventBus=t,this.listener=n,this.TAG="[TrackManager]",this.tracksToProcess=new Map,this.handleTrackAdd=r=>{_.d(this.TAG,"ONTRACKADD",`${r}`),this.tracksToProcess.set(r.trackId,r),this.processPendingTracks()},this.handleTrackRemovedPermanently=r=>{_.d(this.TAG,"ONTRACKREMOVE permanently",r),Object.keys(r.tracks).forEach(s=>{var i;let o=this.store.getTrackState(s);if(!o)return;let l=this.store.getTrackById(s);if(!l){_.d(this.TAG,"Track not found in store");return}l.type==="audio"&&this.eventBus.audioTrackRemoved.publish(l),this.store.removeTrack(l);let c=this.store.getPeerById(o.peerId);c&&(this.removePeerTracks(c,l),(i=this.listener)==null||i.onTrackUpdate(1,l,c))})},this.handleTrackLayerUpdate=r=>{for(let s in r.tracks){let i=r.tracks[s],o=this.store.getTrackById(s);!o||!this.store.getPeerByTrackId(s)||o instanceof os&&this.setLayer(o,i)}},this.handleTrackUpdate=(r,s=!0)=>{var i,o;let l=this.store.getPeerById(r.peer.peer_id),c=r.peer;if(!l&&!c){_.d(this.TAG,"Track Update ignored - Peer not added to store");return}l||(l=zc(c,this.store),this.store.addPeer(l));for(let d in r.tracks){let u=Object.assign({},(i=this.store.getTrackState(d))==null?void 0:i.trackInfo),h=r.tracks[d],f=this.store.getTrackById(d);if(this.store.setTrackState({peerId:r.peer.peer_id,trackInfo:de(de({},u),h)}),!f||this.tracksToProcess.has(d))this.processTrackInfo(h,r.peer.peer_id,s),this.processPendingTracks();else{f.setEnabled(!h.mute);let m=this.processTrackUpdate(f,u,h);m&&((o=this.listener)==null||o.onTrackUpdate(m,f,l))}}},this.processTrackInfo=(r,s,i)=>{},this.processPendingTracks=()=>{new Map(this.tracksToProcess).forEach(r=>{var s;let i=this.store.getTrackState(r.trackId);if(!i){_.d(this.TAG,"TrackState not added to store",`peerId - ${r.peerId}`,`trackId -${r.trackId}`);return}let o=this.store.getPeerById(i.peerId);if(!o){_.d(this.TAG,"Peer not added to store, peerId",i.peerId);return}r.source=i.trackInfo.source,r.peerId=o.peerId,r.logIdentifier=o.name,r.setEnabled(!i.trackInfo.mute),this.addAudioTrack(o,r),this.addVideoTrack(o,r),r.type==="audio"?this.eventBus.audioTrackAdded.publish({track:r,peer:o}):(s=this.listener)==null||s.onTrackUpdate(0,r,o),this.tracksToProcess.delete(r.trackId)})}}handleTrackMetadataAdd(e){_.d(this.TAG,"TRACK_METADATA_ADD",JSON.stringify(e,null,2));for(let t in e.tracks){let n=e.tracks[t];this.store.setTrackState({peerId:e.peer.peer_id,trackInfo:n})}this.processPendingTracks()}handleTrackRemove(e,t=!0){var n;_.d(this.TAG,"ONTRACKREMOVE",`${e}`);let r=this.store.getTrackState(e.trackId);if(r){if(!this.store.hasTrack(e)){_.d(this.TAG,"Track not found in store");return}if(t){this.store.removeTrack(e);let s=this.store.getPeerById(r.peerId);if(!s)return;this.removePeerTracks(s,e),(n=this.listener)==null||n.onTrackUpdate(1,e,s),e.type==="audio"&&this.eventBus.audioTrackRemoved.publish(e)}}}setLayer(e,t){var n,r;let s=this.store.getPeerByTrackId(e.trackId);s&&(e.setLayerFromServer(t)?(n=this.listener)==null||n.onTrackUpdate(5,e,s):(r=this.listener)==null||r.onTrackUpdate(6,e,s))}removePeerTracks(e,t){let n=e.auxiliaryTracks.indexOf(t);n>-1?(e.auxiliaryTracks.splice(n,1),_.d(this.TAG,"auxiliary track removed",`${t}`)):t.type==="audio"&&e.audioTrack===t?(e.audioTrack=void 0,_.d(this.TAG,"audio track removed",`${t}`)):t.type==="video"&&e.videoTrack===t&&(e.videoTrack=void 0,_.d(this.TAG,"video track removed",`${t}`))}addAudioTrack(e,t){var n;t.type==="audio"&&(t.source==="regular"&&(!e.audioTrack||((n=e.audioTrack)==null?void 0:n.trackId)===t.trackId)?e.audioTrack=t:e.auxiliaryTracks.push(t),this.store.addTrack(t),_.d(this.TAG,"audio track added",`${t}`))}addVideoTrack(e,t){if(t.type!=="video")return;let n=t,r=this.store.getSimulcastDefinitionsForPeer(e,n.source);if(n.setSimulcastDefinitons(r),this.addAsPrimaryVideoTrack(e,n))e.videoTrack?e.videoTrack.replaceTrack(n):e.videoTrack=n,this.store.addTrack(e.videoTrack);else{let s=e.auxiliaryTracks.findIndex(i=>i.trackId===n.trackId);s===-1?(e.auxiliaryTracks.push(n),this.store.addTrack(n)):(e.auxiliaryTracks[s].replaceTrack(n),this.store.addTrack(e.auxiliaryTracks[s]))}_.d(this.TAG,"video track added",`${t}`)}addAsPrimaryVideoTrack(e,t){var n;return t.source==="regular"&&(!e.videoTrack||((n=e.videoTrack)==null?void 0:n.trackId)===t.trackId)}processTrackUpdate(e,t,n){let r;return t.mute!==n.mute?(r=n.mute?2:3,e.type==="audio"&&this.eventBus.audioTrackUpdate.publish({track:e,enabled:!n.mute})):t.description!==n.description&&(r=4),r}},QJ=class extends p2{constructor(e,t,n,r){super(e,t,r),this.transport=n,this.TAG="[OnDemandTrackManager]",this.processTrackInfo=(s,i,o=!0)=>{var l,c;if(s.type!=="video")return;let d=this.store.getPeerById(i);if(!d||!this.isPeerRoleSubscribed(i)){_.d(this.TAG,`no peer in store for peerId: ${i}`);return}let u=new ik(new MediaStream,this.transport.getSubscribeConnection()),h=Ih.getEmptyVideoTrack();h.enabled=!s.mute;let f=new os(u,h,s.source,(l=this.store.getRoom())==null?void 0:l.disableNoneLayerRequest);f.setTrackId(s.track_id),f.peerId=d.peerId,f.logIdentifier=d.name,this.addVideoTrack(d,f),o&&((c=this.listener)==null||c.onTrackUpdate(0,d.videoTrack,d))}}handleTrackMetadataAdd(e){super.handleTrackMetadataAdd(e);for(let t in e.tracks)e.tracks[t].type==="video"&&this.processTrackInfo(e.tracks[t],e.peer.peer_id)}handleTrackRemove(e){let t=e.type==="video"&&e.source==="regular";super.handleTrackRemove(e,!t),t&&this.processTrackInfo({track_id:e.trackId,mute:!e.enabled,type:e.type,source:e.source,stream_id:e.stream.id},e.peerId,!1)}addAsPrimaryVideoTrack(e,t){return t.source!=="regular"?!1:!e.videoTrack||e.videoTrack.trackId===t.trackId?!0:e.videoTrack.enabled&&Vc(e.videoTrack.nativeTrack)}isPeerRoleSubscribed(e){var t,n,r,s;if(!e)return!0;let i=this.store.getLocalPeer(),o=this.store.getPeerById(e);return o&&((s=(n=(t=i==null?void 0:i.role)==null?void 0:t.subscribeParams)==null?void 0:n.subscribeToRoles)==null?void 0:s.includes((r=o.role)==null?void 0:r.name))}},JJ=class{constructor(e,t,n,r){this.store=e,this.peerManager=t,this.trackManager=n,this.listener=r,this.TAG="[PeerListManager]",this.handleInitialPeerList=s=>{let i=Object.values(s.peers);this.peerManager.handlePeerList(i)},this.handleReconnectPeerList=s=>{this.handleRepeatedPeerList(s.peers)},this.handlePreviewRoomState=s=>{if(!this.store.hasRoleDetailsArrived())return;let i=s.peers;if(i==null){s.peer_count===0&&this.handleRepeatedPeerList({});return}Object.keys(i).forEach(o=>{i[o].tracks={},i[o].is_from_room_state=!0}),this.handleRepeatedPeerList(i)},this.handleRepeatedPeerList=s=>{let i=this.store.getRemotePeers(),o=Object.values(s),l=i.filter(d=>!s[d.peerId]);l.length>0&&_.d(this.TAG,`${l}`),l.forEach(d=>{var u;let h={peer_id:d.peerId,role:((u=d.role)==null?void 0:u.name)||"",info:{name:d.name,data:d.metadata||"",user_id:d.customerUserId||"",type:d.type},tracks:{},groups:[],realtime:d.realtime};this.peerManager.handlePeerLeave(h)});let c=[];o.forEach(d=>{let u=this.store.getPeerById(d.peer_id),h=Object.values(d.tracks);u&&(this.store.getPeerTracks(u.peerId).forEach(f=>{var m;d.tracks[f.trackId]||(this.removePeerTrack(u,f.trackId),(m=this.listener)==null||m.onTrackUpdate(1,f,u))}),h.forEach(f=>{this.store.getTrackById(f.track_id)||this.store.setTrackState({peerId:u.peerId,trackInfo:f})}),this.trackManager.handleTrackUpdate({peer:d,tracks:d.tracks},!1),this.peerManager.handlePeerUpdate(d)),c.push(d)}),c.length>0&&this.peerManager.handlePeerList(c)}}handleNotification(e,t,n){if(e==="peer-list"){let r=t;n?(_.d(this.TAG,"RECONNECT_PEER_LIST event",JSON.stringify(r,null,2)),this.handleReconnectPeerList(r)):(_.d(this.TAG,"PEER_LIST event",JSON.stringify(r,null,2)),this.handleInitialPeerList(r))}else if(e==="room-state"){let r=t;this.handlePreviewRoomState(r)}}removePeerTrack(e,t){var n,r;if(_.d(this.TAG,`removing track - ${t} from ${e}`),((n=e.audioTrack)==null?void 0:n.trackId)===t)e.audioTrack=void 0;else if(((r=e.videoTrack)==null?void 0:r.trackId)===t)e.videoTrack=void 0;else{let s=e.auxiliaryTracks.findIndex(i=>i.trackId===t);s>=0&&e.auxiliaryTracks.splice(s,1)}}},Rt=e=>e?new Date(e):void 0,YJ=class{constructor(e,t,n){this.store=e,this.trackManager=t,this.listener=n,this.TAG="[PeerManager]",this.handlePeerList=r=>{var s,i;if(r.length===0){(s=this.listener)==null||s.onPeerUpdate(9,[]);return}let o=[],l=new Set(r.map(c=>c.peer_id));this.store.getRemotePeers().forEach(({peerId:c,fromRoomState:d})=>{!l.has(c)&&d&&this.store.removePeer(c)});for(let c of r)o.push(this.makePeer(c));(i=this.listener)==null||i.onPeerUpdate(9,o),this.trackManager.processPendingTracks()},this.handlePeerJoin=r=>{var s;let i=this.makePeer(r);(s=this.listener)==null||s.onPeerUpdate(0,i),this.trackManager.processPendingTracks()},this.handlePeerLeave=r=>{var s,i,o,l;let c=this.store.getPeerById(r.peer_id);this.store.removePeer(r.peer_id),_.d(this.TAG,"PEER_LEAVE",r.peer_id,`remainingPeers=${this.store.getPeers().length}`),c&&(c.audioTrack&&((s=this.listener)==null||s.onTrackUpdate(1,c.audioTrack,c)),c.videoTrack&&((i=this.listener)==null||i.onTrackUpdate(1,c.videoTrack,c)),(o=c.auxiliaryTracks)==null||o.forEach(d=>{var u;(u=this.listener)==null||u.onTrackUpdate(1,d,c)}),(l=this.listener)==null||l.onPeerUpdate(1,c))}}handleNotification(e,t){switch(e){case"on-peer-join":{let n=t;this.handlePeerJoin(n);break}case"on-peer-leave":{let n=t;this.handlePeerLeave(n);break}case"on-peer-update":this.handlePeerUpdate(t);break}}handlePeerUpdate(e){var t,n,r,s,i;let o=this.store.getPeerById(e.peer_id);if(!o&&e.realtime){o=this.makePeer(e),(t=this.listener)==null||t.onPeerUpdate(o.isHandRaised?12:14,o);return}if(o&&!o.isLocal&&!e.realtime){this.store.removePeer(o.peerId),(n=this.listener)==null||n.onPeerUpdate(13,o);return}if(!o){_.d(this.TAG,`peer ${e.peer_id} not found`);return}if(o.role&&o.role.name!==e.role){let d=this.store.getPolicyForRole(e.role);o.updateRole(d),this.updateSimulcastLayersForPeer(o),(r=this.listener)==null||r.onPeerUpdate(8,o)}let l=o.isHandRaised;o.updateGroups(e.groups);let c=(s=e.groups)==null?void 0:s.includes(Cc);l!==c&&((i=this.listener)==null||i.onPeerUpdate(12,o)),this.handlePeerInfoUpdate(de({peer:o},e.info))}handlePeerInfoUpdate({peer:e,name:t,data:n}){var r,s;e&&(t&&e.name!==t&&(e.updateName(t),(r=this.listener)==null||r.onPeerUpdate(10,e)),n&&e.metadata!==n&&(e.updateMetadata(n),(s=this.listener)==null||s.onPeerUpdate(11,e)))}makePeer(e){let t=this.store.getPeerById(e.peer_id);t||(t=zc(e,this.store),t.realtime=e.realtime,t.joinedAt=Rt(e.joined_at),t.fromRoomState=!!e.is_from_room_state,this.store.addPeer(t),_.d(this.TAG,"adding to the peerList",`${t}`));for(let n in e.tracks){let r=e.tracks[n];this.store.setTrackState({peerId:e.peer_id,trackInfo:r}),r.type==="video"&&this.trackManager.processTrackInfo(r,e.peer_id,!1)}return t}updateSimulcastLayersForPeer(e){this.store.getPeerTracks(e.peerId).forEach(t=>{if(t.type==="video"&&["regular","screen"].includes(t.source)){let n=t,r=this.store.getSimulcastDefinitionsForPeer(e,n.source);n.setSimulcastDefinitons(r)}})}},XJ=class{constructor(e,t){this.store=e,this.eventBus=t}handlePolicyChange(e){let t=this.store.getLocalPeer();if(t&&!t.role){let r=e.known_roles[e.name];t.updateRole(r)}this.store.setKnownRoles(e);let n=this.store.getRoom();n?n.templateId=e.template_id:_.w("[PolicyChangeManager]","on policy change - room not present"),this.updateLocalPeerRole(e),this.eventBus.policyChange.publish(e)}updateLocalPeerRole(e){var t;let n=this.store.getLocalPeer();if(n!=null&&n.role&&n.role.name!==e.name){let r=this.store.getPolicyForRole(e.name),s=n.role;n.updateRole(r),r.name===((t=n.asRole)==null?void 0:t.name)&&delete n.asRole,this.eventBus.localRoleUpdate.publish({oldRole:s,newRole:r})}}},m2=(e=>(e.FLAG_SERVER_SUB_DEGRADATION="subscribeDegradation",e.FLAG_SERVER_SIMULCAST="simulcast",e.FLAG_NON_WEBRTC_DISABLE_OFFER="nonWebRTCDisableOffer",e.FLAG_PUBLISH_STATS="publishStats",e.FLAG_SUBSCRIBE_STATS="subscribeStats",e.FLAG_ON_DEMAND_TRACKS="onDemandTracks",e.FLAG_DISABLE_VIDEO_TRACK_AUTO_UNSUBSCRIBE="disableVideoTrackAutoUnsubscribe",e.FLAG_WHITEBOARD_ENABLED="whiteboardEnabled",e.FLAG_EFFECTS_SDK_ENABLED="effectsSDKEnabled",e.FLAG_VB_ENABLED="vb",e.FLAG_HIPAA_ENABLED="hipaa",e.FLAG_NOISE_CANCELLATION="noiseCancellation",e.FLAG_SCALE_SCREENSHARE_BASED_ON_PIXELS="scaleScreenshareBasedOnPixels",e.FLAG_DISABLE_NONE_LAYER_REQUEST="disableNoneLayerRequest",e))(m2||{}),Rw=(e,t,n)=>{let r=n==="qa"?SQ:wQ,s=new URL(r);return s.searchParams.set("endpoint",`https://${t}`),s.searchParams.set("token",e),s.toString()},ZJ=class{constructor(e,t,n){this.transport=e,this.store=t,this.listener=n,this.TAG="[HMSWhiteboardInteractivityCenter]"}get isEnabled(){return this.transport.isFlagEnabled("whiteboardEnabled")}open(e){return T(this,null,function*(){var t;if(!this.isEnabled)return _.w(this.TAG,"Whiteboard is not enabled for customer");let n=this.store.getWhiteboard(e==null?void 0:e.id),r=n==null?void 0:n.id;if(n||(r=(yield this.transport.signal.createWhiteboard(this.getCreateOptionsWithDefaults(e))).id),!r)throw new Error(`Whiteboard ID: ${r} not found`);let s=yield this.transport.signal.getWhiteboard({id:r}),i=Ke(de({},n),{title:e==null?void 0:e.title,attributes:e==null?void 0:e.attributes,id:s.id,url:Rw(s.token,s.addr,this.store.getEnv()),token:s.token,addr:s.addr,owner:s.owner,permissions:s.permissions||[],open:!0});this.store.setWhiteboard(i),(t=this.listener)==null||t.onWhiteboardUpdate(i)})}close(e){return T(this,null,function*(){var t;if(!this.isEnabled)return _.w(this.TAG,"Whiteboard is not enabled for customer");let n=this.store.getWhiteboard(e);if(!n)throw new Error(`Whiteboard ID: ${e} not found`);let r={id:n.id,title:n.title,open:!1};this.store.setWhiteboard(r),(t=this.listener)==null||t.onWhiteboardUpdate(r)})}setListener(e){this.listener=e}handleLocalRoleUpdate(){return T(this,null,function*(){var e,t,n;let r=this.store.getWhiteboards();for(let s of r.values())if(s.url){let i=yield this.transport.signal.getWhiteboard({id:s.id}),o=this.store.getLocalPeer(),l=(o==null?void 0:o.customerUserId)===i.owner?(t=(e=o.role)==null?void 0:e.permissions.whiteboard)==null?void 0:t.includes("admin"):i.permissions.length>0,c=Ke(de({},s),{id:i.id,url:Rw(i.token,i.addr,this.store.getEnv()),token:i.token,addr:i.addr,owner:i.owner,permissions:i.permissions,open:l});this.store.setWhiteboard(c),(n=this.listener)==null||n.onWhiteboardUpdate(c)}})}getCreateOptionsWithDefaults(e){var t;let n=Object.values(this.store.getKnownRoles()),r=[],s=[],i=[];return n.forEach(o=>{var l,c,d;(l=o.permissions.whiteboard)!=null&&l.includes("read")&&r.push(o.name),(c=o.permissions.whiteboard)!=null&&c.includes("write")&&s.push(o.name),(d=o.permissions.whiteboard)!=null&&d.includes("admin")&&i.push(o.name)}),{title:(e==null?void 0:e.title)||`${(t=this.store.getRoom())==null?void 0:t.id} Whiteboard`,reader:(e==null?void 0:e.reader)||r,writer:(e==null?void 0:e.writer)||s,admin:(e==null?void 0:e.admin)||i}}},eY=class{constructor(e,t,n){this.transport=e,this.store=t,this.listener=n,this.whiteboard=new ZJ(e,t,n)}setListener(e){this.listener=e,this.whiteboard.setListener(e)}createPoll(e){return T(this,null,function*(){var t,n;let r={customerID:"userid",peerID:"peerid",userName:"username"},{poll_id:s}=yield this.transport.signal.setPollInfo(Ke(de({},e),{mode:e.mode?r[e.mode]:void 0,poll_id:e.id,vote:e.rolesThatCanVote,responses:e.rolesThatCanViewResponses}));e.id||(e.id=s),Array.isArray(e.questions)&&(yield this.addQuestionsToPoll(e.id,e.questions));let i=yield this.transport.signal.getPollQuestions({poll_id:e.id,index:0,count:50}),o=jw(Ke(de({},e),{poll_id:e.id,state:"created",created_by:(t=this.store.getLocalPeer())==null?void 0:t.peerId}));o.questions=i.questions.map(({question:l,options:c,answer:d})=>Ke(de({},l),{options:c,answer:d})),(n=this.listener)==null||n.onPollsUpdate(0,[o])})}startPoll(e){return T(this,null,function*(){typeof e=="string"?yield this.transport.signal.startPoll({poll_id:e}):(yield this.createPoll(e),yield this.transport.signal.startPoll({poll_id:e.id}))})}addQuestionsToPoll(e,t){return T(this,null,function*(){t.length>0&&(yield this.transport.signal.setPollQuestions({poll_id:e,questions:t.map((n,r)=>this.createQuestionSetParams(n,r))}))})}stopPoll(e){return T(this,null,function*(){yield this.transport.signal.stopPoll({poll_id:e})})}addResponsesToPoll(e,t){return T(this,null,function*(){let n=this.store.getPoll(e);if(!n)throw new Error("Invalid poll ID - Poll not found");let r=t.map(s=>{var i,o;let l=this.getQuestionInPoll(n,s.questionIndex);return l.type==="single-choice"?(s.option=s.option||((i=s.options)==null?void 0:i[0])||-1,delete s.text,delete s.options):l.type==="multiple-choice"?((o=s.options)==null||o.sort(),delete s.text,delete s.option):(delete s.option,delete s.options),s.skipped&&(delete s.option,delete s.options,delete s.text),de({duration:0,type:l.type,question:s.questionIndex},s)});yield this.transport.signal.setPollResponses({poll_id:e,responses:r})})}fetchLeaderboard(e,t,n){return T(this,null,function*(){var r,s;let i=this.store.getPoll(e);if(!i)throw new Error("Invalid poll ID - Poll not found");let o=(s=(r=this.store.getLocalPeer())==null?void 0:r.role)==null?void 0:s.permissions,l=!!(o!=null&&o.pollRead||o!=null&&o.pollWrite);if(i.anonymous||i.state!=="stopped"||!l)return{entries:[],hasNext:!1};let c=yield this.transport.signal.fetchPollLeaderboard({poll_id:i.id,count:n,offset:t}),d={avgScore:c.avg_score,avgTime:c.avg_time,votedUsers:c.voted_users,totalUsers:c.total_users,correctUsers:c.correct_users};return{entries:c.questions.map(u=>({position:u.position,totalResponses:u.total_responses,correctResponses:u.correct_responses,duration:u.duration,peer:u.peer,score:u.score})),hasNext:!c.last,summary:d}})}getPollResponses(e,t){return T(this,null,function*(){var n,r;let s=yield this.transport.signal.getPollResponses({poll_id:e.id,index:0,count:50,self:t}),i=JSON.parse(JSON.stringify(e));(n=s.responses)==null||n.forEach(({response:o,peer:l,final:c})=>{var d,u;let h=(d=e==null?void 0:e.questions)==null?void 0:d.find(f=>f.index===o.question);if(h){let f={id:o.response_id,questionIndex:o.question,option:o.option,options:o.options,text:o.text,responseFinal:c,peer:{peerid:l.peerid,userHash:l.hash,userid:l.userid,username:l.username},skipped:o.skipped,type:o.type,update:o.update},m=h.responses&&!t?[...h.responses]:[];(u=i.questions)!=null&&u[o.question-1]&&(i.questions[o.question-1].responses=[...m,f])}}),this.store.setPoll(i),(r=this.listener)==null||r.onPollsUpdate(4,[i])})}getPolls(){return T(this,null,function*(){var e,t,n;let r=yield this.transport.signal.getPollsList({count:50,state:"started"}),s=[],i=(t=(e=this.store.getLocalPeer())==null?void 0:e.role)==null?void 0:t.permissions.pollWrite,o=[...r.polls];if(i){let l=yield this.transport.signal.getPollsList({count:50,state:"created"}),c=yield this.transport.signal.getPollsList({count:50,state:"stopped"});o=[...l.polls,...o,...c.polls]}for(let l of o){let c=yield this.transport.signal.getPollQuestions({poll_id:l.poll_id,index:0,count:50}),d=jw(l),u=this.store.getPoll(l.poll_id);d.questions=c.questions.map(({question:h,options:f,answer:m},g)=>{var v,x;return Ke(de({},h),{options:f,answer:m,responses:(x=(v=u==null?void 0:u.questions)==null?void 0:v[g])==null?void 0:x.responses})}),s.push(d),this.store.setPoll(d)}return(n=this.listener)==null||n.onPollsUpdate(3,s),s})}createQuestionSetParams(e,t){var n,r;if(e.index){let l=(n=e.options)==null?void 0:n.map((c,d)=>Ke(de({},c),{index:d+1}));return{question:Ke(de({},e),{index:t+1}),options:l,answer:e.answer}}let s=Ke(de({},e),{index:t+1}),i,o=e.answer||{hidden:!1};return Array.isArray(e.options)&&["single-choice","multiple-choice"].includes(e.type)?(i=(r=e.options)==null?void 0:r.map((l,c)=>({index:c+1,text:l.text,weight:l.weight})),e.type==="single-choice"?o.option=e.options.findIndex(l=>l.isCorrectAnswer)+1||void 0:o.options=e.options.map((l,c)=>l.isCorrectAnswer?c+1:void 0).filter(l=>!!l)):(o==null||delete o.options,o==null||delete o.option),{question:s,options:i,answer:o}}getQuestionInPoll(e,t){var n;let r=(n=e==null?void 0:e.questions)==null?void 0:n.find(s=>s.index===t);if(!r)throw new Error("Invalid question index - Question not found in poll");return r}},jw=e=>{let t={userid:"customerID",peerid:"peerID",username:"userName"};return{id:e.poll_id,title:e.title,startedBy:e.started_by,createdBy:e.created_by,anonymous:e.anonymous,type:e.type,duration:e.duration,locked:e.locked,mode:e.mode?t[e.mode]:void 0,visibility:e.visibility,rolesThatCanVote:e.vote||[],rolesThatCanViewResponses:e.responses||[],state:e.state,stoppedBy:e.stopped_by,startedAt:Rt(e.started_at),stoppedAt:Rt(e.stopped_at),createdAt:Rt(e.created_at)}},tY=class{constructor(e,t,n){this.store=e,this.transport=t,this.listener=n}handleNotification(e,t){switch(e){case"on-poll-start":{this.handlePollStart(t);break}case"on-poll-stop":{this.handlePollStop(t);break}case"on-poll-stats":this.handlePollStats(t);break}}handlePollStart(e){return T(this,null,function*(){var t,n;let r=[];for(let s of e.polls){let i=this.store.getPoll(s.poll_id);if(i&&i.state==="started"){(t=this.listener)==null||t.onPollsUpdate(1,[i]);return}let o=yield this.transport.signal.getPollQuestions({poll_id:s.poll_id,index:0,count:50}),l=jw(s);l.questions=o.questions.map(({question:c,options:d,answer:u})=>Ke(de({},c),{options:d,answer:u})),yield this.updatePollResponses(l,!0),r.push(l),this.store.setPoll(l)}(n=this.listener)==null||n.onPollsUpdate(1,r)})}handlePollStop(e){return T(this,null,function*(){var t;let n=[];for(let r of e.polls){let s=this.store.getPoll(r.poll_id);if(s){s.state="stopped",s.stoppedAt=Rt(r.stopped_at),s.stoppedBy=r.stopped_by;let i=yield this.transport.signal.getPollResult({poll_id:r.poll_id});this.updatePollResult(s,i),n.push(s)}}n.length>0&&((t=this.listener)==null||t.onPollsUpdate(2,n))})}handlePollStats(e){return T(this,null,function*(){var t;let n=[];for(let r of e.polls){let s=this.store.getPoll(r.poll_id);if(!s)return;this.updatePollResult(s,r),n.push(s)}n.length>0&&((t=this.listener)==null||t.onPollsUpdate(4,n))})}updatePollResult(e,t){var n;e.result=de({},e.result),e.result.totalUsers=t.user_count,e.result.maxUsers=t.max_user,e.result.totalResponses=t.total_response,(n=t.questions)==null||n.forEach(r=>{var s,i;let o=(s=e.questions)==null?void 0:s.find(l=>l.index===r.question);o&&(o.result=de({},o.result),o.result.correctResponses=r.correct,o.result.skippedCount=r.skipped,o.result.totalResponses=r.total,(i=r.options)==null||i.forEach((l,c)=>{var d;let u=(d=o.options)==null?void 0:d[c];u&&u.voteCount!==l&&(u.voteCount=l)}))})}updatePollResponses(e,t){return T(this,null,function*(){var n;(n=(yield this.transport.signal.getPollResponses({poll_id:e.id,index:0,count:50,self:t})).responses)==null||n.forEach(({response:r,peer:s,final:i})=>{var o;let l=(o=e==null?void 0:e.questions)==null?void 0:o.find(d=>d.index===r.question);if(!l)return;let c={id:r.response_id,questionIndex:r.question,option:r.option,options:r.options,text:r.text,responseFinal:i,peer:{peerid:s.peerid,userHash:s.hash,userid:s.userid,username:s.username},skipped:r.skipped,type:r.type,update:r.update};Array.isArray(l.responses)&&l.responses.length>0?l.responses.find(({id:d})=>d===c.id)||l.responses.push(c):l.responses=[c]})})}},nY=class{constructor(e,t){this.store=e,this.listener=t}handleNotification(e,t){switch(e){case"on-role-change-request":this.handleRoleChangeRequest(t);break;case"on-track-update-request":this.handleTrackUpdateRequest(t);break;case"on-change-track-mute-state-request":this.handleChangeTrackStateRequest(t);break;default:return}}handleRoleChangeRequest(e){var t;let n={requestedBy:e.requested_by?this.store.getPeerById(e.requested_by):void 0,role:this.store.getPolicyForRole(e.role),token:e.token};(t=this.listener)==null||t.onRoleChangeRequest(n)}handleTrackUpdateRequest(e){let{requested_by:t,track_id:n,mute:r}=e,s=t?this.store.getPeerById(t):void 0,i=this.store.getLocalPeerTracks().find(l=>l.publishedTrackId===n);if(!i)return;let o=()=>{var l;(l=this.listener)==null||l.onChangeTrackStateRequest({requestedBy:s,track:i,enabled:!r})};if(r){if(i.enabled===!r)return;i.setEnabled(!r).then(o)}else o()}handleChangeTrackStateRequest(e){var t;let{type:n,source:r,value:s,requested_by:i}=e,o=i?this.store.getPeerById(i):void 0,l=!s,c=this.getTracksToBeUpdated({type:n,source:r,enabled:l});if(c.length!==0)if(l)(t=this.listener)==null||t.onChangeMultiTrackStateRequest({requestedBy:o,tracks:c,type:n,source:r,enabled:!0});else{let d=[];for(let u of c)d.push(u.setEnabled(!1));Promise.all(d).then(()=>{var u;(u=this.listener)==null||u.onChangeMultiTrackStateRequest({requestedBy:o,tracks:c,enabled:!1})})}}getTracksToBeUpdated({type:e,source:t,enabled:n}){let r=this.store.getLocalPeerTracks();return e&&(r=r.filter(s=>s.type===e)),t&&(r=r.filter(s=>s.source===t)),r.filter(s=>s.enabled!==n)}},rY=class{constructor(e,t){this.store=e,this.listener=t,this.TAG="[RoomUpdateManager]"}handleNotification(e,t){switch(e){case"peer-list":this.onRoomState(t.room);break;case"on-rtmp-update":this.updateRTMPStatus(t);break;case"on-record-update":this.updateRecordingStatus(t);break;case"room-state":this.handlePreviewRoomState(t);break;case"room-info":this.handleRoomInfo(t);break;case"session-info":this.handleSessionInfo(t);break;case"on-hls-update":this.updateHLSStatus(t);break;case"on-transcription-update":this.handleTranscriptionStatus([t]);break}}handleRoomInfo(e){let t=this.store.getRoom();if(!t){_.w(this.TAG,"on session info - room not present");return}t.description=e.description,t.large_room_optimization=e.large_room_optimization,t.max_size=e.max_size,t.name=e.name}handleSessionInfo(e){var t;let n=this.store.getRoom();if(!n){_.w(this.TAG,"on session info - room not present");return}n.sessionId=e.session_id,n.peerCount!==e.peer_count&&(n.peerCount=e.peer_count,(t=this.listener)==null||t.onRoomUpdate("ROOM_PEER_COUNT_UPDATED",n))}handlePreviewRoomState(e){let{room:t}=e;this.onRoomState(t)}onRoomState(e){var t,n,r,s;let{recording:i,streaming:o,transcriptions:l,session_id:c,started_at:d,name:u}=e,h=this.store.getRoom();if(!h){_.w(this.TAG,"on room state - room not present");return}h.name=u,h.rtmp.running=this.isStreamingRunning((t=o==null?void 0:o.rtmp)==null?void 0:t.state),h.rtmp.startedAt=Rt((n=o==null?void 0:o.rtmp)==null?void 0:n.started_at),h.rtmp.state=(r=o==null?void 0:o.rtmp)==null?void 0:r.state,h.recording.server=this.getPeerListSFURecording(i),h.recording.browser=this.getPeerListBrowserRecording(i),h.recording.hls=this.getPeerListHLSRecording(i),h.hls=this.convertHls(o==null?void 0:o.hls),h.transcriptions=this.addTranscriptionDetail(l),h.sessionId=c,h.startedAt=Rt(d),(s=this.listener)==null||s.onRoomUpdate("RECORDING_STATE_UPDATED",h)}addTranscriptionDetail(e){return e?e.map(t=>({state:t.state,mode:t.mode,initialised_at:Rt(t.initialised_at),started_at:Rt(t.started_at),stopped_at:Rt(t.stopped_at),updated_at:Rt(t.updated_at),error:this.toSdkError(t==null?void 0:t.error)})):[]}isRecordingRunning(e){return e?!["none","paused","stopped","failed"].includes(e):!1}isStreamingRunning(e){return e?!["none","stopped","failed"].includes(e):!1}initHLS(e){let t=this.store.getRoom(),n={running:!0,variants:[]};return t?(e!=null&&e.variants&&e.variants.forEach((r,s)=>{var i,o,l;r.state!=="initialised"?n.variants.push({meetingURL:r==null?void 0:r.meetingURL,url:r==null?void 0:r.url,metadata:r==null?void 0:r.metadata,playlist_type:r==null?void 0:r.playlist_type,startedAt:Rt((i=e==null?void 0:e.variants)==null?void 0:i[s].started_at),initialisedAt:Rt((o=e==null?void 0:e.variants)==null?void 0:o[s].initialised_at),state:r.state,stream_type:r==null?void 0:r.stream_type}):n.variants.push({initialisedAt:Rt((l=e==null?void 0:e.variants)==null?void 0:l[s].initialised_at),url:""})}),n):(_.w(this.TAG,"on hls - room not present"),n)}updateHLSStatus(e){var t;let n=this.store.getRoom(),r=e.variants&&e.variants.length>0?e.variants.some(s=>this.isStreamingRunning(s.state)):!1;if(!n){_.w(this.TAG,"on hls - room not present");return}e.enabled=r,n.hls=this.convertHls(e),(t=this.listener)==null||t.onRoomUpdate("HLS_STREAMING_STATE_UPDATED",n)}handleTranscriptionStatus(e){var t;let n=this.store.getRoom();if(!n){_.w(this.TAG,"on transcription - room not present");return}n.transcriptions=this.addTranscriptionDetail(e)||[],(t=this.listener)==null||t.onRoomUpdate("TRANSCRIPTION_STATE_UPDATED",n)}convertHls(e){var t;if(e!=null&&e.variants&&e.variants.length>0&&e.variants.some(r=>r.state==="initialised"))return this.initHLS(e);let n={running:!!(e!=null&&e.enabled),variants:[],error:this.toSdkError(e==null?void 0:e.error)};return(t=e==null?void 0:e.variants)==null||t.forEach(r=>{n.variants.push({meetingURL:r==null?void 0:r.meeting_url,url:r==null?void 0:r.url,metadata:r==null?void 0:r.metadata,playlist_type:r==null?void 0:r.playlist_type,startedAt:Rt(r==null?void 0:r.started_at),initialisedAt:Rt(r==null?void 0:r.initialised_at),state:r.state,stream_type:r==null?void 0:r.stream_type})}),n}getHLSRecording(e){var t,n;let r={running:!1},s=this.isRecordingRunning(e==null?void 0:e.state);return(s||(e==null?void 0:e.state)==="paused")&&(r={running:s,singleFilePerLayer:!!((t=e==null?void 0:e.hls_recording)!=null&&t.single_file_per_layer),hlsVod:!!((n=e==null?void 0:e.hls_recording)!=null&&n.hls_vod),startedAt:Rt(e==null?void 0:e.started_at),initialisedAt:Rt(e==null?void 0:e.initialised_at),state:e==null?void 0:e.state,error:this.toSdkError(e==null?void 0:e.error)}),r}getPeerListHLSRecording(e){var t,n;let r=e==null?void 0:e.hls;return{running:this.isRecordingRunning(r==null?void 0:r.state),startedAt:Rt(r==null?void 0:r.started_at),initialisedAt:Rt(r==null?void 0:r.initialised_at),state:r==null?void 0:r.state,singleFilePerLayer:(t=r==null?void 0:r.config)==null?void 0:t.single_file_per_layer,hlsVod:(n=r==null?void 0:r.config)==null?void 0:n.hls_vod}}getPeerListBrowserRecording(e){let t=e==null?void 0:e.browser;return{running:this.isRecordingRunning(t==null?void 0:t.state),startedAt:Rt(t==null?void 0:t.started_at),state:t==null?void 0:t.state}}getPeerListSFURecording(e){let t=e==null?void 0:e.sfu;return{running:this.isRecordingRunning(t==null?void 0:t.state),startedAt:Rt(t==null?void 0:t.started_at),state:t==null?void 0:t.state}}updateRecordingStatus(e){var t;let n=this.store.getRoom(),r=this.isRecordingRunning(e.state);if(!n){_.w(this.TAG,`set recording status running=${r} - room not present`);return}let s;e.type==="sfu"?(n.recording.server={running:r,startedAt:r?Rt(e.started_at):void 0,error:this.toSdkError(e.error),state:e.state},s="SERVER_RECORDING_STATE_UPDATED"):e.type==="HLS"?(n.recording.hls=this.getHLSRecording(e),s="RECORDING_STATE_UPDATED"):(n.recording.browser={running:r,startedAt:r?Rt(e.started_at):void 0,error:this.toSdkError(e.error),state:e==null?void 0:e.state},s="BROWSER_RECORDING_STATE_UPDATED"),(t=this.listener)==null||t.onRoomUpdate(s,n)}updateRTMPStatus(e){var t,n;let r=this.store.getRoom(),s=this.isStreamingRunning(e.state);if(!r){_.w(this.TAG,"on policy change - room not present");return}if(!s){r.rtmp={running:s,state:e.state,error:this.toSdkError(e.error)},(t=this.listener)==null||t.onRoomUpdate("RTMP_STREAMING_STATE_UPDATED",r);return}r.rtmp={running:s,startedAt:s?Rt(e.started_at):void 0,state:e.state,error:this.toSdkError(e.error)},(n=this.listener)==null||n.onRoomUpdate("RTMP_STREAMING_STATE_UPDATED",r)}toSdkError(e){if(!(e!=null&&e.code))return;let t=e.message||"error in streaming/recording",n=new Ue(e.code,"ServerErrors","NONE",t,t);return _.e(this.TAG,"error in streaming/recording",n),n}},sY=class{constructor(e,t){this.store=e,this.listener=t}handleNotification(e,t){e==="on-metadata-change"&&this.handleMetadataChange(t)}handleMetadataChange(e){var t;let n=e.values.map(r=>({key:r.key,value:r.data,updatedAt:Rt(r.updated_at),updatedBy:r.updated_by?this.store.getPeerById(r.updated_by):void 0}));(t=this.listener)==null||t.onSessionStoreUpdate(n)}},iY=class{constructor(e,t,n){this.store=e,this.transport=t,this.listener=n}handleNotification(e,t){switch(e){case"on-whiteboard-update":{this.handleWhiteboardUpdate(t);break}}}handleWhiteboardUpdate(e){return T(this,null,function*(){var t;let n=this.store.getLocalPeer(),r=this.store.getWhiteboard(e.id),s=e.owner===(n==null?void 0:n.peerId)||e.owner===(n==null?void 0:n.customerUserId),i=e.state==="open",o={id:e.id,title:e.title,attributes:e.attributes};if(o.open=s?r==null?void 0:r.open:i,o.owner=o.open?e.owner:void 0,o.open)if(s)o.url=r==null?void 0:r.url,o.token=r==null?void 0:r.token,o.addr=r==null?void 0:r.addr,o.permissions=r==null?void 0:r.permissions;else{let l=yield this.transport.signal.getWhiteboard({id:e.id});o.url=Rw(l.token,l.addr,this.store.getEnv()),o.token=l.token,o.addr=l.addr,o.permissions=l.permissions,o.open=l.permissions.length>0}this.store.setWhiteboard(o),(t=this.listener)==null||t.onWhiteboardUpdate(o)})}},aY=class{constructor(e,t,n,r,s,i){this.store=e,this.transport=n,this.listener=r,this.audioListener=s,this.connectionQualityListener=i,this.TAG="[HMSNotificationManager]",this.hasConsistentRoomStateArrived=!1,this.ignoreNotification=l=>{if(l==="peer-list")this.hasConsistentRoomStateArrived=!0;else if(l==="room-state")return this.hasConsistentRoomStateArrived;return!1},this.handleTrackAdd=l=>{this.trackManager.handleTrackAdd(l)},this.handleTrackRemove=l=>{this.trackManager.handleTrackRemove(l)},this.updateLocalPeer=({name:l,metadata:c})=>{let d=this.store.getLocalPeer();this.peerManager.handlePeerInfoUpdate({peer:d,name:l,data:c})};let o=this.transport.isFlagEnabled("onDemandTracks");this.trackManager=o?new QJ(this.store,t,this.transport,this.listener):new p2(this.store,t,this.listener),this.peerManager=new YJ(this.store,this.trackManager,this.listener),this.peerListManager=new JJ(this.store,this.peerManager,this.trackManager,this.listener),this.broadcastManager=new qJ(this.listener),this.policyChangeManager=new XJ(this.store,t),this.requestManager=new nY(this.store,this.listener),this.activeSpeakerManager=new HJ(this.store,this.listener,this.audioListener),this.connectionQualityManager=new KJ(this.store,this.connectionQualityListener),this.roomUpdateManager=new rY(this.store,this.listener),this.sessionMetadataManager=new sY(this.store,this.listener),this.pollsManager=new tY(this.store,this.transport,this.listener),this.whiteboardManager=new iY(this.store,this.transport,this.listener)}setListener(e){this.listener=e,this.trackManager.listener=e,this.peerManager.listener=e,this.peerListManager.listener=e,this.broadcastManager.listener=e,this.requestManager.listener=e,this.activeSpeakerManager.listener=e,this.roomUpdateManager.listener=e,this.sessionMetadataManager.listener=e,this.pollsManager.listener=e,this.whiteboardManager.listener=e}setAudioListener(e){this.audioListener=e,this.activeSpeakerManager.audioListener=e}setConnectionQualityListener(e){this.connectionQualityListener=e,this.connectionQualityManager.listener=e}handleNotification(e,t=!1){var n,r;let s=e.method,i=e.params;["active-speakers","sfu-stats","on-connection-quality-update",void 0].includes(s)||_.d(this.TAG,`Received notification - ${s}`,{notification:i}),s==="sfu-stats"&&(n=window.HMS)!=null&&n.ON_SFU_STATS&&typeof((r=window.HMS)==null?void 0:r.ON_SFU_STATS)=="function"&&window.HMS.ON_SFU_STATS(e.params),!this.ignoreNotification(s)&&(this.roomUpdateManager.handleNotification(s,i),this.peerManager.handleNotification(s,i),this.requestManager.handleNotification(s,i),this.peerListManager.handleNotification(s,i,t),this.broadcastManager.handleNotification(s,i),this.sessionMetadataManager.handleNotification(s,i),this.pollsManager.handleNotification(s,i),this.whiteboardManager.handleNotification(s,i),this.handleIsolatedMethods(s,i))}handleIsolatedMethods(e,t){switch(e){case"on-track-add":{this.trackManager.handleTrackMetadataAdd(t);break}case"on-track-update":{this.trackManager.handleTrackUpdate(t);break}case"on-track-remove":{if(!t.peer){_.d(this.TAG,`Ignoring sfu notification - ${e}`,{notification:t});return}this.trackManager.handleTrackRemovedPermanently(t);break}case"on-track-layer-update":{this.trackManager.handleTrackLayerUpdate(t);break}case"active-speakers":this.activeSpeakerManager.handleActiveSpeakers(t);break;case"on-connection-quality-update":this.connectionQualityManager.handleQualityUpdate(t);break;case"on-policy-change":this.policyChangeManager.handlePolicyChange(t);break;case"node-info":this.transport.setSFUNodeId(t.sfu_node_id);break}}},oY=class{constructor(e){this.transport=e,this.observedKeys=new Set}get(e){return T(this,null,function*(){let{data:t,updated_at:n}=yield this.transport.signal.getSessionMetadata(e);return{value:t,updatedAt:Rt(n)}})}set(e,t){return T(this,null,function*(){let{data:n,updated_at:r}=yield this.transport.signal.setSessionMetadata({key:e,data:t}),s=Rt(r);return{value:n,updatedAt:s}})}observe(e){return T(this,null,function*(){let t=new Set(this.observedKeys);if(e.forEach(n=>this.observedKeys.add(n)),this.observedKeys.size!==t.size)try{yield this.transport.signal.listenMetadataChange(Array.from(this.observedKeys))}catch(n){throw this.observedKeys=t,n}})}unobserve(e){return T(this,null,function*(){let t=new Set(this.observedKeys);if(this.observedKeys=new Set([...this.observedKeys].filter(n=>!e.includes(n))),this.observedKeys.size!==t.size)try{yield this.transport.signal.listenMetadataChange(Array.from(this.observedKeys))}catch(n){throw this.observedKeys=t,n}})}},lY=class{constructor(e,t,n="",r="",s="https://prod-init.100ms.live/init",i=!1,o){this.authToken=e,this.peerId=t,this.peerName=n,this.data=r,this.endpoint=s,this.autoSubscribeVideo=i,this.iceServers=o}},wr=(e=>(e[e.ConnectFailed=0]="ConnectFailed",e[e.SignalDisconnect=1]="SignalDisconnect",e[e.JoinWSMessageFailed=2]="JoinWSMessageFailed",e[e.PublishIceConnectionFailed=3]="PublishIceConnectionFailed",e[e.SubscribeIceConnectionFailed=4]="SubscribeIceConnectionFailed",e))(wr||{}),cY={0:[],1:[],2:[1],3:[1],4:[1]},Mw=(e=>(e.Disconnected="Disconnected",e.Connecting="Connecting",e.Joined="Joined",e.Preview="Preview",e.Failed="Failed",e.Reconnecting="Reconnecting",e.Leaving="Leaving",e))(Mw||{}),dY=class{constructor(e){this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n,e(t,n)})}},uY=class{constructor(e,t){this.onStateChange=e,this.sendEvent=t,this.TAG="[RetryScheduler]",this.inProgress=new Map,this.retryTaskIds=[]}schedule(e){return T(this,arguments,function*({category:t,error:n,task:r,originalState:s,maxRetryTime:i=6e4,changeState:o=!0}){yield this.scheduleTask({category:t,error:n,changeState:o,task:r,originalState:s,maxRetryTime:i,failedAt:Date.now()})})}reset(){this.retryTaskIds.forEach(e=>clearTimeout(e)),this.retryTaskIds=[],this.inProgress.clear()}isTaskInProgress(e){return!!this.inProgress.get(e)}scheduleTask(e){return T(this,arguments,function*({category:t,error:n,changeState:r,task:s,originalState:i,failedAt:o,maxRetryTime:l=6e4,failedRetryCount:c=0}){if(_.d(this.TAG,"schedule: ",{category:wr[t],error:n}),c===0){let v=this.inProgress.get(t);if(v){_.d(this.TAG,`schedule: Already a task for ${wr[t]} scheduled, waiting for its completion`),yield v.promise;return}let x=new dY((S,y)=>{});this.inProgress.set(t,x),this.sendEvent(n,t)}let d=!1,u=cY[t];for(let v in u){let x=u[parseInt(v)];try{let S=this.inProgress.get(x);S&&(_.d(this.TAG,`schedule: Suspending retry task of ${wr[t]}, waiting for ${wr[x]} to recover`),yield S.promise,_.d(this.TAG,`schedule: Resuming retry task ${wr[t]} as it's dependency ${wr[x]} is recovered`))}catch{_.d(this.TAG,`schedule: Stopping retry task of ${wr[t]} as it's dependency ${wr[x]} failed to recover`),d=!0;break}}let h=v=>{if(this.inProgress.delete(t),this.sendEvent(v,t),this.reset(),r)this.onStateChange("Failed",v);else throw v},f=Date.now()-o;if(f>=l||d)return n.description+=`. [${wr[t]}] Could not recover after ${f} milliseconds`,d&&(n.description+=` Could not recover all of it's required dependencies - [${u.map(v=>wr[v]).toString()}]`),n.isTerminal=!0,h(n);r&&this.onStateChange("Reconnecting",n);let m=this.getDelayForRetryCount(t);_.d(this.TAG,`schedule: [${wr[t]}] [failedRetryCount=${c}] Scheduling retry task in ${m}ms`);let g;try{g=yield this.setTimeoutPromise(s,m)}catch(v){g=!1;let x=v;if(x.isTerminal)return _.e(this.TAG,`[${wr[t]}] Un-caught terminal exception ${x.name} in retry-task`,v),h(x);_.w(this.TAG,`[${wr[t]}] Un-caught exception ${x.name} in retry-task, initiating retry`,v)}if(g){let v=this.inProgress.get(t);this.inProgress.delete(t),v==null||v.resolve(c),r&&this.inProgress.size===0&&this.onStateChange(i),_.d(this.TAG,`schedule: [${wr[t]}] [failedRetryCount=${c}] Recovered  after ${f}ms`)}else yield this.scheduleTask({category:t,error:n,changeState:r,task:s,originalState:i,maxRetryTime:l,failedAt:o,failedRetryCount:c+1})})}getDelayForRetryCount(e){let t=e===2?Math.random()*2:Math.random(),n=0;return e===2?n=2+t:e===1&&(n=1),n*1e3}setTimeoutPromise(e,t){return T(this,null,function*(){return new Promise((n,r)=>{let s=window.setTimeout(()=>T(this,null,function*(){try{let i=yield e();i&&this.retryTaskIds.splice(this.retryTaskIds.indexOf(s),1),n(i)}catch(i){r(i)}}),t);this.retryTaskIds.push(s)})})}},hY=class extends sk{constructor(){super(100),this.localStorage=new xv("hms-analytics"),this.localStorage.clear(),this.initLocalStorageQueue()}enqueue(e){super.enqueue(e),this.localStorage.set(this.storage)}dequeue(){let e=super.dequeue();return this.localStorage.set(this.storage),e}initLocalStorageQueue(){var e;(e=this.localStorage.get())==null||e.forEach(t=>{let n=new Et(t);super.enqueue(n)})}},fY=class{constructor(){this.TAG="[AnalyticsTransport]",this.eventCount=0,this.lastResetTime=Date.now(),this.MAX_EVENTS_PER_MINUTE=200,this.RESET_INTERVAL_MS=6e4}checkRateLimit(){let e=Date.now();if(e-this.lastResetTime>=this.RESET_INTERVAL_MS&&(this.eventCount=0,this.lastResetTime=e),this.eventCount>=this.MAX_EVENTS_PER_MINUTE)throw new Error("Too many events being sent, please check the implementation.");this.eventCount++}sendEvent(e){try{this.checkRateLimit()}catch(t){throw _.w(this.TAG,"Rate limit exceeded",t),t}try{this.sendSingleEvent(e),this.flushFailedEvents()}catch(t){_.w(this.TAG,"sendEvent failed",t)}}flushFailedEvents(e){var t;try{for(_.d(this.TAG,"Flushing failed events",this.failedEvents);this.failedEvents.size()>0;){let n=this.failedEvents.dequeue();n&&(((t=n.metadata)==null?void 0:t.peer.peer_id)===e||!n.metadata.peer.peer_id?this.sendSingleEvent(n):Ah.sendEvent(n))}}catch(n){_.w(this.TAG,"flushFailedEvents failed",n)}}sendSingleEvent(e){try{this.transportProvider.sendEvent(e),_.d(this.TAG,"Sent event",e.name,e)}catch(t){throw _.w(this.TAG,`${this.transportProvider.TAG}.sendEvent failed, adding to local storage events`,{event:e,error:t}),this.failedEvents.enqueue(e),t}}},pY=class extends fY{constructor(e){super(),this.transportProvider=e,this.failedEvents=new hY}},g2=class{constructor(e,t,n,r){this.store=e,this.eventBus=t,this.sampleWindowSize=n,this.pushInterval=r,this.shouldSendEvent=!1,this.sequenceNum=1,this.stop=()=>{this.shouldSendEvent&&this.sendEvent(),this.eventBus.statsUpdate.unsubscribe(this.handleStatsUpdate.bind(this)),this.shouldSendEvent=!1},this.start()}start(){this.shouldSendEvent||(this.stop(),this.shouldSendEvent=!0,this.eventBus.statsUpdate.subscribe(this.handleStatsUpdate.bind(this)),this.startLoop().catch(e=>_.e("[StatsAnalytics]",e.message)))}startLoop(){return T(this,null,function*(){for(;this.shouldSendEvent;)yield ma(this.pushInterval*1e3),this.sendEvent()})}sendEvent(){this.trackAnalytics.forEach(e=>{e.clearSamples()})}cleanTrackAnalyticsAndCreateSample(e){this.trackAnalytics.forEach(t=>{!this.store.hasTrack(t.track)&&!(t.samples.length>0)&&this.trackAnalytics.delete(t.track_id)}),e&&this.trackAnalytics.forEach(t=>{t.createSample()})}},v2=class{constructor({track:e,ssrc:t,rid:n,kind:r,sampleWindowSize:s}){this.samples=[],this.tempStats=[],this.track=e,this.ssrc=t,this.rid=n,this.kind=r,this.track_id=this.track.trackId,this.source=this.track.source,this.sampleWindowSize=s}pushTempStat(e){this.tempStats.push(e)}createSample(){this.tempStats.length!==0&&(this.samples.push(this.collateSample()),this.prevLatestStat=this.getLatestStat(),this.tempStats.length=0)}clearSamples(){this.samples.length=0}getLatestStat(){return this.tempStats[this.tempStats.length-1]}getFirstStat(){return this.tempStats[0]}calculateSum(e){if(typeof this.getLatestStat()[e]=="number")return this.tempStats.reduce((t,n)=>t+(n[e]||0),0)}calculateAverage(e,t=!0){let n=this.calculateSum(e),r=n!==void 0?n/this.tempStats.length:void 0;return r?t?Math.round(r):r:void 0}calculateDifferenceForSample(e){var t;let n=Number((t=this.prevLatestStat)==null?void 0:t[e])||0;return(Number(this.getLatestStat()[e])||0)-n}calculateDifferenceAverage(e,t=!0){let n=this.calculateDifferenceForSample(e)/this.tempStats.length;return t?Math.round(n):n}calculateInstancesOfHigh(e,t){if(typeof this.getLatestStat()[e]=="number")return this.tempStats.reduce((n,r)=>n+((r[e]||0)>t?1:0),0)}},y2=(e,t)=>e&&t&&(e.frameWidth!==t.frameWidth||e.frameHeight!==t.frameHeight),x2=(e,t)=>e&&t&&e.enabled!==t.enabled,Dw=e=>Object.entries(e).filter(([,t])=>t!==void 0).reduce((t,[n,r])=>(t[n]=r,t),{}),mY=class extends g2{constructor(){super(...arguments),this.trackAnalytics=new Map}toAnalytics(){var e,t;let n=[],r=[];return this.trackAnalytics.forEach(s=>{s.track.type==="audio"?n.push(s.toAnalytics()):s.track.type==="video"&&r.push(s.toAnalytics())}),{audio:n,video:r,joined_at:(t=(e=this.store.getRoom())==null?void 0:e.joinedAt)==null?void 0:t.getTime(),sequence_num:this.sequenceNum++,max_window_sec:30}}sendEvent(){this.eventBus.analytics.publish(Be.publishStats(this.toAnalytics())),super.sendEvent()}handleStatsUpdate(e){let t=!1,n=e.getLocalTrackStats();Object.keys(n).forEach(r=>{let s=n[r],i=this.store.getLocalPeerTracks().find(o=>o.getTrackIDBeingSent()===r);Object.keys(s).forEach(o=>{var l,c,d;let u=s[o];if(!i)return;let h=this.getTrackIdentifier(i.trackId,u),f=Ke(de({},u),{availableOutgoingBitrate:(c=(l=e.getLocalPeerStats())==null?void 0:l.publish)==null?void 0:c.availableOutgoingBitrate});if(h&&this.trackAnalytics.has(h))(d=this.trackAnalytics.get(h))==null||d.pushTempStat(f);else if(i){let g=new gY({track:i,sampleWindowSize:this.sampleWindowSize,rid:u.rid,ssrc:u.ssrc.toString(),kind:u.kind});g.pushTempStat(f),this.trackAnalytics.set(this.getTrackIdentifier(i.trackId,u),g)}let m=this.trackAnalytics.get(h);m!=null&&m.shouldCreateSample()&&(t=!0)})}),this.cleanTrackAnalyticsAndCreateSample(t)}getTrackIdentifier(e,t){return t.rid?`${e}:${t.rid}`:e}},gY=class extends v2{constructor(){super(...arguments),this.samples=[],this.collateSample=()=>{let e=this.getLatestStat(),t=e.qualityLimitationDurations,n=t&&{bandwidth_sec:t.bandwidth,cpu_sec:t.cpu,other_sec:t.other},r=e.frameHeight?{height_px:this.getLatestStat().frameHeight,width_px:this.getLatestStat().frameWidth}:void 0,s=this.calculateAverage("jitter",!1),i=s?Math.round(s*1e3):void 0,o=this.calculateAverage("roundTripTime",!1),l=o?Math.round(o*1e3):void 0;return Dw({timestamp:Date.now(),avg_available_outgoing_bitrate_bps:this.calculateAverage("availableOutgoingBitrate"),avg_bitrate_bps:this.calculateAverage("bitrate"),avg_fps:this.calculateAverage("framesPerSecond"),total_packets_lost:this.getLatestStat().packetsLost,total_packets_sent:this.getLatestStat().packetsSent,total_packet_sent_delay_sec:parseFloat(this.calculateDifferenceForSample("totalPacketSendDelay").toFixed(4)),total_fir_count:this.calculateDifferenceForSample("firCount"),total_pli_count:this.calculateDifferenceForSample("pliCount"),total_nack_count:this.calculateDifferenceForSample("nackCount"),avg_jitter_ms:i,avg_round_trip_time_ms:l,total_quality_limitation:n,resolution:r})},this.shouldCreateSample=()=>{let e=this.tempStats.length,t=this.tempStats[e-1],n=this.tempStats[e-2];return e===30||x2(t,n)||t.kind==="video"&&y2(t,n)},this.toAnalytics=()=>({track_id:this.track_id,ssrc:this.ssrc,source:this.source,rid:this.rid,samples:this.samples})}},vY=class extends g2{constructor(){super(...arguments),this.trackAnalytics=new Map}toAnalytics(){var e,t;let n=[],r=[];return this.trackAnalytics.forEach(s=>{s.track.type==="audio"?n.push(s.toAnalytics()):s.track.type==="video"&&r.push(s.toAnalytics())}),{audio:n,video:r,joined_at:(t=(e=this.store.getRoom())==null?void 0:e.joinedAt)==null?void 0:t.getTime(),sequence_num:this.sequenceNum++,max_window_sec:10}}sendEvent(){this.eventBus.analytics.publish(Be.subscribeStats(this.toAnalytics())),super.sendEvent()}handleStatsUpdate(e){let t=e.getAllRemoteTracksStats(),n=!1;Object.keys(t).forEach(r=>{var s,i;let o=this.store.getTrackById(r),l=t[r],c=(s=this.trackAnalytics.get(r))==null?void 0:s.getLatestStat(),d=((m,g)=>{let v=(g==null?void 0:g.jitterBufferDelay)||0,x=(g==null?void 0:g.jitterBufferEmittedCount)||0,S=((m==null?void 0:m.jitterBufferDelay)||0)-v,y=((m==null?void 0:m.jitterBufferEmittedCount)||0)-x;return y>0?S*1e3/y:(g==null?void 0:g.calculatedJitterBufferDelay)||0})(l,c),u=this.calculateAvSyncForStat(l,e),h=Ke(de({},l),{calculatedJitterBufferDelay:d,avSync:u});if(l.kind==="video"){let m=o.getPreferredLayerDefinition();h.expectedFrameHeight=m==null?void 0:m.resolution.height,h.expectedFrameWidth=m==null?void 0:m.resolution.width}if(this.trackAnalytics.has(r))(i=this.trackAnalytics.get(r))==null||i.pushTempStat(h);else if(o){let m=new yY({track:o,sampleWindowSize:this.sampleWindowSize,ssrc:l.ssrc.toString(),kind:l.kind});m.pushTempStat(h),this.trackAnalytics.set(r,m)}let f=this.trackAnalytics.get(r);f!=null&&f.shouldCreateSample()&&(n=!0)}),this.cleanTrackAnalyticsAndCreateSample(n)}calculateAvSyncForStat(e,t){if(!e.peerID||!e.estimatedPlayoutTimestamp||e.kind!=="video")return;let n=this.store.getPeerById(e.peerID),r=n==null?void 0:n.audioTrack,s=n==null?void 0:n.videoTrack;if(!(r&&s&&r.enabled&&s.enabled))return ag;let i=t.getRemoteTrackStats(r.trackId);if(!i)return ag;if(i.estimatedPlayoutTimestamp)return i.estimatedPlayoutTimestamp-e.estimatedPlayoutTimestamp}},yY=class extends v2{constructor(){super(...arguments),this.samples=[],this.collateSample=()=>{let e=this.getLatestStat(),t=this.getFirstStat(),n={timestamp:Date.now(),total_pli_count:this.calculateDifferenceForSample("pliCount"),total_nack_count:this.calculateDifferenceForSample("nackCount"),avg_jitter_buffer_delay:this.calculateAverage("calculatedJitterBufferDelay",!1)};if(e.kind==="video")return Dw(Ke(de({},n),{avg_av_sync_ms:this.calculateAvgAvSyncForSample(),avg_frames_received_per_sec:this.calculateDifferenceAverage("framesReceived"),avg_frames_dropped_per_sec:this.calculateDifferenceAverage("framesDropped"),avg_frames_decoded_per_sec:this.calculateDifferenceAverage("framesDecoded"),frame_width:this.calculateAverage("frameWidth"),frame_height:this.calculateAverage("frameHeight"),expected_frame_width:this.calculateAverage("expectedFrameWidth"),expected_frame_height:this.calculateAverage("expectedFrameHeight"),pause_count:this.calculateDifferenceForSample("pauseCount"),pause_duration_seconds:this.calculateDifferenceForSample("totalPausesDuration"),freeze_count:this.calculateDifferenceForSample("freezeCount"),freeze_duration_seconds:this.calculateDifferenceForSample("totalFreezesDuration")}));{let r=(e.concealedSamples||0)-(e.silentConcealedSamples||0)-((t.concealedSamples||0)-(t.silentConcealedSamples||0));return Dw(Ke(de({},n),{audio_level:this.calculateInstancesOfHigh("audioLevel",.05),audio_concealed_samples:r,audio_total_samples_received:this.calculateDifferenceForSample("totalSamplesReceived"),audio_concealment_events:this.calculateDifferenceForSample("concealmentEvents"),fec_packets_discarded:this.calculateDifferenceForSample("fecPacketsDiscarded"),fec_packets_received:this.calculateDifferenceForSample("fecPacketsReceived"),total_samples_duration:this.calculateDifferenceForSample("totalSamplesDuration"),total_packets_received:this.calculateDifferenceForSample("packetsReceived"),total_packets_lost:this.calculateDifferenceForSample("packetsLost")}))}},this.shouldCreateSample=()=>{let e=this.tempStats.length,t=this.tempStats[e-1],n=this.tempStats[e-2];return e===10||x2(t,n)||t.kind==="video"&&y2(t,n)},this.toAnalytics=()=>({track_id:this.track_id,ssrc:this.ssrc,source:this.source,rid:this.rid,samples:this.samples})}calculateAvgAvSyncForSample(){let e=this.tempStats.map(t=>t.avSync).filter(t=>t!==void 0&&t!==ag);return e.length===0?ag:e.reduce((t,n)=>t+n,0)/e.length}},lg=(e=>(e[e.Publish=0]="Publish",e[e.Subscribe=1]="Subscribe",e))(lg||{});function xY(e,t){var n;let r=CL(e.sdp);if(!((n=r.origin)!=null&&n.username.startsWith("mozilla")))return e;let s=t?Array.from(t.values()):[];return r.media.forEach(i=>{var o,l,c;let d=(o=i.msid)==null?void 0:o.split(" ")[0],u=(l=s.find(h=>h.type===i.type&&h.stream_id===d))==null?void 0:l.track_id;u&&(i.msid=(c=i.msid)==null?void 0:c.replace(/\s(.+)/,` ${u}`))}),{type:e.type,sdp:lK(r)}}function bY(e,t){var n;if(!(e!=null&&e.sdp)||!t)return;let r=CL(e.sdp).media.find(s=>Co(s.mid)&&parseInt(s.mid)===parseInt(t));return(n=r==null?void 0:r.msid)==null?void 0:n.split(" ")[1]}function wY(e){return e.sdp.includes("usedtx=1")?e:{type:e.type,sdp:e.sdp.replace("useinbandfec=1","useinbandfec=1;usedtx=1")}}var Fi="[HMSConnection]",b2=class{constructor(e,t){this.candidates=new Array,this.role=e,this.signal=t}get iceConnectionState(){return this.nativeConnection.iceConnectionState}get connectionState(){return this.nativeConnection.connectionState}get action(){return this.role===0?"PUBLISH":"SUBSCRIBE"}setSfuNodeId(e){this.sfuNodeId=e}addTransceiver(e,t){return this.nativeConnection.addTransceiver(e,t)}createOffer(e,t){return T(this,null,function*(){try{let n=yield this.nativeConnection.createOffer(t);return _.d(Fi,`[role=${this.role}] createOffer offer=${JSON.stringify(n,null,1)}`),wY(xY(n,e))}catch(n){throw oe.WebrtcErrors.CreateOfferFailed(this.action,n.message)}})}createAnswer(e=void 0){return T(this,null,function*(){try{let t=yield this.nativeConnection.createAnswer(e);return _.d(Fi,`[role=${this.role}] createAnswer answer=${JSON.stringify(t,null,1)}`),t}catch(t){throw oe.WebrtcErrors.CreateAnswerFailed(this.action,t.message)}})}setLocalDescription(e){return T(this,null,function*(){try{_.d(Fi,`[role=${this.role}] setLocalDescription description=${JSON.stringify(e,null,1)}`),yield this.nativeConnection.setLocalDescription(e)}catch(t){throw oe.WebrtcErrors.SetLocalDescriptionFailed(this.action,t.message)}})}setRemoteDescription(e){return T(this,null,function*(){try{_.d(Fi,`[role=${this.role}] setRemoteDescription description=${JSON.stringify(e,null,1)}`),yield this.nativeConnection.setRemoteDescription(e)}catch(t){throw oe.WebrtcErrors.SetRemoteDescriptionFailed(this.action,t.message)}})}addIceCandidate(e){return T(this,null,function*(){if(this.nativeConnection.signalingState==="closed"){_.d(Fi,`[role=${this.role}] addIceCandidate signalling state closed`);return}_.d(Fi,`[role=${this.role}] addIceCandidate candidate=${JSON.stringify(e,null,1)}`),yield this.nativeConnection.addIceCandidate(e)})}get remoteDescription(){return this.nativeConnection.remoteDescription}getSenders(){return this.nativeConnection.getSenders()}handleSelectedIceCandidatePairs(){try{(this.role===0?this.getSenders():this.getReceivers()).forEach(e=>{var t;let n=(t=e.track)==null?void 0:t.kind;if(e.transport){let r=e.transport.iceTransport,s=()=>{typeof r.getSelectedCandidatePair=="function"&&(this.selectedCandidatePair=r.getSelectedCandidatePair(),this.selectedCandidatePair&&(this.observer.onSelectedCandidatePairChange(this.selectedCandidatePair),_.d(Fi,`${lg[this.role]} connection`,`selected ${n||"unknown"} candidate pair`,JSON.stringify(this.selectedCandidatePair,null,2))))};typeof r.onselectedcandidatepairchange=="function"&&(r.onselectedcandidatepairchange=s),s()}})}catch(e){_.w(Fi,`Error in logging selected ice candidate pair for ${lg[this.role]} connection`,e)}}removeTrack(e){this.nativeConnection.signalingState!=="closed"&&this.nativeConnection.removeTrack(e)}setMaxBitrateAndFramerate(e,t){return T(this,null,function*(){let n=(t==null?void 0:t.maxBitrate)||e.settings.maxBitrate,r=e instanceof Ss&&e.settings.maxFramerate,s=this.getSenders().find(i=>{var o;return((o=i==null?void 0:i.track)==null?void 0:o.id)===e.getTrackIDBeingSent()});if(s){let i=s.getParameters();i.encodings.length===1&&(n&&(i.encodings[0].maxBitrate=n*1e3),r&&(i.encodings[0].maxFramerate=r)),yield s.setParameters(i)}else _.w(Fi,`no sender found to setMaxBitrate for track - ${e.trackId}, sentTrackId - ${e.getTrackIDBeingSent()}`)})}getStats(){return T(this,null,function*(){return yield this.nativeConnection.getStats()})}close(){this.nativeConnection.close()}getReceivers(){return this.nativeConnection.getReceivers()}},SY=class extends b2{constructor(e,t,n){super(0,e),this.TAG="[HMSPublishConnection]",this.observer=n,this.nativeConnection=new RTCPeerConnection(t),this.channel=this.nativeConnection.createDataChannel(qL,{protocol:"SCTP"}),this.channel.onerror=r=>_.e(this.TAG,`publish data channel onerror ${r}`,r),this.nativeConnection.onicecandidate=({candidate:r})=>{r&&(this.observer.onIceCandidate(r),e.trickle(this.role,r))},this.nativeConnection.oniceconnectionstatechange=()=>{this.observer.onIceConnectionChange(this.nativeConnection.iceConnectionState)},this.nativeConnection.onconnectionstatechange=()=>{this.observer.onConnectionStateChange(this.nativeConnection.connectionState),this.nativeConnection.sctp&&(this.nativeConnection.sctp.transport.onstatechange=()=>{var r;this.observer.onDTLSTransportStateChange((r=this.nativeConnection.sctp)==null?void 0:r.transport.state)},this.nativeConnection.sctp.transport.onerror=r=>{var s;this.observer.onDTLSTransportError(new Error((s=r==null?void 0:r.error)==null?void 0:s.errorDetail)||"DTLS Transport failed")})}}close(){super.close(),this.channel.close()}initAfterJoin(){this.nativeConnection.onnegotiationneeded=()=>T(this,null,function*(){_.d(this.TAG,"onnegotiationneeded"),yield this.observer.onRenegotiationNeeded()})}},kY=class{constructor(e,t,n=""){this.TAG="[HMSDataChannel]",this.nativeChannel=e,this.observer=t,this.metadata=n,e.onmessage=r=>{this.observer.onMessage(r.data)}}get id(){return this.nativeChannel.id}get label(){return this.nativeChannel.label}get readyState(){return this.nativeChannel.readyState}send(e){_.d(this.TAG,`[${this.metadata}] Sending [size=${e.length}] message=${e}`),this.nativeChannel.send(e)}close(){this.nativeChannel.close()}},TY=class extends b2{constructor(e,t,n,r){super(1,e),this.isFlagEnabled=n,this.TAG="[HMSSubscribeConnection]",this.remoteStreams=new Map,this.MAX_RETRIES=3,this.pendingMessageQueue=[],this.eventEmitter=new V7({maxListeners:60}),this.handlePendingApiMessages=()=>{this.eventEmitter.emit("open",!0),this.pendingMessageQueue.length>0&&(_.d(this.TAG,"Found pending message queue, sending messages"),this.pendingMessageQueue.forEach(s=>this.sendOverApiDataChannel(s)),this.pendingMessageQueue.length=0)},this.sendMessage=(s,i)=>T(this,null,function*(){var o;((o=this.apiChannel)==null?void 0:o.readyState)!=="open"&&(yield this.eventEmitter.waitFor("open"));let l;for(let c=0;c<this.MAX_RETRIES;c++){this.apiChannel.send(s),l=yield this.waitForResponse(i);let d=l.error;if(d){if(d.code===404){_.d(this.TAG,`Track not found ${i}`,{request:s,try:c+1,error:d});break}if(_.d(this.TAG,`Failed sending ${i}`,{request:s,try:c+1,error:d}),!(d.code/100===5||d.code===429))throw Error(`code=${d.code}, message=${d.message}`);let u=(2+Math.random()*2)*1e3;yield bv(u)}else break}return l}),this.waitForResponse=s=>T(this,null,function*(){let i=yield this.eventEmitter.waitFor("message",function(l){return l.includes(s)}),o=JSON.parse(i[0]);return _.d(this.TAG,`response for ${s} -`,JSON.stringify(o,null,2)),o}),this.observer=r,this.nativeConnection=new RTCPeerConnection(t),this.initNativeConnectionCallbacks()}initNativeConnectionCallbacks(){this.nativeConnection.oniceconnectionstatechange=()=>{this.observer.onIceConnectionChange(this.nativeConnection.iceConnectionState)},this.nativeConnection.onconnectionstatechange=()=>{this.observer.onConnectionStateChange(this.nativeConnection.connectionState)},this.nativeConnection.ondatachannel=e=>{e.channel.label===qL&&(this.apiChannel=new kY(e.channel,{onMessage:t=>{this.eventEmitter.emit("message",t),this.observer.onApiChannelMessage(t)}},`role=${this.role}`),e.channel.onopen=this.handlePendingApiMessages)},this.nativeConnection.onicecandidate=e=>{e.candidate!==null&&(this.observer.onIceCandidate(e.candidate),this.signal.trickle(this.role,e.candidate))},this.nativeConnection.ontrack=e=>{var t;let n=e.streams[0],r=n.id;if(!this.remoteStreams.has(r)){let d=new ik(n,this);this.remoteStreams.set(r,d)}n.addEventListener("removetrack",d=>{if(d.track.id!==e.track.id)return;let u=s.tracks.findIndex(h=>{var f;return h.nativeTrack.id===d.track.id&&e.transceiver.mid===((f=h.transceiver)==null?void 0:f.mid)});if(u>=0){let h=s.tracks[u];this.observer.onTrackRemove(h),s.tracks.splice(u,1),s.tracks.length===0&&this.remoteStreams.delete(r)}});let s=this.remoteStreams.get(r),i=e.track.kind==="audio",o=i?Cd:os,l=i?new o(s,e.track):new o(s,e.track,void 0,this.isFlagEnabled("disableNoneLayerRequest"));e.track.kind==="video"&&s.setVideoLayerLocally("none","addTrack","subscribeConnection"),l.transceiver=e.transceiver;let c=bY(this.remoteDescription,(t=e.transceiver)==null?void 0:t.mid);c&&l.setSdpTrackId(c),s.tracks.push(l),this.observer.onTrackAdd(l)}}sendOverApiDataChannel(e){this.apiChannel&&this.apiChannel.readyState==="open"?this.apiChannel.send(e):(_.w(this.TAG,`API Data channel not ${this.apiChannel?"open":"present"}, queueing`,e),this.pendingMessageQueue.push(e))}sendOverApiDataChannelWithResponse(e,t){return T(this,null,function*(){let n=Lo();if(e.method==="prefer-video-track-state"&&this.isFlagEnabled("disableVideoTrackAutoUnsubscribe")&&e.params.max_spatial_layer==="none")return _.d(this.TAG,"video auto unsubscribe is disabled, request is ignored"),{id:n};let r=JSON.stringify(de({id:t||n,jsonrpc:"2.0"},e));return this.sendMessage(r,n)})}close(){var e;super.close(),(e=this.apiChannel)==null||e.close()}},CY=(e,t)=>!t||t.length===0?e:t.map(n=>({urls:n.urls,credentialType:"password",credential:n.password,username:n.userName})),om="[InitService]",EY=class{static handleError(e,t){switch(e.status){case 404:throw oe.APIErrors.EndpointUnreachable("INIT",t.message||e.statusText);case 200:break;default:throw oe.APIErrors.ServerErrors(t.code||e.status,"INIT",t.message||(e==null?void 0:e.statusText))}}static fetchInitConfig(e){return T(this,arguments,function*({token:t,peerId:n,userAgent:r,initEndpoint:s="https://prod-init.100ms.live",region:i="",iceServers:o}){_.d(om,`fetchInitConfig: initEndpoint=${s} token=${t} peerId=${n} region=${i} `);let l=_Y(s,n,r,i);try{let c=yield fetch(l,{headers:{Authorization:`Bearer ${t}`}});try{let d=yield c.clone().json();return this.handleError(c,d),_.d(om,`config is ${JSON.stringify(d,null,2)}`),PY(d,o)}catch(d){let u=yield c.text();throw _.e(om,"json error",d.message,u),d instanceof Ue?d:oe.APIErrors.ServerErrors(c.status,"INIT",d.message)}}catch(c){let d=c;throw["Failed to fetch","NetworkError","ECONNRESET"].some(u=>d.message.includes(u))?oe.APIErrors.EndpointUnreachable("INIT",d.message):d}})}};function _Y(e,t,n,r){try{let s=new URL("/init",e);return r&&r.trim().length>0&&s.searchParams.set("region",r.trim()),s.searchParams.set("peer_id",t),s.searchParams.set("user_agent_v2",n),s.toString()}catch(s){let i=s;throw _.e(om,i.name,i.message),i}}function PY(e,t){var n;return Ke(de({},e),{rtcConfiguration:Ke(de({},e.rtcConfiguration),{iceServers:CY((n=e.rtcConfiguration)==null?void 0:n.ice_servers,t)})})}var NY=class{constructor(e){this.TAG="[SIGNAL]: ",this.pongResponseTimes=new sk(5),this.isJoinCompleted=!1,this.pendingTrickle=[],this.socket=null,this.callbacks=new Map,this._isConnected=!1,this.id=0,this.onCloseHandler=()=>{},this.resolvePingOnAnyResponse=()=>{this.callbacks.forEach((t,n)=>{var r;((r=t.metadata)==null?void 0:r.method)==="ping"&&(t.resolve({timestamp:Date.now()}),this.callbacks.delete(n))})},this.offlineListener=()=>{_.d(this.TAG,"Window network offline"),this.setIsConnected(!1,"Window network offline")},this.onlineListener=()=>{_.d(this.TAG,"Window network online"),this.observer.onNetworkOnline()},this.observer=e,window.addEventListener("offline",this.offlineListener),window.addEventListener("online",this.onlineListener),this.onMessageHandler=this.onMessageHandler.bind(this)}get isConnected(){return this._isConnected}setSfuNodeId(e){this.sfuNodeId=e}setIsConnected(e,t=""){_.d(this.TAG,`isConnected set id: ${this.id}, oldValue: ${this._isConnected}, newValue: ${e}`),this._isConnected!==e&&(this._isConnected&&!e?(this._isConnected=e,this.rejectPendingCalls(t),this.observer.onOffline(t)):!this._isConnected&&e&&(this._isConnected=e,this.observer.onOnline()))}getPongResponseTimes(){return this.pongResponseTimes.toList()}internalCall(e,t){return T(this,null,function*(){var n;let r=Lo(),s={method:e,params:t,id:r,jsonrpc:"2.0"};(n=this.socket)==null||n.send(JSON.stringify(s));try{return yield new Promise((i,o)=>{this.callbacks.set(r,{resolve:i,reject:o,metadata:{method:e}})})}catch(i){if(i instanceof Ue)throw i;let o=i;throw oe.WebsocketMethodErrors.ServerErrors(Number(o.code),p_(e),o.message)}})}notify(e,t){var n,r;let s={method:e,params:t};((n=this.socket)==null?void 0:n.readyState)===WebSocket.OPEN&&((r=this.socket)==null||r.send(JSON.stringify(s)))}open(e){return new Promise((t,n)=>{let r=!1;this.socket&&(this.socket.close(),this.socket.removeEventListener("close",this.onCloseHandler),this.socket.removeEventListener("message",this.onMessageHandler)),this.socket=new WebSocket(e);let s=()=>{_.e(this.TAG,"Error from websocket"),r=!0,n(oe.WebSocketConnectionErrors.FailedToConnect("JOIN","Error opening websocket connection"))};this.onCloseHandler=o=>{_.w(`Websocket closed code=${o.code}`),r?this.setIsConnected(!1,`code: ${o.code}${o.code!==1e3?", unexpected websocket close":""}`):(r=!0,n(oe.WebSocketConnectionErrors.AbnormalClose("JOIN",`Error opening websocket connection - websocket closed unexpectedly with code=${o.code}`)))},this.socket.addEventListener("error",s);let i=()=>{var o,l;r=!0,t(),this.setIsConnected(!0),this.id++,(o=this.socket)==null||o.removeEventListener("open",i),(l=this.socket)==null||l.removeEventListener("error",s),this.pingPongLoop(this.id)};this.socket.addEventListener("open",i),this.socket.addEventListener("close",this.onCloseHandler),this.socket.addEventListener("message",this.onMessageHandler)})}close(){return T(this,null,function*(){window.removeEventListener("offline",this.offlineListener),window.removeEventListener("online",this.onlineListener),this.socket?(this.socket.close(1e3,"Normal Close"),this.setIsConnected(!1,"code: 1000, normal websocket close"),this.socket.removeEventListener("close",this.onCloseHandler),this.socket.removeEventListener("message",this.onMessageHandler)):this.setIsConnected(!1,"websocket not connected yet")})}join(e,t,n,r,s,i,o){return T(this,null,function*(){if(!this.isConnected)throw oe.WebSocketConnectionErrors.WebSocketConnectionLost("JOIN","Failed to send join over WS connection");let l={name:e,disableVidAutoSub:n,data:t,offer:o,server_sub_degrade:r,simulcast:s,onDemandTracks:i},c=yield this.internalCall("join",l);return this.isJoinCompleted=!0,this.pendingTrickle.forEach(({target:d,candidate:u})=>this.trickle(d,u)),this.pendingTrickle.length=0,_.d(this.TAG,`join: response=${JSON.stringify(c,null,1)}`),c})}trickle(e,t){this.isJoinCompleted?this.notify("trickle",{target:e,candidate:t,sfu_node_id:this.sfuNodeId}):this.pendingTrickle.push({target:e,candidate:t})}offer(e,t){return T(this,null,function*(){return yield this.call("offer",{desc:e,tracks:Object.fromEntries(t),sfu_node_id:this.sfuNodeId})})}answer(e){this.notify("answer",{desc:e,sfu_node_id:this.sfuNodeId})}trackUpdate(e){this.notify("track-update",{tracks:Object.fromEntries(e)})}broadcast(e){return T(this,null,function*(){return yield this.call("broadcast",e)})}leave(e){this.notify("leave",{client_reason:e})}endRoom(e,t){return T(this,null,function*(){yield this.call("end-room",{lock:e,reason:t})})}sendEvent(e){if(!this.isConnected)throw Error(`${this.TAG} not connected. Could not send event ${e}`);this.notify("analytics",e.toSignalParams())}ping(e){let t=Date.now(),n=new Promise(s=>{setTimeout(()=>{s(Date.now()-t)},e+1)}),r=this.internalCall("ping",{timestamp:t}).then(()=>Date.now()-t).catch(()=>Date.now()-t);return Promise.race([n,r])}requestRoleChange(e){return T(this,null,function*(){yield this.call("role-change-request",e)})}requestBulkRoleChange(e){return T(this,null,function*(){yield this.call("role-change-request",e)})}acceptRoleChangeRequest(e){return T(this,null,function*(){yield this.call("role-change",e)})}requestTrackStateChange(e){return T(this,null,function*(){yield this.call("track-update-request",e)})}requestMultiTrackStateChange(e){return T(this,null,function*(){yield this.call("change-track-mute-state-request",e)})}removePeer(e){return T(this,null,function*(){yield this.call("peer-leave-request",e)})}startRTMPOrRecording(e){return T(this,null,function*(){yield this.call("rtmp-start",de({},e))})}stopRTMPAndRecording(){return T(this,null,function*(){yield this.call("rtmp-stop",{})})}startHLSStreaming(e){return T(this,null,function*(){yield this.call("hls-start",de({},e))})}stopHLSStreaming(e){return T(this,null,function*(){yield this.call("hls-stop",de({},e))})}startTranscription(e){return T(this,null,function*(){yield this.call("transcription-start",de({},e))})}stopTranscription(e){return T(this,null,function*(){yield this.call("transcription-stop",de({},e))})}sendHLSTimedMetadata(e){return T(this,null,function*(){yield this.call("hls-timed-metadata",de({},e))})}updatePeer(e){return T(this,null,function*(){yield this.call("peer-update",de({},e))})}getPeer(e){return T(this,null,function*(){return yield this.call("get-peer",de({},e))})}joinGroup(e){return T(this,null,function*(){return yield this.call("group-join",{name:e})})}leaveGroup(e){return T(this,null,function*(){return yield this.call("group-leave",{name:e})})}addToGroup(e,t){return T(this,null,function*(){yield this.call("group-add",{name:t,peer_id:e})})}removeFromGroup(e,t){return T(this,null,function*(){yield this.call("group-remove",{name:t,peer_id:e})})}peerIterNext(e){return T(this,null,function*(){return yield this.call("peer-iter-next",e)})}findPeers(e){return T(this,null,function*(){return yield this.call("find-peer",e)})}findPeerByName(e){return T(this,null,function*(){return yield this.call("peer-name-search",e)})}setSessionMetadata(e){if(!this.isConnected)throw oe.WebSocketConnectionErrors.WebSocketConnectionLost("RECONNECT_SIGNAL","Failed to set session store value due to network disconnection");return this.call("set-metadata",de({},e))}listenMetadataChange(e){if(!this.isConnected)throw oe.WebSocketConnectionErrors.WebSocketConnectionLost("RECONNECT_SIGNAL","Failed to observe session store key due to network disconnection");return this.call("listen-metadata-change",{keys:e})}getSessionMetadata(e){if(!this.isConnected)throw oe.WebSocketConnectionErrors.WebSocketConnectionLost("RECONNECT_SIGNAL","Failed to set session store value due to network disconnection");return this.call("get-metadata",{key:e})}setPollInfo(e){return this.call("poll-info-set",de({},e))}getPollInfo(e){return this.call("poll-info-get",de({},e))}setPollQuestions(e){return this.call("poll-questions-set",de({},e))}startPoll(e){return this.call("poll-start",de({},e))}stopPoll(e){return this.call("poll-stop",de({},e))}getPollQuestions(e){return this.call("poll-questions-get",de({},e))}setPollResponses(e){return this.call("poll-response",de({},e))}getPollResponses(e){return this.call("poll-responses",de({},e))}getPollsList(e){return this.call("poll-list",de({},e))}getPollResult(e){return this.call("poll-result",de({},e))}createWhiteboard(e){return this.validateConnection(),this.call("whiteboard-create",de({},e))}getWhiteboard(e){return this.validateConnection(),this.call("whiteboard-get",de({},e))}fetchPollLeaderboard(e){return this.call("poll-leaderboard",de({},e))}validateConnection(){if(!this.isConnected)throw oe.WebSocketConnectionErrors.WebSocketConnectionLost("RECONNECT_SIGNAL","Failed to send message due to network disconnection")}onMessageHandler(e){let t=e.data,n=JSON.parse(t);if(this.resolvePingOnAnyResponse(),n.id)this.handleResponseWithId(n);else if(n.method)this.handleResponseWithMethod(n);else throw Error(`WebSocket message has no 'method' or 'id' field, message=${n}`)}handleResponseWithId(e){let t=e,n=t.id;if(this.callbacks.has(n)){let r=this.callbacks.get(n);this.callbacks.delete(n),t.result?r.resolve(t.result):r.reject(t.error)}else this.observer.onNotification(t)}handleResponseWithMethod(e){switch(e.method){case"offer":this.observer.onOffer(e.params);break;case"trickle":this.observer.onTrickle(e.params);break;case"on-error":this.observer.onServerError(oe.WebsocketMethodErrors.ServerErrors(Number(e.params.code),"on-error",e.params.message));break;case"on-warning":_.w(this.TAG,e.params);break;default:this.observer.onNotification(e);break}}rejectPendingCalls(e=""){this.callbacks.forEach((t,n)=>{var r,s,i,o;((r=t.metadata)==null?void 0:r.method)!=="ping"&&(_.e(this.TAG,`rejecting pending callback ${(s=t.metadata)==null?void 0:s.method}, id=${n}`),t.reject(oe.WebSocketConnectionErrors.WebSocketConnectionLost((i=t.metadata)!=null&&i.method?p_((o=t.metadata)==null?void 0:o.method):"RECONNECT_SIGNAL",e)),this.callbacks.delete(n))})}pingPongLoop(e){return T(this,null,function*(){var t,n;let r=((t=window.HMS)==null?void 0:t.PING_TIMEOUT)||12e3;if(this.isConnected){let s=yield this.ping(r);this.pongResponseTimes.enqueue(s),s>r?(_.d(this.TAG,`Pong timeout ${e}, pageHidden=${TK()}`),this.id===e&&this.setIsConnected(!1,"ping pong failure")):setTimeout(()=>this.pingPongLoop(e),((n=window.HMS)==null?void 0:n.PING_INTERVAL)||3e3)}})}call(e,t){return T(this,null,function*(){let n=oe.WebsocketMethodErrors.ServerErrors(500,e,`Default ${e} error`),r;for(r=1;r<=3;r++)try{return this.validateConnection(),_.d(this.TAG,`Try number ${r} sending ${e}`,t),yield this.internalCall(e,t)}catch(s){if(n=s,_.e(this.TAG,`Failed sending ${e} try: ${r}`,{method:e,params:t,error:n}),!(parseInt(`${n.code/100}`)===5||n.code===429||n.code===1003))break;let i=(2+Math.random()*2)*1e3;yield bv(i)}throw _.e(`Sending ${e} over WS failed after ${Math.min(r,3)} retries`,{method:e,params:t,error:n}),n})}},IY=()=>{if(!Is||typeof navigator.connection>"u")return;let e=navigator.connection;return{downlink:e.downlink,downlinkMax:e.downlinkMax,effectiveType:e.effectiveType,rtt:e.rtt,saveData:e.saveData,type:e.type}},Ye="[HMSTransport]:",AY=class{constructor(e,t,n,r,s,i,o){this.observer=e,this.deviceManager=t,this.store=n,this.eventBus=r,this.analyticsEventsService=s,this.analyticsTimer=i,this.pluginUsageTracker=o,this.state="Disconnected",this.trackStates=new Map,this.publishConnection=null,this.subscribeConnection=null,this.maxSubscribeBitrate=0,this.joinRetryCount=0,this.publishDisconnectTimer=0,this.onScreenshareStop=()=>{},this.screenStream=new Set,this.callbacks=new Map,this.setListener=c=>{this.listener=c},this.setOnScreenshareStop=c=>{this.onScreenshareStop=c},this.signalObserver={onOffer:c=>T(this,null,function*(){try{if(!this.subscribeConnection)return;if(c.sfu_node_id&&this.subscribeConnection.sfuNodeId&&this.subscribeConnection.sfuNodeId!==c.sfu_node_id){_.d(Ye,"ignoring old offer");return}yield this.subscribeConnection.setRemoteDescription(c),_.d(Ye,`[SUBSCRIBE] Adding ${this.subscribeConnection.candidates.length} ice-candidates`,this.subscribeConnection.candidates);for(let u of this.subscribeConnection.candidates)yield this.subscribeConnection.addIceCandidate(u);this.subscribeConnection.candidates.length=0;let d=yield this.subscribeConnection.createAnswer();yield this.subscribeConnection.setLocalDescription(d),this.signal.answer(d),_.d(Ye,"[role=SUBSCRIBE] onOffer renegotiation DONE ")}catch(d){_.d(Ye,"[role=SUBSCRIBE] onOffer renegotiation FAILED ",d),this.state="Failed";let u;d instanceof Ue?u=d:u=oe.GenericErrors.Unknown("SUBSCRIBE",d.message),this.observer.onFailure(u),this.eventBus.analytics.publish(Be.subscribeFail(u))}}),onTrickle:c=>T(this,null,function*(){let d=c.target===0?this.publishConnection:this.subscribeConnection;d!=null&&d.remoteDescription?yield d.addIceCandidate(c.candidate):d==null||d.candidates.push(c.candidate)}),onNotification:c=>this.observer.onNotification(c),onServerError:c=>T(this,null,function*(){yield this.observer.onStateChange("Failed",c)}),onFailure:c=>{this.joinParameters&&this.retryScheduler.schedule({category:1,error:c,task:this.retrySignalDisconnectTask,originalState:this.state})},onOffline:c=>T(this,null,function*(){_.d(Ye,"socket offline",Mw[this.state]);try{this.state!=="Leaving"&&this.joinParameters&&this.retryScheduler.schedule({category:1,error:oe.WebSocketConnectionErrors.WebSocketConnectionLost("RECONNECT_SIGNAL",c),task:this.retrySignalDisconnectTask,originalState:this.state})}catch(d){console.error(d)}}),onOnline:()=>{var c;_.d(Ye,"socket online",Mw[this.state]),this.analyticsSignalTransport.flushFailedEvents((c=this.store.getLocalPeer())==null?void 0:c.peerId)},onNetworkOnline:()=>{this.analyticsEventsService.flushFailedClientEvents()}},this.signal=new NY(this.signalObserver),this.analyticsSignalTransport=new pY(this.signal),this.publishDtlsStateTimer=0,this.lastPublishDtlsState="new",this.handleLocalRoleUpdate=c=>T(this,[c],function*({oldRole:d,newRole:u}){!this.doesRoleNeedWebRTC(d)&&this.doesRoleNeedWebRTC(u)&&(_.d(Ye,"Local peer role updated to webrtc role, creating PeerConnections and performing inital publish negotiation "),this.createPeerConnections(),yield this.negotiateOnFirstPublish())}),this.retryPublishIceFailedTask=()=>T(this,null,function*(){if(this.publishConnection){let c=new Promise((d,u)=>{this.callbacks.set(yu,{promise:{resolve:d,reject:u},action:"RESTART_ICE",extra:{}})});yield this.performPublishRenegotiation({iceRestart:this.publishConnection.connectionState!=="connected"}),yield c}return!0}),this.retrySubscribeIceFailedTask=()=>T(this,null,function*(){if(this.subscribeConnection&&this.subscribeConnection.connectionState!=="connected"){let c=new Promise((u,h)=>{this.callbacks.set(xu,{promise:{resolve:u,reject:h},action:"RESTART_ICE",extra:{}})}),d=new Promise(u=>{setTimeout(u,6e4,!1)});return Promise.race([c,d])}return!0}),this.retrySignalDisconnectTask=()=>T(this,null,function*(){var c;_.d(Ye,"retrySignalDisconnectTask",{signalConnected:this.signal.isConnected}),this.signal.isConnected||(yield this.internalConnect(this.joinParameters.authToken,this.joinParameters.endpoint,this.joinParameters.peerId,this.joinParameters.iceServers));let d=(c=this.store.getRoom())!=null&&c.joinedAt?this.signal.isConnected&&(yield this.retryPublishIceFailedTask()):this.signal.isConnected;return this.signal.trackUpdate(this.trackStates),d}),this.webrtcInternals=new AQ(this.store,this.eventBus);let l=(c,d)=>T(this,null,function*(){c!==this.state&&(this.state=c,yield this.observer.onStateChange(this.state,d))});this.retryScheduler=new uY(l,this.sendErrorAnalyticsEvent.bind(this)),this.eventBus.statsUpdate.subscribe(c=>{var d,u;let h=((u=(d=c.getLocalPeerStats())==null?void 0:d.subscribe)==null?void 0:u.bitrate)||0;this.maxSubscribeBitrate=Math.max(this.maxSubscribeBitrate,h)}),this.eventBus.localAudioEnabled.subscribe(({track:c,enabled:d})=>this.trackUpdate(c,d)),this.eventBus.localVideoEnabled.subscribe(({track:c,enabled:d})=>this.trackUpdate(c,d))}getWebsocketEndpoint(){if(this.initConfig)return this.initConfig.endpoint}getWebrtcInternals(){return this.webrtcInternals}isFlagEnabled(e){var t;let n=(t=this.initConfig)==null?void 0:t.config;return((n==null?void 0:n.enabledFlags)||[]).includes(e)}setConnectivityListener(e){this.connectivityListener=e}preview(e,t,n,r,s=!1,i){return T(this,null,function*(){let o=yield this.connect(e,t,n,r,s,i);return this.state="Preview",this.observer.onStateChange(this.state),o})}join(e,t,n,r,s=!1,i){return T(this,null,function*(){_.d(Ye,"join: started ");try{(!this.signal.isConnected||!this.initConfig)&&(yield this.connect(e,r,t,n,s,i)),this.validateNotDisconnected("connect"),this.initConfig&&(yield this.waitForLocalRoleAvailability(),yield this.createConnectionsAndNegotiateJoin(n,s),this.initStatsAnalytics(),_.d(Ye," join: Negotiated over PUBLISH connection"))}catch(o){_.e(Ye,`join: failed  [token=${e}]`,o),this.state="Failed";let l=o;throw l.isTerminal=l.isTerminal||l.code===500,yield this.observer.onStateChange(this.state,l),l}_.d(Ye," join: successful"),this.state="Joined",this.observer.onStateChange(this.state)})}connect(e,t,n,r,s=!1,i){return T(this,null,function*(){this.setTransportStateForConnect(),this.joinParameters=new lY(e,n,r.name,r.metaData,t,s,i);try{return yield this.internalConnect(e,t,n,i)}catch(o){if(o instanceof Ue&&([Me.WebSocketConnectionErrors.WEBSOCKET_CONNECTION_LOST,Me.WebSocketConnectionErrors.FAILED_TO_CONNECT,Me.WebSocketConnectionErrors.ABNORMAL_CLOSE,Me.APIErrors.ENDPOINT_UNREACHABLE].includes(o.code)||o.code.toString().startsWith("5")||o.code.toString().startsWith("429"))){let l=()=>T(this,null,function*(){return yield this.internalConnect(e,t,n,i),!!(this.initConfig&&this.initConfig.endpoint)});yield this.retryScheduler.schedule({category:0,error:o,task:l,originalState:this.state,changeState:!1})}else throw o}})}leave(e){return T(this,arguments,function*(t,n="user request"){var r,s,i;this.retryScheduler.reset(),this.joinParameters=void 0,_.d(Ye,"leaving in transport");try{let o=this.pluginUsageTracker.getPluginUsage("HMSKrispPlugin");if(o&&this.eventBus.analytics.publish(Be.getKrispUsage(o)),this.state="Leaving",(r=this.publishStatsAnalytics)==null||r.stop(),(s=this.subscribeStatsAnalytics)==null||s.stop(),(i=this.webrtcInternals)==null||i.cleanup(),this.clearPeerConnections(),t)try{this.signal.leave(n),_.d(Ye,"signal leave done")}catch(l){_.w(Ye,"failed to send leave on websocket to server",l)}this.analyticsEventsService.flushFailedClientEvents(),this.analyticsEventsService.reset(),yield this.signal.close()}catch(o){this.eventBus.analytics.publish(Be.disconnect(o)),_.e(Ye,"leave: FAILED ",o)}finally{this.state="Disconnected",this.observer.onStateChange(this.state)}})}publish(e){return T(this,null,function*(){var t;for(let n of e)try{yield this.publishTrack(n),(t=this.connectivityListener)==null||t.onMediaPublished(n)}catch(r){this.eventBus.analytics.publish(Be.publish({devices:this.deviceManager.getDevices(),error:r}))}})}unpublish(e){return T(this,null,function*(){for(let t of e)yield this.unpublishTrack(t)})}setSFUNodeId(e){var t,n;this.signal.setSfuNodeId(e),this.sfuNodeId?e&&this.sfuNodeId!==e&&(this.sfuNodeId=e,this.handleSFUMigration()):(this.sfuNodeId=e,(t=this.publishConnection)==null||t.setSfuNodeId(e),(n=this.subscribeConnection)==null||n.setSfuNodeId(e))}handleSFUMigration(){return T(this,null,function*(){var e,t;_.time("sfu migration"),this.clearPeerConnections();let n=this.store.getPeerMap();this.store.removeRemoteTracks();for(let o in n){let l=n[o];l.isLocal||(l.audioTrack=void 0,l.videoTrack=void 0,l.auxiliaryTracks=[])}let r=this.store.getLocalPeer();if(!r)return;this.createPeerConnections(),this.trackStates.clear(),yield this.negotiateOnFirstPublish();let s=new Map;if(r.audioTrack){let o=r.audioTrack.stream;s.get(o.id)||s.set(o.id,new Bc(new MediaStream));let l=r.audioTrack.clone(s.get(o.id));this.store.removeTrack(r.audioTrack),r.audioTrack.cleanup(),yield this.publishTrack(l),r.audioTrack=l}if(r.videoTrack){let o=r.videoTrack.stream;s.get(o.id)||s.set(o.id,new Bc(new MediaStream)),this.store.removeTrack(r.videoTrack);let l=r.videoTrack.clone(s.get(o.id));r.videoTrack.cleanup(),yield this.publishTrack(l),r.videoTrack=l}let i=[];for(;r.auxiliaryTracks.length>0;){let o=r.auxiliaryTracks.shift();if(o){let l=o.stream;s.get(l.id)||s.set(l.id,new Bc(o.source==="screen"?l.nativeStream.clone():new MediaStream)),this.store.removeTrack(o);let c=o.clone(s.get(l.id));c.type==="video"&&c.source==="screen"&&(this.screenStream.add(l.nativeStream),this.screenStream.add(c.stream.nativeStream),c.nativeTrack.addEventListener("ended",this.onScreenshareStop)),o.cleanup(),yield this.publishTrack(c),i.push(c)}}r.auxiliaryTracks=i,s.clear(),(t=(e=this.listener)==null?void 0:e.onSFUMigration)==null||t.call(e),_.timeEnd("sfu migration")})}trackUpdate(e,t){var n;let r=Array.from(this.trackStates.values()).find(s=>e.type===s.type&&e.source===s.source);if(r){let s=new I_(Ke(de({},r),{mute:!t}));this.trackStates.set(r.track_id,s),_.d(Ye,"Track Update",this.trackStates,e),this.signal.trackUpdate(new Map([[r.track_id,s]]));let i=this.store.getLocalPeer();i&&t===e.enabled&&((n=this.listener)==null||n.onTrackUpdate(t?3:2,e,i))}}publishTrack(e){return T(this,null,function*(){e.publishedTrackId=e.getTrackIDBeingSent(),_.d(Ye,` publishTrack: trackId=${e.trackId}, toPublishTrackId=${e.publishedTrackId}`,`${e}`),this.trackStates.set(e.publishedTrackId,new I_(e));let t=new Promise((s,i)=>{this.callbacks.set(yu,{promise:{resolve:s,reject:i},action:"PUBLISH",extra:{}})}),n=e.stream;n.setConnection(this.publishConnection);let r=this.store.getSimulcastLayers(e.source);n.addTransceiver(e,r),_.time(`publish-${e.trackId}-${e.type}`),yield t,_.timeEnd(`publish-${e.trackId}-${e.type}`),this.store.addTrack(e),yield n.setMaxBitrateAndFramerate(e).then(()=>{_.d(Ye,`Setting maxBitrate=${e.settings.maxBitrate} kpbs${e instanceof Ss?` and maxFramerate=${e.settings.maxFramerate}`:""} for ${e.source} ${e.type} ${e.trackId}`)}).catch(s=>_.w(Ye,"Failed setting maxBitrate and maxFramerate",s)),e.isPublished=!0,_.d(Ye,` publishTrack: trackId=${e.trackId}`,`${e}`,this.callbacks)})}unpublishTrack(e){return T(this,null,function*(){if(_.d(Ye,` unpublishTrack: trackId=${e.trackId}`,`${e}`),e.publishedTrackId&&this.trackStates.has(e.publishedTrackId))this.trackStates.delete(e.publishedTrackId);else{let n=Array.from(this.trackStates.values()).find(r=>e.type===r.type&&e.source===r.source);n&&this.trackStates.delete(n.track_id)}let t=new Promise((n,r)=>{this.callbacks.set(yu,{promise:{resolve:n,reject:r},action:"UNPUBLISH",extra:{}})});e.stream.removeSender(e),yield t,yield e.cleanup(),e.source==="screen"&&this.screenStream&&this.screenStream.forEach(n=>{n.getTracks().forEach(r=>{r.stop()}),this.screenStream.delete(n)}),this.store.removeTrack(e),_.d(Ye,` unpublishTrack: trackId=${e.trackId}`,this.callbacks)})}clearPeerConnections(){return T(this,null,function*(){var e,t;clearTimeout(this.publishDtlsStateTimer),this.publishDtlsStateTimer=0,clearTimeout(this.publishDisconnectTimer),this.publishDisconnectTimer=0,this.lastPublishDtlsState="new",(e=this.publishConnection)==null||e.close(),(t=this.subscribeConnection)==null||t.close(),this.publishConnection=null,this.subscribeConnection=null})}waitForLocalRoleAvailability(){if(!this.store.hasRoleDetailsArrived())return new Promise(e=>{this.eventBus.policyChange.subscribeOnce(()=>e())})}createConnectionsAndNegotiateJoin(e,t=!1){return T(this,null,function*(){let n=this.doesLocalPeerNeedWebRTC();n&&this.createPeerConnections(),this.analyticsTimer.start("join_response_time"),yield this.negotiateJoinWithRetry({name:e.name,data:e.metaData,autoSubscribeVideo:t,isWebRTC:n}),this.analyticsTimer.end("join_response_time")})}createPeerConnections(){var e,t,n;let r=(s,i,o=!1)=>{(["disconnected","failed"].includes(i)?_.w.bind(_):_.d.bind(_))(Ye,`${lg[s]} ${o?"ice":""} connection state change: ${i}`)};if(this.initConfig){let s={onRenegotiationNeeded:()=>T(this,null,function*(){yield this.performPublishRenegotiation()}),onDTLSTransportStateChange:o=>{var l,c,d;if((o==="failed"?_.w.bind(_):_.d.bind(_))(Ye,`Publisher on dtls transport state change: ${o}`),!o||this.lastPublishDtlsState===o||(this.lastPublishDtlsState=o,this.publishDtlsStateTimer!==0&&(clearTimeout(this.publishDtlsStateTimer),this.publishDtlsStateTimer=0),o!=="connecting"&&o!=="failed"))return;let u=(d=(c=(l=this.initConfig)==null?void 0:l.config)==null?void 0:c.dtlsStateTimeouts)==null?void 0:d[o];!u||u<=0||(this.publishDtlsStateTimer=window.setTimeout(()=>{var h;let f=(h=this.publishConnection)==null?void 0:h.nativeConnection.connectionState;if(f&&o&&f===o){let m=oe.WebrtcErrors.ICEFailure("PUBLISH",`DTLS transport state ${o} timeout:${u}ms`,!0);this.eventBus.analytics.publish(Be.disconnect(m)),this.observer.onFailure(m)}},u))},onDTLSTransportError:o=>{_.e(Ye,`onDTLSTransportError ${o.name} ${o.message}`,o),this.eventBus.analytics.publish(Be.disconnect(o))},onIceConnectionChange:o=>T(this,null,function*(){r(0,o,!0)}),onConnectionStateChange:o=>T(this,null,function*(){var l,c,d,u,h,f,m,g;r(0,o,!1),o!=="new"&&(o==="connected"?((l=this.connectivityListener)==null||l.onICESuccess(!0),(c=this.publishConnection)==null||c.handleSelectedIceCandidatePairs()):o==="failed"?yield this.handleIceConnectionFailure(0,oe.WebrtcErrors.ICEFailure("PUBLISH",`local candidate - ${(h=(u=(d=this.publishConnection)==null?void 0:d.selectedCandidatePair)==null?void 0:u.local)==null?void 0:h.candidate}; remote candidate - ${(g=(m=(f=this.publishConnection)==null?void 0:f.selectedCandidatePair)==null?void 0:m.remote)==null?void 0:g.candidate}`)):this.publishDisconnectTimer=window.setTimeout(()=>{var v,x,S,y,b,w,C;((v=this.publishConnection)==null?void 0:v.connectionState)!=="connected"&&this.handleIceConnectionFailure(0,oe.WebrtcErrors.ICEDisconnected("PUBLISH",`local candidate - ${(y=(S=(x=this.publishConnection)==null?void 0:x.selectedCandidatePair)==null?void 0:S.local)==null?void 0:y.candidate}; remote candidate - ${(C=(w=(b=this.publishConnection)==null?void 0:b.selectedCandidatePair)==null?void 0:w.remote)==null?void 0:C.candidate}`))},5e3))}),onIceCandidate:o=>{var l;(l=this.connectivityListener)==null||l.onICECandidate(o,!0)},onSelectedCandidatePairChange:o=>{var l;(l=this.connectivityListener)==null||l.onSelectedICECandidatePairChange(o,!0)}},i={onApiChannelMessage:o=>{this.observer.onNotification(JSON.parse(o))},onTrackAdd:o=>{_.d(Ye,"[Subscribe] onTrackAdd",`${o}`),this.observer.onTrackAdd(o)},onTrackRemove:o=>{_.d(Ye,"[Subscribe] onTrackRemove",`${o}`),this.observer.onTrackRemove(o)},onIceConnectionChange:o=>T(this,null,function*(){var l;if(r(1,o,!0),o==="connected"){let c=this.callbacks.get(xu);this.callbacks.delete(xu),(l=this.connectivityListener)==null||l.onICESuccess(!1),c&&c.promise.resolve(!0)}}),onConnectionStateChange:o=>T(this,null,function*(){var l,c,d,u,h,f,m;if(r(1,o,!1),o==="failed")yield this.handleIceConnectionFailure(1,oe.WebrtcErrors.ICEFailure("SUBSCRIBE",`local candidate - ${(d=(c=(l=this.subscribeConnection)==null?void 0:l.selectedCandidatePair)==null?void 0:c.local)==null?void 0:d.candidate}; remote candidate - ${(f=(h=(u=this.subscribeConnection)==null?void 0:u.selectedCandidatePair)==null?void 0:h.remote)==null?void 0:f.candidate}`));else if(o==="disconnected")setTimeout(()=>{var g,v,x,S,y,b,w;((g=this.subscribeConnection)==null?void 0:g.connectionState)==="disconnected"&&this.handleIceConnectionFailure(1,oe.WebrtcErrors.ICEDisconnected("SUBSCRIBE",`local candidate - ${(S=(x=(v=this.subscribeConnection)==null?void 0:v.selectedCandidatePair)==null?void 0:x.local)==null?void 0:S.candidate}; remote candidate - ${(w=(b=(y=this.subscribeConnection)==null?void 0:y.selectedCandidatePair)==null?void 0:b.remote)==null?void 0:w.candidate}`))},5e3);else if(o==="connected"){(m=this.subscribeConnection)==null||m.handleSelectedIceCandidatePairs();let g=this.callbacks.get(xu);this.callbacks.delete(xu),g&&g.promise.resolve(!0)}}),onIceCandidate:o=>{var l;(l=this.connectivityListener)==null||l.onICECandidate(o,!1)},onSelectedCandidatePairChange:o=>{var l;(l=this.connectivityListener)==null||l.onSelectedICECandidatePairChange(o,!1)}};this.publishConnection||(this.publishConnection=new SY(this.signal,this.initConfig.rtcConfiguration,s)),this.subscribeConnection||(this.subscribeConnection=new TY(this.signal,this.initConfig.rtcConfiguration,this.isFlagEnabled.bind(this),i))}(n=this.webrtcInternals)==null||n.setPeerConnections({publish:(e=this.publishConnection)==null?void 0:e.nativeConnection,subscribe:(t=this.subscribeConnection)==null?void 0:t.nativeConnection})}negotiateJoinWithRetry(e){return T(this,arguments,function*({name:t,data:n,autoSubscribeVideo:r,isWebRTC:s=!0}){try{yield this.negotiateJoin({name:t,data:n,autoSubscribeVideo:r,isWebRTC:s})}catch(i){_.e(Ye,"Join negotiation failed ",i);let o=i instanceof Ue?i:oe.WebsocketMethodErrors.ServerErrors(500,"JOIN",`Websocket join error - ${i.message}`),l=parseInt(`${o.code/100}`)===5||[Me.WebSocketConnectionErrors.WEBSOCKET_CONNECTION_LOST,429].includes(o.code);if(o.code===410&&(o.isTerminal=!0),l){this.joinRetryCount=0,o.isTerminal=!1;let c=()=>T(this,null,function*(){return this.joinRetryCount++,yield this.negotiateJoin({name:t,data:n,autoSubscribeVideo:r,isWebRTC:s})});yield this.retryScheduler.schedule({category:2,error:o,task:c,originalState:"Joined",changeState:!1})}else throw i}})}negotiateJoin(e){return T(this,arguments,function*({name:t,data:n,autoSubscribeVideo:r,isWebRTC:s=!0}){return s?yield this.negotiateJoinWebRTC({name:t,data:n,autoSubscribeVideo:r}):yield this.negotiateJoinNonWebRTC({name:t,data:n,autoSubscribeVideo:r})})}negotiateJoinWebRTC(e){return T(this,arguments,function*({name:t,data:n,autoSubscribeVideo:r}){if(_.d(Ye," join: Negotiating over PUBLISH connection"),!this.publishConnection)return _.e(Ye,"Publish peer connection not found, cannot negotiate"),!1;let s=yield this.publishConnection.createOffer();yield this.publishConnection.setLocalDescription(s);let i=this.isFlagEnabled("subscribeDegradation"),o=this.isFlagEnabled("simulcast"),l=this.isFlagEnabled("onDemandTracks"),c=yield this.signal.join(t,n,!r,i,o,l,s);this.setSFUNodeId(c==null?void 0:c.sfu_node_id),yield this.publishConnection.setRemoteDescription(c);for(let d of this.publishConnection.candidates)yield this.publishConnection.addIceCandidate(d);return this.publishConnection.initAfterJoin(),!!c})}negotiateJoinNonWebRTC(e){return T(this,arguments,function*({name:t,data:n,autoSubscribeVideo:r}){_.d(Ye," join: Negotiating Non-WebRTC");let s=this.isFlagEnabled("subscribeDegradation"),i=this.isFlagEnabled("simulcast"),o=this.isFlagEnabled("onDemandTracks"),l=yield this.signal.join(t,n,!r,s,i,o);return this.setSFUNodeId(l==null?void 0:l.sfu_node_id),!!l})}negotiateOnFirstPublish(){return T(this,null,function*(){if(_.d(Ye," Negotiating offer over PUBLISH connection"),!this.publishConnection)return _.e(Ye,"Publish peer connection not found, cannot negotiate"),!1;try{let e=yield this.publishConnection.createOffer(this.trackStates);yield this.publishConnection.setLocalDescription(e);let t=yield this.signal.offer(e,this.trackStates);yield this.publishConnection.setRemoteDescription(t);for(let n of this.publishConnection.candidates)yield this.publishConnection.addIceCandidate(n);return this.publishConnection.initAfterJoin(),!!t}catch(e){if(e instanceof Ue&&e.code===421)return!0;throw e}})}performPublishRenegotiation(e){return T(this,null,function*(){_.d(Ye," [role=PUBLISH] onRenegotiationNeeded START",this.trackStates);let t=this.callbacks.get(yu);if(!t){_.w(Ye,"no callback found for renegotiation");return}if(!this.publishConnection){_.e(Ye,"Publish peer connection not found, cannot renegotiate");return}try{let n=yield this.publishConnection.createOffer(this.trackStates,e);yield this.publishConnection.setLocalDescription(n),_.time("renegotiation-offer-exchange");let r=yield this.signal.offer(n,this.trackStates);this.callbacks.delete(yu),_.timeEnd("renegotiation-offer-exchange"),yield this.publishConnection.setRemoteDescription(r),t.promise.resolve(!0),_.d(Ye,"[role=PUBLISH] onRenegotiationNeeded DONE ")}catch(n){let r;n instanceof Ue?r=n:r=oe.GenericErrors.Unknown("PUBLISH",n.message),r.code===421?t.promise.resolve(!0):t.promise.reject(r),_.d(Ye,"[role=PUBLISH] onRenegotiationNeeded FAILED ")}})}handleIceConnectionFailure(e,t){return T(this,null,function*(){this.retryScheduler.isTaskInProgress(4)||(e===0?this.retryScheduler.schedule({category:3,error:t,task:this.retryPublishIceFailedTask,originalState:"Joined"}):this.retryScheduler.schedule({category:4,error:t,task:this.retrySubscribeIceFailedTask,originalState:"Joined"}))})}internalConnect(e,t,n,r){return T(this,null,function*(){var s,i,o;_.d(Ye,"connect: started ");let l=new Date;try{this.analyticsTimer.start("init_response_time"),this.initConfig=yield EY.fetchInitConfig({token:e,peerId:n,userAgent:this.store.getUserAgent(),initEndpoint:t,iceServers:r}),(s=this.connectivityListener)==null||s.onInitSuccess(this.initConfig.endpoint);let c=this.store.getRoom();return c&&(c.effectsKey=(i=this.initConfig.config.vb)==null?void 0:i.effectsKey,c.isEffectsEnabled=this.isFlagEnabled("effectsSDKEnabled"),c.disableNoneLayerRequest=this.isFlagEnabled("disableNoneLayerRequest"),c.isVBEnabled=this.isFlagEnabled("vb"),c.isHipaaEnabled=this.isFlagEnabled("hipaa"),c.isNoiseCancellationEnabled=this.isFlagEnabled("noiseCancellation")),this.analyticsTimer.end("init_response_time"),Ah.setWebsocketEndpoint(this.initConfig.endpoint),this.validateNotDisconnected("post init"),yield this.openSignal(e,n),this.observer.onConnected(),(o=this.connectivityListener)==null||o.onSignallingSuccess(),this.store.setSimulcastEnabled(this.isFlagEnabled("simulcast")),_.d(Ye,"Adding Analytics Transport: JsonRpcSignal"),this.analyticsEventsService.setTransport(this.analyticsSignalTransport),this.analyticsEventsService.flush(),this.initConfig}catch(c){throw this.state!=="Reconnecting"&&this.eventBus.analytics.publish(Be.connect(c,this.getAdditionalAnalyticsProperties(),l,new Date,t)),_.e(Ye," internal connect: failed",c),c}})}validateNotDisconnected(e){if(this.state==="Disconnected")throw _.w(Ye,"aborting join as transport state is disconnected"),oe.GenericErrors.ValidationFailed(`leave called before join could complete - stage=${e}`)}openSignal(e,t){return T(this,null,function*(){if(!this.initConfig)throw oe.APIErrors.InitConfigNotAvailable("INIT","Init Config not found");_.d(Ye," internal connect: connecting to ws endpoint",this.initConfig.endpoint);let n=new URL(this.initConfig.endpoint);n.searchParams.set("peer",t),n.searchParams.set("token",e),n.searchParams.set("user_agent_v2",this.store.getUserAgent()),n.searchParams.set("protocol_version",xQ),n.searchParams.set("protocol_spec",bQ),this.endpoint=n.toString(),this.analyticsTimer.start("ws_connect_time"),yield this.signal.open(this.endpoint),this.analyticsTimer.end("ws_connect_time"),this.analyticsTimer.start("on_policy_change_time"),this.analyticsTimer.start("room_state_time"),_.d(Ye," internal connect: connected to ws endpoint")})}initStatsAnalytics(){var e,t;this.isFlagEnabled("publishStats")&&(this.publishStatsAnalytics=new mY(this.store,this.eventBus,this.getValueFromInitConfig("publishStats","maxSampleWindowSize",30),this.getValueFromInitConfig("publishStats","maxSamplePushInterval",300)),(e=this.getWebrtcInternals())==null||e.start()),this.isFlagEnabled("subscribeStats")&&(this.subscribeStatsAnalytics=new vY(this.store,this.eventBus,this.getValueFromInitConfig("subscribeStats","maxSampleWindowSize",10),this.getValueFromInitConfig("subscribeStats","maxSamplePushInterval",60)),(t=this.getWebrtcInternals())==null||t.start())}getValueFromInitConfig(e,t,n){var r,s;return((s=(r=this.initConfig)==null?void 0:r.config[e])==null?void 0:s[t])||n}doesRoleNeedWebRTC(e){var t,n;if(!this.isFlagEnabled("nonWebRTCDisableOffer"))return!0;let r=!!(e.publishParams.allowed&&((t=e.publishParams.allowed)==null?void 0:t.length)>0),s=!!(e.subscribeParams.subscribeToRoles&&((n=e.subscribeParams.subscribeToRoles)==null?void 0:n.length)>0);return r||s}doesLocalPeerNeedWebRTC(){var e;let t=(e=this.store.getLocalPeer())==null?void 0:e.role;return t?this.doesRoleNeedWebRTC(t):!0}setTransportStateForConnect(){if(this.state==="Failed"&&(this.state="Disconnected"),this.state!=="Disconnected"&&this.state!=="Reconnecting")throw oe.WebsocketMethodErrors.AlreadyJoined("JOIN",`Cannot join a meeting in ${this.state} state`);this.state==="Disconnected"&&(this.state="Connecting",this.observer.onStateChange(this.state))}sendErrorAnalyticsEvent(e,t){let n=this.getAdditionalAnalyticsProperties(),r;switch(t){case 0:r=Be.connect(e,n);break;case 1:r=Be.disconnect(e,n);break;case 2:r=Be.join({error:e,time:this.analyticsTimer.getTimeTaken("join_time"),init_response_time:this.analyticsTimer.getTimeTaken("init_response_time"),ws_connect_time:this.analyticsTimer.getTimeTaken("ws_connect_time"),on_policy_change_time:this.analyticsTimer.getTimeTaken("on_policy_change_time"),local_audio_track_time:this.analyticsTimer.getTimeTaken("local_audio_track_time"),local_video_track_time:this.analyticsTimer.getTimeTaken("local_video_track_time"),retries_join:this.joinRetryCount});break;case 3:r=Be.publish({error:e});break;case 4:r=Be.subscribeFail(e);break}this.eventBus.analytics.publish(r)}getSubscribeConnection(){return this.subscribeConnection}getAdditionalAnalyticsProperties(){var e,t,n,r,s,i,o,l;let c=IY(),d=typeof document<"u"&&document.hidden,u=this.store.getRemoteVideoTracks().filter(m=>m.degraded).length,h=(r=(n=(t=(e=this.getWebrtcInternals())==null?void 0:e.getCurrentStats())==null?void 0:t.getLocalPeerStats())==null?void 0:n.publish)==null?void 0:r.bitrate,f=(l=(o=(i=(s=this.getWebrtcInternals())==null?void 0:s.getCurrentStats())==null?void 0:i.getLocalPeerStats())==null?void 0:o.subscribe)==null?void 0:l.bitrate;return{network_info:c,document_hidden:d,num_degraded_tracks:u,bitrate:{publish:h,subscribe:f},max_sub_bitrate:this.maxSubscribeBitrate,recent_pong_response_times:this.signal.getPongResponseTimes(),transport_state:this.state}}};function R_(e){if(!e||e.length===0)throw oe.APIErrors.InvalidTokenFormat("INIT","Token cannot be an empty string or undefined or null");let t=e.split(".");if(t.length!==3)throw oe.APIErrors.InvalidTokenFormat("INIT","Expected 3 '.' separate fields - header, payload and signature respectively");let n=atob(t[1]);try{let r=JSON.parse(n);return{roomId:r.room_id,userId:r.user_id,role:r.role}}catch(r){throw oe.APIErrors.InvalidTokenFormat("INIT",`couldn't parse to json - ${r.message}`)}}var j_={published:!1,isInitialised:!1,isReconnecting:!1,isPreviewInProgress:!1,isPreviewCalled:!1,isJoinInProgress:!1,deviceManagersInitialised:!1},RY=class{constructor(){this.TAG="[HMSSdk]:",this.transportState="Disconnected",this.analyticsTimer=new UK,this.sdkState=de({},j_),this.isDiagnostics=!1,this.playlistSettings={video:{bitrate:k_},audio:{bitrate:T_}},this.handleAutoplayError=e=>{var t,n;(n=(t=this.errorListener)==null?void 0:t.onError)==null||n.call(t,e)},this.observer={onNotification:e=>{var t;if(e.method==="on-peer-leave-request"){this.handlePeerLeaveRequest(e.params);return}switch(e.method){case"on-policy-change":this.analyticsTimer.end("on_policy_change_time");break;case"peer-list":this.analyticsTimer.end("peer_list_time"),this.sendJoinAnalyticsEvent(this.sdkState.isPreviewCalled);break;case"room-state":this.analyticsTimer.end("room_state_time");break}(t=this.notificationManager)==null||t.handleNotification(e,this.sdkState.isReconnecting)},onConnected:()=>{this.initNotificationManager()},onTrackAdd:e=>{var t;(t=this.notificationManager)==null||t.handleTrackAdd(e)},onTrackRemove:e=>{var t;(t=this.notificationManager)==null||t.handleTrackRemove(e)},onFailure:e=>{var t;(t=this.errorListener)==null||t.onError(e)},onStateChange:(e,t)=>T(this,null,function*(){var n,r;let s=i=>T(this,null,function*(){var o,l;yield this.internalLeave(!0,i),!this.sdkState.isPreviewInProgress&&!this.sdkState.isJoinInProgress&&((l=(o=this.errorListener)==null?void 0:o.onError)==null||l.call(o,i)),this.sdkState.isReconnecting=!1});switch(e){case"Preview":case"Joined":this.initNotificationManager(),this.transportState==="Reconnecting"&&((n=this.listener)==null||n.onReconnected());break;case"Failed":yield s(t);break;case"Reconnecting":this.sdkState.isReconnecting=!0,(r=this.listener)==null||r.onReconnecting(t);break}this.transportState=e,_.d(this.TAG,"Transport State Change",this.transportState)})},this.handlePeerLeaveRequest=e=>{var t;let n=e.requested_by?this.store.getPeerById(e.requested_by):void 0,r={roomEnded:e.room_end,reason:e.reason,requestedBy:n};(t=this.listener)==null||t.onRemovedFromRoom(r),this.internalLeave(!1)},this.handlePreviewError=e=>{var t;this.analyticsTimer.end("preview_time"),e&&((t=this.errorListener)==null||t.onError(e)),this.sendPreviewAnalyticsEvent(e),this.sdkState.isPreviewInProgress=!1},this.handleDeviceChange=e=>{var t,n;e.isUserSelection||(_.d(this.TAG,"Device Change event",e),(n=(t=this.deviceChangeListener)==null?void 0:t.onDeviceChange)==null||n.call(t,e),(()=>{var r,s,i,o;if(e.error&&e.type){let l=e.type.includes("audio")?(r=this.localPeer)==null?void 0:r.audioTrack:(s=this.localPeer)==null?void 0:s.videoTrack;(i=this.errorListener)==null||i.onError(e.error),[Me.TracksErrors.CANT_ACCESS_CAPTURE_DEVICE,Me.TracksErrors.DEVICE_IN_USE,Me.TracksErrors.DEVICE_NOT_AVAILABLE].includes(e.error.code)&&l&&(l.setEnabled(!1),(o=this.listener)==null||o.onTrackUpdate(2,l,this.localPeer))}})())},this.handleAudioPluginError=e=>{var t;_.e(this.TAG,"Audio Plugin Error event",e),(t=this.errorListener)==null||t.onError(e)},this.handleError=e=>{var t;_.e(this.TAG,e),(t=this.errorListener)==null||t.onError(e)},this.handleLocalRoleUpdate=e=>T(this,[e],function*({oldRole:t,newRole:n}){var r;this.deviceManager.currentSelection=this.deviceManager.getCurrentSelection(),yield this.transport.handleLocalRoleUpdate({oldRole:t,newRole:n}),yield(r=this.roleChangeManager)==null?void 0:r.handleLocalPeerRoleUpdate({oldRole:t,newRole:n}),yield this.interactivityCenter.whiteboard.handleLocalRoleUpdate()}),this.unpauseRemoteVideoTracks=()=>{this.store.getRemoteVideoTracks().forEach(e=>e.handleTrackUnmute())},this.sendAudioPresenceFailed=()=>{var e;let t=oe.TracksErrors.NoAudioDetected("PREVIEW");_.w(this.TAG,"Audio Presence Failure",this.transportState,t),this.isDiagnostics&&((e=this.listener)==null||e.onError(t))},this.sendJoinAnalyticsEvent=(e=!1,t)=>{this.eventBus.analytics.publish(Be.join(Ke(de({error:t},this.analyticsTimer.getTimes()),{time:this.analyticsTimer.getTimeTaken("join_time"),is_preview_called:e,retries_join:this.transport.joinRetryCount})))},this.sendPreviewAnalyticsEvent=e=>{this.eventBus.analytics.publish(Be.preview(Ke(de({error:e},this.analyticsTimer.getTimes()),{time:this.analyticsTimer.getTimeTaken("preview_time")})))},this.sendAnalyticsEvent=e=>{this.isDiagnostics||this.analyticsEventsService.queue(e).flush()}}setSessionPeerInfo(e,t){var n,r,s,i;let o=this.store.getRoom();if(!t||!o){_.e(this.TAG,"setSessionPeerInfo> Local peer or room is undefined");return}this.sessionPeerInfo={peer:{peer_id:t.peerId,role:(n=t.role)==null?void 0:n.name,joined_at:((r=t.joinedAt)==null?void 0:r.valueOf())||0,room_name:o.name,session_started_at:((s=o.startedAt)==null?void 0:s.valueOf())||0,user_data:t.customerUserId,user_name:t.name,template_id:o.templateId,session_id:o.sessionId,token:(i=this.store.getConfig())==null?void 0:i.authToken},agent:this.store.getUserAgent(),device_id:LL(),cluster:{websocket_url:e},timestamp:Date.now()}}initNotificationManager(){this.notificationManager||(this.notificationManager=new aY(this.store,this.eventBus,this.transport,this.listener,this.audioListener))}initStoreAndManagers(e){var t,n;if(this.listener=e,this.errorListener=e,this.deviceChangeListener=e,(t=this.store)==null||t.setErrorListener(this.errorListener),this.sdkState.isInitialised){(n=this.notificationManager)==null||n.setListener(this.listener),this.audioSinkManager.setListener(this.listener),this.interactivityCenter.setListener(this.listener),this.transport.setListener(this.listener);return}this.sdkState.isInitialised=!0,this.store=new FJ,this.store.setErrorListener(this.errorListener),this.eventBus=new WJ,this.pluginUsageTracker=new BJ(this.eventBus),this.wakeLockManager=new $J,this.networkTestManager=new DJ(this.eventBus,this.listener),this.playlistManager=new OQ(this,this.eventBus),this.deviceManager=new zJ(this.store,this.eventBus),this.audioSinkManager=new VJ(this.store,this.deviceManager,this.eventBus),this.audioOutput=new GJ(this.deviceManager,this.audioSinkManager),this.audioSinkManager.setListener(this.listener),this.eventBus.autoplayError.subscribe(this.handleAutoplayError),this.localTrackManager=new Ih(this.store,this.observer,this.deviceManager,this.eventBus,this.analyticsTimer),this.analyticsEventsService=new UJ(this.store),this.transport=new AY(this.observer,this.deviceManager,this.store,this.eventBus,this.analyticsEventsService,this.analyticsTimer,this.pluginUsageTracker),"onInitSuccess"in e&&this.transport.setConnectivityListener(e),this.sessionStore=new oY(this.transport),this.interactivityCenter=new eY(this.transport,this.store,this.listener),this.eventBus.analytics.subscribe(this.sendAnalyticsEvent),this.eventBus.deviceChange.subscribe(this.handleDeviceChange),this.eventBus.localVideoUnmutedNatively.subscribe(this.unpauseRemoteVideoTracks),this.eventBus.localAudioUnmutedNatively.subscribe(this.unpauseRemoteVideoTracks),this.eventBus.audioPluginFailed.subscribe(this.handleAudioPluginError),this.eventBus.error.subscribe(this.handleError)}validateJoined(e){if(!this.localPeer)throw oe.GenericErrors.NotConnected("VALIDATION",`Not connected - ${e}`)}sendHLSAnalytics(e){this.sendAnalyticsEvent(Be.hlsPlayerError(e))}refreshDevices(){return T(this,null,function*(){this.validateJoined("refreshDevices"),yield this.deviceManager.init(!0)})}getWebrtcInternals(){var e;return(e=this.transport)==null?void 0:e.getWebrtcInternals()}getDebugInfo(){var e;if(!this.transport)throw _.e(this.TAG,"Transport is not defined"),new Error("getDebugInfo can only be called after join");let t=this.transport.getWebsocketEndpoint(),n=Object.values(m2).filter(s=>this.transport.isFlagEnabled(s)),r=(e=this.store.getConfig())==null?void 0:e.initEndpoint;return{websocketURL:t,enabledFlags:n,initEndpoint:r}}getSessionStore(){return this.sessionStore}getPlaylistManager(){return this.playlistManager}getRecordingState(){var e;return(e=this.store.getRoom())==null?void 0:e.recording}getRTMPState(){var e;return(e=this.store.getRoom())==null?void 0:e.rtmp}getHLSState(){var e;return(e=this.store.getRoom())==null?void 0:e.hls}getTranscriptionState(){var e;return(e=this.store.getRoom())==null?void 0:e.transcriptions}getTemplateAppData(){return this.store.getTemplateAppData()}getInteractivityCenter(){return this.interactivityCenter}getPeerListIterator(e){return new jQ(this.transport,this.store,e)}updatePlaylistSettings(e){e.video&&Object.assign(this.playlistSettings.video,e.video),e.audio&&Object.assign(this.playlistSettings.audio,e.audio)}get localPeer(){var e;return(e=this.store)==null?void 0:e.getLocalPeer()}preview(e,t){return T(this,null,function*(){if(Cw(),Tw(),this.sdkState.isPreviewInProgress)return Promise.reject(oe.GenericErrors.PreviewAlreadyInProgress("PREVIEW","Preview already called"));if(["Joined","Reconnecting"].includes(this.transportState))return this.midCallPreview(e.asRole,e.settings);this.analyticsTimer.start("preview_time"),this.setUpPreview(e,t);let n=!1,r=!1,s=setTimeout(()=>{var i,o;(!n||!r)&&((o=(i=this.listener)==null?void 0:i.onNetworkQuality)==null||o.call(i,-1))},3e3);return new Promise((i,o)=>{let l=()=>T(this,null,function*(){var c;if(this.localPeer){let h=e.asRole&&this.store.getPolicyForRole(e.asRole);this.localPeer.asRole=h||this.localPeer.role}let d=yield this.localTrackManager.getTracksToPublish(e.settings);d.forEach(h=>{var f;if(this.setLocalPeerTrack(h),h.isTrackNotPublishing()){let m=oe.TracksErrors.NoDataInTrack(`${h.type} track has no data. muted: ${h.nativeTrack.muted}, readyState: ${h.nativeTrack.readyState}`);_.e(this.TAG,m),this.sendAnalyticsEvent(Be.publish({devices:this.deviceManager.getDevices(),error:m})),(f=this.listener)==null||f.onError(m)}}),(c=this.localPeer)!=null&&c.audioTrack&&this.initPreviewTrackAudioLevelMonitor(),yield this.initDeviceManagers(),this.sdkState.isPreviewInProgress=!1,this.analyticsTimer.end("preview_time");let u=this.store.getRoom();u&&t.onPreview(u,d),this.sendPreviewAnalyticsEvent(),i()});this.eventBus.policyChange.subscribeOnce(l),this.eventBus.leave.subscribeOnce(this.handlePreviewError),this.eventBus.leave.subscribeOnce(c=>o(c)),this.transport.preview(e.authToken,e.initEndpoint,this.localPeer.peerId,{name:e.userName,metaData:e.metaData||""},e.autoVideoSubscribe,e.iceServers).then(c=>{var d;n=!0,clearTimeout(s),c&&e.captureNetworkQualityInPreview&&this.networkTestManager.start((d=c.config)==null?void 0:d.networkHealth).then(()=>{r=!0})}).catch(c=>{this.handlePreviewError(c),o(c)})})})}midCallPreview(e,t){return T(this,null,function*(){var n,r;if(!this.localPeer||this.transportState!=="Joined")throw oe.GenericErrors.NotConnected("VALIDATION","Not connected - midCallPreview");let s=e&&this.store.getPolicyForRole(e);if(!s)throw oe.GenericErrors.InvalidRole("PREVIEW",`role ${e} does not exist in policy`);this.localPeer.asRole=s;let i=yield this.localTrackManager.getTracksToPublish(t);i.forEach(o=>this.setLocalPeerTrack(o)),(n=this.localPeer)!=null&&n.audioTrack&&this.initPreviewTrackAudioLevelMonitor(),yield this.initDeviceManagers(),(r=this.listener)==null||r.onPreview(this.store.getRoom(),i)})}cancelMidCallPreview(){return T(this,null,function*(){var e,t,n;if((!this.localPeer||!this.localPeer.isInPreview())&&_.w(this.TAG,"Cannot cancel mid call preview as preview is not in progress"),(e=this.localPeer)!=null&&e.asRole&&this.localPeer.role){let r=this.localPeer.asRole,s=this.localPeer.role;delete this.localPeer.asRole,yield(t=this.roleChangeManager)==null?void 0:t.diffRolesAndPublishTracks({oldRole:r,newRole:s}),(n=this.listener)==null||n.onPeerUpdate(8,this.localPeer)}})}join(e,t){return T(this,null,function*(){var n,r,s,i,o,l,c,d;if(Cw(),Tw(),this.sdkState.isPreviewInProgress)throw oe.GenericErrors.NotReady("JOIN","Preview is in progress, can't join");(r=(n=this.eventBus)==null?void 0:n.leave)==null||r.unsubscribe(this.handlePreviewError),this.analyticsTimer.start("join_time"),this.sdkState.isJoinInProgress=!0;let{roomId:u,userId:h,role:f}=R_(e.authToken),m=((i=(s=this.localPeer)==null?void 0:s.asRole)==null?void 0:i.name)||((l=(o=this.localPeer)==null?void 0:o.role)==null?void 0:l.name);(c=this.networkTestManager)==null||c.stop(),this.commonSetup(e,u,t),this.removeDevicesFromConfig(e),this.store.setConfig(e),this.store.createAndSetUserAgent(this.frameworkInfo),qd.resumeContext();let g=this.store.getConfig();g!=null&&g.autoManageWakeLock&&this.wakeLockManager.acquireLock(),this.localPeer?(this.localPeer.name=e.userName,this.localPeer.role=this.store.getPolicyForRole(f),this.localPeer.customerUserId=h,this.localPeer.metadata=e.metaData,delete this.localPeer.asRole):this.createAndAddLocalPeerToStore(e,f,h),this.roleChangeManager=new OJ(this.store,this.transport,this.deviceManager,this.getAndPublishTracks.bind(this),this.removeTrack.bind(this),this.listener),this.eventBus.localRoleUpdate.subscribe(this.handleLocalRoleUpdate),_.d(this.TAG,` Joining room ${u}`),_.time(`join-room-${u}`);try{yield this.transport.join(e.authToken,this.localPeer.peerId,{name:e.userName,metaData:e.metaData},e.initEndpoint,e.autoVideoSubscribe,e.iceServers),_.d(this.TAG,` Joined room ${u}`),this.analyticsTimer.start("peer_list_time"),yield this.notifyJoin(),this.sdkState.isJoinInProgress=!1,yield this.publish(e.settings,m)}catch(v){throw this.analyticsTimer.end("join_time"),this.sdkState.isJoinInProgress=!1,(d=this.listener)==null||d.onError(v),this.sendJoinAnalyticsEvent(this.sdkState.isPreviewCalled,v),_.e(this.TAG,"Unable to join room",v),v}_.timeEnd(`join-room-${u}`)})}stringifyMetadata(e){e.metaData&&typeof e.metaData!="string"?e.metaData=JSON.stringify(e.metaData):e.metaData||(e.metaData="")}cleanup(){var e,t,n;this.cleanDeviceManagers(),this.eventBus.analytics.unsubscribe(this.sendAnalyticsEvent),this.eventBus.localVideoUnmutedNatively.unsubscribe(this.unpauseRemoteVideoTracks),this.eventBus.localAudioUnmutedNatively.unsubscribe(this.unpauseRemoteVideoTracks),this.eventBus.error.unsubscribe(this.handleError),this.analyticsTimer.cleanup(),pa.cleanup(),this.playlistManager.cleanup(),(e=this.wakeLockManager)==null||e.cleanup(),Ih.cleanup(),this.notificationManager=void 0,_.cleanup(),this.sdkState=de({},j_),this.localPeer&&((t=this.localPeer.audioTrack)==null||t.cleanup(),this.localPeer.audioTrack=void 0,(n=this.localPeer.videoTrack)==null||n.cleanup(),this.localPeer.videoTrack=void 0),this.store.cleanup(),this.listener=void 0,this.roleChangeManager&&this.eventBus.localRoleUpdate.unsubscribe(this.handleLocalRoleUpdate)}leave(e){return this.internalLeave(e)}internalLeave(e=!0,t){return T(this,null,function*(){var n,r,s,i;let o=(n=this.store)==null?void 0:n.getRoom();if(o){for(;(this.sdkState.isPreviewInProgress||this.sdkState.isJoinInProgress)&&!(t!=null&&t.isTerminal);)yield bv(100);let l=o.id;this.setSessionPeerInfo(this.transport.getWebsocketEndpoint()||"",this.localPeer),(r=this.networkTestManager)==null||r.stop(),this.eventBus.leave.publish(t);let c=(s=this.localPeer)==null?void 0:s.peerId;_.d(this.TAG,` Leaving room ${l}, peerId=${c}`),yield(i=this.transport)==null?void 0:i.leave(e,t?"sdk request":"user request"),this.cleanup(),_.d(this.TAG,` Left room ${l}, peerId=${c}`)}})}getAuthTokenByRoomCode(e,t){return T(this,null,function*(){let n=(t||{}).endpoint||"https://auth.100ms.live/v2/token";this.analyticsTimer.start("GET_TOKEN");let r=yield u2(n,{method:"POST",body:JSON.stringify({code:e.roomCode,user_id:e.userId})},[429,500,501,502,503,504,505,506,507,508,509,510,511]),s=yield r.json();if(this.analyticsTimer.end("GET_TOKEN"),!r.ok)throw oe.APIErrors.ServerErrors(s.code,"GET_TOKEN",s.message,!1);let{token:i}=s;if(!i)throw Error(s.message);return i})}getLocalPeer(){return this.store.getLocalPeer()}getPeers(){return this.store.getPeers()}getPeerMap(){return this.store.getPeerMap()}getAudioOutput(){return this.audioOutput}sendMessage(e,t){this.sendMessageInternal({message:t,type:e})}sendBroadcastMessage(e,t){return T(this,null,function*(){return yield this.sendMessageInternal({message:e,type:t})})}sendGroupMessage(e,t,n){return T(this,null,function*(){let r=this.store.getKnownRoles();if((t.filter(s=>r[s.name])||[]).length===0)throw oe.GenericErrors.ValidationFailed("No valid role is present",t);return yield this.sendMessageInternal({message:e,recipientRoles:t,type:n})})}sendDirectMessage(e,t,n){return T(this,null,function*(){var r,s;if(((r=this.localPeer)==null?void 0:r.peerId)===t)throw oe.GenericErrors.ValidationFailed("Cannot send message to self");let i=!!((s=this.store.getRoom())!=null&&s.large_room_optimization),o=this.store.getPeerById(t);if(!o)if(i){let l=yield this.transport.signal.getPeer({peer_id:t});if(!l)throw oe.GenericErrors.ValidationFailed("Invalid peer - peer not present in the room",t);o=zc(l,this.store)}else throw oe.GenericErrors.ValidationFailed("Invalid peer - peer not present in the room",t);return yield this.sendMessageInternal({message:e,recipientPeer:o,type:n})})}submitSessionFeedback(e,t){return T(this,null,function*(){if(!this.sessionPeerInfo)throw _.e(this.TAG,"submitSessionFeedback> session is undefined"),new Error("session is undefined");let n=this.sessionPeerInfo.peer.token;if(!n)throw _.e(this.TAG,"submitSessionFeedback> token is undefined"),new Error("Internal error, token is not present");try{yield f2.sendFeedback({token:n,info:this.sessionPeerInfo,feedback:e,eventEndpoint:t}),_.i(this.TAG,"submitSessionFeedback> submitted feedback"),this.sessionPeerInfo=void 0}catch(r){throw _.e(this.TAG,"submitSessionFeedback> error occured ",r),new Error("Unable to submit feedback")}})}getPeer(e){return T(this,null,function*(){let t=yield this.transport.signal.getPeer({peer_id:e});if(t)return zc(t,this.store)})}findPeerByName(e){return T(this,arguments,function*({query:t,limit:n=10,offset:r}){let{peers:s,offset:i,eof:o}=yield this.transport.signal.findPeerByName({query:t==null?void 0:t.toLowerCase(),limit:n,offset:r});return s.length>0?{offset:i,eof:o,peers:s.map(l=>zc({peer_id:l.peer_id,role:l.role,groups:[],info:{name:l.name,data:"",user_id:"",type:l.type}},this.store))}:{offset:i,peers:[]}})}sendMessageInternal(e){return T(this,arguments,function*({recipientRoles:t,recipientPeer:n,type:r="chat",message:s}){if(s.replace(/\u200b/g," ").trim()==="")throw _.w(this.TAG,"sendMessage","Ignoring empty message send"),oe.GenericErrors.ValidationFailed("Empty message not allowed");let i={info:{message:s,type:r}};return t!=null&&t.length&&(i.roles=t.map(o=>o.name)),n!=null&&n.peerId&&(i.peer_id=n.peerId),_.d(this.TAG,"Sending Message: ",i),yield this.transport.signal.broadcast(i)})}startScreenShare(e,t){return T(this,null,function*(){var n,r,s;let i=this.store.getPublishParams();if(!i)return;let{allowed:o}=i;if(!(o&&o.includes("screen"))){_.e(this.TAG,`Role ${(n=this.localPeer)==null?void 0:n.role} cannot share screen`);return}if((s=(r=this.localPeer)==null?void 0:r.auxiliaryTracks)!=null&&s.find(c=>c.source==="screen"))throw Error("Cannot share multiple screens");let l=yield this.getScreenshareTracks(e,t);if(!this.localPeer){_.d(this.TAG,"Screenshared when not connected"),l.forEach(c=>{c.cleanup()});return}this.transport.setOnScreenshareStop(()=>{this.stopEndedScreenshare(e)}),yield this.transport.publish(l),l.forEach(c=>{var d,u,h;c.peerId=(d=this.localPeer)==null?void 0:d.peerId,(u=this.localPeer)==null||u.auxiliaryTracks.push(c),(h=this.listener)==null||h.onTrackUpdate(0,c,this.localPeer)})})}stopEndedScreenshare(e){return T(this,null,function*(){_.d(this.TAG," Screenshare ended natively"),yield this.stopScreenShare(),e()})}stopScreenShare(){return T(this,null,function*(){var e;_.d(this.TAG," Screenshare ended from app");let t=(e=this.localPeer)==null?void 0:e.auxiliaryTracks.filter(n=>n.source==="screen");if(t)for(let n of t)yield this.removeTrack(n.trackId)})}addTrack(e,t="regular"){return T(this,null,function*(){var n,r,s,i;if(!e){_.w(this.TAG,"Please pass a valid MediaStreamTrack");return}if(!this.localPeer)throw oe.GenericErrors.NotConnected("VALIDATION","No local peer present, cannot addTrack");if(this.localPeer.auxiliaryTracks.find(h=>h.trackId===e.id))return;let o=e.kind,l=new MediaStream([e]),c=new Bc(l),d=o==="audio"?wl:Ss,u=new d(c,e,t,this.eventBus);yield this.applySettings(u),yield this.setPlaylistSettings({track:e,hmsTrack:u,source:t}),yield(n=this.transport)==null?void 0:n.publish([u]),u.peerId=(r=this.localPeer)==null?void 0:r.peerId,(s=this.localPeer)==null||s.auxiliaryTracks.push(u),(i=this.listener)==null||i.onTrackUpdate(0,u,this.localPeer)})}removeTrack(e,t=!1){return T(this,null,function*(){var n;if(!this.localPeer)throw oe.GenericErrors.NotConnected("VALIDATION","No local peer present, cannot removeTrack");let r=this.localPeer.auxiliaryTracks.findIndex(s=>s.trackId===e);if(r>-1){let s=this.localPeer.auxiliaryTracks[r];s.isPublished?yield this.transport.unpublish([s]):yield s.cleanup(),t||this.stopPlaylist(s),this.localPeer.auxiliaryTracks.splice(r,1),(n=this.listener)==null||n.onTrackUpdate(1,s,this.localPeer)}else _.w(this.TAG,`No track found for ${e}`)})}setAnalyticsLevel(e){this.analyticsEventsService.level=e}setLogLevel(e){_.level=e}autoSelectAudioOutput(e){var t;(t=this.deviceManager)==null||t.autoSelectAudioOutput(e)}addAudioListener(e){var t;this.audioListener=e,(t=this.notificationManager)==null||t.setAudioListener(e)}addConnectionQualityListener(e){var t;(t=this.notificationManager)==null||t.setConnectionQualityListener(e)}setIsDiagnostics(e){this.isDiagnostics=e}changeRole(e,t,n=!1){return T(this,null,function*(){var r;yield(r=this.transport)==null?void 0:r.signal.requestRoleChange({requested_for:e,role:t,force:n})})}changeRoleOfPeer(e,t,n=!1){return T(this,null,function*(){var r;yield(r=this.transport)==null?void 0:r.signal.requestRoleChange({requested_for:e,role:t,force:n})})}changeRoleOfPeersWithRoles(e,t){return T(this,null,function*(){var n;e.length<=0||!t||(yield(n=this.transport)==null?void 0:n.signal.requestBulkRoleChange({roles:e.map(r=>r.name),role:t,force:!0}))})}acceptChangeRole(e){return T(this,null,function*(){var t,n;yield(n=this.transport)==null?void 0:n.signal.acceptRoleChangeRequest({requested_by:(t=e.requestedBy)==null?void 0:t.peerId,role:e.role.name,token:e.token})})}endRoom(e,t){return T(this,null,function*(){var n;if(!this.localPeer)throw oe.GenericErrors.NotConnected("VALIDATION","No local peer present, cannot end room");yield(n=this.transport)==null?void 0:n.signal.endRoom(e,t),yield this.leave()})}removePeer(e,t){return T(this,null,function*(){var n;if(!this.localPeer)throw oe.GenericErrors.NotConnected("VALIDATION","No local peer present, cannot remove peer");yield(n=this.transport)==null?void 0:n.signal.removePeer({requested_for:e,reason:t})})}startRTMPOrRecording(e){return T(this,null,function*(){var t,n;if(!this.localPeer)throw oe.GenericErrors.NotConnected("VALIDATION","No local peer present, cannot start streaming or recording");let r={meeting_url:e.meetingURL,record:e.record};(t=e.rtmpURLs)!=null&&t.length&&(r.rtmp_urls=e.rtmpURLs),e.resolution&&(r.resolution=e.resolution),yield(n=this.transport)==null?void 0:n.signal.startRTMPOrRecording(r)})}stopRTMPAndRecording(){return T(this,null,function*(){var e;if(!this.localPeer)throw oe.GenericErrors.NotConnected("VALIDATION","No local peer present, cannot stop streaming or recording");yield(e=this.transport)==null?void 0:e.signal.stopRTMPAndRecording()})}startHLSStreaming(e){return T(this,null,function*(){var t;if(!this.localPeer)throw oe.GenericErrors.NotConnected("VALIDATION","No local peer present, cannot start HLS streaming");let n={};e&&e.variants&&e.variants.length>0&&(n.variants=e.variants.map(r=>{let s={meeting_url:r.meetingURL};return r.metadata&&(s.metadata=r.metadata),s})),e!=null&&e.recording&&(n.hls_recording={single_file_per_layer:e.recording.singleFilePerLayer,hls_vod:e.recording.hlsVod}),yield(t=this.transport)==null?void 0:t.signal.startHLSStreaming(n)})}stopHLSStreaming(e){return T(this,null,function*(){var t,n,r;if(!this.localPeer)throw oe.GenericErrors.NotConnected("VALIDATION","No local peer present, cannot stop HLS streaming");if(e){let s={variants:(t=e==null?void 0:e.variants)==null?void 0:t.map(i=>{let o={meeting_url:i.meetingURL};return i.metadata&&(o.metadata=i.metadata),o}),stop_reason:e.stop_reason};yield(n=this.transport)==null?void 0:n.signal.stopHLSStreaming(s)}else yield(r=this.transport)==null?void 0:r.signal.stopHLSStreaming()})}startTranscription(e){return T(this,null,function*(){var t;if(!this.localPeer)throw oe.GenericErrors.NotConnected("VALIDATION","No local peer present, cannot start transcriptions");let n={mode:e.mode};yield(t=this.transport)==null?void 0:t.signal.startTranscription(n)})}stopTranscription(e){return T(this,null,function*(){var t;if(!this.localPeer)throw oe.GenericErrors.NotConnected("VALIDATION","No local peer present, cannot stop transcriptions");if(!e)throw oe.GenericErrors.Signalling("VALIDATION","No mode is passed to stop the transcription");let n={mode:e.mode};yield(t=this.transport)==null?void 0:t.signal.stopTranscription(n)})}sendHLSTimedMetadata(e){return T(this,null,function*(){var t;if(this.validateJoined("sendHLSTimedMetadata"),e.length>0){let n={metadata_objs:e};yield(t=this.transport)==null?void 0:t.signal.sendHLSTimedMetadata(n)}})}changeName(e){return T(this,null,function*(){var t,n;this.validateJoined("changeName");let r=this.store.getLocalPeer();r&&r.name!==e&&(yield(t=this.transport)==null?void 0:t.signal.updatePeer({name:e}),(n=this.notificationManager)==null||n.updateLocalPeer({name:e}))})}changeMetadata(e){return T(this,null,function*(){var t,n;this.validateJoined("changeMetadata"),yield(t=this.transport)==null?void 0:t.signal.updatePeer({data:e}),(n=this.notificationManager)==null||n.updateLocalPeer({metadata:e})})}setSessionMetadata(e){return T(this,null,function*(){var t;yield(t=this.transport)==null?void 0:t.signal.setSessionMetadata({key:"default",data:e})})}getSessionMetadata(){return T(this,null,function*(){var e;return(yield(e=this.transport)==null?void 0:e.signal.getSessionMetadata("default")).data})}getRoles(){return Object.values(this.store.getKnownRoles())}changeTrackState(e,t){return T(this,null,function*(){var n;if(e.type==="video"&&e.source!=="regular"){_.w(this.TAG,"Muting non-regular video tracks is currently not supported");return}if(e.enabled===t){_.w(this.TAG,`Aborting change track state, track already has enabled - ${t}`,e);return}if(!this.store.getTrackById(e.trackId))throw oe.GenericErrors.ValidationFailed("No track found for change track state",e);let r=this.store.getPeerByTrackId(e.trackId);if(!r)throw oe.GenericErrors.ValidationFailed("No peer found for change track state",e);yield(n=this.transport)==null?void 0:n.signal.requestTrackStateChange({requested_for:r.peerId,track_id:e.trackId,stream_id:e.stream.id,mute:!t})})}changeMultiTrackState(e){return T(this,null,function*(){var t;if(typeof e.enabled!="boolean")throw oe.GenericErrors.ValidationFailed("Pass a boolean for enabled");let{enabled:n,roles:r,type:s,source:i}=e;yield(t=this.transport)==null?void 0:t.signal.requestMultiTrackStateChange({value:!n,type:s,source:i,roles:r==null?void 0:r.map(o=>o==null?void 0:o.name)})})}raiseLocalPeerHand(){return T(this,null,function*(){var e;this.validateJoined("raiseLocalPeerHand"),yield(e=this.transport)==null?void 0:e.signal.joinGroup(Cc)})}lowerLocalPeerHand(){return T(this,null,function*(){var e;this.validateJoined("lowerLocalPeerHand"),yield(e=this.transport)==null?void 0:e.signal.leaveGroup(Cc)})}raiseRemotePeerHand(e){return T(this,null,function*(){var t;yield(t=this.transport)==null?void 0:t.signal.addToGroup(e,Cc)})}lowerRemotePeerHand(e){return T(this,null,function*(){var t;yield(t=this.transport)==null?void 0:t.signal.removeFromGroup(e,Cc)})}setFrameworkInfo(e){this.frameworkInfo=de(de({},this.frameworkInfo),e)}attachVideo(e,t){return T(this,null,function*(){let n=this.store.getConfig();n!=null&&n.autoManageVideo?e.attach(t):yield e.addSink(t)})}detachVideo(e,t){return T(this,null,function*(){let n=this.store.getConfig();n!=null&&n.autoManageVideo?e.detach(t):yield e.removeSink(t)})}publish(e,t){return T(this,null,function*(){var n,r,s;if([this.store.getPublishParams(),!this.sdkState.published,!Z0].every(i=>!!i)){let i=t&&t!==((r=(n=this.localPeer)==null?void 0:n.role)==null?void 0:r.name)?()=>{var o;return(o=this.roleChangeManager)==null?void 0:o.diffRolesAndPublishTracks({oldRole:this.store.getPolicyForRole(t),newRole:this.localPeer.role})}:()=>this.getAndPublishTracks(e);yield(s=i==null?void 0:i())==null?void 0:s.catch(o=>{var l;_.e(this.TAG,"Error in publish",o),(l=this.listener)==null||l.onError(o)})}})}getAndPublishTracks(e){return T(this,null,function*(){var t,n;let r=yield this.localTrackManager.getTracksToPublish(e);yield this.initDeviceManagers(),yield this.setAndPublishTracks(r),(n=(t=this.localPeer)==null?void 0:t.audioTrack)==null||n.initAudioLevelMonitor(),this.sdkState.published=!0})}setAndPublishTracks(e){return T(this,null,function*(){var t,n;for(let r of e){if(yield this.transport.publish([r]),r.isTrackNotPublishing()){let s=oe.TracksErrors.NoDataInTrack(`${r.type} track has no data. muted: ${r.nativeTrack.muted}, readyState: ${r.nativeTrack.readyState}`);_.e(this.TAG,s),this.sendAnalyticsEvent(Be.publish({devices:this.deviceManager.getDevices(),error:s})),(t=this.listener)==null||t.onError(s)}yield this.setLocalPeerTrack(r),(n=this.listener)==null||n.onTrackUpdate(0,r,this.localPeer)}})}setLocalPeerTrack(e){return T(this,null,function*(){var t;switch(e.peerId=(t=this.localPeer)==null?void 0:t.peerId,e.type){case"audio":this.localPeer.audioTrack=e,yield this.deviceManager.autoSelectAudioOutput();break;case"video":this.localPeer.videoTrack=e;break}})}initDeviceManagers(){return T(this,null,function*(){var e,t,n,r,s;this.sdkState.deviceManagersInitialised||(this.sdkState.deviceManagersInitialised=!0,yield this.deviceManager.init(),(yield this.deviceManager.updateOutputDevice((t=(e=this.store.getConfig())==null?void 0:e.settings)==null?void 0:t.audioOutputDeviceId))||(yield this.deviceManager.updateOutputDevice((r=(n=pa.getSelection())==null?void 0:n.audioOutput)==null?void 0:r.deviceId)),this.audioSinkManager.init((s=this.store.getConfig())==null?void 0:s.audioSinkElementId))})}cleanDeviceManagers(){this.eventBus.deviceChange.unsubscribe(this.handleDeviceChange),this.eventBus.audioPluginFailed.unsubscribe(this.handleAudioPluginError),this.eventBus.autoplayError.unsubscribe(this.handleAutoplayError),this.deviceManager.cleanup(),this.audioSinkManager.cleanup()}initPreviewTrackAudioLevelMonitor(){var e;let t=(e=this.localPeer)==null?void 0:e.audioTrack;t==null||t.initAudioLevelMonitor(),this.eventBus.trackAudioLevelUpdate.subscribe(n=>{var r;let s=n&&n.track.trackId===(t==null?void 0:t.trackId)?[{audioLevel:n.audioLevel,peer:this.localPeer,track:t}]:[];this.store.updateSpeakers(s),(r=this.audioListener)==null||r.onAudioLevelUpdate(s)}),this.eventBus.localAudioSilence.subscribe(this.sendAudioPresenceFailed)}notifyJoin(){var e;let t=this.store.getLocalPeer(),n=this.store.getRoom();if(!n){_.w(this.TAG,"notify join - room not present");return}if(n.joinedAt=new Date,t&&(t.joinedAt=n.joinedAt),t!=null&&t.role){this.analyticsTimer.end("join_time"),(e=this.listener)==null||e.onJoin(n);return}return new Promise((r,s)=>{this.eventBus.policyChange.subscribeOnce(()=>{var i;this.analyticsTimer.end("join_time"),(i=this.listener)==null||i.onJoin(n),r()}),this.eventBus.leave.subscribeOnce(i=>{s(i)})})}setUpPreview(e,t){this.sdkState.isPreviewCalled=!0,this.sdkState.isPreviewInProgress=!0;let{roomId:n,userId:r,role:s}=R_(e.authToken);this.commonSetup(e,n,t),this.store.setConfig(e),this.store.createAndSetUserAgent(this.frameworkInfo),this.createAndAddLocalPeerToStore(e,s,r,e.asRole)}setPlaylistSettings(e){return T(this,arguments,function*({track:t,hmsTrack:n,source:r}){var s,i;if(r==="videoplaylist"){let o={};if(t.kind==="audio")o.maxBitrate=((s=this.playlistSettings.audio)==null?void 0:s.bitrate)||T_;else{o.maxBitrate=((i=this.playlistSettings.video)==null?void 0:i.bitrate)||k_;let{width:l,height:c}=t.getSettings();o.width=l,o.height=c}yield n.setSettings(o)}else r==="audioplaylist"&&(yield n.setSettings({maxBitrate:64}))})}createAndAddLocalPeerToStore(e,t,n,r){let s=this.store.getPolicyForRole(t),i=r?this.store.getPolicyForRole(r):void 0,o=new YL({name:e.userName||"",customerUserId:n,metadata:e.metaData||"",role:s,asRole:i||s,type:"regular"});this.store.addPeer(o)}commonSetup(e,t,n){this.stringifyMetadata(e),e.initEndpoint||(e.initEndpoint="https://prod-init.100ms.live"),this.initStoreAndManagers(n),this.store.getRoom()||this.store.setRoom(new d2(t))}removeDevicesFromConfig(e){this.store.getConfig()&&e.settings&&(delete e.settings.audioOutputDeviceId,delete e.settings.videoDeviceId,delete e.settings.audioInputDeviceId)}getScreenshareTracks(e,t){return T(this,null,function*(){let n=this.transport.isFlagEnabled("scaleScreenshareBasedOnPixels"),[r,s]=yield this.localTrackManager.getLocalScreen(t,n),i=()=>{this.stopEndedScreenshare(e)},o=[];if(t!=null&&t.audioOnly){if(r.nativeTrack.stop(),!s)throw oe.TracksErrors.NothingToReturn("TRACK","Select share audio when sharing screen","No audio found");o.push(s),s.nativeTrack.addEventListener("ended",i)}else o.push(r),r.nativeTrack.addEventListener("ended",i),s&&o.push(s);return o})}stopPlaylist(e){e.source==="audioplaylist"?this.playlistManager.stop("audio"):e.source==="videoplaylist"&&this.playlistManager.stop("video")}applySettings(e){return T(this,null,function*(){jK(this.store);let t=this.store.getPublishParams();if(t){if(e instanceof Ss){let n=e.source==="regular"?"video":e.source==="screen"?"screen":"";if(!n||!t.allowed.includes(n))return;let r=t[n];if(!r)return;let s=new Eo().codec(r.codec).maxBitrate(r.bitRate).maxFramerate(r.frameRate).setWidth(r.width).setHeight(r.height).build();yield e.setSettings(s)}else if(e instanceof wl){if(!t.allowed.includes("audio"))return;let n=new Dl().codec(t.audio.codec).maxBitrate(t.audio.bitRate).build();yield e.setSettings(n)}}})}},w2=class Xo{constructor(t,n,r){this.getStats=()=>(this.stats||(this.stats=new LY(this.store,this.sdk)),this.stats),this.getDiagnosticsSDK=()=>(this.diagnostics||(this.diagnostics=this.actions.initDiagnostics()),this.diagnostics),t?this.store=t:this.store=Xo.createNewHMSStore(h2("HMSStore"),NL),r?this.notifications=r:this.notifications=new gJ(this.store),n?this.actions=n:(this.sdk=new RY,this.actions=new MJ(this.store,this.sdk,this.notifications)),this.actions.setFrameworkInfo({type:"js",sdkVersion:PL().version}),this.initialTriggerOnSubscribe=!1,Is&&(window.__hms=this)}triggerOnSubscribe(){this.initialTriggerOnSubscribe||(Xo.makeStoreTriggerOnSubscribe(this.store),this.initialTriggerOnSubscribe=!0)}getStore(){return this.store}getHMSActions(){return this.actions}getActions(){return this.actions}getNotifications(){return{onNotification:this.notifications.onNotification}}static createNewHMSStore(t,n){let r=tK(()=>n()),s=r.setState;r.setState=l=>{let c=typeof l=="function"?Z7(l):l;s(c)};let i=r.getState;r.getState=l=>l?l(i()):i(),Xo.compareWithShallowCheckInSubscribe(r);let o=Xo.setUpDevtools(r,t);return Ke(de({},r),{namedSetState:o})}static makeStoreTriggerOnSubscribe(t){let n=t.subscribe;t.subscribe=(r,s,i)=>(r(t.getState(s),void 0),n(r,s,i))}static compareWithShallowCheckInSubscribe(t){let n=t.subscribe;t.subscribe=(r,s,i)=>(s||(s=o=>o),i=i||eK,n(r,s,i))}static setUpDevtools(t,n){let r;try{r=window.__REDUX_DEVTOOLS_EXTENSION__||window.top.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!r)return o=>{t.setState(o)};let s=r.connect(Xo.devtoolsOptions(n));s.prefix=n?`${n} > `:"";let i=t.setState;return t.setState=o=>{i(o),s.send(`${s.prefix}setState`,t.getState())},s.subscribe(Xo.devtoolsSubscribe(s,t,i)),s.send("setUpStore",t.getState()),(o,l)=>{i(o);let c=l||`${s.prefix}action`;s.send(c,t.getState())}}static devtoolsOptions(t){return{name:t,actionsBlacklist:["audioLevel","playlistProgress","connectionQuality"]}}static devtoolsSubscribe(t,n,r){return s=>{var i,o,l,c;if(s.type==="DISPATCH"&&s.state)["JUMP_TO_ACTION","JUMP_TO_STATE"].includes(s.payload.type)?r(JSON.parse(s.state)):n.setState(JSON.parse(s.state));else if(s.type==="DISPATCH"&&((i=s.payload)==null?void 0:i.type)==="COMMIT")t.init(n.getState());else if(s.type==="DISPATCH"&&((o=s.payload)==null?void 0:o.type)==="IMPORT_STATE"){let d=(l=s.payload.nextLiftedState)==null?void 0:l.actionsById;(((c=s.payload.nextLiftedState)==null?void 0:c.computedStates)||[]).forEach(({state:u},h)=>{let f=d[h]||`${t.prefix}setState`;h===0?t.init(u):(r(u),t.send(f,n.getState()))})}}}},jY=(e,t,n)=>{let r;n.getState(yi)==="Connected"&&(r=M_(e,t,n)),n.subscribe(s=>{["Connected","Reconnecting"].includes(s)?r||(r=M_(e,t,n)):["Disconnected","Failed"].includes(s)&&r&&(OY(t,s),r(),r=void 0)},yi)},M_=(e,t,n)=>{var r,s;let i=MY(n,t);(r=e.getWebrtcInternals())==null||r.start();let o=(s=e.getWebrtcInternals())==null?void 0:s.onStatsChange(l=>DY(t,l,n,e));return()=>{i(),o&&o()}},MY=(e,t)=>{let n,r,s;return e.getState(Gc)?t.namedSetState(i=>{i.localPeer.id=e.getState(Gc)},"localpeer-id"):n=e.subscribe(i=>{i&&t.namedSetState(o=>{o.localPeer.id=i},"localpeer-id")},Gc),e.getState(Gs)?t.namedSetState(i=>{i.localPeer.videoTrack=e.getState(Gs)},"localpeer-videotrack-id"):r=e.subscribe(i=>{i&&t.namedSetState(o=>{o.localPeer.videoTrack=i},"localpeer-videotrack-id")},Gs),e.getState(ea)?t.namedSetState(i=>{i.localPeer.audioTrack=e.getState(ea)},"localpeer-audiotrack-id"):s=e.subscribe(i=>{i&&t.namedSetState(o=>{o.localPeer.audioTrack=i},"localpeer-audiotrack-id")},ea),()=>{n==null||n(),r==null||r(),s==null||s()}},DY=(e,t,n,r)=>{let s=n.getState(fn);e.namedSetState(i=>{let o=n.getState(Gc),l={},c=Object.keys(s).filter(u=>s[u].peerId!==o);for(let u of c){let h=t.getRemoteTrackStats(u);h&&(l[u]=h)}E_(i.remoteTrackStats,l);let d={[o]:t.getLocalPeerStats()};E_(i.peerStats,d),SJ(i.localTrackStats,t.getLocalTrackStats(),r.store.getLocalPeerTracks())},"webrtc-stats")},OY=(e,t="resetState")=>{e.namedSetState(n=>{Object.assign(n,IL())},t)},LY=class{constructor(e,t){this.hmsStore=e,this.sdk=t,this.store=w2.createNewHMSStore(h2("HMSStatsStore"),IL),this.getState=this.store.getState,this.subscribe=this.store.subscribe,this.getPublishPeerConnection=()=>new Promise(n=>{var r,s;this.hmsStore.getState(yi)==="Connected"?n((s=(r=this.sdk)==null?void 0:r.getWebrtcInternals())==null?void 0:s.getPublishPeerConnection()):this.hmsStore.subscribe(i=>{var o,l;i==="Connected"&&n((l=(o=this.sdk)==null?void 0:o.getWebrtcInternals())==null?void 0:l.getPublishPeerConnection())},yi)}),this.getSubscribePeerConnection=()=>new Promise(n=>{var r,s;this.hmsStore.getState(yi)==="Connected"?n((s=(r=this.sdk)==null?void 0:r.getWebrtcInternals())==null?void 0:s.getSubscribePeerConnection()):this.hmsStore.subscribe(i=>{var o,l;i==="Connected"&&n((l=(o=this.sdk)==null?void 0:o.getWebrtcInternals())==null?void 0:l.getSubscribePeerConnection())},yi)}),this.sdk&&jY(this.sdk,this.store,this.hmsStore)}},FY=e=>e.localPeer.id,$Y=e=>e.localPeer.audioTrack,UY=e=>e.localPeer.videoTrack,VY=(e,t)=>t,S2=(e,t)=>t,BY=e=>e.remoteTrackStats,k2=e=>e.peerStats,hk=e=>e.localTrackStats,$o=me([k2,FY],(e,t)=>e[t]);me($o,e=>{var t;return(t=e==null?void 0:e.subscribe)==null?void 0:t.packetsLost});me($o,e=>{var t;return(t=e==null?void 0:e.subscribe)==null?void 0:t.jitter});me($o,e=>{var t;return(t=e==null?void 0:e.publish)==null?void 0:t.bitrate});me($o,e=>{var t;return(t=e==null?void 0:e.subscribe)==null?void 0:t.bitrate});me($o,e=>{var t;return(t=e==null?void 0:e.publish)==null?void 0:t.availableOutgoingBitrate});me($o,e=>{var t;return(t=e==null?void 0:e.subscribe)==null?void 0:t.availableIncomingBitrate});me($o,e=>{var t;return(t=e==null?void 0:e.publish)==null?void 0:t.bytesSent});me($o,e=>{var t;return(t=e==null?void 0:e.subscribe)==null?void 0:t.bytesReceived});me([k2,VY],(e,t)=>t?e[t]:void 0);me([BY,S2],(e,t)=>t?e[t]:void 0);var T2=me([hk,S2],(e,t)=>t?e[t]:void 0);me([hk,$Y],(e,t)=>{var n;return t?(n=e[t])==null?void 0:n[0]:void 0});xr(me(T2,e=>e==null?void 0:e[0]));me([hk,UY],(e,t)=>{var n;return t?(n=e[t])==null?void 0:n[0]:void 0});xr(me(T2,e=>e));function zY(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(let r=0;r<n.length;r++)if(!Object.prototype.hasOwnProperty.call(t,n[r])||!Object.is(e[n[r]],t[n[r]]))return!1;return!0}var Jr,gs;(gs=Jr||(Jr={}))[gs.VERBOSE=0]="VERBOSE",gs[gs.DEBUG=1]="DEBUG",gs[gs.INFO=2]="INFO",gs[gs.WARN=3]="WARN",gs[gs.ERROR=4]="ERROR",gs[gs.NONE=5]="NONE";let C2=class{static v(t,...n){this.log(Jr.VERBOSE,t,...n)}static d(t,...n){this.log(Jr.DEBUG,t,...n)}static i(t,...n){this.log(Jr.INFO,t,...n)}static w(t,...n){this.log(Jr.WARN,t,...n)}static e(t,...n){this.log(Jr.ERROR,t,...n)}static log(t,n,...r){if(!(this.level.valueOf()>t.valueOf()))switch(t){case Jr.VERBOSE:console.log("HMSui-components: ",n,...r);break;case Jr.DEBUG:console.debug("HMSui-components: ",n,...r);break;case Jr.INFO:console.info("HMSui-components: ",n,...r);break;case Jr.WARN:console.warn("HMSui-components: ",n,...r);break;case Jr.ERROR:console.error("HMSui-components: ",n,...r)}}};C2.level=Jr.VERBOSE;var GY=C2;const E2=`It seems like you forgot to add your component within a top level HMSRoomProvider, please refer to 100ms react docs(https://www.100ms.live/docs/javascript/v2/how-to-guides/install-the-sdk/integration#react-hooks) to check on the required steps for using this hook. If the provider is present
  at the top level, check the yarn.lock/package-lock.json, if there are multiple versions of @100mslive/react-sdk. Please ensure the versions of @100mslive/react-sdk and @100mslive/roomkit-react are the same versions from the release notes(https://www.100ms.live/docs/javascript/v2/changelog/release-notes) that you are trying to update to.`;function WY(e){return(t,n=zY)=>{t||GY.w("fetching full store without passing any selector may have a heavy performance impact on your website.");const r=p.useContext(e);if(!r)throw new Error(E2);return(0,r.store)(t,n)}}const HY=typeof window<"u",fk=p.createContext(null),qY=({children:e,actions:t,store:n,notifications:r,stats:s,isHMSStatsOn:i=!1,leaveOnUnload:o=!0})=>{const l=p.useMemo(()=>{let c;const d=()=>{throw new Error("modifying store is not allowed")};if(t&&n)c={actions:t,store:wp(Object.assign(Object.assign({},n),{setState:d,destroy:d}))},r&&(c.notifications=r),s&&(c.statsStore=wp({getState:s.getState,subscribe:s.subscribe,setState:d,destroy:d}));else{const u=new w2;if(c={actions:u.getActions(),store:wp(Object.assign(Object.assign({},u.getStore()),{setState:d,destroy:d})),notifications:u.getNotifications()},i){const h=u.getStats();c.statsStore=wp({getState:h.getState,subscribe:h.subscribe,setState:d,destroy:d})}}return c.actions.setFrameworkInfo({type:"react-web",version:xe.version,sdkVersion:"0.10.39"}),c},[t,n,r,s,i]);return p.useEffect(()=>{if(HY&&o){const c=()=>l.actions.leave();return window.addEventListener("unload",c),()=>{window.removeEventListener("unload",c)}}return()=>{}},[o,l]),xe.createElement(fk.Provider,{value:l},e)},pr=WY(fk),pk=()=>{const e=p.useContext(fk);if(!e)throw new Error(E2);return e.actions},_2=p.createContext(void 0);function KY({children:e}){const[t,n]=p.useState(null),[r,s]=p.useState(!1),i=(l,c="individual")=>{l===null?(n(null),s(!1)):(n({id:l,type:c}),s(!0))};p.useEffect(()=>{const l=sessionStorage.getItem("activeVoiceChannel");if(l)try{const c=JSON.parse(l);n(c)}catch{console.warn("Failed to parse saved voice channel data"),sessionStorage.removeItem("activeVoiceChannel")}},[]),p.useEffect(()=>{t?sessionStorage.setItem("activeVoiceChannel",JSON.stringify(t)):sessionStorage.removeItem("activeVoiceChannel")},[t]);const o=(t==null?void 0:t.id)||null;return a.jsx(_2.Provider,{value:{isInVoiceChannel:r,currentConnectionId:o,activeVoiceChannel:t,setVoiceChannelActive:i},children:a.jsx(qY,{children:e})})}function P2(){const e=p.useContext(_2);if(e===void 0)throw new Error("useHMSContext must be used within a HMSProvider");return e}function mk(){const{data:e,isLoading:t,isFetching:n}=Pt({queryKey:["/api/auth/user"],retry:!1,queryFn:async()=>{try{const r=await fetch(lt("/api/auth/user"),{credentials:"include"});if(r.status===401||!r.ok)return null;const s=r.headers.get("content-type");return s&&s.includes("application/json")?await r.json():(console.warn("Auth endpoint returned non-JSON response, treating as unauthenticated"),null)}catch(r){return console.error("Auth check failed:",r),null}}});return{user:e,isLoading:t,isFetching:n,isAuthenticated:!!e}}const QY="/assets/Gemini_Generated_Image_rl0g6nrl0g6nrl0g_1762075477562-XyNtJzlQ.png",JY="/assets/left_1762075484949-BBPC_vu_.jpg",YY="/assets/right_1762075491469-CEWazxu5.jpg",XY="/assets/abt_1762075393318-BmLChz63.webp",ZY="/assets/sup_1762075536689-DxJzlM8B.webp";function eX({onShowAuth:e}){const[t,n]=p.useState(!1),r=i=>{const o=document.getElementById(i);o&&(o.scrollIntoView({behavior:"smooth"}),n(!1))},s=[{name:"Apex Legends",type:"Battle Royale"},{name:"Valorant",type:"Tactical FPS"},{name:"League of Legends",type:"MOBA"},{name:"Fortnite",type:"Battle Royale"},{name:"Overwatch 2",type:"Hero Shooter"},{name:"Rainbow Six",type:"Tactical FPS"}];return a.jsxs("div",{className:"nexus-landing",children:[a.jsx("nav",{className:"nexus-nav",children:a.jsxs("div",{className:"nexus-container nav-container",children:[a.jsxs("div",{className:"logo",children:[a.jsx("span",{className:"text-cyan-400 font-bold text-2xl",children:"N"}),a.jsx("span",{className:"font-bold text-xl ml-1",children:"Nexus Match"})]}),a.jsx("button",{className:`hamburger ${t?"active":""}`,onClick:()=>n(!t),"data-testid":"button-menu-toggle",children:t?a.jsx(Ot,{className:"w-6 h-6"}):a.jsx(VD,{className:"w-6 h-6"})}),a.jsxs("div",{className:`nav-links ${t?"active":""}`,children:[a.jsx("a",{href:"#how",onClick:()=>r("how"),"data-testid":"link-features",children:"Features"}),a.jsx("a",{href:"#games",onClick:()=>r("games"),"data-testid":"link-games",children:"Games"}),a.jsx("a",{href:"#community",onClick:()=>r("community"),"data-testid":"link-community",children:"Community"}),a.jsx("a",{href:"#support",onClick:()=>r("support"),"data-testid":"link-support",children:"Support"}),a.jsx("a",{href:"#about",onClick:()=>r("about"),"data-testid":"link-about",children:"About"})]}),a.jsx("button",{className:"signup-btn",onClick:e,"data-testid":"button-signup-nav",children:"Join Now"})]})}),a.jsxs("section",{className:"hero nexus-container",children:[a.jsxs("div",{className:"hero-content",children:[a.jsxs("h1",{children:["Nexus Match ",a.jsx("span",{className:"text-cyan-400",children:" Find Your Perfect Gaming Partner"})]}),a.jsx("p",{children:"The ultimate platform for instant matchmaking, real-time voice channels, and gamer networking. Connect by skill, game, and playstyle  in seconds."}),a.jsxs("div",{className:"btn-group",children:[a.jsx("button",{className:"btn btn-primary",onClick:e,"data-testid":"button-find-players",children:"Find Players"}),a.jsx("button",{className:"btn btn-outline",onClick:()=>r("how"),"data-testid":"button-explore-features",children:"Explore Features"})]})]}),a.jsxs("div",{className:"hero-image",children:[a.jsx("div",{className:"hero-image-glow"}),a.jsx("img",{src:QY,alt:"Hero Gamer",className:"hero-img"})]})]}),a.jsxs("div",{className:"scroll-indicator",onClick:()=>r("how"),"data-testid":"button-scroll-indicator",children:[a.jsx("span",{className:"text-2xl",children:""}),a.jsx("span",{className:"ml-2",children:"EXPLORE FEATURES"})]}),a.jsxs("section",{id:"how",className:"features nexus-container",children:[a.jsx("h2",{children:"Core Features"}),a.jsxs("div",{className:"feature-grid",children:[a.jsxs("div",{className:"card","data-testid":"card-feature-1",children:[a.jsx("h3",{className:"text-cyan-400",children:"1. Authentication & Profiles"}),a.jsx("p",{children:"Jump in using Google, Discord, or a custom gamertag-only login. Shape your profile with stats, favorite games, and playstyle preferences  your gaming identity, redefined."})]}),a.jsxs("div",{className:"card","data-testid":"card-feature-2",children:[a.jsx("h3",{className:"text-cyan-400",children:"2. Smart Search & Discovery"}),a.jsx("p",{children:"Find your ideal teammates faster than ever. Filter by skill, playstyle, language, or vibe  and instantly discover players who share your energy, not just your rank."})]}),a.jsxs("div",{className:"card","data-testid":"card-feature-3",children:[a.jsx("h3",{className:"text-cyan-400",children:"3. Game Portfolios"}),a.jsx("p",{children:"Turn your gaming journey into a visual showcase. Highlight your top clips, tournament wins, or creative achievements with stylish, customizable game cards."})]}),a.jsxs("div",{className:"card","data-testid":"card-feature-4",children:[a.jsx("h3",{className:"text-cyan-400",children:"4. Real-Time Chat & Voice"}),a.jsx("p",{children:"Talk, plan, or just vibe with teammates through lightning-fast voice and chat channels. Powered by 100ms  optimized for low latency, zero lag, and crystal-clear comms."})]}),a.jsxs("div",{className:"card","data-testid":"card-feature-5",children:[a.jsx("h3",{className:"text-cyan-400",children:"5. Progressive Web App"}),a.jsx("p",{children:"Install Nexus Match directly on your desktop or phone. Experience native-speed performance, instant push notifications, and offline access  all in one lightweight PWA."})]}),a.jsxs("div",{className:"card","data-testid":"card-feature-6",children:[a.jsx("h3",{className:"text-cyan-400",children:"6. Advanced Search Filters"}),a.jsx("p",{children:"Drill down to the perfect squad. Filter by distance, rank, gender, game mode, or even microphone preference  because the best teams start with the right chemistry."})]})]})]}),a.jsx("section",{id:"games",className:"games-section",children:a.jsxs("div",{className:"nexus-container",children:[a.jsx("h2",{children:"Supported Games"}),a.jsx("p",{children:"Connect instantly across major multiplayer titles. Whether you're a casual or competitive gamer, Nexus Match helps you find your squad fast."}),a.jsx("div",{className:"games-grid",children:s.map(i=>a.jsxs("div",{className:"game-card","data-testid":`card-game-${i.name.toLowerCase().replace(/\s+/g,"-")}`,children:[a.jsx("h4",{children:i.name}),a.jsx("p",{children:i.type})]},i.name))})]})}),a.jsxs("section",{id:"community",className:"hero-match",children:[a.jsx("div",{className:"match-bg"}),a.jsxs("div",{className:"match-players",children:[a.jsx("div",{className:"neon-gamer",children:a.jsx("img",{src:JY,alt:"Player 1",className:"warrior-img"})}),a.jsx("div",{className:"match-beam"}),a.jsx("div",{className:"neon-gamer",children:a.jsx("img",{src:YY,alt:"Player 2",className:"warrior-img"})})]}),a.jsx("h1",{className:"match-title",children:"Join the Nexus Community"}),a.jsx("p",{className:"match-subtitle",children:"Meet gamers who share your passion. Discover friends, connect directly, and share your gaming journey through voice, chat, and portfolios."}),a.jsxs("div",{className:"community-features",style:{maxWidth:"1000px",margin:"3rem auto",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"2rem"},children:[a.jsxs("div",{className:"card","data-testid":"card-community-interests",children:[a.jsx("h3",{className:"text-cyan-400",children:"Mutual Interests"}),a.jsx("p",{children:"Find players who share your hobbies  music, anime, art, books, and more  all visible through customizable profiles."})]}),a.jsxs("div",{className:"card","data-testid":"card-community-connections",children:[a.jsx("h3",{className:"text-cyan-400",children:"Direct Connections"}),a.jsx("p",{children:"Send, accept, or decline friend requests. Manage connections easily and see shared games, ranks, and hobbies."})]}),a.jsxs("div",{className:"card","data-testid":"card-community-notifications",children:[a.jsx("h3",{className:"text-cyan-400",children:"Notifications & Updates"}),a.jsx("p",{children:"Stay in the loop with in-app and push notifications for matches, requests, and messages  in real-time via WebSocket."})]})]}),a.jsx("button",{className:"btn-large",onClick:e,"data-testid":"button-join-community",children:"Join the Community"})]}),a.jsx("section",{id:"about",className:"about-section",children:a.jsx("div",{className:"nexus-container",children:a.jsxs("div",{className:"about-grid",children:[a.jsx("div",{className:"about-image",children:a.jsx("img",{src:XY,alt:"About Nexus Match"})}),a.jsxs("div",{className:"about-content",children:[a.jsx("h2",{children:"About Nexus Match"}),a.jsx("p",{children:"Nexus Match is built for gamers who want smarter, faster, and more meaningful multiplayer experiences. Powered by AI matchmaking and real-time communication, it's the bridge between casual and competitive players worldwide."}),a.jsxs("div",{className:"mt-8 space-y-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-cyan-400 text-xl mb-2",children:"Our Mission"}),a.jsx("p",{children:"To eliminate solo queue frustration by connecting gamers through compatibility  skill, attitude, and playstyle  not just rank."})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-cyan-400 text-xl mb-2",children:"Our Technology"}),a.jsx("p",{children:"Backed by PostgreSQL, WebSockets, Cloudflare R2, and a PWA architecture, Nexus Match delivers instant updates and seamless user experience."})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-cyan-400 text-xl mb-2",children:"Our Vision"}),a.jsx("p",{children:"To redefine how players connect  not through random queues, but through shared purpose, respect, and teamwork."})]})]})]})]})})}),a.jsx("section",{id:"support",className:"support-section",children:a.jsx("div",{className:"nexus-container",children:a.jsxs("div",{className:"support-grid",children:[a.jsxs("div",{className:"support-content",children:[a.jsx("h2",{children:"Support & Help Center"}),a.jsx("p",{className:"mb-6",children:"Need assistance? We're here 24/7 to help you make the most of Nexus Match."}),a.jsxs("div",{className:"faq-list",children:[a.jsx("h3",{className:"text-cyan-400 mb-4 text-xl",children:"FAQs"}),a.jsxs("div",{className:"faq-item",children:[a.jsx("strong",{children:"How do I report a player?"})," Use the in-app reporting tool available on every match and chat window."]}),a.jsxs("div",{className:"faq-item",children:[a.jsx("strong",{children:"Is my voice data secure?"})," 100%  all voice channels are encrypted end-to-end via WebRTC."]}),a.jsxs("div",{className:"faq-item",children:[a.jsx("strong",{children:"Can I use it on mobile?"})," Yes! Nexus Match works on all devices. Mobile apps launching in Q1 2026."]})]}),a.jsxs("div",{className:"mt-8",children:[a.jsx("h3",{className:"text-cyan-400 mb-4 text-xl",children:"Contact Support"}),a.jsxs("p",{children:["For technical help or bug reports, reach out to ",a.jsx("a",{href:"mailto:support@nexusmatch.gg",className:"text-cyan-400 hover:underline",children:"support@nexusmatch.gg"})]})]}),a.jsxs("div",{className:"mt-8",children:[a.jsx("h3",{className:"text-cyan-400 mb-4 text-xl",children:"Future Updates"}),a.jsx("p",{children:"Mobile apps launching in Q1 2026  stay tuned for push notifications, AI duo suggestions, and personalized stats dashboards."})]})]}),a.jsx("div",{className:"support-image",children:a.jsx("img",{src:ZY,alt:"Support"})})]})})}),a.jsx("section",{className:"cta-section",children:a.jsxs("div",{className:"nexus-container text-center",children:[a.jsx("h2",{className:"text-5xl font-bold mb-4",children:"Ready to Find Your Squad?"}),a.jsx("p",{className:"text-xl text-gray-300 mb-8",children:"Join thousands of gamers already winning together"}),a.jsx("button",{className:"btn btn-primary btn-large",onClick:e,"data-testid":"button-cta-signup",children:"Sign Up Free Now"})]})}),a.jsx("footer",{className:"text-center py-8 text-gray-400 text-sm border-t border-gray-800",children:a.jsx("p",{children:" 2025 Nexus Match. Built for the gaming community."})})]})}/*! Capacitor: https://capacitorjs.com/ - MIT License */var Pd;(function(e){e.Unimplemented="UNIMPLEMENTED",e.Unavailable="UNAVAILABLE"})(Pd||(Pd={}));class dx extends Error{constructor(t,n,r){super(t),this.message=t,this.code=n,this.data=r}}const tX=e=>{var t,n;return e!=null&&e.androidBridge?"android":!((n=(t=e==null?void 0:e.webkit)===null||t===void 0?void 0:t.messageHandlers)===null||n===void 0)&&n.bridge?"ios":"web"},nX=e=>{const t=e.CapacitorCustomPlatform||null,n=e.Capacitor||{},r=n.Plugins=n.Plugins||{},s=()=>t!==null?t.name:tX(e),i=()=>s()!=="web",o=h=>{const f=d.get(h);return!!(f!=null&&f.platforms.has(s())||l(h))},l=h=>{var f;return(f=n.PluginHeaders)===null||f===void 0?void 0:f.find(m=>m.name===h)},c=h=>e.console.error(h),d=new Map,u=(h,f={})=>{const m=d.get(h);if(m)return console.warn(`Capacitor plugin "${h}" already registered. Cannot register plugins twice.`),m.proxy;const g=s(),v=l(h);let x;const S=async()=>(!x&&g in f?x=typeof f[g]=="function"?x=await f[g]():x=f[g]:t!==null&&!x&&"web"in f&&(x=typeof f.web=="function"?x=await f.web():x=f.web),x),y=(L,N)=>{var O,G;if(v){const H=v==null?void 0:v.methods.find(re=>N===re.name);if(H)return H.rtype==="promise"?re=>n.nativePromise(h,N.toString(),re):(re,X)=>n.nativeCallback(h,N.toString(),re,X);if(L)return(O=L[N])===null||O===void 0?void 0:O.bind(L)}else{if(L)return(G=L[N])===null||G===void 0?void 0:G.bind(L);throw new dx(`"${h}" plugin is not implemented on ${g}`,Pd.Unimplemented)}},b=L=>{let N;const O=(...G)=>{const H=S().then(re=>{const X=y(re,L);if(X){const Q=X(...G);return N=Q==null?void 0:Q.remove,Q}else throw new dx(`"${h}.${L}()" is not implemented on ${g}`,Pd.Unimplemented)});return L==="addListener"&&(H.remove=async()=>N()),H};return O.toString=()=>`${L.toString()}() { [capacitor code] }`,Object.defineProperty(O,"name",{value:L,writable:!1,configurable:!1}),O},w=b("addListener"),C=b("removeListener"),I=(L,N)=>{const O=w({eventName:L},N),G=async()=>{const re=await O;C({eventName:L,callbackId:re},N)},H=new Promise(re=>O.then(()=>re({remove:G})));return H.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await G()},H},R=new Proxy({},{get(L,N){switch(N){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return v?I:w;case"removeListener":return C;default:return b(N)}}});return r[h]=R,d.set(h,{name:h,proxy:R,platforms:new Set([...Object.keys(f),...v?[g]:[]])}),R};return n.convertFileSrc||(n.convertFileSrc=h=>h),n.getPlatform=s,n.handleError=c,n.isNativePlatform=i,n.isPluginAvailable=o,n.registerPlugin=u,n.Exception=dx,n.DEBUG=!!n.DEBUG,n.isLoggingEnabled=!!n.isLoggingEnabled,n},rX=e=>e.Capacitor=nX(e),Ol=rX(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),kf=Ol.registerPlugin;class N2{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(t,n){let r=!1;this.listeners[t]||(this.listeners[t]=[],r=!0),this.listeners[t].push(n);const i=this.windowListeners[t];i&&!i.registered&&this.addWindowListener(i),r&&this.sendRetainedArgumentsForEvent(t);const o=async()=>this.removeListener(t,n);return Promise.resolve({remove:o})}async removeAllListeners(){this.listeners={};for(const t in this.windowListeners)this.removeWindowListener(this.windowListeners[t]);this.windowListeners={}}notifyListeners(t,n,r){const s=this.listeners[t];if(!s){if(r){let i=this.retainedEventArguments[t];i||(i=[]),i.push(n),this.retainedEventArguments[t]=i}return}s.forEach(i=>i(n))}hasListeners(t){var n;return!!(!((n=this.listeners[t])===null||n===void 0)&&n.length)}registerWindowListener(t,n){this.windowListeners[n]={registered:!1,windowEventName:t,pluginEventName:n,handler:r=>{this.notifyListeners(n,r)}}}unimplemented(t="not implemented"){return new Ol.Exception(t,Pd.Unimplemented)}unavailable(t="not available"){return new Ol.Exception(t,Pd.Unavailable)}async removeListener(t,n){const r=this.listeners[t];if(!r)return;const s=r.indexOf(n);this.listeners[t].splice(s,1),this.listeners[t].length||this.removeWindowListener(this.windowListeners[t])}addWindowListener(t){window.addEventListener(t.windowEventName,t.handler),t.registered=!0}removeWindowListener(t){t&&(window.removeEventListener(t.windowEventName,t.handler),t.registered=!1)}sendRetainedArgumentsForEvent(t){const n=this.retainedEventArguments[t];n&&(delete this.retainedEventArguments[t],n.forEach(r=>{this.notifyListeners(t,r)}))}}const D_=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),O_=e=>e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class sX extends N2{async getCookies(){const t=document.cookie,n={};return t.split(";").forEach(r=>{if(r.length<=0)return;let[s,i]=r.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");s=O_(s).trim(),i=O_(i).trim(),n[s]=i}),n}async setCookie(t){try{const n=D_(t.key),r=D_(t.value),s=`; expires=${(t.expires||"").replace("expires=","")}`,i=(t.path||"/").replace("path=",""),o=t.url!=null&&t.url.length>0?`domain=${t.url}`:"";document.cookie=`${n}=${r||""}${s}; path=${i}; ${o};`}catch(n){return Promise.reject(n)}}async deleteCookie(t){try{document.cookie=`${t.key}=; Max-Age=0`}catch(n){return Promise.reject(n)}}async clearCookies(){try{const t=document.cookie.split(";")||[];for(const n of t)document.cookie=n.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(t){return Promise.reject(t)}}async clearAllCookies(){try{await this.clearCookies()}catch(t){return Promise.reject(t)}}}kf("CapacitorCookies",{web:()=>new sX});const iX=async e=>new Promise((t,n)=>{const r=new FileReader;r.onload=()=>{const s=r.result;t(s.indexOf(",")>=0?s.split(",")[1]:s)},r.onerror=s=>n(s),r.readAsDataURL(e)}),aX=(e={})=>{const t=Object.keys(e);return Object.keys(e).map(s=>s.toLocaleLowerCase()).reduce((s,i,o)=>(s[i]=e[t[o]],s),{})},oX=(e,t=!0)=>e?Object.entries(e).reduce((r,s)=>{const[i,o]=s;let l,c;return Array.isArray(o)?(c="",o.forEach(d=>{l=t?encodeURIComponent(d):d,c+=`${i}=${l}&`}),c.slice(0,-1)):(l=t?encodeURIComponent(o):o,c=`${i}=${l}`),`${r}&${c}`},"").substr(1):null,lX=(e,t={})=>{const n=Object.assign({method:e.method||"GET",headers:e.headers},t),s=aX(e.headers)["content-type"]||"";if(typeof e.data=="string")n.body=e.data;else if(s.includes("application/x-www-form-urlencoded")){const i=new URLSearchParams;for(const[o,l]of Object.entries(e.data||{}))i.set(o,l);n.body=i.toString()}else if(s.includes("multipart/form-data")||e.data instanceof FormData){const i=new FormData;if(e.data instanceof FormData)e.data.forEach((l,c)=>{i.append(c,l)});else for(const l of Object.keys(e.data))i.append(l,e.data[l]);n.body=i;const o=new Headers(n.headers);o.delete("content-type"),n.headers=o}else(s.includes("application/json")||typeof e.data=="object")&&(n.body=JSON.stringify(e.data));return n};class cX extends N2{async request(t){const n=lX(t,t.webFetchExtra),r=oX(t.params,t.shouldEncodeUrlParams),s=r?`${t.url}?${r}`:t.url,i=await fetch(s,n),o=i.headers.get("content-type")||"";let{responseType:l="text"}=i.ok?t:{};o.includes("application/json")&&(l="json");let c,d;switch(l){case"arraybuffer":case"blob":d=await i.blob(),c=await iX(d);break;case"json":c=await i.json();break;case"document":case"text":default:c=await i.text()}const u={};return i.headers.forEach((h,f)=>{u[f]=h}),{data:c,headers:u,status:i.status,url:i.url}}async get(t){return this.request(Object.assign(Object.assign({},t),{method:"GET"}))}async post(t){return this.request(Object.assign(Object.assign({},t),{method:"POST"}))}async put(t){return this.request(Object.assign(Object.assign({},t),{method:"PUT"}))}async patch(t){return this.request(Object.assign(Object.assign({},t),{method:"PATCH"}))}async delete(t){return this.request(Object.assign(Object.assign({},t),{method:"DELETE"}))}}kf("CapacitorHttp",{web:()=>new cX});var L_;(function(e){e.IndexedDbLocal="INDEXED_DB_LOCAL",e.InMemory="IN_MEMORY",e.BrowserLocal="BROWSER_LOCAL",e.BrowserSession="BROWSER_SESSION"})(L_||(L_={}));var F_;(function(e){e.APPLE="apple.com",e.FACEBOOK="facebook.com",e.GAME_CENTER="gc.apple.com",e.GITHUB="github.com",e.GOOGLE="google.com",e.MICROSOFT="microsoft.com",e.PLAY_GAMES="playgames.google.com",e.TWITTER="twitter.com",e.YAHOO="yahoo.com",e.PASSWORD="password",e.PHONE="phone"})(F_||(F_={}));const dX=kf("FirebaseAuthentication",{web:()=>m0(()=>import("./web-DofEE4cx.js"),[]).then(e=>new e.FirebaseAuthenticationWeb)});var uX=Symbol.for("react.lazy"),cg=Bg[" use ".trim().toString()];function hX(e){return typeof e=="object"&&e!==null&&"then"in e}function I2(e){return e!=null&&typeof e=="object"&&"$$typeof"in e&&e.$$typeof===uX&&"_payload"in e&&hX(e._payload)}function kv(e){const t=fX(e),n=p.forwardRef((r,s)=>{let{children:i,...o}=r;I2(i)&&typeof cg=="function"&&(i=cg(i._payload));const l=p.Children.toArray(i),c=l.find(mX);if(c){const d=c.props.children,u=l.map(h=>h===c?p.Children.count(d)>1?p.Children.only(null):p.isValidElement(d)?d.props.children:null:h);return a.jsx(t,{...o,ref:s,children:p.isValidElement(d)?p.cloneElement(d,void 0,u):null})}return a.jsx(t,{...o,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}var A2=kv("Slot");function fX(e){const t=p.forwardRef((n,r)=>{let{children:s,...i}=n;if(I2(s)&&typeof cg=="function"&&(s=cg(s._payload)),p.isValidElement(s)){const o=vX(s),l=gX(i,s.props);return s.type!==p.Fragment&&(l.ref=r?Ii(r,o):o),p.cloneElement(s,l)}return p.Children.count(s)>1?p.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var pX=Symbol("radix.slottable");function mX(e){return p.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===pX}function gX(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...l)=>{const c=i(...l);return s(...l),c}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function vX(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}const gk=gf("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 hover-elevate active-elevate-2",{variants:{variant:{default:"bg-primary text-primary-foreground border border-primary-border",destructive:"bg-destructive text-destructive-foreground border border-destructive-border",outline:" border [border-color:var(--button-outline)]  shadow-xs active:shadow-none ",secondary:"border bg-secondary text-secondary-foreground border border-secondary-border ",ghost:"border border-transparent"},size:{default:"min-h-9 px-4 py-2",sm:"min-h-8 rounded-md px-3 text-xs",lg:"min-h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),ee=p.forwardRef(({className:e,variant:t,size:n,asChild:r=!1,...s},i)=>{const o=r?A2:"button";return a.jsx(o,{className:be(gk({variant:t,size:n,className:e})),ref:i,...s})});ee.displayName="Button";const tt=p.forwardRef(({className:e,type:t,...n},r)=>a.jsx("input",{type:t,className:be("flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...n}));tt.displayName="Input";var yX=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],xX=yX.reduce((e,t)=>{const n=kv(`Primitive.${t}`),r=p.forwardRef((s,i)=>{const{asChild:o,...l}=s,c=o?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),a.jsx(c,{...l,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{}),bX="Label",R2=p.forwardRef((e,t)=>a.jsx(xX.label,{...e,ref:t,onMouseDown:n=>{var s;n.target.closest("button, input, select, textarea")||((s=e.onMouseDown)==null||s.call(e,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));R2.displayName=bX;var j2=R2;const wX=gf("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Xn=p.forwardRef(({className:e,...t},n)=>a.jsx(j2,{ref:n,className:be(wX(),e),...t}));Xn.displayName=j2.displayName;const Ne=p.forwardRef(({className:e,...t},n)=>a.jsx("div",{ref:n,className:be("shadcn-card rounded-xl border bg-card border-card-border text-card-foreground shadow-sm",e),...t}));Ne.displayName="Card";const an=p.forwardRef(({className:e,...t},n)=>a.jsx("div",{ref:n,className:be("flex flex-col space-y-1.5 p-6",e),...t}));an.displayName="CardHeader";const mr=p.forwardRef(({className:e,...t},n)=>a.jsx("div",{ref:n,className:be("text-2xl font-semibold leading-none tracking-tight",e),...t}));mr.displayName="CardTitle";const Sl=p.forwardRef(({className:e,...t},n)=>a.jsx("div",{ref:n,className:be("text-sm text-muted-foreground",e),...t}));Sl.displayName="CardDescription";const Fe=p.forwardRef(({className:e,...t},n)=>a.jsx("div",{ref:n,className:be("p-6 pt-0",e),...t}));Fe.displayName="CardContent";const SX=p.forwardRef(({className:e,...t},n)=>a.jsx("div",{ref:n,className:be("flex items-center p-6 pt-0",e),...t}));SX.displayName="CardFooter";var kX=p.createContext(void 0);function ec(e){const t=p.useContext(kX);return e||t||"ltr"}var ux="rovingFocusGroup.onEntryFocus",TX={bubbles:!1,cancelable:!0},Tf="RovingFocusGroup",[Ow,M2,CX]=pf(Tf),[EX,Jd]=Mn(Tf,[CX]),[_X,PX]=EX(Tf),D2=p.forwardRef((e,t)=>a.jsx(Ow.Provider,{scope:e.__scopeRovingFocusGroup,children:a.jsx(Ow.Slot,{scope:e.__scopeRovingFocusGroup,children:a.jsx(NX,{...e,ref:t})})}));D2.displayName=Tf;var NX=p.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:s=!1,dir:i,currentTabStopId:o,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:c,onEntryFocus:d,preventScrollOnEntryFocus:u=!1,...h}=e,f=p.useRef(null),m=We(t,f),g=ec(i),[v,x]=qr({prop:o,defaultProp:l??null,onChange:c,caller:Tf}),[S,y]=p.useState(!1),b=rn(d),w=M2(n),C=p.useRef(!1),[I,R]=p.useState(0);return p.useEffect(()=>{const L=f.current;if(L)return L.addEventListener(ux,b),()=>L.removeEventListener(ux,b)},[b]),a.jsx(_X,{scope:n,orientation:r,dir:g,loop:s,currentTabStopId:v,onItemFocus:p.useCallback(L=>x(L),[x]),onItemShiftTab:p.useCallback(()=>y(!0),[]),onFocusableItemAdd:p.useCallback(()=>R(L=>L+1),[]),onFocusableItemRemove:p.useCallback(()=>R(L=>L-1),[]),children:a.jsx(Re.div,{tabIndex:S||I===0?-1:0,"data-orientation":r,...h,ref:m,style:{outline:"none",...e.style},onMouseDown:pe(e.onMouseDown,()=>{C.current=!0}),onFocus:pe(e.onFocus,L=>{const N=!C.current;if(L.target===L.currentTarget&&N&&!S){const O=new CustomEvent(ux,TX);if(L.currentTarget.dispatchEvent(O),!O.defaultPrevented){const G=w().filter(V=>V.focusable),H=G.find(V=>V.active),re=G.find(V=>V.id===v),Q=[H,re,...G].filter(Boolean).map(V=>V.ref.current);F2(Q,u)}}C.current=!1}),onBlur:pe(e.onBlur,()=>y(!1))})})}),O2="RovingFocusGroupItem",L2=p.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:s=!1,tabStopId:i,children:o,...l}=e,c=is(),d=i||c,u=PX(O2,n),h=u.currentTabStopId===d,f=M2(n),{onFocusableItemAdd:m,onFocusableItemRemove:g,currentTabStopId:v}=u;return p.useEffect(()=>{if(r)return m(),()=>g()},[r,m,g]),a.jsx(Ow.ItemSlot,{scope:n,id:d,focusable:r,active:s,children:a.jsx(Re.span,{tabIndex:h?0:-1,"data-orientation":u.orientation,...l,ref:t,onMouseDown:pe(e.onMouseDown,x=>{r?u.onItemFocus(d):x.preventDefault()}),onFocus:pe(e.onFocus,()=>u.onItemFocus(d)),onKeyDown:pe(e.onKeyDown,x=>{if(x.key==="Tab"&&x.shiftKey){u.onItemShiftTab();return}if(x.target!==x.currentTarget)return;const S=RX(x,u.orientation,u.dir);if(S!==void 0){if(x.metaKey||x.ctrlKey||x.altKey||x.shiftKey)return;x.preventDefault();let b=f().filter(w=>w.focusable).map(w=>w.ref.current);if(S==="last")b.reverse();else if(S==="prev"||S==="next"){S==="prev"&&b.reverse();const w=b.indexOf(x.currentTarget);b=u.loop?jX(b,w+1):b.slice(w+1)}setTimeout(()=>F2(b))}}),children:typeof o=="function"?o({isCurrentTabStop:h,hasTabStop:v!=null}):o})})});L2.displayName=O2;var IX={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function AX(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function RX(e,t,n){const r=AX(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return IX[r]}function F2(e,t=!1){const n=document.activeElement;for(const r of e)if(r===n||(r.focus({preventScroll:t}),document.activeElement!==n))return}function jX(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var vk=D2,yk=L2,Tv="Tabs",[MX]=Mn(Tv,[Jd]),$2=Jd(),[DX,xk]=MX(Tv),U2=p.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,onValueChange:s,defaultValue:i,orientation:o="horizontal",dir:l,activationMode:c="automatic",...d}=e,u=ec(l),[h,f]=qr({prop:r,onChange:s,defaultProp:i??"",caller:Tv});return a.jsx(DX,{scope:n,baseId:is(),value:h,onValueChange:f,orientation:o,dir:u,activationMode:c,children:a.jsx(Re.div,{dir:u,"data-orientation":o,...d,ref:t})})});U2.displayName=Tv;var V2="TabsList",B2=p.forwardRef((e,t)=>{const{__scopeTabs:n,loop:r=!0,...s}=e,i=xk(V2,n),o=$2(n);return a.jsx(vk,{asChild:!0,...o,orientation:i.orientation,dir:i.dir,loop:r,children:a.jsx(Re.div,{role:"tablist","aria-orientation":i.orientation,...s,ref:t})})});B2.displayName=V2;var z2="TabsTrigger",G2=p.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,disabled:s=!1,...i}=e,o=xk(z2,n),l=$2(n),c=q2(o.baseId,r),d=K2(o.baseId,r),u=r===o.value;return a.jsx(yk,{asChild:!0,...l,focusable:!s,active:u,children:a.jsx(Re.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":d,"data-state":u?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:c,...i,ref:t,onMouseDown:pe(e.onMouseDown,h=>{!s&&h.button===0&&h.ctrlKey===!1?o.onValueChange(r):h.preventDefault()}),onKeyDown:pe(e.onKeyDown,h=>{[" ","Enter"].includes(h.key)&&o.onValueChange(r)}),onFocus:pe(e.onFocus,()=>{const h=o.activationMode!=="manual";!u&&!s&&h&&o.onValueChange(r)})})})});G2.displayName=z2;var W2="TabsContent",H2=p.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,forceMount:s,children:i,...o}=e,l=xk(W2,n),c=q2(l.baseId,r),d=K2(l.baseId,r),u=r===l.value,h=p.useRef(u);return p.useEffect(()=>{const f=requestAnimationFrame(()=>h.current=!1);return()=>cancelAnimationFrame(f)},[]),a.jsx(Pn,{present:s||u,children:({present:f})=>a.jsx(Re.div,{"data-state":u?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":c,hidden:!f,id:d,tabIndex:0,...o,ref:t,style:{...e.style,animationDuration:h.current?"0s":void 0},children:f&&i})})});H2.displayName=W2;function q2(e,t){return`${e}-trigger-${t}`}function K2(e,t){return`${e}-content-${t}`}var OX=U2,Q2=B2,J2=G2,Y2=H2;const Ll=OX,_o=p.forwardRef(({className:e,...t},n)=>a.jsx(Q2,{ref:n,className:be("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));_o.displayName=Q2.displayName;const _r=p.forwardRef(({className:e,...t},n)=>a.jsx(J2,{ref:n,className:be("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));_r.displayName=J2.displayName;const si=p.forwardRef(({className:e,...t},n)=>a.jsx(Y2,{ref:n,className:be("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));si.displayName=Y2.displayName;var X2={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},$_=xe.createContext&&xe.createContext(X2),LX=["attr","size","title"];function FX(e,t){if(e==null)return{};var n=$X(e,t),r,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function $X(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function dg(){return dg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},dg.apply(this,arguments)}function U_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function ug(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?U_(Object(n),!0).forEach(function(r){UX(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U_(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function UX(e,t,n){return t=VX(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function VX(e){var t=BX(e,"string");return typeof t=="symbol"?t:t+""}function BX(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Z2(e){return e&&e.map((t,n)=>xe.createElement(t.tag,ug({key:n},t.attr),Z2(t.child)))}function zX(e){return t=>xe.createElement(GX,dg({attr:ug({},e.attr)},t),Z2(e.child))}function GX(e){var t=n=>{var{attr:r,size:s,title:i}=e,o=FX(e,LX),l=s||n.size||"1em",c;return n.className&&(c=n.className),e.className&&(c=(c?c+" ":"")+e.className),xe.createElement("svg",dg({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,o,{className:c,style:ug(ug({color:e.color||n.color},n.style),e.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),i&&xe.createElement("title",null,i),e.children)};return $_!==void 0?xe.createElement($_.Consumer,null,n=>t(n)):t(X2)}function WX(e){return zX({attr:{role:"img",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M12.48 10.92v3.28h7.84c-.24 1.84-.853 3.187-1.787 4.133-1.147 1.147-2.933 2.4-6.053 2.4-4.827 0-8.6-3.893-8.6-8.72s3.773-8.72 8.6-8.72c2.6 0 4.507 1.027 5.907 2.347l2.307-2.307C18.747 1.44 16.133 0 12.48 0 5.867 0 .307 5.387.307 12s5.56 12 12.173 12c3.573 0 6.267-1.173 8.373-3.36 2.16-2.16 2.84-5.213 2.84-7.667 0-.76-.053-1.467-.173-2.053H12.48z"},child:[]}]})(e)}const HX=()=>{};var V_={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eF=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let s=e.charCodeAt(r);s<128?t[n++]=s:s<2048?(t[n++]=s>>6|192,t[n++]=s&63|128):(s&64512)===55296&&r+1<e.length&&(e.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(e.charCodeAt(++r)&1023),t[n++]=s>>18|240,t[n++]=s>>12&63|128,t[n++]=s>>6&63|128,t[n++]=s&63|128):(t[n++]=s>>12|224,t[n++]=s>>6&63|128,t[n++]=s&63|128)}return t},qX=function(e){const t=[];let n=0,r=0;for(;n<e.length;){const s=e[n++];if(s<128)t[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=e[n++];t[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=e[n++],o=e[n++],l=e[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;t[r++]=String.fromCharCode(55296+(c>>10)),t[r++]=String.fromCharCode(56320+(c&1023))}else{const i=e[n++],o=e[n++];t[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return t.join("")},bk={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<e.length;s+=3){const i=e[s],o=s+1<e.length,l=o?e[s+1]:0,c=s+2<e.length,d=c?e[s+2]:0,u=i>>2,h=(i&3)<<4|l>>4;let f=(l&15)<<2|d>>6,m=d&63;c||(m=64,o||(f=64)),r.push(n[u],n[h],n[f],n[m])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(eF(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):qX(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<e.length;){const i=n[e.charAt(s++)],l=s<e.length?n[e.charAt(s)]:0;++s;const d=s<e.length?n[e.charAt(s)]:64;++s;const h=s<e.length?n[e.charAt(s)]:64;if(++s,i==null||l==null||d==null||h==null)throw new KX;const f=i<<2|l>>4;if(r.push(f),d!==64){const m=l<<4&240|d>>2;if(r.push(m),h!==64){const g=d<<6&192|h;r.push(g)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class KX extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const QX=function(e){const t=eF(e);return bk.encodeByteArray(t,!0)},tF=function(e){return QX(e).replace(/\./g,"")},nF=function(e){try{return bk.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JX(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YX=()=>JX().__FIREBASE_DEFAULTS__,XX=()=>{if(typeof process>"u"||typeof V_>"u")return;const e=V_.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},ZX=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&nF(e[1]);return t&&JSON.parse(t)},wk=()=>{try{return HX()||YX()||XX()||ZX()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},eZ=e=>{var t,n;return(n=(t=wk())===null||t===void 0?void 0:t.emulatorHosts)===null||n===void 0?void 0:n[e]},rF=()=>{var e;return(e=wk())===null||e===void 0?void 0:e.config},sF=e=>{var t;return(t=wk())===null||t===void 0?void 0:t[`_${e}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lw{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}wrapCallback(t){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(n):t(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cv(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch{return!1}}async function tZ(e){return(await fetch(e,{credentials:"include"})).ok}const Zu={};function nZ(){const e={prod:[],emulator:[]};for(const t of Object.keys(Zu))Zu[t]?e.emulator.push(t):e.prod.push(t);return e}function rZ(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}let B_=!1;function sZ(e,t){if(typeof window>"u"||typeof document>"u"||!Cv(window.location.host)||Zu[e]===t||Zu[e]||B_)return;Zu[e]=t;function n(f){return`__firebase__banner__${f}`}const r="__firebase__banner",i=nZ().prod.length>0;function o(){const f=document.getElementById(r);f&&f.remove()}function l(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function c(f,m){f.setAttribute("width","24"),f.setAttribute("id",m),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function d(){const f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{B_=!0,o()},f}function u(f,m){f.setAttribute("id",m),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function h(){const f=rZ(r),m=n("text"),g=document.getElementById(m)||document.createElement("span"),v=n("learnmore"),x=document.getElementById(v)||document.createElement("a"),S=n("preprendIcon"),y=document.getElementById(S)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){const b=f.element;l(b),u(x,v);const w=d();c(y,S),b.append(y,g,x,w),document.body.appendChild(b)}i?(g.innerText="Preview backend disconnected.",y.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(y.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,g.innerText="Preview backend running in this workspace."),g.setAttribute("id",m)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ar(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function iZ(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ar())}function aZ(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function oZ(){const e=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof e=="object"&&e.id!==void 0}function lZ(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function cZ(){const e=Ar();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function iF(){try{return typeof indexedDB=="object"}catch{return!1}}function dZ(){return new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;t(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){t(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uZ="FirebaseError";class Uo extends Error{constructor(t,n,r){super(n),this.code=t,this.customData=r,this.name=uZ,Object.setPrototypeOf(this,Uo.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Yd.prototype.create)}}class Yd{constructor(t,n,r){this.service=t,this.serviceName=n,this.errors=r}create(t,...n){const r=n[0]||{},s=`${this.service}/${t}`,i=this.errors[t],o=i?hZ(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new Uo(s,l,r)}}function hZ(e,t){return e.replace(fZ,(n,r)=>{const s=t[r];return s!=null?String(s):`<${r}?>`})}const fZ=/\{\$([^}]+)}/g;function pZ(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function Nd(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const s of n){if(!r.includes(s))return!1;const i=e[s],o=t[s];if(z_(i)&&z_(o)){if(!Nd(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function z_(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xd(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach(s=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function Mu(e){const t={};return e.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");t[decodeURIComponent(s)]=decodeURIComponent(i)}}),t}function Du(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}function mZ(e,t){const n=new gZ(e,t);return n.subscribe.bind(n)}class gZ{constructor(t,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{t(this)}).catch(r=>{this.error(r)})}next(t){this.forEachObserver(n=>{n.next(t)})}error(t){this.forEachObserver(n=>{n.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,n,r){let s;if(t===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");vZ(t,["next","error","complete"])?s=t:s={next:t,error:n,complete:r},s.next===void 0&&(s.next=hx),s.error===void 0&&(s.error=hx),s.complete===void 0&&(s.complete=hx);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,t)}sendOne(t,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[t]!==void 0)try{n(this.observers[t])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(t){this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function vZ(e,t){if(typeof e!="object"||e===null)return!1;for(const n of t)if(n in e&&typeof e[n]=="function")return!0;return!1}function hx(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zt(e){return e&&e._delegate?e._delegate:e}class Po{constructor(t,n,r){this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yZ{constructor(t,n){this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const n=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(n)){const r=new Lw;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(t){var n;const r=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),s=(n=t==null?void 0:t.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(bZ(t))try{this.getOrInitializeService({instanceIdentifier:Zo})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(t=Zo){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...t.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=Zo){return this.instances.has(t)}getOptions(t=Zo){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:n={}}=t,r=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&o.resolve(s)}return s}onInit(t,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(t),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&t(o,s),()=>{i.delete(t)}}invokeOnInitCallbacks(t,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(t,n)}catch{}}getOrInitializeService({instanceIdentifier:t,options:n={}}){let r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:xZ(t),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch{}return r||null}normalizeInstanceIdentifier(t=Zo){return this.component?this.component.multipleInstances?t:Zo:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function xZ(e){return e===Zo?void 0:e}function bZ(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wZ{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const n=this.getProvider(t.name);if(n.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);n.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const n=new yZ(t,this);return this.providers.set(t,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Mt;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(Mt||(Mt={}));const SZ={debug:Mt.DEBUG,verbose:Mt.VERBOSE,info:Mt.INFO,warn:Mt.WARN,error:Mt.ERROR,silent:Mt.SILENT},kZ=Mt.INFO,TZ={[Mt.DEBUG]:"log",[Mt.VERBOSE]:"log",[Mt.INFO]:"info",[Mt.WARN]:"warn",[Mt.ERROR]:"error"},CZ=(e,t,...n)=>{if(t<e.logLevel)return;const r=new Date().toISOString(),s=TZ[t];if(s)console[s](`[${r}]  ${e.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Sk{constructor(t){this.name=t,this._logLevel=kZ,this._logHandler=CZ,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Mt))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?SZ[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Mt.DEBUG,...t),this._logHandler(this,Mt.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Mt.VERBOSE,...t),this._logHandler(this,Mt.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Mt.INFO,...t),this._logHandler(this,Mt.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Mt.WARN,...t),this._logHandler(this,Mt.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Mt.ERROR,...t),this._logHandler(this,Mt.ERROR,...t)}}const EZ=(e,t)=>t.some(n=>e instanceof n);let G_,W_;function _Z(){return G_||(G_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function PZ(){return W_||(W_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const aF=new WeakMap,Fw=new WeakMap,oF=new WeakMap,fx=new WeakMap,kk=new WeakMap;function NZ(e){const t=new Promise((n,r)=>{const s=()=>{e.removeEventListener("success",i),e.removeEventListener("error",o)},i=()=>{n(mo(e.result)),s()},o=()=>{r(e.error),s()};e.addEventListener("success",i),e.addEventListener("error",o)});return t.then(n=>{n instanceof IDBCursor&&aF.set(n,e)}).catch(()=>{}),kk.set(t,e),t}function IZ(e){if(Fw.has(e))return;const t=new Promise((n,r)=>{const s=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",o),e.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(e.error||new DOMException("AbortError","AbortError")),s()};e.addEventListener("complete",i),e.addEventListener("error",o),e.addEventListener("abort",o)});Fw.set(e,t)}let $w={get(e,t,n){if(e instanceof IDBTransaction){if(t==="done")return Fw.get(e);if(t==="objectStoreNames")return e.objectStoreNames||oF.get(e);if(t==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return mo(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function AZ(e){$w=e($w)}function RZ(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...n){const r=e.call(px(this),t,...n);return oF.set(r,t.sort?t.sort():[t]),mo(r)}:PZ().includes(e)?function(...t){return e.apply(px(this),t),mo(aF.get(this))}:function(...t){return mo(e.apply(px(this),t))}}function jZ(e){return typeof e=="function"?RZ(e):(e instanceof IDBTransaction&&IZ(e),EZ(e,_Z())?new Proxy(e,$w):e)}function mo(e){if(e instanceof IDBRequest)return NZ(e);if(fx.has(e))return fx.get(e);const t=jZ(e);return t!==e&&(fx.set(e,t),kk.set(t,e)),t}const px=e=>kk.get(e);function MZ(e,t,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(e,t),l=mo(o);return r&&o.addEventListener("upgradeneeded",c=>{r(mo(o.result),c.oldVersion,c.newVersion,mo(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),l}const DZ=["get","getKey","getAll","getAllKeys","count"],OZ=["put","add","delete","clear"],mx=new Map;function H_(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(mx.get(t))return mx.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,s=OZ.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||DZ.includes(n)))return;const i=async function(o,...l){const c=this.transaction(o,s?"readwrite":"readonly");let d=c.store;return r&&(d=d.index(l.shift())),(await Promise.all([d[n](...l),s&&c.done]))[0]};return mx.set(t,i),i}AZ(e=>({...e,get:(t,n,r)=>H_(t,n)||e.get(t,n,r),has:(t,n)=>!!H_(t,n)||e.has(t,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LZ{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(FZ(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function FZ(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const Uw="@firebase/app",q_="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ga=new Sk("@firebase/app"),$Z="@firebase/app-compat",UZ="@firebase/analytics-compat",VZ="@firebase/analytics",BZ="@firebase/app-check-compat",zZ="@firebase/app-check",GZ="@firebase/auth",WZ="@firebase/auth-compat",HZ="@firebase/database",qZ="@firebase/data-connect",KZ="@firebase/database-compat",QZ="@firebase/functions",JZ="@firebase/functions-compat",YZ="@firebase/installations",XZ="@firebase/installations-compat",ZZ="@firebase/messaging",eee="@firebase/messaging-compat",tee="@firebase/performance",nee="@firebase/performance-compat",ree="@firebase/remote-config",see="@firebase/remote-config-compat",iee="@firebase/storage",aee="@firebase/storage-compat",oee="@firebase/firestore",lee="@firebase/ai",cee="@firebase/firestore-compat",dee="firebase",uee="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vw="[DEFAULT]",hee={[Uw]:"fire-core",[$Z]:"fire-core-compat",[VZ]:"fire-analytics",[UZ]:"fire-analytics-compat",[zZ]:"fire-app-check",[BZ]:"fire-app-check-compat",[GZ]:"fire-auth",[WZ]:"fire-auth-compat",[HZ]:"fire-rtdb",[qZ]:"fire-data-connect",[KZ]:"fire-rtdb-compat",[QZ]:"fire-fn",[JZ]:"fire-fn-compat",[YZ]:"fire-iid",[XZ]:"fire-iid-compat",[ZZ]:"fire-fcm",[eee]:"fire-fcm-compat",[tee]:"fire-perf",[nee]:"fire-perf-compat",[ree]:"fire-rc",[see]:"fire-rc-compat",[iee]:"fire-gcs",[aee]:"fire-gcs-compat",[oee]:"fire-fst",[cee]:"fire-fst-compat",[lee]:"fire-vertex","fire-js":"fire-js",[dee]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hg=new Map,fee=new Map,Bw=new Map;function K_(e,t){try{e.container.addComponent(t)}catch(n){ga.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function Fl(e){const t=e.name;if(Bw.has(t))return ga.debug(`There were multiple attempts to register component ${t}.`),!1;Bw.set(t,e);for(const n of hg.values())K_(n,e);for(const n of fee.values())K_(n,e);return!0}function lF(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function zn(e){return e==null?!1:e.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pee={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},go=new Yd("app","Firebase",pee);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mee{constructor(t,n,r){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Po("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw go.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cf=uee;function cF(e,t={}){let n=e;typeof t!="object"&&(t={name:t});const r=Object.assign({name:Vw,automaticDataCollectionEnabled:!0},t),s=r.name;if(typeof s!="string"||!s)throw go.create("bad-app-name",{appName:String(s)});if(n||(n=rF()),!n)throw go.create("no-options");const i=hg.get(s);if(i){if(Nd(n,i.options)&&Nd(r,i.config))return i;throw go.create("duplicate-app",{appName:s})}const o=new wZ(s);for(const c of Bw.values())o.addComponent(c);const l=new mee(n,r,o);return hg.set(s,l),l}function gee(e=Vw){const t=hg.get(e);if(!t&&e===Vw&&rF())return cF();if(!t)throw go.create("no-app",{appName:e});return t}function kl(e,t,n){var r;let s=(r=hee[e])!==null&&r!==void 0?r:e;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=t.match(/\s|\//);if(i||o){const l=[`Unable to register library "${s}" with version "${t}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&l.push("and"),o&&l.push(`version name "${t}" contains illegal characters (whitespace or "/")`),ga.warn(l.join(" "));return}Fl(new Po(`${s}-version`,()=>({library:s,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vee="firebase-heartbeat-database",yee=1,Rh="firebase-heartbeat-store";let gx=null;function dF(){return gx||(gx=MZ(vee,yee,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(Rh)}catch(n){console.warn(n)}}}}).catch(e=>{throw go.create("idb-open",{originalErrorMessage:e.message})})),gx}async function xee(e){try{const n=(await dF()).transaction(Rh),r=await n.objectStore(Rh).get(uF(e));return await n.done,r}catch(t){if(t instanceof Uo)ga.warn(t.message);else{const n=go.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});ga.warn(n.message)}}}async function Q_(e,t){try{const r=(await dF()).transaction(Rh,"readwrite");await r.objectStore(Rh).put(t,uF(e)),await r.done}catch(n){if(n instanceof Uo)ga.warn(n.message);else{const r=go.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});ga.warn(r.message)}}}function uF(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bee=1024,wee=30;class See{constructor(t){this.container=t,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Tee(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var t,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=J_();if(((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>wee){const o=Cee(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){ga.warn(r)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=J_(),{heartbeatsToSend:r,unsentEntries:s}=kee(this._heartbeatsCache.heartbeats),i=tF(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return ga.warn(n),""}}}function J_(){return new Date().toISOString().substring(0,10)}function kee(e,t=bee){const n=[];let r=e.slice();for(const s of e){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Y_(n)>t){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Y_(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class Tee{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return iF()?dZ().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await xee(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Q_(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Q_(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...t.heartbeats]})}else return}}function Y_(e){return tF(JSON.stringify({version:2,heartbeats:e})).length}function Cee(e){if(e.length===0)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Eee(e){Fl(new Po("platform-logger",t=>new LZ(t),"PRIVATE")),Fl(new Po("heartbeat",t=>new See(t),"PRIVATE")),kl(Uw,q_,e),kl(Uw,q_,"esm2017"),kl("fire-js","")}Eee("");var _ee="firebase",Pee="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */kl(_ee,Pee,"app");var mi=function(){return mi=Object.assign||function(t){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},mi.apply(this,arguments)};function Ef(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]]);return n}function Nee(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}function hF(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Iee=hF,fF=new Yd("auth","Firebase",hF());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fg=new Sk("@firebase/auth");function Aee(e,...t){fg.logLevel<=Mt.WARN&&fg.warn(`Auth (${Cf}): ${e}`,...t)}function lm(e,...t){fg.logLevel<=Mt.ERROR&&fg.error(`Auth (${Cf}): ${e}`,...t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rs(e,...t){throw Ck(e,...t)}function Hr(e,...t){return Ck(e,...t)}function Tk(e,t,n){const r=Object.assign(Object.assign({},Iee()),{[t]:n});return new Yd("auth","Firebase",r).create(t,{appName:e.name})}function Ir(e){return Tk(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ev(e,t,n){const r=n;if(!(t instanceof r))throw r.name!==t.constructor.name&&Rs(e,"argument-error"),Tk(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Ck(e,...t){if(typeof e!="string"){const n=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(n,...r)}return fF.create(e,...t)}function ke(e,t,...n){if(!e)throw Ck(t,...n)}function ta(e){const t="INTERNAL ASSERTION FAILED: "+e;throw lm(t),new Error(t)}function va(e,t){e||ta(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jh(){var e;return typeof self<"u"&&((e=self.location)===null||e===void 0?void 0:e.href)||""}function Ek(){return X_()==="http:"||X_()==="https:"}function X_(){var e;return typeof self<"u"&&((e=self.location)===null||e===void 0?void 0:e.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ree(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Ek()||oZ()||"connection"in navigator)?navigator.onLine:!0}function jee(){if(typeof navigator>"u")return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _f{constructor(t,n){this.shortDelay=t,this.longDelay=n,va(n>t,"Short delay should be less than long delay!"),this.isMobile=iZ()||lZ()}get(){return Ree()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _k(e,t){va(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pF{static initialize(t,n,r){this.fetchImpl=t,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ta("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ta("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ta("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mee={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dee=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Oee=new _f(3e4,6e4);function On(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function Ln(e,t,n,r,s={}){return mF(e,s,async()=>{let i={},o={};r&&(t==="GET"?o=r:i={body:JSON.stringify(r)});const l=Xd(Object.assign({key:e.config.apiKey},o)).slice(1),c=await e._getAdditionalHeaders();c["Content-Type"]="application/json",e.languageCode&&(c["X-Firebase-Locale"]=e.languageCode);const d=Object.assign({method:t,headers:c},i);return aZ()||(d.referrerPolicy="no-referrer"),e.emulatorConfig&&Cv(e.emulatorConfig.host)&&(d.credentials="include"),pF.fetch()(await gF(e,e.config.apiHost,n,l),d)})}async function mF(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},Mee),t);try{const s=new Fee(e),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Ou(e,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[c,d]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ou(e,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Ou(e,"email-already-in-use",o);if(c==="USER_DISABLED")throw Ou(e,"user-disabled",o);const u=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw Tk(e,u,d);Rs(e,u)}}catch(s){if(s instanceof Uo)throw s;Rs(e,"network-request-failed",{message:String(s)})}}async function wa(e,t,n,r,s={}){const i=await Ln(e,t,n,r,s);return"mfaPendingCredential"in i&&Rs(e,"multi-factor-auth-required",{_serverResponse:i}),i}async function gF(e,t,n,r){const s=`${t}${n}?${r}`,i=e,o=i.config.emulator?_k(e.config,s):`${e.config.apiScheme}://${s}`;return Dee.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function Lee(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Fee{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Hr(this.auth,"network-request-failed")),Oee.get())})}}function Ou(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Hr(e,t,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z_(e){return e!==void 0&&e.getResponse!==void 0}function eP(e){return e!==void 0&&e.enterprise!==void 0}class vF{constructor(t){if(this.siteKey="",this.recaptchaEnforcementState=[],t.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=t.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=t.recaptchaEnforcementState}getProviderEnforcementState(t){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===t)return Lee(n.enforcementState);return null}isProviderEnabled(t){return this.getProviderEnforcementState(t)==="ENFORCE"||this.getProviderEnforcementState(t)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $ee(e){return(await Ln(e,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function yF(e,t){return Ln(e,"GET","/v2/recaptchaConfig",On(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Uee(e,t){return Ln(e,"POST","/v1/accounts:delete",t)}async function Vee(e,t){return Ln(e,"POST","/v1/accounts:update",t)}async function pg(e,t){return Ln(e,"POST","/v1/accounts:lookup",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eh(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}async function Bee(e,t=!1){const n=zt(e),r=await n.getIdToken(t),s=_v(r);ke(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:eh(vx(s.auth_time)),issuedAtTime:eh(vx(s.iat)),expirationTime:eh(vx(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function vx(e){return Number(e)*1e3}function _v(e){const[t,n,r]=e.split(".");if(t===void 0||n===void 0||r===void 0)return lm("JWT malformed, contained fewer than 3 sections"),null;try{const s=nF(n);return s?JSON.parse(s):(lm("Failed to decode base64 JWT payload"),null)}catch(s){return lm("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function tP(e){const t=_v(e);return ke(t,"internal-error"),ke(typeof t.exp<"u","internal-error"),ke(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $l(e,t,n=!1){if(n)return t;try{return await t}catch(r){throw r instanceof Uo&&zee(r)&&e.auth.currentUser===e&&await e.auth.signOut(),r}}function zee({code:e}){return e==="auth/user-disabled"||e==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gee{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(t){var n;if(t){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(t=!1){if(!this.isRunning)return;const n=this.getInterval(t);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){(t==null?void 0:t.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zw{constructor(t,n){this.createdAt=t,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=eh(this.lastLoginAt),this.creationTime=eh(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mh(e){var t;const n=e.auth,r=await e.getIdToken(),s=await $l(e,pg(n,{idToken:r}));ke(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];e._notifyReloadListener(i);const o=!((t=i.providerUserInfo)===null||t===void 0)&&t.length?xF(i.providerUserInfo):[],l=Hee(e.providerData,o),c=e.isAnonymous,d=!(e.email&&i.passwordHash)&&!(l!=null&&l.length),u=c?d:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new zw(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(e,h)}async function Wee(e){const t=zt(e);await Mh(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function Hee(e,t){return[...e.filter(r=>!t.some(s=>s.providerId===r.providerId)),...t]}function xF(e){return e.map(t=>{var{providerId:n}=t,r=Ef(t,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qee(e,t){const n=await mF(e,{},async()=>{const r=Xd({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:s,apiKey:i}=e.config,o=await gF(e,s,"/v1/token",`key=${i}`),l=await e._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:l,body:r};return e.emulatorConfig&&Cv(e.emulatorConfig.host)&&(c.credentials="include"),pF.fetch()(o,c)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function Kee(e,t){return Ln(e,"POST","/v2/accounts:revokeToken",On(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){ke(t.idToken,"internal-error"),ke(typeof t.idToken<"u","internal-error"),ke(typeof t.refreshToken<"u","internal-error");const n="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):tP(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,n)}updateFromIdToken(t){ke(t.length!==0,"internal-error");const n=tP(t);this.updateTokensAndExpiration(t,null,n)}async getToken(t,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(ke(this.refreshToken,t,"user-token-expired"),this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(t,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await qee(t,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(t,n,r){this.refreshToken=n||null,this.accessToken=t||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(t,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new Wc;return r&&(ke(typeof r=="string","internal-error",{appName:t}),o.refreshToken=r),s&&(ke(typeof s=="string","internal-error",{appName:t}),o.accessToken=s),i&&(ke(typeof i=="number","internal-error",{appName:t}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new Wc,this.toJSON())}_performRefresh(){return ta("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ia(e,t){ke(typeof e=="string"||typeof e>"u","internal-error",{appName:t})}class Qs{constructor(t){var{uid:n,auth:r,stsTokenManager:s}=t,i=Ef(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Gee(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new zw(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(t){const n=await $l(this,this.stsTokenManager.getToken(this.auth,t));return ke(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(t){return Bee(this,t)}reload(){return Wee(this)}_assign(t){this!==t&&(ke(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(n=>Object.assign({},n)),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const n=new Qs(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(t){ke(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,n=!1){let r=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),r=!0),n&&await Mh(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(zn(this.auth.app))return Promise.reject(Ir(this.auth));const t=await this.getIdToken();return await $l(this,Uee(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>Object.assign({},t)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,n){var r,s,i,o,l,c,d,u;const h=(r=n.displayName)!==null&&r!==void 0?r:void 0,f=(s=n.email)!==null&&s!==void 0?s:void 0,m=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,g=(o=n.photoURL)!==null&&o!==void 0?o:void 0,v=(l=n.tenantId)!==null&&l!==void 0?l:void 0,x=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,S=(d=n.createdAt)!==null&&d!==void 0?d:void 0,y=(u=n.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:b,emailVerified:w,isAnonymous:C,providerData:I,stsTokenManager:R}=n;ke(b&&R,t,"internal-error");const L=Wc.fromJSON(this.name,R);ke(typeof b=="string",t,"internal-error"),Ia(h,t.name),Ia(f,t.name),ke(typeof w=="boolean",t,"internal-error"),ke(typeof C=="boolean",t,"internal-error"),Ia(m,t.name),Ia(g,t.name),Ia(v,t.name),Ia(x,t.name),Ia(S,t.name),Ia(y,t.name);const N=new Qs({uid:b,auth:t,email:f,emailVerified:w,displayName:h,isAnonymous:C,photoURL:g,phoneNumber:m,tenantId:v,stsTokenManager:L,createdAt:S,lastLoginAt:y});return I&&Array.isArray(I)&&(N.providerData=I.map(O=>Object.assign({},O))),x&&(N._redirectEventId=x),N}static async _fromIdTokenResponse(t,n,r=!1){const s=new Wc;s.updateFromServerResponse(n);const i=new Qs({uid:n.localId,auth:t,stsTokenManager:s,isAnonymous:r});return await Mh(i),i}static async _fromGetAccountInfoResponse(t,n,r){const s=n.users[0];ke(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?xF(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),l=new Wc;l.updateFromIdToken(r);const c=new Qs({uid:s.localId,auth:t,stsTokenManager:l,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new zw(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,d),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nP=new Map;function na(e){va(e instanceof Function,"Expected a class definition");let t=nP.get(e);return t?(va(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,nP.set(e,t),t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bF{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,n){this.storage[t]=n}async _get(t){const n=this.storage[t];return n===void 0?null:n}async _remove(t){delete this.storage[t]}_addListener(t,n){}_removeListener(t,n){}}bF.type="NONE";const rP=bF;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cm(e,t,n){return`firebase:${e}:${t}:${n}`}class Hc{constructor(t,n,r){this.persistence=t,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=cm(this.userKey,s.apiKey,i),this.fullPersistenceKey=cm("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);if(!t)return null;if(typeof t=="string"){const n=await pg(this.auth,{idToken:t}).catch(()=>{});return n?Qs._fromGetAccountInfoResponse(this.auth,n,t):null}return Qs._fromJSON(this.auth,t)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=t,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,n,r="authUser"){if(!n.length)return new Hc(na(rP),t,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||na(rP);const o=cm(r,t.config.apiKey,t.name);let l=null;for(const d of n)try{const u=await d._get(o);if(u){let h;if(typeof u=="string"){const f=await pg(t,{idToken:u}).catch(()=>{});if(!f)break;h=await Qs._fromGetAccountInfoResponse(t,f,u)}else h=Qs._fromJSON(t,u);d!==i&&(l=h),i=d;break}}catch{}const c=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new Hc(i,t,r):(i=c[0],l&&await i._set(o,l.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new Hc(i,t,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sP(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(TF(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(wF(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(EF(t))return"Blackberry";if(_F(t))return"Webos";if(SF(t))return"Safari";if((t.includes("chrome/")||kF(t))&&!t.includes("edge/"))return"Chrome";if(CF(t))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=e.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function wF(e=Ar()){return/firefox\//i.test(e)}function SF(e=Ar()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function kF(e=Ar()){return/crios\//i.test(e)}function TF(e=Ar()){return/iemobile/i.test(e)}function CF(e=Ar()){return/android/i.test(e)}function EF(e=Ar()){return/blackberry/i.test(e)}function _F(e=Ar()){return/webos/i.test(e)}function Pk(e=Ar()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Qee(e=Ar()){var t;return Pk(e)&&!!(!((t=window.navigator)===null||t===void 0)&&t.standalone)}function Jee(){return cZ()&&document.documentMode===10}function PF(e=Ar()){return Pk(e)||CF(e)||_F(e)||EF(e)||/windows phone/i.test(e)||TF(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NF(e,t=[]){let n;switch(e){case"Browser":n=sP(Ar());break;case"Worker":n=`${sP(Ar())}-${e}`;break;default:n=e}const r=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${Cf}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yee{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,n){const r=i=>new Promise((o,l)=>{try{const c=t(i);o(c)}catch(c){l(c)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const n=[];try{for(const r of this.queue)await r(t),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xee(e,t={}){return Ln(e,"GET","/v2/passwordPolicy",On(e,t))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zee=6;class ete{constructor(t){var n,r,s,i;const o=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:Zee,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=t.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=t.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=t.schemaVersion}validatePassword(t){var n,r,s,i,o,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,c),this.validatePasswordCharacterOptions(t,c),c.isValid&&(c.isValid=(n=c.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(s=c.containsLowercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(i=c.containsUppercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(t,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=t.length>=r),s&&(n.meetsMaxPasswordLength=t.length<=s)}validatePasswordCharacterOptions(t,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<t.length;s++)r=t.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(t,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tte{constructor(t,n,r,s){this.app=t,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new iP(this),this.idTokenSubscription=new iP(this),this.beforeStateQueue=new Yee(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=fF,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(t,n){return n&&(this._popupRedirectResolver=na(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await Hc.create(this,t),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!t)){if(this.currentUser&&t&&this.currentUser.uid===t.uid){this._currentUser._assign(t),await this.currentUser.getIdToken();return}await this._updateCurrentUser(t,!0)}}async initializeCurrentUserFromIdToken(t){try{const n=await pg(this,{idToken:t}),r=await Qs._fromGetAccountInfoResponse(this,n,t);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(t){var n;if(zn(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=s==null?void 0:s._redirectEventId,c=await this.tryRedirectSignIn(t);(!o||o===l)&&(c!=null&&c.user)&&(s=c.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return ke(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(t){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(t){try{await Mh(t)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=jee()}async _delete(){this._deleted=!0}async updateCurrentUser(t){if(zn(this.app))return Promise.reject(Ir(this));const n=t?zt(t):null;return n&&ke(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(t,n=!1){if(!this._deleted)return t&&ke(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(t),this.queue(async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()})}async signOut(){return zn(this.app)?Promise.reject(Ir(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(t){return zn(this.app)?Promise.reject(Ir(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(na(t))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(t)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await Xee(this),n=new ete(t);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(t){this._errorFactory=new Yd("auth","Firebase",t())}onAuthStateChanged(t,n,r){return this.registerStateListener(this.authStateSubscription,t,n,r)}beforeAuthStateChanged(t,n){return this.beforeStateQueue.pushCallback(t,n)}onIdTokenChanged(t,n,r){return this.registerStateListener(this.idTokenSubscription,t,n,r)}authStateReady(){return new Promise((t,n)=>{if(this.currentUser)t();else{const r=this.onAuthStateChanged(()=>{r(),t()},n)}})}async revokeAccessToken(t){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await Kee(this,r)}}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(t=this._currentUser)===null||t===void 0?void 0:t.toJSON()}}async _setRedirectUser(t,n){const r=await this.getOrInitRedirectPersistenceManager(n);return t===null?r.removeCurrentUser():r.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const n=t&&na(t)||this._popupRedirectResolver;ke(n,this,"argument-error"),this.redirectPersistenceManager=await Hc.create(this,[na(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===t?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(t))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(t=this.currentUser)===null||t===void 0?void 0:t.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(ke(l,this,"internal-error"),l.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const c=t.addObserver(n,r,s);return()=>{o=!0,c()}}else{const c=t.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return ke(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=NF(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var t;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((t=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||t===void 0?void 0:t.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var t;if(zn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const n=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||t===void 0?void 0:t.getToken());return n!=null&&n.error&&Aee(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Hn(e){return zt(e)}class iP{constructor(t){this.auth=t,this.observer=null,this.addObserver=mZ(n=>this.observer=n)}get next(){return ke(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function nte(e){Pf=e}function Nk(e){return Pf.loadJS(e)}function rte(){return Pf.recaptchaV2Script}function ste(){return Pf.recaptchaEnterpriseScript}function ite(){return Pf.gapiScript}function IF(e){return`__${e}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ate=500,ote=6e4,Cp=1e12;class lte{constructor(t){this.auth=t,this.counter=Cp,this._widgets=new Map}render(t,n){const r=this.counter;return this._widgets.set(r,new ute(t,this.auth.name,n||{})),this.counter++,r}reset(t){var n;const r=t||Cp;(n=this._widgets.get(r))===null||n===void 0||n.delete(),this._widgets.delete(r)}getResponse(t){var n;const r=t||Cp;return((n=this._widgets.get(r))===null||n===void 0?void 0:n.getResponse())||""}async execute(t){var n;const r=t||Cp;return(n=this._widgets.get(r))===null||n===void 0||n.execute(),""}}class cte{constructor(){this.enterprise=new dte}ready(t){t()}execute(t,n){return Promise.resolve("token")}render(t,n){return""}}class dte{ready(t){t()}execute(t,n){return Promise.resolve("token")}render(t,n){return""}}class ute{constructor(t,n,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const s=typeof t=="string"?document.getElementById(t):t;ke(s,"argument-error",{appName:n}),this.container=s,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=hte(50);const{callback:t,"expired-callback":n}=this.params;if(t)try{t(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,n)try{n()}catch{}this.isVisible&&this.execute()},ote)},ate))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function hte(e){const t=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<e;r++)t.push(n.charAt(Math.floor(Math.random()*n.length)));return t.join("")}const fte="recaptcha-enterprise",th="NO_RECAPTCHA";class AF{constructor(t){this.type=fte,this.auth=Hn(t)}async verify(t="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,l)=>{yF(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const d=new vF(c);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,o(d.siteKey)}}).catch(c=>{l(c)})})}function s(i,o,l){const c=window.grecaptcha;eP(c)?c.enterprise.ready(()=>{c.enterprise.execute(i,{action:t}).then(d=>{o(d)}).catch(()=>{o(th)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new cte().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(l=>{if(!n&&eP(window.grecaptcha))s(l,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=ste();c.length!==0&&(c+=l),Nk(c).then(()=>{s(l,i,o)}).catch(d=>{o(d)})}}).catch(l=>{o(l)})})}}async function Su(e,t,n,r=!1,s=!1){const i=new AF(e);let o;if(s)o=th;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const l=Object.assign({},t);if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in l){const c=l.phoneEnrollmentInfo.phoneNumber,d=l.phoneEnrollmentInfo.recaptchaToken;Object.assign(l,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in l){const c=l.phoneSignInInfo.recaptchaToken;Object.assign(l,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return l}return r?Object.assign(l,{captchaResp:o}):Object.assign(l,{captchaResponse:o}),Object.assign(l,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(l,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),l}async function vo(e,t,n,r,s){var i,o;if(s==="EMAIL_PASSWORD_PROVIDER")if(!((i=e._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await Su(e,t,n,n==="getOobCode");return r(e,l)}else return r(e,t).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await Su(e,t,n,n==="getOobCode");return r(e,c)}else return Promise.reject(l)});else if(s==="PHONE_PROVIDER")if(!((o=e._getRecaptchaConfig())===null||o===void 0)&&o.isProviderEnabled("PHONE_PROVIDER")){const l=await Su(e,t,n);return r(e,l).catch(async c=>{var d;if(((d=e._getRecaptchaConfig())===null||d===void 0?void 0:d.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&(c.code==="auth/missing-recaptcha-token"||c.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${n} flow.`);const u=await Su(e,t,n,!1,!0);return r(e,u)}return Promise.reject(c)})}else{const l=await Su(e,t,n,!1,!0);return r(e,l)}else return Promise.reject(s+" provider is not supported.")}async function pte(e){const t=Hn(e),n=await yF(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new vF(n);t.tenantId==null?t._agentRecaptchaConfig=r:t._tenantRecaptchaConfigs[t.tenantId]=r,r.isAnyProviderEnabled()&&new AF(t).verify()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mte(e,t){const n=lF(e,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(Nd(i,t??{}))return s;Rs(s,"already-initialized")}return n.initialize({options:t})}function gte(e,t){const n=(t==null?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(na);t!=null&&t.errorMap&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,t==null?void 0:t.popupRedirectResolver)}function vte(e,t,n){const r=Hn(e);ke(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const s=!1,i=RF(t),{host:o,port:l}=yte(t),c=l===null?"":`:${l}`,d={url:`${i}//${o}${c}/`},u=Object.freeze({host:o,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){ke(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),ke(Nd(d,r.config.emulator)&&Nd(u,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=u,r.settings.appVerificationDisabledForTesting=!0,Cv(o)?(tZ(`${i}//${o}${c}`),sZ("Auth",!0)):xte()}function RF(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function yte(e){const t=RF(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:aP(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:aP(o)}}}function aP(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}function xte(){function e(){const t=document.createElement("p"),n=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",e):e())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pv{constructor(t,n){this.providerId=t,this.signInMethod=n}toJSON(){return ta("not implemented")}_getIdTokenResponse(t){return ta("not implemented")}_linkToIdToken(t,n){return ta("not implemented")}_getReauthenticationResolver(t){return ta("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bte(e,t){return Ln(e,"POST","/v1/accounts:resetPassword",On(e,t))}async function wte(e,t){return Ln(e,"POST","/v1/accounts:update",t)}async function Ste(e,t){return Ln(e,"POST","/v1/accounts:signUp",t)}async function kte(e,t){return Ln(e,"POST","/v1/accounts:update",On(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tte(e,t){return wa(e,"POST","/v1/accounts:signInWithPassword",On(e,t))}async function Nv(e,t){return Ln(e,"POST","/v1/accounts:sendOobCode",On(e,t))}async function Cte(e,t){return Nv(e,t)}async function Ete(e,t){return Nv(e,t)}async function _te(e,t){return Nv(e,t)}async function Pte(e,t){return Nv(e,t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nte(e,t){return wa(e,"POST","/v1/accounts:signInWithEmailLink",On(e,t))}async function Ite(e,t){return wa(e,"POST","/v1/accounts:signInWithEmailLink",On(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dh extends Pv{constructor(t,n,r,s=null){super("password",r),this._email=t,this._password=n,this._tenantId=s}static _fromEmailAndPassword(t,n){return new Dh(t,n,"password")}static _fromEmailAndCode(t,n,r=null){return new Dh(t,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const n=typeof t=="string"?JSON.parse(t):t;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(t){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return vo(t,n,"signInWithPassword",Tte,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return Nte(t,{email:this._email,oobCode:this._password});default:Rs(t,"internal-error")}}async _linkToIdToken(t,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return vo(t,r,"signUpPassword",Ste,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return Ite(t,{idToken:n,email:this._email,oobCode:this._password});default:Rs(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qc(e,t){return wa(e,"POST","/v1/accounts:signInWithIdp",On(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ate="http://localhost";class ya extends Pv{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const n=new ya(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(n.idToken=t.idToken),t.accessToken&&(n.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(n.nonce=t.nonce),t.pendingToken&&(n.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(n.accessToken=t.oauthToken,n.secret=t.oauthTokenSecret):Rs("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const n=typeof t=="string"?JSON.parse(t):t,{providerId:r,signInMethod:s}=n,i=Ef(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new ya(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(t){const n=this.buildRequest();return qc(t,n)}_linkToIdToken(t,n){const r=this.buildRequest();return r.idToken=n,qc(t,r)}_getReauthenticationResolver(t){const n=this.buildRequest();return n.autoCreate=!1,qc(t,n)}buildRequest(){const t={requestUri:Ate,returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),t.postBody=Xd(n)}return t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oP(e,t){return Ln(e,"POST","/v1/accounts:sendVerificationCode",On(e,t))}async function Rte(e,t){return wa(e,"POST","/v1/accounts:signInWithPhoneNumber",On(e,t))}async function jte(e,t){const n=await wa(e,"POST","/v1/accounts:signInWithPhoneNumber",On(e,t));if(n.temporaryProof)throw Ou(e,"account-exists-with-different-credential",n);return n}const Mte={USER_NOT_FOUND:"user-not-found"};async function Dte(e,t){const n=Object.assign(Object.assign({},t),{operation:"REAUTH"});return wa(e,"POST","/v1/accounts:signInWithPhoneNumber",On(e,n),Mte)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nh extends Pv{constructor(t){super("phone","phone"),this.params=t}static _fromVerification(t,n){return new nh({verificationId:t,verificationCode:n})}static _fromTokenResponse(t,n){return new nh({phoneNumber:t,temporaryProof:n})}_getIdTokenResponse(t){return Rte(t,this._makeVerificationRequest())}_linkToIdToken(t,n){return jte(t,Object.assign({idToken:n},this._makeVerificationRequest()))}_getReauthenticationResolver(t){return Dte(t,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:t,phoneNumber:n,verificationId:r,verificationCode:s}=this.params;return t&&n?{temporaryProof:t,phoneNumber:n}:{sessionInfo:r,code:s}}toJSON(){const t={providerId:this.providerId};return this.params.phoneNumber&&(t.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(t.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(t.verificationCode=this.params.verificationCode),this.params.verificationId&&(t.verificationId=this.params.verificationId),t}static fromJSON(t){typeof t=="string"&&(t=JSON.parse(t));const{verificationId:n,verificationCode:r,phoneNumber:s,temporaryProof:i}=t;return!r&&!n&&!s&&!i?null:new nh({verificationId:n,verificationCode:r,phoneNumber:s,temporaryProof:i})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ote(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Lte(e){const t=Mu(Du(e)).link,n=t?Mu(Du(t)).deep_link_id:null,r=Mu(Du(e)).deep_link_id;return(r?Mu(Du(r)).link:null)||r||n||t||e}class Iv{constructor(t){var n,r,s,i,o,l;const c=Mu(Du(t)),d=(n=c.apiKey)!==null&&n!==void 0?n:null,u=(r=c.oobCode)!==null&&r!==void 0?r:null,h=Ote((s=c.mode)!==null&&s!==void 0?s:null);ke(d&&u&&h,"argument-error"),this.apiKey=d,this.operation=h,this.code=u,this.continueUrl=(i=c.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=c.lang)!==null&&o!==void 0?o:null,this.tenantId=(l=c.tenantId)!==null&&l!==void 0?l:null}static parseLink(t){const n=Lte(t);try{return new Iv(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tc{constructor(){this.providerId=tc.PROVIDER_ID}static credential(t,n){return Dh._fromEmailAndPassword(t,n)}static credentialWithLink(t,n){const r=Iv.parseLink(n);return ke(r,"argument-error"),Dh._fromEmailAndCode(t,r.code,r.tenantId)}}tc.PROVIDER_ID="password";tc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";tc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zd{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eu extends Zd{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}class dm extends eu{static credentialFromJSON(t){const n=typeof t=="string"?JSON.parse(t):t;return ke("providerId"in n&&"signInMethod"in n,"argument-error"),ya._fromParams(n)}credential(t){return this._credential(Object.assign(Object.assign({},t),{nonce:t.rawNonce}))}_credential(t){return ke(t.idToken||t.accessToken,"argument-error"),ya._fromParams(Object.assign(Object.assign({},t),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(t){return dm.oauthCredentialFromTaggedObject(t)}static credentialFromError(t){return dm.oauthCredentialFromTaggedObject(t.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r,oauthTokenSecret:s,pendingToken:i,nonce:o,providerId:l}=t;if(!r&&!s&&!n&&!i||!l)return null;try{return new dm(l)._credential({idToken:n,accessToken:r,nonce:o,pendingToken:i})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua extends eu{constructor(){super("facebook.com")}static credential(t){return ya._fromParams({providerId:Ua.PROVIDER_ID,signInMethod:Ua.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Ua.credentialFromTaggedObject(t)}static credentialFromError(t){return Ua.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return Ua.credential(t.oauthAccessToken)}catch{return null}}}Ua.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ua.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Va extends eu{constructor(){super("google.com"),this.addScope("profile")}static credential(t,n){return ya._fromParams({providerId:Va.PROVIDER_ID,signInMethod:Va.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:n})}static credentialFromResult(t){return Va.credentialFromTaggedObject(t)}static credentialFromError(t){return Va.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return Va.credential(n,r)}catch{return null}}}Va.GOOGLE_SIGN_IN_METHOD="google.com";Va.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ba extends eu{constructor(){super("github.com")}static credential(t){return ya._fromParams({providerId:Ba.PROVIDER_ID,signInMethod:Ba.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Ba.credentialFromTaggedObject(t)}static credentialFromError(t){return Ba.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return Ba.credential(t.oauthAccessToken)}catch{return null}}}Ba.GITHUB_SIGN_IN_METHOD="github.com";Ba.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class za extends eu{constructor(){super("twitter.com")}static credential(t,n){return ya._fromParams({providerId:za.PROVIDER_ID,signInMethod:za.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:n})}static credentialFromResult(t){return za.credentialFromTaggedObject(t)}static credentialFromError(t){return za.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=t;if(!n||!r)return null;try{return za.credential(n,r)}catch{return null}}}za.TWITTER_SIGN_IN_METHOD="twitter.com";za.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jF(e,t){return wa(e,"POST","/v1/accounts:signUp",On(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ei{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,n,r,s=!1){const i=await Qs._fromIdTokenResponse(t,r,s),o=lP(r);return new Ei({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(t,n,r){await t._updateTokensIfNecessary(r,!0);const s=lP(r);return new Ei({user:t,providerId:s,_tokenResponse:r,operationType:n})}}function lP(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sfe(e){var t;if(zn(e.app))return Promise.reject(Ir(e));const n=Hn(e);if(await n._initializationPromise,!((t=n.currentUser)===null||t===void 0)&&t.isAnonymous)return new Ei({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await jF(n,{returnSecureToken:!0}),s=await Ei._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mg extends Uo{constructor(t,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,mg.prototype),this.customData={appName:t.name,tenantId:(i=t.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(t,n,r,s){return new mg(t,n,r,s)}}function MF(e,t,n,r){return(t==="reauthenticate"?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?mg._fromErrorAndOperation(e,i,t,r):i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DF(e){return new Set(e.map(({providerId:t})=>t).filter(t=>!!t))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kfe(e,t){const n=zt(e);await Av(!0,n,t);const{providerUserInfo:r}=await Vee(n.auth,{idToken:await n.getIdToken(),deleteProvider:[t]}),s=DF(r||[]);return n.providerData=n.providerData.filter(i=>s.has(i.providerId)),s.has("phone")||(n.phoneNumber=null),await n.auth._persistUserIfCurrent(n),n}async function OF(e,t,n=!1){const r=await $l(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Ei._forOperation(e,"link",r)}async function Av(e,t,n){await Mh(t);const r=DF(t.providerData),s=e===!1?"provider-already-linked":"no-such-provider";ke(r.has(n)===e,t.auth,s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fte(e,t,n=!1){const{auth:r}=e;if(zn(r.app))return Promise.reject(Ir(r));const s="reauthenticate";try{const i=await $l(e,MF(r,s,t,e),n);ke(i.idToken,r,"internal-error");const o=_v(i.idToken);ke(o,r,"internal-error");const{sub:l}=o;return ke(e.uid===l,r,"user-mismatch"),Ei._forOperation(e,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Rs(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LF(e,t,n=!1){if(zn(e.app))return Promise.reject(Ir(e));const r="signIn",s=await MF(e,r,t),i=await Ei._fromIdTokenResponse(e,r,s);return n||await e._updateCurrentUser(i.user),i}async function Ik(e,t){return LF(Hn(e),t)}async function $te(e,t){const n=zt(e);return await Av(!1,n,t.providerId),OF(n,t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ute(e,t){return wa(e,"POST","/v1/accounts:signInWithCustomToken",On(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tfe(e,t){if(zn(e.app))return Promise.reject(Ir(e));const n=Hn(e),r=await Ute(n,{token:t,returnSecureToken:!0}),s=await Ei._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rv(e,t,n){var r;ke(((r=n.url)===null||r===void 0?void 0:r.length)>0,e,"invalid-continue-uri"),ke(typeof n.dynamicLinkDomain>"u"||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),ke(typeof n.linkDomain>"u"||n.linkDomain.length>0,e,"invalid-hosting-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.linkDomain=n.linkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(ke(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(ke(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ak(e){const t=Hn(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}async function Cfe(e,t,n){const r=Hn(e),s={requestType:"PASSWORD_RESET",email:t,clientType:"CLIENT_TYPE_WEB"};n&&Rv(r,s,n),await vo(r,s,"getOobCode",Ete,"EMAIL_PASSWORD_PROVIDER")}async function Efe(e,t,n){await bte(zt(e),{oobCode:t,newPassword:n}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Ak(e),r})}async function _fe(e,t){await kte(zt(e),{oobCode:t})}async function Pfe(e,t,n){if(zn(e.app))return Promise.reject(Ir(e));const r=Hn(e),o=await vo(r,{returnSecureToken:!0,email:t,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",jF,"EMAIL_PASSWORD_PROVIDER").catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&Ak(e),c}),l=await Ei._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(l.user),l}function Nfe(e,t,n){return zn(e.app)?Promise.reject(Ir(e)):Ik(zt(e),tc.credential(t,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Ak(e),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ife(e,t,n){const r=Hn(e),s={requestType:"EMAIL_SIGNIN",email:t,clientType:"CLIENT_TYPE_WEB"};function i(o,l){ke(l.handleCodeInApp,r,"argument-error"),l&&Rv(r,o,l)}i(s,n),await vo(r,s,"getOobCode",_te,"EMAIL_PASSWORD_PROVIDER")}function Afe(e,t){const n=Iv.parseLink(t);return(n==null?void 0:n.operation)==="EMAIL_SIGNIN"}async function Rfe(e,t,n){if(zn(e.app))return Promise.reject(Ir(e));const r=zt(e),s=tc.credentialWithLink(t,n||jh());return ke(s._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),Ik(r,s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vte(e,t){return Ln(e,"POST","/v1/accounts:createAuthUri",On(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jfe(e,t){const n=Ek()?jh():"http://localhost",r={identifier:t,continueUri:n},{signinMethods:s}=await Vte(zt(e),r);return s||[]}async function Mfe(e,t){const n=zt(e),s={requestType:"VERIFY_EMAIL",idToken:await e.getIdToken()};t&&Rv(n.auth,s,t);const{email:i}=await Cte(n.auth,s);i!==e.email&&await e.reload()}async function Dfe(e,t,n){const r=zt(e),i={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await e.getIdToken(),newEmail:t};n&&Rv(r.auth,i,n);const{email:o}=await Pte(r.auth,i);o!==e.email&&await e.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bte(e,t){return Ln(e,"POST","/v1/accounts:update",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ofe(e,{displayName:t,photoURL:n}){if(t===void 0&&n===void 0)return;const r=zt(e),i={idToken:await r.getIdToken(),displayName:t,photoUrl:n,returnSecureToken:!0},o=await $l(r,Bte(r.auth,i));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const l=r.providerData.find(({providerId:c})=>c==="password");l&&(l.displayName=r.displayName,l.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function Lfe(e,t){const n=zt(e);return zn(n.auth.app)?Promise.reject(Ir(n.auth)):FF(n,t,null)}function Ffe(e,t){return FF(zt(e),null,t)}async function FF(e,t,n){const{auth:r}=e,i={idToken:await e.getIdToken(),returnSecureToken:!0};t&&(i.email=t),n&&(i.password=n);const o=await $l(e,wte(r,i));await e._updateTokensIfNecessary(o,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zte(e){var t,n;if(!e)return null;const{providerId:r}=e,s=e.rawUserInfo?JSON.parse(e.rawUserInfo):{},i=e.isNewUser||e.kind==="identitytoolkit#SignupNewUserResponse";if(!r&&(e!=null&&e.idToken)){const o=(n=(t=_v(e.idToken))===null||t===void 0?void 0:t.firebase)===null||n===void 0?void 0:n.sign_in_provider;if(o){const l=o!=="anonymous"&&o!=="custom"?o:null;return new Kc(i,l)}}if(!r)return null;switch(r){case"facebook.com":return new Gte(i,s);case"github.com":return new Wte(i,s);case"google.com":return new Hte(i,s);case"twitter.com":return new qte(i,s,e.screenName||null);case"custom":case"anonymous":return new Kc(i,null);default:return new Kc(i,r,s)}}class Kc{constructor(t,n,r={}){this.isNewUser=t,this.providerId=n,this.profile=r}}class $F extends Kc{constructor(t,n,r,s){super(t,n,r),this.username=s}}class Gte extends Kc{constructor(t,n){super(t,"facebook.com",n)}}class Wte extends $F{constructor(t,n){super(t,"github.com",n,typeof(n==null?void 0:n.login)=="string"?n==null?void 0:n.login:null)}}class Hte extends Kc{constructor(t,n){super(t,"google.com",n)}}class qte extends $F{constructor(t,n,r){super(t,"twitter.com",n,r)}}function $fe(e){const{user:t,_tokenResponse:n}=e;return t.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:zte(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ufe(e,t){return zt(e).setPersistence(t)}function Kte(e,t,n,r){return zt(e).onIdTokenChanged(t,n,r)}function Qte(e,t,n){return zt(e).beforeAuthStateChanged(t,n)}function Vfe(e,t){return Hn(e).revokeAccessToken(t)}async function Bfe(e){return zt(e).delete()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cP(e,t){return Ln(e,"POST","/v2/accounts/mfaEnrollment:start",On(e,t))}const gg="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UF{constructor(t,n){this.storageRetriever=t,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(gg,"1"),this.storage.removeItem(gg),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,n){return this.storage.setItem(t,JSON.stringify(n)),Promise.resolve()}_get(t){const n=this.storage.getItem(t);return Promise.resolve(n?JSON.parse(n):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jte=1e3,Yte=10;class VF extends UF{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,n)=>this.onStorageEvent(t,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=PF(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&t(n,s,r)}}onStorageEvent(t,n=!1){if(!t.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const r=t.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);Jee()&&i!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,Yte):s()}notifyListeners(t,n){this.localCache[t]=n;const r=this.listeners[t];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:n,newValue:r}),!0)})},Jte)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(n)}_removeListener(t,n){this.listeners[t]&&(this.listeners[t].delete(n),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,n){await super._set(t,n),this.localCache[t]=JSON.stringify(n)}async _get(t){const n=await super._get(t);return this.localCache[t]=JSON.stringify(n),n}async _remove(t){await super._remove(t),delete this.localCache[t]}}VF.type="LOCAL";const Xte=VF;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BF extends UF{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,n){}_removeListener(t,n){}}BF.type="SESSION";const zF=BF;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zte(e){return Promise.all(e.map(async t=>{try{return{fulfilled:!0,value:await t}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jv{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const n=this.receivers.find(s=>s.isListeningto(t));if(n)return n;const r=new jv(t);return this.receivers.push(r),r}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const n=t,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(o).map(async d=>d(n.origin,i)),c=await Zte(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:c})}_subscribe(t,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(n)}_unsubscribe(t,n){this.handlersMap[t]&&n&&this.handlersMap[t].delete(n),(!n||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}jv.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mv(e="",t=10){let n="";for(let r=0;r<t;r++)n+=Math.floor(Math.random()*10);return e+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ene{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((l,c)=>{const d=Mv("",20);s.port1.start();const u=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(h){const f=h;if(f.data.eventId===d)switch(f.data.status){case"ack":clearTimeout(u),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(f.data.response);break;default:clearTimeout(u),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:t,eventId:d,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bn(){return window}function tne(e){bn().location.href=e}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rk(){return typeof bn().WorkerGlobalScope<"u"&&typeof bn().importScripts=="function"}async function nne(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function rne(){var e;return((e=navigator==null?void 0:navigator.serviceWorker)===null||e===void 0?void 0:e.controller)||null}function sne(){return Rk()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GF="firebaseLocalStorageDb",ine=1,vg="firebaseLocalStorage",WF="fbase_key";class Nf{constructor(t){this.request=t}toPromise(){return new Promise((t,n)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Dv(e,t){return e.transaction([vg],t?"readwrite":"readonly").objectStore(vg)}function ane(){const e=indexedDB.deleteDatabase(GF);return new Nf(e).toPromise()}function Gw(){const e=indexedDB.open(GF,ine);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const r=e.result;try{r.createObjectStore(vg,{keyPath:WF})}catch(s){n(s)}}),e.addEventListener("success",async()=>{const r=e.result;r.objectStoreNames.contains(vg)?t(r):(r.close(),await ane(),t(await Gw()))})})}async function dP(e,t,n){const r=Dv(e,!0).put({[WF]:t,value:n});return new Nf(r).toPromise()}async function one(e,t){const n=Dv(e,!1).get(t),r=await new Nf(n).toPromise();return r===void 0?null:r.value}function uP(e,t){const n=Dv(e,!0).delete(t);return new Nf(n).toPromise()}const lne=800,cne=3;class HF{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Gw(),this.db)}async _withRetries(t){let n=0;for(;;)try{const r=await this._openDb();return await t(r)}catch(r){if(n++>cne)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Rk()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=jv._getInstance(sne()),this.receiver._subscribe("keyChanged",async(t,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(t,n)=>["keyChanged"])}async initializeSender(){var t,n;if(this.activeServiceWorker=await nne(),!this.activeServiceWorker)return;this.sender=new ene(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((t=r[0])===null||t===void 0)&&t.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||rne()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await Gw();return await dP(t,gg,"1"),await uP(t,gg),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>dP(r,t,n)),this.localCache[t]=n,this.notifyServiceWorker(t)))}async _get(t){const n=await this._withRetries(r=>one(r,t));return this.localCache[t]=n,n}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(n=>uP(n,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){const t=await this._withRetries(s=>{const i=Dv(s,!1).getAll();return new Nf(i).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(t.length!==0)for(const{fbase_key:s,value:i}of t)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(t,n){this.localCache[t]=n;const r=this.listeners[t];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),lne)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(n)}_removeListener(t,n){this.listeners[t]&&(this.listeners[t].delete(n),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}HF.type="LOCAL";const dne=HF;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hP(e,t){return Ln(e,"POST","/v2/accounts/mfaSignIn:start",On(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yx=IF("rcb"),une=new _f(3e4,6e4);class hne{constructor(){var t;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((t=bn().grecaptcha)===null||t===void 0)&&t.render)}load(t,n=""){return ke(fne(n),t,"argument-error"),this.shouldResolveImmediately(n)&&Z_(bn().grecaptcha)?Promise.resolve(bn().grecaptcha):new Promise((r,s)=>{const i=bn().setTimeout(()=>{s(Hr(t,"network-request-failed"))},une.get());bn()[yx]=()=>{bn().clearTimeout(i),delete bn()[yx];const l=bn().grecaptcha;if(!l||!Z_(l)){s(Hr(t,"internal-error"));return}const c=l.render;l.render=(d,u)=>{const h=c(d,u);return this.counter++,h},this.hostLanguage=n,r(l)};const o=`${rte()}?${Xd({onload:yx,render:"explicit",hl:n})}`;Nk(o).catch(()=>{clearTimeout(i),s(Hr(t,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(t){var n;return!!(!((n=bn().grecaptcha)===null||n===void 0)&&n.render)&&(t===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function fne(e){return e.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(e)}class pne{async load(t){return new lte(t)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rh="recaptcha",mne={theme:"light",type:"image"};class gne{constructor(t,n,r=Object.assign({},mne)){this.parameters=r,this.type=rh,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Hn(t),this.isInvisible=this.parameters.size==="invisible",ke(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const s=typeof n=="string"?document.getElementById(n):n;ke(s,this.auth,"argument-error"),this.container=s,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new pne:new hne,this.validateStartingState()}async verify(){this.assertNotDestroyed();const t=await this.render(),n=this.getAssertedRecaptcha(),r=n.getResponse(t);return r||new Promise(s=>{const i=o=>{o&&(this.tokenChangeListeners.delete(i),s(o))};this.tokenChangeListeners.add(i),this.isInvisible&&n.execute(t)})}render(){try{this.assertNotDestroyed()}catch(t){return Promise.reject(t)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(t=>{throw this.renderPromise=null,t}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(t=>{this.container.removeChild(t)})}validateStartingState(){ke(!this.parameters.sitekey,this.auth,"argument-error"),ke(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),ke(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(t){return n=>{if(this.tokenChangeListeners.forEach(r=>r(n)),typeof t=="function")t(n);else if(typeof t=="string"){const r=bn()[t];typeof r=="function"&&r(n)}}}assertNotDestroyed(){ke(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let t=this.container;if(!this.isInvisible){const n=document.createElement("div");t.appendChild(n),t=n}this.widgetId=this.getAssertedRecaptcha().render(t,this.parameters)}return this.widgetId}async init(){ke(Ek()&&!Rk(),this.auth,"internal-error"),await vne(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const t=await $ee(this.auth);ke(t,this.auth,"internal-error"),this.parameters.sitekey=t}getAssertedRecaptcha(){return ke(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}function vne(){let e=null;return new Promise(t=>{if(document.readyState==="complete"){t();return}e=()=>t(),window.addEventListener("load",e)}).catch(t=>{throw e&&window.removeEventListener("load",e),t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qF{constructor(t,n){this.verificationId=t,this.onConfirmation=n}confirm(t){const n=nh._fromVerification(this.verificationId,t);return this.onConfirmation(n)}}async function yne(e,t,n){if(zn(e.app))return Promise.reject(Ir(e));const r=Hn(e),s=await KF(r,t,zt(n));return new qF(s,i=>Ik(r,i))}async function zfe(e,t,n){const r=zt(e);await Av(!1,r,"phone");const s=await KF(r.auth,t,zt(n));return new qF(s,i=>$te(r,i))}async function KF(e,t,n){var r;if(!e._getRecaptchaConfig())try{await pte(e)}catch{console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let s;if(typeof t=="string"?s={phoneNumber:t}:s=t,"session"in s){const i=s.session;if("phoneNumber"in s){ke(i.type==="enroll",e,"internal-error");const o={idToken:i.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,clientType:"CLIENT_TYPE_WEB"}};return(await vo(e,o,"mfaSmsEnrollment",async(u,h)=>{if(h.phoneEnrollmentInfo.captchaResponse===th){ke((n==null?void 0:n.type)===rh,u,"argument-error");const f=await xx(u,h,n);return cP(u,f)}return cP(u,h)},"PHONE_PROVIDER").catch(u=>Promise.reject(u))).phoneSessionInfo.sessionInfo}else{ke(i.type==="signin",e,"internal-error");const o=((r=s.multiFactorHint)===null||r===void 0?void 0:r.uid)||s.multiFactorUid;ke(o,e,"missing-multi-factor-info");const l={mfaPendingCredential:i.credential,mfaEnrollmentId:o,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}};return(await vo(e,l,"mfaSmsSignIn",async(h,f)=>{if(f.phoneSignInInfo.captchaResponse===th){ke((n==null?void 0:n.type)===rh,h,"argument-error");const m=await xx(h,f,n);return hP(h,m)}return hP(h,f)},"PHONE_PROVIDER").catch(h=>Promise.reject(h))).phoneResponseInfo.sessionInfo}}else{const i={phoneNumber:s.phoneNumber,clientType:"CLIENT_TYPE_WEB"};return(await vo(e,i,"sendVerificationCode",async(d,u)=>{if(u.captchaResponse===th){ke((n==null?void 0:n.type)===rh,d,"argument-error");const h=await xx(d,u,n);return oP(d,h)}return oP(d,u)},"PHONE_PROVIDER").catch(d=>Promise.reject(d))).sessionInfo}}finally{n==null||n._reset()}}async function xx(e,t,n){ke(n.type===rh,e,"argument-error");const r=await n.verify();ke(typeof r=="string",e,"argument-error");const s=Object.assign({},t);if("phoneEnrollmentInfo"in s){const i=s.phoneEnrollmentInfo.phoneNumber,o=s.phoneEnrollmentInfo.captchaResponse,l=s.phoneEnrollmentInfo.clientType,c=s.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(s,{phoneEnrollmentInfo:{phoneNumber:i,recaptchaToken:r,captchaResponse:o,clientType:l,recaptchaVersion:c}}),s}else if("phoneSignInInfo"in s){const i=s.phoneSignInInfo.captchaResponse,o=s.phoneSignInInfo.clientType,l=s.phoneSignInInfo.recaptchaVersion;return Object.assign(s,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:i,clientType:o,recaptchaVersion:l}}),s}else return Object.assign(s,{recaptchaToken:r}),s}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function If(e,t){return t?na(t):(ke(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jk extends Pv{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return qc(t,this._buildIdpRequest())}_linkToIdToken(t,n){return qc(t,this._buildIdpRequest(n))}_getReauthenticationResolver(t){return qc(t,this._buildIdpRequest())}_buildIdpRequest(t){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(n.idToken=t),n}}function xne(e){return LF(e.auth,new jk(e),e.bypassAuthState)}function bne(e){const{auth:t,user:n}=e;return ke(n,t,"internal-error"),Fte(n,new jk(e),e.bypassAuthState)}async function wne(e){const{auth:t,user:n}=e;return ke(n,t,"internal-error"),OF(n,new jk(e),e.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QF{constructor(t,n,r,s,i=!1){this.auth=t,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(t,n)=>{this.pendingPromise={resolve:t,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(t){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:l}=t;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(d){this.reject(d)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return xne;case"linkViaPopup":case"linkViaRedirect":return wne;case"reauthViaPopup":case"reauthViaRedirect":return bne;default:Rs(this.auth,"internal-error")}}resolve(t){va(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){va(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sne=new _f(2e3,1e4);async function Gfe(e,t,n){if(zn(e.app))return Promise.reject(Hr(e,"operation-not-supported-in-this-environment"));const r=Hn(e);Ev(e,t,Zd);const s=If(r,n);return new to(r,"signInViaPopup",t,s).executeNotNull()}async function Wfe(e,t,n){const r=zt(e);Ev(r.auth,t,Zd);const s=If(r.auth,n);return new to(r.auth,"linkViaPopup",t,s,r).executeNotNull()}class to extends QF{constructor(t,n,r,s,i){super(t,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,to.currentPopupAction&&to.currentPopupAction.cancel(),to.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return ke(t,this.auth,"internal-error"),t}async onExecution(){va(this.filter.length===1,"Popup operations only handle one event");const t=Mv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Hr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var t;return((t=this.authWindow)===null||t===void 0?void 0:t.associatedEvent)||null}cancel(){this.reject(Hr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,to.currentPopupAction=null}pollUserCancellation(){const t=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Hr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,Sne.get())};t()}}to.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kne="pendingRedirect",um=new Map;class Tne extends QF{constructor(t,n,r=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let t=um.get(this.auth._key());if(!t){try{const r=await Cne(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(r)}catch(n){t=()=>Promise.reject(n)}um.set(this.auth._key(),t)}return this.bypassAuthState||um.set(this.auth._key(),()=>Promise.resolve(null)),t()}async onAuthEvent(t){if(t.type==="signInViaRedirect")return super.onAuthEvent(t);if(t.type==="unknown"){this.resolve(null);return}if(t.eventId){const n=await this.auth._redirectUserForId(t.eventId);if(n)return this.user=n,super.onAuthEvent(t);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Cne(e,t){const n=XF(t),r=YF(e);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}async function JF(e,t){return YF(e)._set(XF(t),"true")}function Ene(e,t){um.set(e._key(),t)}function YF(e){return na(e._redirectPersistence)}function XF(e){return cm(kne,e.config.apiKey,e.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hfe(e,t,n){return _ne(e,t,n)}async function _ne(e,t,n){if(zn(e.app))return Promise.reject(Ir(e));const r=Hn(e);Ev(e,t,Zd),await r._initializationPromise;const s=If(r,n);return await JF(s,r),s._openRedirect(r,t,"signInViaRedirect")}function qfe(e,t,n){return Pne(e,t,n)}async function Pne(e,t,n){const r=zt(e);Ev(r.auth,t,Zd),await r.auth._initializationPromise;const s=If(r.auth,n);await Av(!1,r,t.providerId),await JF(s,r.auth);const i=await Nne(r);return s._openRedirect(r.auth,t,"linkViaRedirect",i)}async function Kfe(e,t){return await Hn(e)._initializationPromise,ZF(e,t,!1)}async function ZF(e,t,n=!1){if(zn(e.app))return Promise.reject(Ir(e));const r=Hn(e),s=If(r,t),o=await new Tne(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,t)),o}async function Nne(e){const t=Mv(`${e.uid}:::`);return e._redirectEventId=t,await e.auth._setRedirectUser(e),await e.auth._persistUserIfCurrent(e),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ine=10*60*1e3;class Ane{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(t,r)&&(n=!0,this.sendToConsumer(t,r),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!Rne(t)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=t,n=!0)),n}sendToConsumer(t,n){var r;if(t.error&&!e4(t)){const s=((r=t.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Hr(this.auth,s))}else n.onAuthEvent(t)}isEventForConsumer(t,n){const r=n.eventId===null||!!t.eventId&&t.eventId===n.eventId;return n.filter.includes(t.type)&&r}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=Ine&&this.cachedEventUids.clear(),this.cachedEventUids.has(fP(t))}saveEventToCache(t){this.cachedEventUids.add(fP(t)),this.lastProcessedEventTime=Date.now()}}function fP(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(t=>t).join("-")}function e4({type:e,error:t}){return e==="unknown"&&(t==null?void 0:t.code)==="auth/no-auth-event"}function Rne(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return e4(e);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jne(e,t={}){return Ln(e,"GET","/v1/projects",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mne=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Dne=/^https?/;async function One(e){if(e.config.emulator)return;const{authorizedDomains:t}=await jne(e);for(const n of t)try{if(Lne(n))return}catch{}Rs(e,"unauthorized-domain")}function Lne(e){const t=jh(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const o=new URL(e);return o.hostname===""&&r===""?n==="chrome-extension:"&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!Dne.test(n))return!1;if(Mne.test(e))return r===e;const s=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fne=new _f(3e4,6e4);function pP(){const e=bn().___jsl;if(e!=null&&e.H){for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}}function $ne(e){return new Promise((t,n)=>{var r,s,i;function o(){pP(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{pP(),n(Hr(e,"network-request-failed"))},timeout:Fne.get()})}if(!((s=(r=bn().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)t(gapi.iframes.getContext());else if(!((i=bn().gapi)===null||i===void 0)&&i.load)o();else{const l=IF("iframefcb");return bn()[l]=()=>{gapi.load?o():n(Hr(e,"network-request-failed"))},Nk(`${ite()}?onload=${l}`).catch(c=>n(c))}}).catch(t=>{throw hm=null,t})}let hm=null;function Une(e){return hm=hm||$ne(e),hm}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vne=new _f(5e3,15e3),Bne="__/auth/iframe",zne="emulator/auth/iframe",Gne={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Wne=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Hne(e){const t=e.config;ke(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?_k(t,zne):`https://${e.config.authDomain}/${Bne}`,r={apiKey:t.apiKey,appName:e.name,v:Cf},s=Wne.get(e.config.apiHost);s&&(r.eid=s);const i=e._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Xd(r).slice(1)}`}async function qne(e){const t=await Une(e),n=bn().gapi;return ke(n,e,"internal-error"),t.open({where:document.body,url:Hne(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Gne,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Hr(e,"network-request-failed"),l=bn().setTimeout(()=>{i(o)},Vne.get());function c(){bn().clearTimeout(l),s(r)}r.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kne={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Qne=500,Jne=600,Yne="_blank",Xne="http://localhost";class mP{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Zne(e,t,n,r=Qne,s=Jne){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const c=Object.assign(Object.assign({},Kne),{width:r.toString(),height:s.toString(),top:i,left:o}),d=Ar().toLowerCase();n&&(l=kF(d)?Yne:n),wF(d)&&(t=t||Xne,c.scrollbars="yes");const u=Object.entries(c).reduce((f,[m,g])=>`${f}${m}=${g},`,"");if(Qee(d)&&l!=="_self")return ere(t||"",l),new mP(null);const h=window.open(t||"",l,u);ke(h,e,"popup-blocked");try{h.focus()}catch{}return new mP(h)}function ere(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tre="__/auth/handler",nre="emulator/auth/handler",rre=encodeURIComponent("fac");async function gP(e,t,n,r,s,i){ke(e.config.authDomain,e,"auth-domain-config-required"),ke(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:Cf,eventId:s};if(t instanceof Zd){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",pZ(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[u,h]of Object.entries({}))o[u]=h}if(t instanceof eu){const u=t.getScopes().filter(h=>h!=="");u.length>0&&(o.scopes=u.join(","))}e.tenantId&&(o.tid=e.tenantId);const l=o;for(const u of Object.keys(l))l[u]===void 0&&delete l[u];const c=await e._getAppCheckToken(),d=c?`#${rre}=${encodeURIComponent(c)}`:"";return`${sre(e)}?${Xd(l).slice(1)}${d}`}function sre({config:e}){return e.emulator?_k(e,nre):`https://${e.authDomain}/${tre}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bx="webStorageSupport";class ire{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=zF,this._completeRedirectFn=ZF,this._overrideRedirectResult=Ene}async _openPopup(t,n,r,s){var i;va((i=this.eventManagers[t._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await gP(t,n,r,jh(),s);return Zne(t,o,Mv())}async _openRedirect(t,n,r,s){await this._originValidation(t);const i=await gP(t,n,r,jh(),s);return tne(i),new Promise(()=>{})}_initialize(t){const n=t._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(va(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(t);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(t){const n=await qne(t),r=new Ane(t);return n.register("authEvent",s=>(ke(s==null?void 0:s.authEvent,t,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:r},this.iframes[t._key()]=n,r}_isIframeWebStorageSupported(t,n){this.iframes[t._key()].send(bx,{type:bx},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[bx];o!==void 0&&n(!!o),Rs(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const n=t._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=One(t)),this.originValidationPromises[n]}get _shouldInitProactively(){return PF()||SF()||Pk()}}const are=ire;var vP="@firebase/auth",yP="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ore{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),((t=this.auth.currentUser)===null||t===void 0?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const n=this.auth.onIdTokenChanged(r=>{t((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(t,n),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const n=this.internalListeners.get(t);n&&(this.internalListeners.delete(t),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ke(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lre(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function cre(e){Fl(new Po("auth",(t,{options:n})=>{const r=t.getProvider("app").getImmediate(),s=t.getProvider("heartbeat"),i=t.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;ke(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:l,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:NF(e)},d=new tte(r,s,i,c);return gte(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,n,r)=>{t.getProvider("auth-internal").initialize()})),Fl(new Po("auth-internal",t=>{const n=Hn(t.getProvider("auth").getImmediate());return(r=>new ore(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),kl(vP,yP,lre(e)),kl(vP,yP,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dre=5*60,ure=sF("authIdTokenMaxAge")||dre;let xP=null;const hre=e=>async t=>{const n=t&&await t.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>ure)return;const s=n==null?void 0:n.token;xP!==s&&(xP=s,await fetch(e,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function fre(e=gee()){const t=lF(e,"auth");if(t.isInitialized())return t.getImmediate();const n=mte(e,{popupRedirectResolver:are,persistence:[dne,Xte,zF]}),r=sF("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=hre(i.toString());Qte(n,o,()=>o(n.currentUser)),Kte(n,l=>o(l))}}const s=eZ("auth");return s&&vte(n,`http://${s}`),n}function pre(){var e,t;return(t=(e=document.getElementsByTagName("head"))===null||e===void 0?void 0:e[0])!==null&&t!==void 0?t:document}nte({loadJS(e){return new Promise((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=s=>{const i=Hr("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",pre().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});cre("Browser");/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mre=new Map,gre={activated:!1,tokenObservers:[]};function ii(e){return mre.get(e)||Object.assign({},gre)}const bP={RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vre{constructor(t,n,r,s,i){if(this.operation=t,this.retryPolicy=n,this.getWaitDuration=r,this.lowerBound=s,this.upperBound=i,this.pending=null,this.nextErrorWaitInterval=s,s>i)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}async process(t){this.stop();try{this.pending=new Lw,this.pending.promise.catch(n=>{}),await yre(this.getNextRun(t)),this.pending.resolve(),await this.pending.promise,this.pending=new Lw,this.pending.promise.catch(n=>{}),await this.operation(),this.pending.resolve(),await this.pending.promise,this.process(!0).catch(()=>{})}catch(n){this.retryPolicy(n)?this.process(!1).catch(()=>{}):this.stop()}}getNextRun(t){if(t)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const n=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),n}}}function yre(e){return new Promise(t=>{setTimeout(t,e)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xre={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.","initial-throttle":"{$httpStatus} error. Attempts allowed again after {$time}",throttled:"Requests throttled due to previous {$httpStatus} error. Attempts allowed again after {$time}"},yg=new Yd("appCheck","AppCheck",xre);function t4(e){if(!ii(e).activated)throw yg.create("use-before-activation",{appName:e.name})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bre="firebase-app-check-database",wre=1,Ww="firebase-app-check-store";let Ep=null;function Sre(){return Ep||(Ep=new Promise((e,t)=>{try{const n=indexedDB.open(bre,wre);n.onsuccess=r=>{e(r.target.result)},n.onerror=r=>{var s;t(yg.create("storage-open",{originalErrorMessage:(s=r.target.error)===null||s===void 0?void 0:s.message}))},n.onupgradeneeded=r=>{const s=r.target.result;switch(r.oldVersion){case 0:s.createObjectStore(Ww,{keyPath:"compositeKey"})}}}catch(n){t(yg.create("storage-open",{originalErrorMessage:n==null?void 0:n.message}))}}),Ep)}function kre(e,t){return Tre(Cre(e),t)}async function Tre(e,t){const r=(await Sre()).transaction(Ww,"readwrite"),i=r.objectStore(Ww).put({compositeKey:e,value:t});return new Promise((o,l)=>{i.onsuccess=c=>{o()},r.onerror=c=>{var d;l(yg.create("storage-set",{originalErrorMessage:(d=c.target.error)===null||d===void 0?void 0:d.message}))}})}function Cre(e){return`${e.options.appId}-${e.name}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hw=new Sk("@firebase/app-check");function wP(e,t){return iF()?kre(e,t).catch(n=>{Hw.warn(`Failed to write token to IndexedDB. Error: ${n}`)}):Promise.resolve()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ere={error:"UNKNOWN_ERROR"};function _re(e){return bk.encodeString(JSON.stringify(e),!1)}async function qw(e,t=!1,n=!1){const r=e.app;t4(r);const s=ii(r);let i=s.token,o;if(i&&!Lu(i)&&(s.token=void 0,i=void 0),!i){const d=await s.cachedTokenPromise;d&&(Lu(d)?i=d:await wP(r,void 0))}if(!t&&i&&Lu(i))return{token:i.token};let l=!1;try{s.exchangeTokenPromise||(s.exchangeTokenPromise=s.provider.getToken().finally(()=>{s.exchangeTokenPromise=void 0}),l=!0),i=await ii(r).exchangeTokenPromise}catch(d){d.code==="appCheck/throttled"||d.code==="appCheck/initial-throttle"?Hw.warn(d.message):n&&Hw.error(d),o=d}let c;return i?o?Lu(i)?c={token:i.token,internalError:o}:c=kP(o):(c={token:i.token},s.token=i,await wP(r,i)):c=kP(o),l&&Are(r,c),c}async function Pre(e){const t=e.app;t4(t);const{provider:n}=ii(t);{const{token:r}=await n.getToken();return{token:r}}}function Nre(e,t,n,r){const{app:s}=e,i=ii(s),o={next:n,error:r,type:t};if(i.tokenObservers=[...i.tokenObservers,o],i.token&&Lu(i.token)){const l=i.token;Promise.resolve().then(()=>{n({token:l.token}),SP(e)}).catch(()=>{})}i.cachedTokenPromise.then(()=>SP(e))}function n4(e,t){const n=ii(e),r=n.tokenObservers.filter(s=>s.next!==t);r.length===0&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),n.tokenObservers=r}function SP(e){const{app:t}=e,n=ii(t);let r=n.tokenRefresher;r||(r=Ire(e),n.tokenRefresher=r),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function Ire(e){const{app:t}=e;return new vre(async()=>{const n=ii(t);let r;if(n.token?r=await qw(e,!0):r=await qw(e),r.error)throw r.error;if(r.internalError)throw r.internalError},()=>!0,()=>{const n=ii(t);if(n.token){let r=n.token.issuedAtTimeMillis+(n.token.expireTimeMillis-n.token.issuedAtTimeMillis)*.5+3e5;const s=n.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,s),Math.max(0,r-Date.now())}else return 0},bP.RETRIAL_MIN_WAIT,bP.RETRIAL_MAX_WAIT)}function Are(e,t){const n=ii(e).tokenObservers;for(const r of n)try{r.type==="EXTERNAL"&&t.error!=null?r.error(t.error):r.next(t)}catch{}}function Lu(e){return e.expireTimeMillis-Date.now()>0}function kP(e){return{token:_re(Ere),error:e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rre{constructor(t,n){this.app=t,this.heartbeatServiceProvider=n}_delete(){const{tokenObservers:t}=ii(this.app);for(const n of t)n4(this.app,n.next);return Promise.resolve()}}function jre(e,t){return new Rre(e,t)}function Mre(e){return{getToken:t=>qw(e,t),getLimitedUseToken:()=>Pre(e),addTokenListener:t=>Nre(e,"INTERNAL",t),removeTokenListener:t=>n4(e.app,t)}}const Dre="@firebase/app-check",Ore="0.10.1",Lre="app-check",TP="app-check-internal";function Fre(){Fl(new Po(Lre,e=>{const t=e.getProvider("app").getImmediate(),n=e.getProvider("heartbeat");return jre(t,n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider(TP).initialize()})),Fl(new Po(TP,e=>{const t=e.getProvider("app-check").getImmediate();return Mre(t)},"PUBLIC").setInstantiationMode("EXPLICIT")),kl(Dre,Ore)}Fre();const r4={apiKey:void 0,authDomain:void 0,projectId:void 0,storageBucket:void 0,messagingSenderId:void 0,appId:void 0},s4=Object.values(r4).every(e=>e!==void 0),CP=s4?cF(r4):null,Fu=CP?fre(CP):null;function $re(){return s4&&Fu!==null}function Ure({onAuthSuccess:e}){const[t,n]=p.useState(!1),{toast:r}=Wn(),[s,i]=p.useState("phone"),[o,l]=p.useState(""),[c,d]=p.useState(""),[u,h]=p.useState("+1"),[f,m]=p.useState(null),[g,v]=p.useState(""),[x,S]=p.useState({gamertag:"",firstName:"",lastName:"",age:void 0}),y=async()=>{var L;if(Ol.isNativePlatform())try{n(!0),((L=(await dX.signInWithGoogle()).credential)==null?void 0:L.idToken)&&(r({title:"Welcome!",description:"Logged in with Google successfully."}),e())}catch(N){console.error("Native Google Login Error:",N),r({title:"Login Failed",description:N.message||"Could not sign in with Google",variant:"destructive"})}finally{n(!1)}else window.location.href=lt("/api/auth/google")},b=()=>Fu?(window.recaptchaVerifier||(window.recaptchaVerifier=new gne(Fu,"recaptcha-container",{size:"invisible",callback:()=>{}})),window.recaptchaVerifier):null,w=async L=>{if(L.preventDefault(),!$re()||!Fu){r({title:"Firebase not configured",description:"Phone authentication is not available",variant:"destructive"});return}n(!0);try{const N=`${u}${o}`,O=b();if(!O)throw new Error("Failed to setup reCAPTCHA");delete window.phoneConfirmation;const G=await yne(Fu,N,O);m(G),window.phoneConfirmation=G,i("code"),r({title:"Code sent!",description:`Verification code sent to ${N}`})}catch(N){console.error("Error sending code:",N),r({title:"Failed to send code",description:N.message||"Please try again",variant:"destructive"}),window.recaptchaVerifier&&(window.recaptchaVerifier.clear(),window.recaptchaVerifier=null)}finally{n(!1)}},C=async L=>{L.preventDefault();const N=f||window.phoneConfirmation;if(!N){r({title:"Error",description:"Please request a new code",variant:"destructive"});return}n(!0);try{const O=c.trim(),H=await(await N.confirm(O)).user.getIdToken();v(H);const re=await fetch(lt("/api/auth/phone/verify-token"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({firebaseToken:H})});if(!re.ok){const Q=await re.json();throw new Error(Q.message||"Verification failed")}const X=await re.json();if(delete window.phoneConfirmation,X.userExists){const Q=await fetch(lt("/api/auth/phone/login"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({firebaseToken:H})});if(!Q.ok){const V=await Q.json();throw new Error(V.message||"Login failed")}r({title:"Welcome back!",description:"You've successfully logged in."}),e()}else i("register"),r({title:"Phone verified!",description:"Now complete your profile to continue."})}catch(O){console.error("Verification error:",O),r({title:"Verification failed",description:O.message||"Please check your code",variant:"destructive"})}finally{n(!1)}},I=async L=>{L.preventDefault(),n(!0);try{const N={...x,firebaseToken:g,age:x.age||void 0},O=await fetch(lt("/api/auth/phone/register"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(N)});if(!O.ok){const G=await O.json();throw new Error(G.message||"Registration failed")}r({title:"Account created!",description:"Welcome to Nexus Match!"}),e()}catch(N){r({title:"Registration failed",description:N instanceof Error?N.message:"Please try again",variant:"destructive"})}finally{n(!1)}},R=()=>{switch(s){case"phone":return a.jsxs("form",{onSubmit:w,className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Xn,{htmlFor:"phone-number","data-testid":"label-phone",children:"Phone Number"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("select",{value:u,onChange:L=>h(L.target.value),className:"w-24 px-3 py-2 bg-background border border-input rounded-md","data-testid":"select-country-code",children:[a.jsx("option",{value:"+1",children:" +1"}),a.jsx("option",{value:"+44",children:" +44"}),a.jsx("option",{value:"+91",children:" +91"}),a.jsx("option",{value:"+86",children:" +86"}),a.jsx("option",{value:"+81",children:" +81"}),a.jsx("option",{value:"+49",children:" +49"}),a.jsx("option",{value:"+33",children:" +33"})]}),a.jsx(tt,{id:"phone-number","data-testid":"input-phone-number",type:"tel",placeholder:"1234567890",value:o,onChange:L=>l(L.target.value),required:!0,className:"flex-1"})]})]}),a.jsx("div",{id:"recaptcha-container"}),a.jsxs(ee,{type:"submit",className:"w-full",disabled:t||!o,"data-testid":"button-send-code",children:[a.jsx(Vr,{className:"mr-2 h-4 w-4"}),t?"Sending...":"Send Verification Code"]})]});case"code":return a.jsxs("form",{onSubmit:C,className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Xn,{htmlFor:"verification-code","data-testid":"label-code",children:"Verification Code"}),a.jsx(tt,{id:"verification-code","data-testid":"input-verification-code",type:"text",placeholder:"123456",value:c,onChange:L=>d(L.target.value),maxLength:6,required:!0}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:["Enter the 6-digit code sent to ",u,o]})]}),a.jsxs(ee,{type:"submit",className:"w-full",disabled:t||c.length!==6,"data-testid":"button-verify-code",children:[a.jsx(WD,{className:"mr-2 h-4 w-4"}),t?"Verifying...":"Verify Code"]}),a.jsx(ee,{type:"button",variant:"ghost",className:"w-full",onClick:()=>i("phone"),"data-testid":"button-back-to-phone",children:"Back"})]});case"register":return a.jsxs("form",{onSubmit:I,className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Xn,{htmlFor:"gamertag","data-testid":"label-gamertag",children:"Gamertag"}),a.jsx(tt,{id:"gamertag","data-testid":"input-gamertag",type:"text",placeholder:"Enter your gamertag",value:x.gamertag,onChange:L=>S({...x,gamertag:L.target.value}),required:!0})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Xn,{htmlFor:"firstName","data-testid":"label-firstname",children:"First Name"}),a.jsx(tt,{id:"firstName","data-testid":"input-firstname",type:"text",placeholder:"First name",value:x.firstName||"",onChange:L=>S({...x,firstName:L.target.value})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Xn,{htmlFor:"lastName","data-testid":"label-lastname",children:"Last Name"}),a.jsx(tt,{id:"lastName","data-testid":"input-lastname",type:"text",placeholder:"Last name",value:x.lastName||"",onChange:L=>S({...x,lastName:L.target.value})})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Xn,{htmlFor:"age","data-testid":"label-age",children:"Age"}),a.jsx(tt,{id:"age","data-testid":"input-age",type:"number",placeholder:"Age",value:x.age||"",onChange:L=>S({...x,age:L.target.value?parseInt(L.target.value):void 0})})]}),a.jsxs(ee,{type:"submit",className:"w-full",disabled:t||!x.gamertag,"data-testid":"button-complete-registration",children:[a.jsx(ia,{className:"mr-2 h-4 w-4"}),t?"Creating Account...":"Complete Registration"]})]})}};return a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-900 via-purple-900 to-indigo-900 p-4",children:a.jsxs(Ne,{className:"w-full max-w-md",children:[a.jsxs(an,{className:"text-center",children:[a.jsx("div",{className:"flex justify-center mb-4",children:a.jsx(ia,{className:"h-12 w-12 text-primary","data-testid":"icon-logo"})}),a.jsx(mr,{className:"text-2xl","data-testid":"text-title",children:"Welcome to Nexus Match"}),a.jsx(Sl,{"data-testid":"text-description",children:"Find your perfect gaming partner"})]}),a.jsx(Fe,{children:a.jsxs(Ll,{defaultValue:"google",className:"w-full",children:[a.jsxs(_o,{className:"grid w-full grid-cols-2",children:[a.jsx(_r,{value:"google","data-testid":"tab-google",children:"Google"}),a.jsx(_r,{value:"phone","data-testid":"tab-phone",children:"Phone"})]}),a.jsx(si,{value:"google",className:"space-y-4",children:a.jsxs(ee,{onClick:y,className:"w-full",variant:"outline","data-testid":"button-google-login",children:[a.jsx(WX,{className:"mr-2 h-4 w-4"}),"Continue with Google"]})}),a.jsx(si,{value:"phone",children:R()})]})})]})})}const Vre=gf("whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 hover-elevate ",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow-xs",secondary:"border-transparent bg-secondary text-secondary-foreground",destructive:"border-transparent bg-destructive text-destructive-foreground shadow-xs",outline:" border [border-color:var(--badge-outline)] shadow-xs"}},defaultVariants:{variant:"default"}});function $e({className:e,variant:t,...n}){return a.jsx("div",{className:be(Vre({variant:t}),e),...n})}function Bre(e,t=[]){let n=[];function r(i,o){const l=p.createContext(o);l.displayName=i+"Context";const c=n.length;n=[...n,o];const d=h=>{var S;const{scope:f,children:m,...g}=h,v=((S=f==null?void 0:f[e])==null?void 0:S[c])||l,x=p.useMemo(()=>g,Object.values(g));return a.jsx(v.Provider,{value:x,children:m})};d.displayName=i+"Provider";function u(h,f){var v;const m=((v=f==null?void 0:f[e])==null?void 0:v[c])||l,g=p.useContext(m);if(g)return g;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[d,u]}const s=()=>{const i=n.map(o=>p.createContext(o));return function(l){const c=(l==null?void 0:l[e])||i;return p.useMemo(()=>({[`__scope${e}`]:{...l,[e]:c}}),[l,c])}};return s.scopeName=e,[r,zre(s,...t)]}function zre(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=r.reduce((l,{useScope:c,scopeName:d})=>{const h=c(i)[`__scope${d}`];return{...l,...h}},{});return p.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return n.scopeName=t.scopeName,n}var Gre=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Mk=Gre.reduce((e,t)=>{const n=kv(`Primitive.${t}`),r=p.forwardRef((s,i)=>{const{asChild:o,...l}=s,c=o?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),a.jsx(c,{...l,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function Wre(){return BM.useSyncExternalStore(Hre,()=>!0,()=>!1)}function Hre(){return()=>{}}var Dk="Avatar",[qre]=Bre(Dk),[Kre,i4]=qre(Dk),a4=p.forwardRef((e,t)=>{const{__scopeAvatar:n,...r}=e,[s,i]=p.useState("idle");return a.jsx(Kre,{scope:n,imageLoadingStatus:s,onImageLoadingStatusChange:i,children:a.jsx(Mk.span,{...r,ref:t})})});a4.displayName=Dk;var o4="AvatarImage",l4=p.forwardRef((e,t)=>{const{__scopeAvatar:n,src:r,onLoadingStatusChange:s=()=>{},...i}=e,o=i4(o4,n),l=Qre(r,i),c=rn(d=>{s(d),o.onImageLoadingStatusChange(d)});return on(()=>{l!=="idle"&&c(l)},[l,c]),l==="loaded"?a.jsx(Mk.img,{...i,ref:t,src:r}):null});l4.displayName=o4;var c4="AvatarFallback",d4=p.forwardRef((e,t)=>{const{__scopeAvatar:n,delayMs:r,...s}=e,i=i4(c4,n),[o,l]=p.useState(r===void 0);return p.useEffect(()=>{if(r!==void 0){const c=window.setTimeout(()=>l(!0),r);return()=>window.clearTimeout(c)}},[r]),o&&i.imageLoadingStatus!=="loaded"?a.jsx(Mk.span,{...s,ref:t}):null});d4.displayName=c4;function EP(e,t){return e?t?(e.src!==t&&(e.src=t),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}function Qre(e,{referrerPolicy:t,crossOrigin:n}){const r=Wre(),s=p.useRef(null),i=r?(s.current||(s.current=new window.Image),s.current):null,[o,l]=p.useState(()=>EP(i,e));return on(()=>{l(EP(i,e))},[i,e]),on(()=>{const c=h=>()=>{l(h)};if(!i)return;const d=c("loaded"),u=c("error");return i.addEventListener("load",d),i.addEventListener("error",u),t&&(i.referrerPolicy=t),typeof n=="string"&&(i.crossOrigin=n),()=>{i.removeEventListener("load",d),i.removeEventListener("error",u)}},[i,n,t]),o}var u4=a4,h4=l4,f4=d4;const Tn=p.forwardRef(({className:e,...t},n)=>a.jsx(u4,{ref:n,className:be(`
      after:content-[''] after:block after:absolute after:inset-0 after:rounded-full after:pointer-events-none after:border after:border-black/10 dark:after:border-white/10
      relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full`,e),...t}));Tn.displayName=u4.displayName;const tr=p.forwardRef(({className:e,...t},n)=>a.jsx(h4,{ref:n,className:be("aspect-square h-full w-full",e),...t}));tr.displayName=h4.displayName;const Cn=p.forwardRef(({className:e,...t},n)=>a.jsx(f4,{ref:n,className:be("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...t}));Cn.displayName=f4.displayName;var wx=0;function Ov(){p.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??_P()),document.body.insertAdjacentElement("beforeend",e[1]??_P()),wx++,()=>{wx===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),wx--}},[])}function _P(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var Sx="focusScope.autoFocusOnMount",kx="focusScope.autoFocusOnUnmount",PP={bubbles:!1,cancelable:!0},Jre="FocusScope",Af=p.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...o}=e,[l,c]=p.useState(null),d=rn(s),u=rn(i),h=p.useRef(null),f=We(t,v=>c(v)),m=p.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;p.useEffect(()=>{if(r){let v=function(b){if(m.paused||!l)return;const w=b.target;l.contains(w)?h.current=w:Da(h.current,{select:!0})},x=function(b){if(m.paused||!l)return;const w=b.relatedTarget;w!==null&&(l.contains(w)||Da(h.current,{select:!0}))},S=function(b){if(document.activeElement===document.body)for(const C of b)C.removedNodes.length>0&&Da(l)};document.addEventListener("focusin",v),document.addEventListener("focusout",x);const y=new MutationObserver(S);return l&&y.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",v),document.removeEventListener("focusout",x),y.disconnect()}}},[r,l,m.paused]),p.useEffect(()=>{if(l){IP.add(m);const v=document.activeElement;if(!l.contains(v)){const S=new CustomEvent(Sx,PP);l.addEventListener(Sx,d),l.dispatchEvent(S),S.defaultPrevented||(Yre(nse(p4(l)),{select:!0}),document.activeElement===v&&Da(l))}return()=>{l.removeEventListener(Sx,d),setTimeout(()=>{const S=new CustomEvent(kx,PP);l.addEventListener(kx,u),l.dispatchEvent(S),S.defaultPrevented||Da(v??document.body,{select:!0}),l.removeEventListener(kx,u),IP.remove(m)},0)}}},[l,d,u,m]);const g=p.useCallback(v=>{if(!n&&!r||m.paused)return;const x=v.key==="Tab"&&!v.altKey&&!v.ctrlKey&&!v.metaKey,S=document.activeElement;if(x&&S){const y=v.currentTarget,[b,w]=Xre(y);b&&w?!v.shiftKey&&S===w?(v.preventDefault(),n&&Da(b,{select:!0})):v.shiftKey&&S===b&&(v.preventDefault(),n&&Da(w,{select:!0})):S===y&&v.preventDefault()}},[n,r,m.paused]);return a.jsx(Re.div,{tabIndex:-1,...o,ref:f,onKeyDown:g})});Af.displayName=Jre;function Yre(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(Da(r,{select:t}),document.activeElement!==n)return}function Xre(e){const t=p4(e),n=NP(t,e),r=NP(t.reverse(),e);return[n,r]}function p4(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function NP(e,t){for(const n of e)if(!Zre(n,{upTo:t}))return n}function Zre(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function ese(e){return e instanceof HTMLInputElement&&"select"in e}function Da(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&ese(e)&&t&&e.select()}}var IP=tse();function tse(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=AP(e,t),e.unshift(t)},remove(t){var n;e=AP(e,t),(n=e[0])==null||n.resume()}}}function AP(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function nse(e){return e.filter(t=>t.tagName!=="A")}function rse(e){const t=sse(e),n=p.forwardRef((r,s)=>{const{children:i,...o}=r,l=p.Children.toArray(i),c=l.find(ase);if(c){const d=c.props.children,u=l.map(h=>h===c?p.Children.count(d)>1?p.Children.only(null):p.isValidElement(d)?d.props.children:null:h);return a.jsx(t,{...o,ref:s,children:p.isValidElement(d)?p.cloneElement(d,void 0,u):null})}return a.jsx(t,{...o,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}function sse(e){const t=p.forwardRef((n,r)=>{const{children:s,...i}=n;if(p.isValidElement(s)){const o=lse(s),l=ose(i,s.props);return s.type!==p.Fragment&&(l.ref=r?Ii(r,o):o),p.cloneElement(s,l)}return p.Children.count(s)>1?p.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var ise=Symbol("radix.slottable");function ase(e){return p.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===ise}function ose(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...l)=>{const c=i(...l);return s(...l),c}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function lse(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var cse=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},oc=new WeakMap,_p=new WeakMap,Pp={},Tx=0,m4=function(e){return e&&(e.host||m4(e.parentNode))},dse=function(e,t){return t.map(function(n){if(e.contains(n))return n;var r=m4(n);return r&&e.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},use=function(e,t,n,r){var s=dse(t,Array.isArray(e)?e:[e]);Pp[n]||(Pp[n]=new WeakMap);var i=Pp[n],o=[],l=new Set,c=new Set(s),d=function(h){!h||l.has(h)||(l.add(h),d(h.parentNode))};s.forEach(d);var u=function(h){!h||c.has(h)||Array.prototype.forEach.call(h.children,function(f){if(l.has(f))u(f);else try{var m=f.getAttribute(r),g=m!==null&&m!=="false",v=(oc.get(f)||0)+1,x=(i.get(f)||0)+1;oc.set(f,v),i.set(f,x),o.push(f),v===1&&g&&_p.set(f,!0),x===1&&f.setAttribute(n,"true"),g||f.setAttribute(r,"true")}catch(S){console.error("aria-hidden: cannot operate on ",f,S)}})};return u(t),l.clear(),Tx++,function(){o.forEach(function(h){var f=oc.get(h)-1,m=i.get(h)-1;oc.set(h,f),i.set(h,m),f||(_p.has(h)||h.removeAttribute(r),_p.delete(h)),m||h.removeAttribute(n)}),Tx--,Tx||(oc=new WeakMap,oc=new WeakMap,_p=new WeakMap,Pp={})}},Lv=function(e,t,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),s=cse(e);return s?(r.push.apply(r,Array.from(s.querySelectorAll("[aria-live], script"))),use(r,s,n,"aria-hidden")):function(){return null}},fm="right-scroll-bar-position",pm="width-before-scroll-bar",hse="with-scroll-bars-hidden",fse="--removed-body-scroll-bar-size";function Cx(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function pse(e,t){var n=p.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var s=n.value;s!==r&&(n.value=r,n.callback(r,s))}}}})[0];return n.callback=t,n.facade}var mse=typeof window<"u"?p.useLayoutEffect:p.useEffect,RP=new WeakMap;function gse(e,t){var n=pse(null,function(r){return e.forEach(function(s){return Cx(s,r)})});return mse(function(){var r=RP.get(n);if(r){var s=new Set(r),i=new Set(e),o=n.current;s.forEach(function(l){i.has(l)||Cx(l,null)}),i.forEach(function(l){s.has(l)||Cx(l,o)})}RP.set(n,e)},[e]),n}function vse(e){return e}function yse(e,t){t===void 0&&(t=vse);var n=[],r=!1,s={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(i){var o=t(i,r);return n.push(o),function(){n=n.filter(function(l){return l!==o})}},assignSyncMedium:function(i){for(r=!0;n.length;){var o=n;n=[],o.forEach(i)}n={push:function(l){return i(l)},filter:function(){return n}}},assignMedium:function(i){r=!0;var o=[];if(n.length){var l=n;n=[],l.forEach(i),o=n}var c=function(){var u=o;o=[],u.forEach(i)},d=function(){return Promise.resolve().then(c)};d(),n={push:function(u){o.push(u),d()},filter:function(u){return o=o.filter(u),n}}}};return s}function xse(e){e===void 0&&(e={});var t=yse(null);return t.options=mi({async:!0,ssr:!1},e),t}var g4=function(e){var t=e.sideCar,n=Ef(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return p.createElement(r,mi({},n))};g4.isSideCarExport=!0;function bse(e,t){return e.useMedium(t),g4}var v4=xse(),Ex=function(){},Fv=p.forwardRef(function(e,t){var n=p.useRef(null),r=p.useState({onScrollCapture:Ex,onWheelCapture:Ex,onTouchMoveCapture:Ex}),s=r[0],i=r[1],o=e.forwardProps,l=e.children,c=e.className,d=e.removeScrollBar,u=e.enabled,h=e.shards,f=e.sideCar,m=e.noRelative,g=e.noIsolation,v=e.inert,x=e.allowPinchZoom,S=e.as,y=S===void 0?"div":S,b=e.gapMode,w=Ef(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),C=f,I=gse([n,t]),R=mi(mi({},w),s);return p.createElement(p.Fragment,null,u&&p.createElement(C,{sideCar:v4,removeScrollBar:d,shards:h,noRelative:m,noIsolation:g,inert:v,setCallbacks:i,allowPinchZoom:!!x,lockRef:n,gapMode:b}),o?p.cloneElement(p.Children.only(l),mi(mi({},R),{ref:I})):p.createElement(y,mi({},R,{className:c,ref:I}),l))});Fv.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Fv.classNames={fullWidth:pm,zeroRight:fm};var wse=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Sse(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=wse();return t&&e.setAttribute("nonce",t),e}function kse(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function Tse(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var Cse=function(){var e=0,t=null;return{add:function(n){e==0&&(t=Sse())&&(kse(t,n),Tse(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},Ese=function(){var e=Cse();return function(t,n){p.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},y4=function(){var e=Ese(),t=function(n){var r=n.styles,s=n.dynamic;return e(r,s),null};return t},_se={left:0,top:0,right:0,gap:0},_x=function(e){return parseInt(e||"",10)||0},Pse=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],s=t[e==="padding"?"paddingRight":"marginRight"];return[_x(n),_x(r),_x(s)]},Nse=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return _se;var t=Pse(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},Ise=y4(),Qc="data-scroll-locked",Ase=function(e,t,n,r){var s=e.left,i=e.top,o=e.right,l=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(hse,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(l,"px ").concat(r,`;
  }
  body[`).concat(Qc,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(l,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(fm,` {
    right: `).concat(l,"px ").concat(r,`;
  }
  
  .`).concat(pm,` {
    margin-right: `).concat(l,"px ").concat(r,`;
  }
  
  .`).concat(fm," .").concat(fm,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(pm," .").concat(pm,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Qc,`] {
    `).concat(fse,": ").concat(l,`px;
  }
`)},jP=function(){var e=parseInt(document.body.getAttribute(Qc)||"0",10);return isFinite(e)?e:0},Rse=function(){p.useEffect(function(){return document.body.setAttribute(Qc,(jP()+1).toString()),function(){var e=jP()-1;e<=0?document.body.removeAttribute(Qc):document.body.setAttribute(Qc,e.toString())}},[])},jse=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,s=r===void 0?"margin":r;Rse();var i=p.useMemo(function(){return Nse(s)},[s]);return p.createElement(Ise,{styles:Ase(i,!t,s,n?"":"!important")})},Kw=!1;if(typeof window<"u")try{var Np=Object.defineProperty({},"passive",{get:function(){return Kw=!0,!0}});window.addEventListener("test",Np,Np),window.removeEventListener("test",Np,Np)}catch{Kw=!1}var lc=Kw?{passive:!1}:!1,Mse=function(e){return e.tagName==="TEXTAREA"},x4=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!Mse(e)&&n[t]==="visible")},Dse=function(e){return x4(e,"overflowY")},Ose=function(e){return x4(e,"overflowX")},MP=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var s=b4(e,r);if(s){var i=w4(e,r),o=i[1],l=i[2];if(o>l)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},Lse=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},Fse=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},b4=function(e,t){return e==="v"?Dse(t):Ose(t)},w4=function(e,t){return e==="v"?Lse(t):Fse(t)},$se=function(e,t){return e==="h"&&t==="rtl"?-1:1},Use=function(e,t,n,r,s){var i=$se(e,window.getComputedStyle(t).direction),o=i*r,l=n.target,c=t.contains(l),d=!1,u=o>0,h=0,f=0;do{if(!l)break;var m=w4(e,l),g=m[0],v=m[1],x=m[2],S=v-x-i*g;(g||S)&&b4(e,l)&&(h+=S,f+=g);var y=l.parentNode;l=y&&y.nodeType===Node.DOCUMENT_FRAGMENT_NODE?y.host:y}while(!c&&l!==document.body||c&&(t.contains(l)||t===l));return(u&&Math.abs(h)<1||!u&&Math.abs(f)<1)&&(d=!0),d},Ip=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},DP=function(e){return[e.deltaX,e.deltaY]},OP=function(e){return e&&"current"in e?e.current:e},Vse=function(e,t){return e[0]===t[0]&&e[1]===t[1]},Bse=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},zse=0,cc=[];function Gse(e){var t=p.useRef([]),n=p.useRef([0,0]),r=p.useRef(),s=p.useState(zse++)[0],i=p.useState(y4)[0],o=p.useRef(e);p.useEffect(function(){o.current=e},[e]),p.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(s));var v=Nee([e.lockRef.current],(e.shards||[]).map(OP),!0).filter(Boolean);return v.forEach(function(x){return x.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),v.forEach(function(x){return x.classList.remove("allow-interactivity-".concat(s))})}}},[e.inert,e.lockRef.current,e.shards]);var l=p.useCallback(function(v,x){if("touches"in v&&v.touches.length===2||v.type==="wheel"&&v.ctrlKey)return!o.current.allowPinchZoom;var S=Ip(v),y=n.current,b="deltaX"in v?v.deltaX:y[0]-S[0],w="deltaY"in v?v.deltaY:y[1]-S[1],C,I=v.target,R=Math.abs(b)>Math.abs(w)?"h":"v";if("touches"in v&&R==="h"&&I.type==="range")return!1;var L=window.getSelection(),N=L&&L.anchorNode,O=N?N===I||N.contains(I):!1;if(O)return!1;var G=MP(R,I);if(!G)return!0;if(G?C=R:(C=R==="v"?"h":"v",G=MP(R,I)),!G)return!1;if(!r.current&&"changedTouches"in v&&(b||w)&&(r.current=C),!C)return!0;var H=r.current||C;return Use(H,x,v,H==="h"?b:w)},[]),c=p.useCallback(function(v){var x=v;if(!(!cc.length||cc[cc.length-1]!==i)){var S="deltaY"in x?DP(x):Ip(x),y=t.current.filter(function(C){return C.name===x.type&&(C.target===x.target||x.target===C.shadowParent)&&Vse(C.delta,S)})[0];if(y&&y.should){x.cancelable&&x.preventDefault();return}if(!y){var b=(o.current.shards||[]).map(OP).filter(Boolean).filter(function(C){return C.contains(x.target)}),w=b.length>0?l(x,b[0]):!o.current.noIsolation;w&&x.cancelable&&x.preventDefault()}}},[]),d=p.useCallback(function(v,x,S,y){var b={name:v,delta:x,target:S,should:y,shadowParent:Wse(S)};t.current.push(b),setTimeout(function(){t.current=t.current.filter(function(w){return w!==b})},1)},[]),u=p.useCallback(function(v){n.current=Ip(v),r.current=void 0},[]),h=p.useCallback(function(v){d(v.type,DP(v),v.target,l(v,e.lockRef.current))},[]),f=p.useCallback(function(v){d(v.type,Ip(v),v.target,l(v,e.lockRef.current))},[]);p.useEffect(function(){return cc.push(i),e.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:f}),document.addEventListener("wheel",c,lc),document.addEventListener("touchmove",c,lc),document.addEventListener("touchstart",u,lc),function(){cc=cc.filter(function(v){return v!==i}),document.removeEventListener("wheel",c,lc),document.removeEventListener("touchmove",c,lc),document.removeEventListener("touchstart",u,lc)}},[]);var m=e.removeScrollBar,g=e.inert;return p.createElement(p.Fragment,null,g?p.createElement(i,{styles:Bse(s)}):null,m?p.createElement(jse,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function Wse(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const Hse=bse(v4,Gse);var Rf=p.forwardRef(function(e,t){return p.createElement(Fv,mi({},e,{ref:t,sideCar:Hse}))});Rf.classNames=Fv.classNames;var Qw=["Enter"," "],qse=["ArrowDown","PageUp","Home"],S4=["ArrowUp","PageDown","End"],Kse=[...qse,...S4],Qse={ltr:[...Qw,"ArrowRight"],rtl:[...Qw,"ArrowLeft"]},Jse={ltr:["ArrowLeft"],rtl:["ArrowRight"]},jf="Menu",[Oh,Yse,Xse]=pf(jf),[nc,k4]=Mn(jf,[Xse,Oo,Jd]),$v=Oo(),T4=Jd(),[Zse,rc]=nc(jf),[eie,Mf]=nc(jf),C4=e=>{const{__scopeMenu:t,open:n=!1,children:r,dir:s,onOpenChange:i,modal:o=!0}=e,l=$v(t),[c,d]=p.useState(null),u=p.useRef(!1),h=rn(i),f=ec(s);return p.useEffect(()=>{const m=()=>{u.current=!0,document.addEventListener("pointerdown",g,{capture:!0,once:!0}),document.addEventListener("pointermove",g,{capture:!0,once:!0})},g=()=>u.current=!1;return document.addEventListener("keydown",m,{capture:!0}),()=>{document.removeEventListener("keydown",m,{capture:!0}),document.removeEventListener("pointerdown",g,{capture:!0}),document.removeEventListener("pointermove",g,{capture:!0})}},[]),a.jsx($0,{...l,children:a.jsx(Zse,{scope:t,open:n,onOpenChange:h,content:c,onContentChange:d,children:a.jsx(eie,{scope:t,onClose:p.useCallback(()=>h(!1),[h]),isUsingKeyboardRef:u,dir:f,modal:o,children:r})})})};C4.displayName=jf;var tie="MenuAnchor",Ok=p.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,s=$v(n);return a.jsx(xf,{...s,...r,ref:t})});Ok.displayName=tie;var Lk="MenuPortal",[nie,E4]=nc(Lk,{forceMount:void 0}),_4=e=>{const{__scopeMenu:t,forceMount:n,children:r,container:s}=e,i=rc(Lk,t);return a.jsx(nie,{scope:t,forceMount:n,children:a.jsx(Pn,{present:n||i.open,children:a.jsx(Bd,{asChild:!0,container:s,children:r})})})};_4.displayName=Lk;var Es="MenuContent",[rie,Fk]=nc(Es),P4=p.forwardRef((e,t)=>{const n=E4(Es,e.__scopeMenu),{forceMount:r=n.forceMount,...s}=e,i=rc(Es,e.__scopeMenu),o=Mf(Es,e.__scopeMenu);return a.jsx(Oh.Provider,{scope:e.__scopeMenu,children:a.jsx(Pn,{present:r||i.open,children:a.jsx(Oh.Slot,{scope:e.__scopeMenu,children:o.modal?a.jsx(sie,{...s,ref:t}):a.jsx(iie,{...s,ref:t})})})})}),sie=p.forwardRef((e,t)=>{const n=rc(Es,e.__scopeMenu),r=p.useRef(null),s=We(t,r);return p.useEffect(()=>{const i=r.current;if(i)return Lv(i)},[]),a.jsx($k,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:pe(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),iie=p.forwardRef((e,t)=>{const n=rc(Es,e.__scopeMenu);return a.jsx($k,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),aie=rse("MenuContent.ScrollLock"),$k=p.forwardRef((e,t)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:l,onEntryFocus:c,onEscapeKeyDown:d,onPointerDownOutside:u,onFocusOutside:h,onInteractOutside:f,onDismiss:m,disableOutsideScroll:g,...v}=e,x=rc(Es,n),S=Mf(Es,n),y=$v(n),b=T4(n),w=Yse(n),[C,I]=p.useState(null),R=p.useRef(null),L=We(t,R,x.onContentChange),N=p.useRef(0),O=p.useRef(""),G=p.useRef(0),H=p.useRef(null),re=p.useRef("right"),X=p.useRef(0),Q=g?Rf:p.Fragment,V=g?{as:aie,allowPinchZoom:!0}:void 0,te=E=>{var W,ie;const M=O.current+E,A=w().filter(Z=>!Z.disabled),F=document.activeElement,q=(W=A.find(Z=>Z.ref.current===F))==null?void 0:W.textValue,P=A.map(Z=>Z.textValue),j=yie(P,M,q),$=(ie=A.find(Z=>Z.textValue===j))==null?void 0:ie.ref.current;(function Z(ne){O.current=ne,window.clearTimeout(N.current),ne!==""&&(N.current=window.setTimeout(()=>Z(""),1e3))})(M),$&&setTimeout(()=>$.focus())};p.useEffect(()=>()=>window.clearTimeout(N.current),[]),Ov();const k=p.useCallback(E=>{var A,F;return re.current===((A=H.current)==null?void 0:A.side)&&bie(E,(F=H.current)==null?void 0:F.area)},[]);return a.jsx(rie,{scope:n,searchRef:O,onItemEnter:p.useCallback(E=>{k(E)&&E.preventDefault()},[k]),onItemLeave:p.useCallback(E=>{var M;k(E)||((M=R.current)==null||M.focus(),I(null))},[k]),onTriggerLeave:p.useCallback(E=>{k(E)&&E.preventDefault()},[k]),pointerGraceTimerRef:G,onPointerGraceIntentChange:p.useCallback(E=>{H.current=E},[]),children:a.jsx(Q,{...V,children:a.jsx(Af,{asChild:!0,trapped:s,onMountAutoFocus:pe(i,E=>{var M;E.preventDefault(),(M=R.current)==null||M.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:a.jsx(Yl,{asChild:!0,disableOutsidePointerEvents:l,onEscapeKeyDown:d,onPointerDownOutside:u,onFocusOutside:h,onInteractOutside:f,onDismiss:m,children:a.jsx(vk,{asChild:!0,...b,dir:S.dir,orientation:"vertical",loop:r,currentTabStopId:C,onCurrentTabStopIdChange:I,onEntryFocus:pe(c,E=>{S.isUsingKeyboardRef.current||E.preventDefault()}),preventScrollOnEntryFocus:!0,children:a.jsx(pv,{role:"menu","aria-orientation":"vertical","data-state":G4(x.open),"data-radix-menu-content":"",dir:S.dir,...y,...v,ref:L,style:{outline:"none",...v.style},onKeyDown:pe(v.onKeyDown,E=>{const A=E.target.closest("[data-radix-menu-content]")===E.currentTarget,F=E.ctrlKey||E.altKey||E.metaKey,q=E.key.length===1;A&&(E.key==="Tab"&&E.preventDefault(),!F&&q&&te(E.key));const P=R.current;if(E.target!==P||!Kse.includes(E.key))return;E.preventDefault();const $=w().filter(W=>!W.disabled).map(W=>W.ref.current);S4.includes(E.key)&&$.reverse(),gie($)}),onBlur:pe(e.onBlur,E=>{E.currentTarget.contains(E.target)||(window.clearTimeout(N.current),O.current="")}),onPointerMove:pe(e.onPointerMove,Lh(E=>{const M=E.target,A=X.current!==E.clientX;if(E.currentTarget.contains(M)&&A){const F=E.clientX>X.current?"right":"left";re.current=F,X.current=E.clientX}}))})})})})})})});P4.displayName=Es;var oie="MenuGroup",Uk=p.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return a.jsx(Re.div,{role:"group",...r,ref:t})});Uk.displayName=oie;var lie="MenuLabel",N4=p.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return a.jsx(Re.div,{...r,ref:t})});N4.displayName=lie;var xg="MenuItem",LP="menu.itemSelect",Uv=p.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:r,...s}=e,i=p.useRef(null),o=Mf(xg,e.__scopeMenu),l=Fk(xg,e.__scopeMenu),c=We(t,i),d=p.useRef(!1),u=()=>{const h=i.current;if(!n&&h){const f=new CustomEvent(LP,{bubbles:!0,cancelable:!0});h.addEventListener(LP,m=>r==null?void 0:r(m),{once:!0}),k0(h,f),f.defaultPrevented?d.current=!1:o.onClose()}};return a.jsx(I4,{...s,ref:c,disabled:n,onClick:pe(e.onClick,u),onPointerDown:h=>{var f;(f=e.onPointerDown)==null||f.call(e,h),d.current=!0},onPointerUp:pe(e.onPointerUp,h=>{var f;d.current||(f=h.currentTarget)==null||f.click()}),onKeyDown:pe(e.onKeyDown,h=>{const f=l.searchRef.current!=="";n||f&&h.key===" "||Qw.includes(h.key)&&(h.currentTarget.click(),h.preventDefault())})})});Uv.displayName=xg;var I4=p.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:r=!1,textValue:s,...i}=e,o=Fk(xg,n),l=T4(n),c=p.useRef(null),d=We(t,c),[u,h]=p.useState(!1),[f,m]=p.useState("");return p.useEffect(()=>{const g=c.current;g&&m((g.textContent??"").trim())},[i.children]),a.jsx(Oh.ItemSlot,{scope:n,disabled:r,textValue:s??f,children:a.jsx(yk,{asChild:!0,...l,focusable:!r,children:a.jsx(Re.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...i,ref:d,onPointerMove:pe(e.onPointerMove,Lh(g=>{r?o.onItemLeave(g):(o.onItemEnter(g),g.defaultPrevented||g.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:pe(e.onPointerLeave,Lh(g=>o.onItemLeave(g))),onFocus:pe(e.onFocus,()=>h(!0)),onBlur:pe(e.onBlur,()=>h(!1))})})})}),cie="MenuCheckboxItem",A4=p.forwardRef((e,t)=>{const{checked:n=!1,onCheckedChange:r,...s}=e;return a.jsx(O4,{scope:e.__scopeMenu,checked:n,children:a.jsx(Uv,{role:"menuitemcheckbox","aria-checked":bg(n)?"mixed":n,...s,ref:t,"data-state":Bk(n),onSelect:pe(s.onSelect,()=>r==null?void 0:r(bg(n)?!0:!n),{checkForDefaultPrevented:!1})})})});A4.displayName=cie;var R4="MenuRadioGroup",[die,uie]=nc(R4,{value:void 0,onValueChange:()=>{}}),j4=p.forwardRef((e,t)=>{const{value:n,onValueChange:r,...s}=e,i=rn(r);return a.jsx(die,{scope:e.__scopeMenu,value:n,onValueChange:i,children:a.jsx(Uk,{...s,ref:t})})});j4.displayName=R4;var M4="MenuRadioItem",D4=p.forwardRef((e,t)=>{const{value:n,...r}=e,s=uie(M4,e.__scopeMenu),i=n===s.value;return a.jsx(O4,{scope:e.__scopeMenu,checked:i,children:a.jsx(Uv,{role:"menuitemradio","aria-checked":i,...r,ref:t,"data-state":Bk(i),onSelect:pe(r.onSelect,()=>{var o;return(o=s.onValueChange)==null?void 0:o.call(s,n)},{checkForDefaultPrevented:!1})})})});D4.displayName=M4;var Vk="MenuItemIndicator",[O4,hie]=nc(Vk,{checked:!1}),L4=p.forwardRef((e,t)=>{const{__scopeMenu:n,forceMount:r,...s}=e,i=hie(Vk,n);return a.jsx(Pn,{present:r||bg(i.checked)||i.checked===!0,children:a.jsx(Re.span,{...s,ref:t,"data-state":Bk(i.checked)})})});L4.displayName=Vk;var fie="MenuSeparator",F4=p.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return a.jsx(Re.div,{role:"separator","aria-orientation":"horizontal",...r,ref:t})});F4.displayName=fie;var pie="MenuArrow",$4=p.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,s=$v(n);return a.jsx(mv,{...s,...r,ref:t})});$4.displayName=pie;var mie="MenuSub",[Qfe,U4]=nc(mie),$u="MenuSubTrigger",V4=p.forwardRef((e,t)=>{const n=rc($u,e.__scopeMenu),r=Mf($u,e.__scopeMenu),s=U4($u,e.__scopeMenu),i=Fk($u,e.__scopeMenu),o=p.useRef(null),{pointerGraceTimerRef:l,onPointerGraceIntentChange:c}=i,d={__scopeMenu:e.__scopeMenu},u=p.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return p.useEffect(()=>u,[u]),p.useEffect(()=>{const h=l.current;return()=>{window.clearTimeout(h),c(null)}},[l,c]),a.jsx(Ok,{asChild:!0,...d,children:a.jsx(I4,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":s.contentId,"data-state":G4(n.open),...e,ref:Ii(t,s.onTriggerChange),onClick:h=>{var f;(f=e.onClick)==null||f.call(e,h),!(e.disabled||h.defaultPrevented)&&(h.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:pe(e.onPointerMove,Lh(h=>{i.onItemEnter(h),!h.defaultPrevented&&!e.disabled&&!n.open&&!o.current&&(i.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{n.onOpenChange(!0),u()},100))})),onPointerLeave:pe(e.onPointerLeave,Lh(h=>{var m,g;u();const f=(m=n.content)==null?void 0:m.getBoundingClientRect();if(f){const v=(g=n.content)==null?void 0:g.dataset.side,x=v==="right",S=x?-5:5,y=f[x?"left":"right"],b=f[x?"right":"left"];i.onPointerGraceIntentChange({area:[{x:h.clientX+S,y:h.clientY},{x:y,y:f.top},{x:b,y:f.top},{x:b,y:f.bottom},{x:y,y:f.bottom}],side:v}),window.clearTimeout(l.current),l.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(h),h.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:pe(e.onKeyDown,h=>{var m;const f=i.searchRef.current!=="";e.disabled||f&&h.key===" "||Qse[r.dir].includes(h.key)&&(n.onOpenChange(!0),(m=n.content)==null||m.focus(),h.preventDefault())})})})});V4.displayName=$u;var B4="MenuSubContent",z4=p.forwardRef((e,t)=>{const n=E4(Es,e.__scopeMenu),{forceMount:r=n.forceMount,...s}=e,i=rc(Es,e.__scopeMenu),o=Mf(Es,e.__scopeMenu),l=U4(B4,e.__scopeMenu),c=p.useRef(null),d=We(t,c);return a.jsx(Oh.Provider,{scope:e.__scopeMenu,children:a.jsx(Pn,{present:r||i.open,children:a.jsx(Oh.Slot,{scope:e.__scopeMenu,children:a.jsx($k,{id:l.contentId,"aria-labelledby":l.triggerId,...s,ref:d,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var h;o.isUsingKeyboardRef.current&&((h=c.current)==null||h.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:pe(e.onFocusOutside,u=>{u.target!==l.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:pe(e.onEscapeKeyDown,u=>{o.onClose(),u.preventDefault()}),onKeyDown:pe(e.onKeyDown,u=>{var m;const h=u.currentTarget.contains(u.target),f=Jse[o.dir].includes(u.key);h&&f&&(i.onOpenChange(!1),(m=l.trigger)==null||m.focus(),u.preventDefault())})})})})})});z4.displayName=B4;function G4(e){return e?"open":"closed"}function bg(e){return e==="indeterminate"}function Bk(e){return bg(e)?"indeterminate":e?"checked":"unchecked"}function gie(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function vie(e,t){return e.map((n,r)=>e[(t+r)%e.length])}function yie(e,t,n){const s=t.length>1&&Array.from(t).every(d=>d===t[0])?t[0]:t,i=n?e.indexOf(n):-1;let o=vie(e,Math.max(i,0));s.length===1&&(o=o.filter(d=>d!==n));const c=o.find(d=>d.toLowerCase().startsWith(s.toLowerCase()));return c!==n?c:void 0}function xie(e,t){const{x:n,y:r}=e;let s=!1;for(let i=0,o=t.length-1;i<t.length;o=i++){const l=t[i],c=t[o],d=l.x,u=l.y,h=c.x,f=c.y;u>r!=f>r&&n<(h-d)*(r-u)/(f-u)+d&&(s=!s)}return s}function bie(e,t){if(!t)return!1;const n={x:e.clientX,y:e.clientY};return xie(n,t)}function Lh(e){return t=>t.pointerType==="mouse"?e(t):void 0}var wie=C4,Sie=Ok,kie=_4,Tie=P4,Cie=Uk,Eie=N4,_ie=Uv,Pie=A4,Nie=j4,Iie=D4,Aie=L4,Rie=F4,jie=$4,Mie=V4,Die=z4,Vv="DropdownMenu",[Oie]=Mn(Vv,[k4]),Dr=k4(),[Lie,W4]=Oie(Vv),H4=e=>{const{__scopeDropdownMenu:t,children:n,dir:r,open:s,defaultOpen:i,onOpenChange:o,modal:l=!0}=e,c=Dr(t),d=p.useRef(null),[u,h]=qr({prop:s,defaultProp:i??!1,onChange:o,caller:Vv});return a.jsx(Lie,{scope:t,triggerId:is(),triggerRef:d,contentId:is(),open:u,onOpenChange:h,onOpenToggle:p.useCallback(()=>h(f=>!f),[h]),modal:l,children:a.jsx(wie,{...c,open:u,onOpenChange:h,dir:r,modal:l,children:n})})};H4.displayName=Vv;var q4="DropdownMenuTrigger",K4=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...s}=e,i=W4(q4,n),o=Dr(n);return a.jsx(Sie,{asChild:!0,...o,children:a.jsx(Re.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...s,ref:Ii(t,i.triggerRef),onPointerDown:pe(e.onPointerDown,l=>{!r&&l.button===0&&l.ctrlKey===!1&&(i.onOpenToggle(),i.open||l.preventDefault())}),onKeyDown:pe(e.onKeyDown,l=>{r||(["Enter"," "].includes(l.key)&&i.onOpenToggle(),l.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(l.key)&&l.preventDefault())})})})});K4.displayName=q4;var Fie="DropdownMenuPortal",Q4=e=>{const{__scopeDropdownMenu:t,...n}=e,r=Dr(t);return a.jsx(kie,{...r,...n})};Q4.displayName=Fie;var J4="DropdownMenuContent",Y4=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=W4(J4,n),i=Dr(n),o=p.useRef(!1);return a.jsx(Tie,{id:s.contentId,"aria-labelledby":s.triggerId,...i,...r,ref:t,onCloseAutoFocus:pe(e.onCloseAutoFocus,l=>{var c;o.current||(c=s.triggerRef.current)==null||c.focus(),o.current=!1,l.preventDefault()}),onInteractOutside:pe(e.onInteractOutside,l=>{const c=l.detail.originalEvent,d=c.button===0&&c.ctrlKey===!0,u=c.button===2||d;(!s.modal||u)&&(o.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Y4.displayName=J4;var $ie="DropdownMenuGroup",Uie=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Dr(n);return a.jsx(Cie,{...s,...r,ref:t})});Uie.displayName=$ie;var Vie="DropdownMenuLabel",X4=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Dr(n);return a.jsx(Eie,{...s,...r,ref:t})});X4.displayName=Vie;var Bie="DropdownMenuItem",Z4=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Dr(n);return a.jsx(_ie,{...s,...r,ref:t})});Z4.displayName=Bie;var zie="DropdownMenuCheckboxItem",e$=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Dr(n);return a.jsx(Pie,{...s,...r,ref:t})});e$.displayName=zie;var Gie="DropdownMenuRadioGroup",Wie=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Dr(n);return a.jsx(Nie,{...s,...r,ref:t})});Wie.displayName=Gie;var Hie="DropdownMenuRadioItem",t$=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Dr(n);return a.jsx(Iie,{...s,...r,ref:t})});t$.displayName=Hie;var qie="DropdownMenuItemIndicator",n$=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Dr(n);return a.jsx(Aie,{...s,...r,ref:t})});n$.displayName=qie;var Kie="DropdownMenuSeparator",r$=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Dr(n);return a.jsx(Rie,{...s,...r,ref:t})});r$.displayName=Kie;var Qie="DropdownMenuArrow",Jie=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Dr(n);return a.jsx(jie,{...s,...r,ref:t})});Jie.displayName=Qie;var Yie="DropdownMenuSubTrigger",s$=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Dr(n);return a.jsx(Mie,{...s,...r,ref:t})});s$.displayName=Yie;var Xie="DropdownMenuSubContent",i$=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Dr(n);return a.jsx(Die,{...s,...r,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});i$.displayName=Xie;var Zie=H4,eae=K4,tae=Q4,a$=Y4,o$=X4,l$=Z4,c$=e$,d$=t$,u$=n$,h$=r$,f$=s$,p$=i$;const m$=Zie,g$=eae,nae=p.forwardRef(({className:e,inset:t,children:n,...r},s)=>a.jsxs(f$,{ref:s,className:be("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t&&"pl-8",e),...r,children:[n,a.jsx(N8,{className:"ml-auto"})]}));nae.displayName=f$.displayName;const rae=p.forwardRef(({className:e,...t},n)=>a.jsx(p$,{ref:n,className:be("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",e),...t}));rae.displayName=p$.displayName;const zk=p.forwardRef(({className:e,sideOffset:t=4,...n},r)=>a.jsx(tae,{children:a.jsx(a$,{ref:r,sideOffset:t,className:be("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",e),...n})}));zk.displayName=a$.displayName;const Fh=p.forwardRef(({className:e,inset:t,...n},r)=>a.jsx(l$,{ref:r,className:be("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t&&"pl-8",e),...n}));Fh.displayName=l$.displayName;const sae=p.forwardRef(({className:e,children:t,checked:n,...r},s)=>a.jsxs(c$,{ref:s,className:be("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:n,...r,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(u$,{children:a.jsx(Zr,{className:"h-4 w-4"})})}),t]}));sae.displayName=c$.displayName;const iae=p.forwardRef(({className:e,children:t,...n},r)=>a.jsxs(d$,{ref:r,className:be("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(u$,{children:a.jsx(FD,{className:"h-2 w-2 fill-current"})})}),t]}));iae.displayName=d$.displayName;const Jw=p.forwardRef(({className:e,inset:t,...n},r)=>a.jsx(o$,{ref:r,className:be("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...n}));Jw.displayName=o$.displayName;const sh=p.forwardRef(({className:e,...t},n)=>a.jsx(h$,{ref:n,className:be("-mx-1 my-1 h-px bg-muted",e),...t}));sh.displayName=h$.displayName;function aae(e){const t=oae(e),n=p.forwardRef((r,s)=>{const{children:i,...o}=r,l=p.Children.toArray(i),c=l.find(cae);if(c){const d=c.props.children,u=l.map(h=>h===c?p.Children.count(d)>1?p.Children.only(null):p.isValidElement(d)?d.props.children:null:h);return a.jsx(t,{...o,ref:s,children:p.isValidElement(d)?p.cloneElement(d,void 0,u):null})}return a.jsx(t,{...o,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}function oae(e){const t=p.forwardRef((n,r)=>{const{children:s,...i}=n;if(p.isValidElement(s)){const o=uae(s),l=dae(i,s.props);return s.type!==p.Fragment&&(l.ref=r?Ii(r,o):o),p.cloneElement(s,l)}return p.Children.count(s)>1?p.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var lae=Symbol("radix.slottable");function cae(e){return p.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===lae}function dae(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...l)=>{const c=i(...l);return s(...l),c}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function uae(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var Bv="Dialog",[v$,y$]=Mn(Bv),[hae,oi]=v$(Bv),x$=e=>{const{__scopeDialog:t,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:o=!0}=e,l=p.useRef(null),c=p.useRef(null),[d,u]=qr({prop:r,defaultProp:s??!1,onChange:i,caller:Bv});return a.jsx(hae,{scope:t,triggerRef:l,contentRef:c,contentId:is(),titleId:is(),descriptionId:is(),open:d,onOpenChange:u,onOpenToggle:p.useCallback(()=>u(h=>!h),[u]),modal:o,children:n})};x$.displayName=Bv;var b$="DialogTrigger",w$=p.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=oi(b$,n),i=We(t,s.triggerRef);return a.jsx(Re.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":Hk(s.open),...r,ref:i,onClick:pe(e.onClick,s.onOpenToggle)})});w$.displayName=b$;var Gk="DialogPortal",[fae,S$]=v$(Gk,{forceMount:void 0}),k$=e=>{const{__scopeDialog:t,forceMount:n,children:r,container:s}=e,i=oi(Gk,t);return a.jsx(fae,{scope:t,forceMount:n,children:p.Children.map(r,o=>a.jsx(Pn,{present:n||i.open,children:a.jsx(Bd,{asChild:!0,container:s,children:o})}))})};k$.displayName=Gk;var wg="DialogOverlay",T$=p.forwardRef((e,t)=>{const n=S$(wg,e.__scopeDialog),{forceMount:r=n.forceMount,...s}=e,i=oi(wg,e.__scopeDialog);return i.modal?a.jsx(Pn,{present:r||i.open,children:a.jsx(mae,{...s,ref:t})}):null});T$.displayName=wg;var pae=aae("DialogOverlay.RemoveScroll"),mae=p.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=oi(wg,n);return a.jsx(Rf,{as:pae,allowPinchZoom:!0,shards:[s.contentRef],children:a.jsx(Re.div,{"data-state":Hk(s.open),...r,ref:t,style:{pointerEvents:"auto",...r.style}})})}),Ul="DialogContent",C$=p.forwardRef((e,t)=>{const n=S$(Ul,e.__scopeDialog),{forceMount:r=n.forceMount,...s}=e,i=oi(Ul,e.__scopeDialog);return a.jsx(Pn,{present:r||i.open,children:i.modal?a.jsx(gae,{...s,ref:t}):a.jsx(vae,{...s,ref:t})})});C$.displayName=Ul;var gae=p.forwardRef((e,t)=>{const n=oi(Ul,e.__scopeDialog),r=p.useRef(null),s=We(t,n.contentRef,r);return p.useEffect(()=>{const i=r.current;if(i)return Lv(i)},[]),a.jsx(E$,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:pe(e.onCloseAutoFocus,i=>{var o;i.preventDefault(),(o=n.triggerRef.current)==null||o.focus()}),onPointerDownOutside:pe(e.onPointerDownOutside,i=>{const o=i.detail.originalEvent,l=o.button===0&&o.ctrlKey===!0;(o.button===2||l)&&i.preventDefault()}),onFocusOutside:pe(e.onFocusOutside,i=>i.preventDefault())})}),vae=p.forwardRef((e,t)=>{const n=oi(Ul,e.__scopeDialog),r=p.useRef(!1),s=p.useRef(!1);return a.jsx(E$,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,l;(o=e.onCloseAutoFocus)==null||o.call(e,i),i.defaultPrevented||(r.current||(l=n.triggerRef.current)==null||l.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var c,d;(c=e.onInteractOutside)==null||c.call(e,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const o=i.target;((d=n.triggerRef.current)==null?void 0:d.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),E$=p.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,...o}=e,l=oi(Ul,n),c=p.useRef(null),d=We(t,c);return Ov(),a.jsxs(a.Fragment,{children:[a.jsx(Af,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:a.jsx(Yl,{role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":Hk(l.open),...o,ref:d,onDismiss:()=>l.onOpenChange(!1)})}),a.jsxs(a.Fragment,{children:[a.jsx(xae,{titleId:l.titleId}),a.jsx(wae,{contentRef:c,descriptionId:l.descriptionId})]})]})}),Wk="DialogTitle",_$=p.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=oi(Wk,n);return a.jsx(Re.h2,{id:s.titleId,...r,ref:t})});_$.displayName=Wk;var P$="DialogDescription",N$=p.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=oi(P$,n);return a.jsx(Re.p,{id:s.descriptionId,...r,ref:t})});N$.displayName=P$;var I$="DialogClose",A$=p.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=oi(I$,n);return a.jsx(Re.button,{type:"button",...r,ref:t,onClick:pe(e.onClick,()=>s.onOpenChange(!1))})});A$.displayName=I$;function Hk(e){return e?"open":"closed"}var R$="DialogTitleWarning",[yae,j$]=EH(R$,{contentName:Ul,titleName:Wk,docsSlug:"dialog"}),xae=({titleId:e})=>{const t=j$(R$),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return p.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},bae="DialogDescriptionWarning",wae=({contentRef:e,descriptionId:t})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${j$(bae).contentName}}.`;return p.useEffect(()=>{var i;const s=(i=e.current)==null?void 0:i.getAttribute("aria-describedby");t&&s&&(document.getElementById(t)||console.warn(r))},[r,e,t]),null},qk=x$,Kk=w$,Qk=k$,Df=T$,Of=C$,Lf=_$,Ff=N$,zv=A$;const gr=qk,Vl=Kk,Sae=Qk,M$=p.forwardRef(({className:e,...t},n)=>a.jsx(Df,{ref:n,className:be("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));M$.displayName=Df.displayName;const nr=p.forwardRef(({className:e,children:t,...n},r)=>a.jsxs(Sae,{children:[a.jsx(M$,{}),a.jsxs(Of,{ref:r,className:be("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...n,children:[t,a.jsxs(zv,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[a.jsx(Ot,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));nr.displayName=Of.displayName;const rr=({className:e,...t})=>a.jsx("div",{className:be("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});rr.displayName="DialogHeader";const D$=({className:e,...t})=>a.jsx("div",{className:be("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});D$.displayName="DialogFooter";const sr=p.forwardRef(({className:e,...t},n)=>a.jsx(Lf,{ref:n,className:be("text-lg font-semibold leading-none tracking-tight",e),...t}));sr.displayName=Lf.displayName;const $h=p.forwardRef(({className:e,...t},n)=>a.jsx(Ff,{ref:n,className:be("text-sm text-muted-foreground",e),...t}));$h.displayName=Ff.displayName;function Yw(e,[t,n]){return Math.min(n,Math.max(t,e))}function kae(e,t){return p.useReducer((n,r)=>t[n][r]??n,e)}var Jk="ScrollArea",[O$]=Mn(Jk),[Tae,Ms]=O$(Jk),L$=p.forwardRef((e,t)=>{const{__scopeScrollArea:n,type:r="hover",dir:s,scrollHideDelay:i=600,...o}=e,[l,c]=p.useState(null),[d,u]=p.useState(null),[h,f]=p.useState(null),[m,g]=p.useState(null),[v,x]=p.useState(null),[S,y]=p.useState(0),[b,w]=p.useState(0),[C,I]=p.useState(!1),[R,L]=p.useState(!1),N=We(t,G=>c(G)),O=ec(s);return a.jsx(Tae,{scope:n,type:r,dir:O,scrollHideDelay:i,scrollArea:l,viewport:d,onViewportChange:u,content:h,onContentChange:f,scrollbarX:m,onScrollbarXChange:g,scrollbarXEnabled:C,onScrollbarXEnabledChange:I,scrollbarY:v,onScrollbarYChange:x,scrollbarYEnabled:R,onScrollbarYEnabledChange:L,onCornerWidthChange:y,onCornerHeightChange:w,children:a.jsx(Re.div,{dir:O,...o,ref:N,style:{position:"relative","--radix-scroll-area-corner-width":S+"px","--radix-scroll-area-corner-height":b+"px",...e.style}})})});L$.displayName=Jk;var F$="ScrollAreaViewport",$$=p.forwardRef((e,t)=>{const{__scopeScrollArea:n,children:r,nonce:s,...i}=e,o=Ms(F$,n),l=p.useRef(null),c=We(t,l,o.onViewportChange);return a.jsxs(a.Fragment,{children:[a.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),a.jsx(Re.div,{"data-radix-scroll-area-viewport":"",...i,ref:c,style:{overflowX:o.scrollbarXEnabled?"scroll":"hidden",overflowY:o.scrollbarYEnabled?"scroll":"hidden",...e.style},children:a.jsx("div",{ref:o.onContentChange,style:{minWidth:"100%",display:"table"},children:r})})]})});$$.displayName=F$;var ji="ScrollAreaScrollbar",Yk=p.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=Ms(ji,e.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:o}=s,l=e.orientation==="horizontal";return p.useEffect(()=>(l?i(!0):o(!0),()=>{l?i(!1):o(!1)}),[l,i,o]),s.type==="hover"?a.jsx(Cae,{...r,ref:t,forceMount:n}):s.type==="scroll"?a.jsx(Eae,{...r,ref:t,forceMount:n}):s.type==="auto"?a.jsx(U$,{...r,ref:t,forceMount:n}):s.type==="always"?a.jsx(Xk,{...r,ref:t}):null});Yk.displayName=ji;var Cae=p.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=Ms(ji,e.__scopeScrollArea),[i,o]=p.useState(!1);return p.useEffect(()=>{const l=s.scrollArea;let c=0;if(l){const d=()=>{window.clearTimeout(c),o(!0)},u=()=>{c=window.setTimeout(()=>o(!1),s.scrollHideDelay)};return l.addEventListener("pointerenter",d),l.addEventListener("pointerleave",u),()=>{window.clearTimeout(c),l.removeEventListener("pointerenter",d),l.removeEventListener("pointerleave",u)}}},[s.scrollArea,s.scrollHideDelay]),a.jsx(Pn,{present:n||i,children:a.jsx(U$,{"data-state":i?"visible":"hidden",...r,ref:t})})}),Eae=p.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=Ms(ji,e.__scopeScrollArea),i=e.orientation==="horizontal",o=Wv(()=>c("SCROLL_END"),100),[l,c]=kae("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return p.useEffect(()=>{if(l==="idle"){const d=window.setTimeout(()=>c("HIDE"),s.scrollHideDelay);return()=>window.clearTimeout(d)}},[l,s.scrollHideDelay,c]),p.useEffect(()=>{const d=s.viewport,u=i?"scrollLeft":"scrollTop";if(d){let h=d[u];const f=()=>{const m=d[u];h!==m&&(c("SCROLL"),o()),h=m};return d.addEventListener("scroll",f),()=>d.removeEventListener("scroll",f)}},[s.viewport,i,c,o]),a.jsx(Pn,{present:n||l!=="hidden",children:a.jsx(Xk,{"data-state":l==="hidden"?"hidden":"visible",...r,ref:t,onPointerEnter:pe(e.onPointerEnter,()=>c("POINTER_ENTER")),onPointerLeave:pe(e.onPointerLeave,()=>c("POINTER_LEAVE"))})})}),U$=p.forwardRef((e,t)=>{const n=Ms(ji,e.__scopeScrollArea),{forceMount:r,...s}=e,[i,o]=p.useState(!1),l=e.orientation==="horizontal",c=Wv(()=>{if(n.viewport){const d=n.viewport.offsetWidth<n.viewport.scrollWidth,u=n.viewport.offsetHeight<n.viewport.scrollHeight;o(l?d:u)}},10);return Id(n.viewport,c),Id(n.content,c),a.jsx(Pn,{present:r||i,children:a.jsx(Xk,{"data-state":i?"visible":"hidden",...s,ref:t})})}),Xk=p.forwardRef((e,t)=>{const{orientation:n="vertical",...r}=e,s=Ms(ji,e.__scopeScrollArea),i=p.useRef(null),o=p.useRef(0),[l,c]=p.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),d=W$(l.viewport,l.content),u={...r,sizes:l,onSizesChange:c,hasThumb:d>0&&d<1,onThumbChange:f=>i.current=f,onThumbPointerUp:()=>o.current=0,onThumbPointerDown:f=>o.current=f};function h(f,m){return Rae(f,o.current,l,m)}return n==="horizontal"?a.jsx(_ae,{...u,ref:t,onThumbPositionChange:()=>{if(s.viewport&&i.current){const f=s.viewport.scrollLeft,m=FP(f,l,s.dir);i.current.style.transform=`translate3d(${m}px, 0, 0)`}},onWheelScroll:f=>{s.viewport&&(s.viewport.scrollLeft=f)},onDragScroll:f=>{s.viewport&&(s.viewport.scrollLeft=h(f,s.dir))}}):n==="vertical"?a.jsx(Pae,{...u,ref:t,onThumbPositionChange:()=>{if(s.viewport&&i.current){const f=s.viewport.scrollTop,m=FP(f,l);i.current.style.transform=`translate3d(0, ${m}px, 0)`}},onWheelScroll:f=>{s.viewport&&(s.viewport.scrollTop=f)},onDragScroll:f=>{s.viewport&&(s.viewport.scrollTop=h(f))}}):null}),_ae=p.forwardRef((e,t)=>{const{sizes:n,onSizesChange:r,...s}=e,i=Ms(ji,e.__scopeScrollArea),[o,l]=p.useState(),c=p.useRef(null),d=We(t,c,i.onScrollbarXChange);return p.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),a.jsx(B$,{"data-orientation":"horizontal",...s,ref:d,sizes:n,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Gv(n)+"px",...e.style},onThumbPointerDown:u=>e.onThumbPointerDown(u.x),onDragScroll:u=>e.onDragScroll(u.x),onWheelScroll:(u,h)=>{if(i.viewport){const f=i.viewport.scrollLeft+u.deltaX;e.onWheelScroll(f),q$(f,h)&&u.preventDefault()}},onResize:()=>{c.current&&i.viewport&&o&&r({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:c.current.clientWidth,paddingStart:kg(o.paddingLeft),paddingEnd:kg(o.paddingRight)}})}})}),Pae=p.forwardRef((e,t)=>{const{sizes:n,onSizesChange:r,...s}=e,i=Ms(ji,e.__scopeScrollArea),[o,l]=p.useState(),c=p.useRef(null),d=We(t,c,i.onScrollbarYChange);return p.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),a.jsx(B$,{"data-orientation":"vertical",...s,ref:d,sizes:n,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Gv(n)+"px",...e.style},onThumbPointerDown:u=>e.onThumbPointerDown(u.y),onDragScroll:u=>e.onDragScroll(u.y),onWheelScroll:(u,h)=>{if(i.viewport){const f=i.viewport.scrollTop+u.deltaY;e.onWheelScroll(f),q$(f,h)&&u.preventDefault()}},onResize:()=>{c.current&&i.viewport&&o&&r({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:c.current.clientHeight,paddingStart:kg(o.paddingTop),paddingEnd:kg(o.paddingBottom)}})}})}),[Nae,V$]=O$(ji),B$=p.forwardRef((e,t)=>{const{__scopeScrollArea:n,sizes:r,hasThumb:s,onThumbChange:i,onThumbPointerUp:o,onThumbPointerDown:l,onThumbPositionChange:c,onDragScroll:d,onWheelScroll:u,onResize:h,...f}=e,m=Ms(ji,n),[g,v]=p.useState(null),x=We(t,N=>v(N)),S=p.useRef(null),y=p.useRef(""),b=m.viewport,w=r.content-r.viewport,C=rn(u),I=rn(c),R=Wv(h,10);function L(N){if(S.current){const O=N.clientX-S.current.left,G=N.clientY-S.current.top;d({x:O,y:G})}}return p.useEffect(()=>{const N=O=>{const G=O.target;(g==null?void 0:g.contains(G))&&C(O,w)};return document.addEventListener("wheel",N,{passive:!1}),()=>document.removeEventListener("wheel",N,{passive:!1})},[b,g,w,C]),p.useEffect(I,[r,I]),Id(g,R),Id(m.content,R),a.jsx(Nae,{scope:n,scrollbar:g,hasThumb:s,onThumbChange:rn(i),onThumbPointerUp:rn(o),onThumbPositionChange:I,onThumbPointerDown:rn(l),children:a.jsx(Re.div,{...f,ref:x,style:{position:"absolute",...f.style},onPointerDown:pe(e.onPointerDown,N=>{N.button===0&&(N.target.setPointerCapture(N.pointerId),S.current=g.getBoundingClientRect(),y.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",m.viewport&&(m.viewport.style.scrollBehavior="auto"),L(N))}),onPointerMove:pe(e.onPointerMove,L),onPointerUp:pe(e.onPointerUp,N=>{const O=N.target;O.hasPointerCapture(N.pointerId)&&O.releasePointerCapture(N.pointerId),document.body.style.webkitUserSelect=y.current,m.viewport&&(m.viewport.style.scrollBehavior=""),S.current=null})})})}),Sg="ScrollAreaThumb",z$=p.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=V$(Sg,e.__scopeScrollArea);return a.jsx(Pn,{present:n||s.hasThumb,children:a.jsx(Iae,{ref:t,...r})})}),Iae=p.forwardRef((e,t)=>{const{__scopeScrollArea:n,style:r,...s}=e,i=Ms(Sg,n),o=V$(Sg,n),{onThumbPositionChange:l}=o,c=We(t,h=>o.onThumbChange(h)),d=p.useRef(void 0),u=Wv(()=>{d.current&&(d.current(),d.current=void 0)},100);return p.useEffect(()=>{const h=i.viewport;if(h){const f=()=>{if(u(),!d.current){const m=jae(h,l);d.current=m,l()}};return l(),h.addEventListener("scroll",f),()=>h.removeEventListener("scroll",f)}},[i.viewport,u,l]),a.jsx(Re.div,{"data-state":o.hasThumb?"visible":"hidden",...s,ref:c,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...r},onPointerDownCapture:pe(e.onPointerDownCapture,h=>{const m=h.target.getBoundingClientRect(),g=h.clientX-m.left,v=h.clientY-m.top;o.onThumbPointerDown({x:g,y:v})}),onPointerUp:pe(e.onPointerUp,o.onThumbPointerUp)})});z$.displayName=Sg;var Zk="ScrollAreaCorner",G$=p.forwardRef((e,t)=>{const n=Ms(Zk,e.__scopeScrollArea),r=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&r?a.jsx(Aae,{...e,ref:t}):null});G$.displayName=Zk;var Aae=p.forwardRef((e,t)=>{const{__scopeScrollArea:n,...r}=e,s=Ms(Zk,n),[i,o]=p.useState(0),[l,c]=p.useState(0),d=!!(i&&l);return Id(s.scrollbarX,()=>{var h;const u=((h=s.scrollbarX)==null?void 0:h.offsetHeight)||0;s.onCornerHeightChange(u),c(u)}),Id(s.scrollbarY,()=>{var h;const u=((h=s.scrollbarY)==null?void 0:h.offsetWidth)||0;s.onCornerWidthChange(u),o(u)}),d?a.jsx(Re.div,{...r,ref:t,style:{width:i,height:l,position:"absolute",right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function kg(e){return e?parseInt(e,10):0}function W$(e,t){const n=e/t;return isNaN(n)?0:n}function Gv(e){const t=W$(e.viewport,e.content),n=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,r=(e.scrollbar.size-n)*t;return Math.max(r,18)}function Rae(e,t,n,r="ltr"){const s=Gv(n),i=s/2,o=t||i,l=s-o,c=n.scrollbar.paddingStart+o,d=n.scrollbar.size-n.scrollbar.paddingEnd-l,u=n.content-n.viewport,h=r==="ltr"?[0,u]:[u*-1,0];return H$([c,d],h)(e)}function FP(e,t,n="ltr"){const r=Gv(t),s=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,i=t.scrollbar.size-s,o=t.content-t.viewport,l=i-r,c=n==="ltr"?[0,o]:[o*-1,0],d=Yw(e,c);return H$([0,o],[0,l])(d)}function H$(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(n-e[0])}}function q$(e,t){return e>0&&e<t}var jae=(e,t=()=>{})=>{let n={left:e.scrollLeft,top:e.scrollTop},r=0;return function s(){const i={left:e.scrollLeft,top:e.scrollTop},o=n.left!==i.left,l=n.top!==i.top;(o||l)&&t(),n=i,r=window.requestAnimationFrame(s)}(),()=>window.cancelAnimationFrame(r)};function Wv(e,t){const n=rn(e),r=p.useRef(0);return p.useEffect(()=>()=>window.clearTimeout(r.current),[]),p.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(n,t)},[n,t])}function Id(e,t){const n=rn(t);on(()=>{let r=0;if(e){const s=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(n)});return s.observe(e),()=>{window.cancelAnimationFrame(r),s.unobserve(e)}}},[e,n])}var K$=L$,Mae=$$,Dae=G$;const Hv=p.forwardRef(({className:e,children:t,...n},r)=>a.jsxs(K$,{ref:r,className:be("relative overflow-hidden",e),...n,children:[a.jsx(Mae,{className:"h-full w-full rounded-[inherit]",children:t}),a.jsx(Q$,{}),a.jsx(Dae,{})]}));Hv.displayName=K$.displayName;const Q$=p.forwardRef(({className:e,orientation:t="vertical",...n},r)=>a.jsx(Yk,{ref:r,orientation:t,className:be("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...n,children:a.jsx(z$,{className:"relative flex-1 rounded-full bg-border"})}));Q$.displayName=Yk.displayName;var Oae=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Lae=Oae.reduce((e,t)=>{const n=kv(`Primitive.${t}`),r=p.forwardRef((s,i)=>{const{asChild:o,...l}=s,c=o?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),a.jsx(c,{...l,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{}),Fae="Separator",$P="horizontal",$ae=["horizontal","vertical"],J$=p.forwardRef((e,t)=>{const{decorative:n,orientation:r=$P,...s}=e,i=Uae(r)?r:$P,l=n?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return a.jsx(Lae.div,{"data-orientation":i,...l,...s,ref:t})});J$.displayName=Fae;function Uae(e){return $ae.includes(e)}var Y$=J$;const aa=p.forwardRef(({className:e,orientation:t="horizontal",decorative:n=!0,...r},s)=>a.jsx(Y$,{ref:s,decorative:n,orientation:t,className:be("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...r}));aa.displayName=Y$.displayName;function Zn(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function Vae(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}const Ap=43200,UP=1440;let Bae={};function zae(){return Bae}function VP(e){const t=Zn(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function mm(e,t){const n=Zn(e),r=Zn(t),s=n.getTime()-r.getTime();return s<0?-1:s>0?1:s}function Gae(e){return Vae(e,Date.now())}function Wae(e,t){const n=Zn(e),r=Zn(t),s=n.getFullYear()-r.getFullYear(),i=n.getMonth()-r.getMonth();return s*12+i}function Hae(e){return t=>{const r=(e?Math[e]:Math.trunc)(t);return r===0?0:r}}function qae(e,t){return+Zn(e)-+Zn(t)}function Kae(e){const t=Zn(e);return t.setHours(23,59,59,999),t}function Qae(e){const t=Zn(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}function Jae(e){const t=Zn(e);return+Kae(t)==+Qae(t)}function Yae(e,t){const n=Zn(e),r=Zn(t),s=mm(n,r),i=Math.abs(Wae(n,r));let o;if(i<1)o=0;else{n.getMonth()===1&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-s*i);let l=mm(n,r)===-s;Jae(Zn(e))&&i===1&&mm(e,r)===1&&(l=!1),o=s*(i-Number(l))}return o===0?0:o}function Xae(e,t,n){const r=qae(e,t)/1e3;return Hae(n==null?void 0:n.roundingMethod)(r)}const Zae={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},eoe=(e,t,n)=>{let r;const s=Zae[e];return typeof s=="string"?r=s:t===1?r=s.one:r=s.other.replace("{{count}}",t.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function Px(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const toe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},noe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},roe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},soe={date:Px({formats:toe,defaultWidth:"full"}),time:Px({formats:noe,defaultWidth:"full"}),dateTime:Px({formats:roe,defaultWidth:"full"})},ioe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},aoe=(e,t,n,r)=>ioe[e];function ku(e){return(t,n)=>{const r=n!=null&&n.context?String(n.context):"standalone";let s;if(r==="formatting"&&e.formattingValues){const o=e.defaultFormattingWidth||e.defaultWidth,l=n!=null&&n.width?String(n.width):o;s=e.formattingValues[l]||e.formattingValues[o]}else{const o=e.defaultWidth,l=n!=null&&n.width?String(n.width):e.defaultWidth;s=e.values[l]||e.values[o]}const i=e.argumentCallback?e.argumentCallback(t):t;return s[i]}}const ooe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},loe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},coe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},doe={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},uoe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},hoe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},foe=(e,t)=>{const n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},poe={ordinalNumber:foe,era:ku({values:ooe,defaultWidth:"wide"}),quarter:ku({values:loe,defaultWidth:"wide",argumentCallback:e=>e-1}),month:ku({values:coe,defaultWidth:"wide"}),day:ku({values:doe,defaultWidth:"wide"}),dayPeriod:ku({values:uoe,defaultWidth:"wide",formattingValues:hoe,defaultFormattingWidth:"wide"})};function Tu(e){return(t,n={})=>{const r=n.width,s=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],i=t.match(s);if(!i)return null;const o=i[0],l=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(l)?goe(l,h=>h.test(o)):moe(l,h=>h.test(o));let d;d=e.valueCallback?e.valueCallback(c):c,d=n.valueCallback?n.valueCallback(d):d;const u=t.slice(o.length);return{value:d,rest:u}}}function moe(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}function goe(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}function voe(e){return(t,n={})=>{const r=t.match(e.matchPattern);if(!r)return null;const s=r[0],i=t.match(e.parsePattern);if(!i)return null;let o=e.valueCallback?e.valueCallback(i[0]):i[0];o=n.valueCallback?n.valueCallback(o):o;const l=t.slice(s.length);return{value:o,rest:l}}}const yoe=/^(\d+)(th|st|nd|rd)?/i,xoe=/\d+/i,boe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},woe={any:[/^b/i,/^(a|c)/i]},Soe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},koe={any:[/1/i,/2/i,/3/i,/4/i]},Toe={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Coe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Eoe={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},_oe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Poe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Noe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Ioe={ordinalNumber:voe({matchPattern:yoe,parsePattern:xoe,valueCallback:e=>parseInt(e,10)}),era:Tu({matchPatterns:boe,defaultMatchWidth:"wide",parsePatterns:woe,defaultParseWidth:"any"}),quarter:Tu({matchPatterns:Soe,defaultMatchWidth:"wide",parsePatterns:koe,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Tu({matchPatterns:Toe,defaultMatchWidth:"wide",parsePatterns:Coe,defaultParseWidth:"any"}),day:Tu({matchPatterns:Eoe,defaultMatchWidth:"wide",parsePatterns:_oe,defaultParseWidth:"any"}),dayPeriod:Tu({matchPatterns:Poe,defaultMatchWidth:"any",parsePatterns:Noe,defaultParseWidth:"any"})},Aoe={code:"en-US",formatDistance:eoe,formatLong:soe,formatRelative:aoe,localize:poe,match:Ioe,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Roe(e,t,n){const r=zae(),s=(n==null?void 0:n.locale)??r.locale??Aoe,i=2520,o=mm(e,t);if(isNaN(o))throw new RangeError("Invalid time value");const l=Object.assign({},n,{addSuffix:n==null?void 0:n.addSuffix,comparison:o});let c,d;o>0?(c=Zn(t),d=Zn(e)):(c=Zn(e),d=Zn(t));const u=Xae(d,c),h=(VP(d)-VP(c))/1e3,f=Math.round((u-h)/60);let m;if(f<2)return n!=null&&n.includeSeconds?u<5?s.formatDistance("lessThanXSeconds",5,l):u<10?s.formatDistance("lessThanXSeconds",10,l):u<20?s.formatDistance("lessThanXSeconds",20,l):u<40?s.formatDistance("halfAMinute",0,l):u<60?s.formatDistance("lessThanXMinutes",1,l):s.formatDistance("xMinutes",1,l):f===0?s.formatDistance("lessThanXMinutes",1,l):s.formatDistance("xMinutes",f,l);if(f<45)return s.formatDistance("xMinutes",f,l);if(f<90)return s.formatDistance("aboutXHours",1,l);if(f<UP){const g=Math.round(f/60);return s.formatDistance("aboutXHours",g,l)}else{if(f<i)return s.formatDistance("xDays",1,l);if(f<Ap){const g=Math.round(f/UP);return s.formatDistance("xDays",g,l)}else if(f<Ap*2)return m=Math.round(f/Ap),s.formatDistance("aboutXMonths",m,l)}if(m=Yae(d,c),m<12){const g=Math.round(f/Ap);return s.formatDistance("xMonths",g,l)}else{const g=m%12,v=Math.trunc(m/12);return g<3?s.formatDistance("aboutXYears",v,l):g<9?s.formatDistance("overXYears",v,l):s.formatDistance("almostXYears",v+1,l)}}function joe(e,t){return Roe(e,Gae(e),t)}function BP(){const{toast:e}=Wn(),[,t]=Jl(),[n,r]=p.useState(!1);p.useEffect(()=>{const v=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws`,x=new WebSocket(v);return x.onopen=()=>{console.log("WebSocket connected for notifications"),x.send(JSON.stringify({type:"ping"}))},x.onmessage=S=>{try{const y=JSON.parse(S.data);if(y.type==="new_notification"){ze.invalidateQueries({queryKey:["/api/notifications"]}),ze.invalidateQueries({queryKey:["/api/notifications/unread-count"]});const b=y.data;e({title:b.title,description:b.message})}}catch(y){console.error("Error parsing WebSocket message:",y)}},x.onerror=S=>{console.error("WebSocket error:",S)},x.onclose=()=>{console.log("WebSocket disconnected")},()=>{x.readyState===WebSocket.OPEN&&x.close()}},[e]);const{data:s=[],isLoading:i}=Pt({queryKey:["/api/notifications"],refetchInterval:3e4}),{data:o}=Pt({queryKey:["/api/notifications/unread-count"],refetchInterval:15e3}),l=(o==null?void 0:o.count)||0,c=Nt({mutationFn:async g=>kt("PATCH",`/api/notifications/${g}/read`),onSuccess:()=>{ze.invalidateQueries({queryKey:["/api/notifications"]}),ze.invalidateQueries({queryKey:["/api/notifications/unread-count"]})},onError:g=>{e({title:"Error",description:g.message||"Failed to mark notification as read",variant:"destructive"})}}),d=Nt({mutationFn:async g=>kt("DELETE",`/api/notifications/${g}`),onSuccess:()=>{ze.invalidateQueries({queryKey:["/api/notifications"]}),ze.invalidateQueries({queryKey:["/api/notifications/unread-count"]})},onError:g=>{e({title:"Error",description:g.message||"Failed to delete notification",variant:"destructive"})}}),u=Nt({mutationFn:async()=>kt("PATCH","/api/notifications/read-all"),onSuccess:()=>{ze.invalidateQueries({queryKey:["/api/notifications"]}),ze.invalidateQueries({queryKey:["/api/notifications/unread-count"]}),e({title:"Success",description:"All notifications marked as read"})},onError:g=>{e({title:"Error",description:g.message||"Failed to mark all as read",variant:"destructive"})}}),h=Nt({mutationFn:async()=>kt("DELETE","/api/notifications/delete-all"),onSuccess:()=>{ze.invalidateQueries({queryKey:["/api/notifications"]}),ze.invalidateQueries({queryKey:["/api/notifications/unread-count"]}),e({title:"Success",description:"All notifications deleted"})},onError:g=>{e({title:"Error",description:g.message||"Failed to delete all notifications",variant:"destructive"})}}),f=g=>{switch(g.isRead===!1&&c.mutate(g.id),r(!1),g.type){case"voice_channel_invite":case"voice_channel_invite_accepted":case"voice_channel_invite_declined":t("/voice-channels");break;case"connection_request":case"connection_accepted":case"connection_declined":t("/connections");break;case"match_application":case"match_accepted":case"match_declined":t("/");break;default:g.actionUrl&&t(g.actionUrl)}},m=g=>{switch(g){case"connection_request":return"";case"connection_accepted":return"";case"connection_declined":return"";case"match_application":return"";case"match_accepted":return"";case"match_declined":return"";case"voice_channel_invite":return"";case"voice_channel_invite_accepted":return"";case"voice_channel_invite_declined":return"";default:return""}};return a.jsxs(gr,{open:n,onOpenChange:r,children:[a.jsx(Vl,{asChild:!0,children:a.jsxs(ee,{variant:"ghost",size:"icon",className:"relative","data-testid":"button-notification-bell",children:[a.jsx(Yu,{className:"h-5 w-5"}),l>0&&a.jsx($e,{variant:"destructive",className:"absolute -top-1 -right-1 h-5 w-5 flex items-center justify-center p-0 text-xs","data-testid":"badge-unread-count",children:l>9?"9+":l})]})}),a.jsxs(nr,{className:"max-w-2xl max-h-[80vh]",children:[a.jsx(rr,{children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs(sr,{className:"flex items-center gap-2",children:[a.jsx(Yu,{className:"h-5 w-5"}),"Notifications",l>0&&a.jsxs($e,{variant:"secondary",className:"ml-2",children:[l," unread"]})]}),a.jsxs("div",{className:"flex gap-2",children:[l>0&&a.jsxs(ee,{variant:"outline",size:"sm",onClick:()=>u.mutate(),disabled:u.isPending,className:"gap-2","data-testid":"button-mark-all-read",children:[a.jsx(P8,{className:"h-4 w-4"}),"Mark All Read"]}),s.length>0&&a.jsxs(ee,{variant:"ghost",size:"sm",onClick:()=>h.mutate(),disabled:h.isPending,className:"gap-2 text-destructive hover:bg-destructive/10","data-testid":"button-delete-all",children:[a.jsx(So,{className:"h-4 w-4"}),"Delete All"]})]})]})}),a.jsx(aa,{}),a.jsx(Hv,{className:"h-[500px] pr-4",children:i?a.jsx("div",{className:"p-8 text-center text-muted-foreground",children:"Loading notifications..."}):s.length===0?a.jsxs("div",{className:"p-8 text-center",children:[a.jsx(Yu,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground/50"}),a.jsx("p",{className:"text-muted-foreground",children:"No notifications yet"})]}):a.jsx("div",{className:"space-y-2",children:s.map(g=>a.jsx("div",{className:`p-4 rounded-lg border cursor-pointer transition-all hover:shadow-md ${g.isRead===!1?"bg-blue-50 dark:bg-blue-950/30 border-blue-200 dark:border-blue-900":"bg-card border-border"}`,onClick:()=>f(g),"data-testid":`notification-item-${g.id}`,children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("span",{className:"text-3xl flex-shrink-0",children:m(g.type)}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1",children:[a.jsx("h4",{className:"font-semibold text-base",children:g.title}),g.isRead===!1&&a.jsx("div",{className:"w-2.5 h-2.5 bg-blue-600 rounded-full flex-shrink-0 mt-1"})]}),a.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:g.message}),a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("span",{className:"text-xs text-muted-foreground",children:joe(new Date(g.createdAt||new Date),{addSuffix:!0})}),a.jsxs("div",{className:"flex items-center gap-1",children:[g.isRead===!1&&a.jsxs(ee,{variant:"ghost",size:"sm",className:"h-7 gap-1 text-xs",onClick:v=>{v.stopPropagation(),c.mutate(g.id)},"data-testid":`button-mark-read-${g.id}`,children:[a.jsx(Zr,{className:"h-3 w-3"}),"Mark Read"]}),a.jsxs(ee,{variant:"ghost",size:"sm",className:"h-7 gap-1 text-xs text-destructive hover:text-destructive",onClick:v=>{v.stopPropagation(),d.mutate(g.id)},"data-testid":`button-delete-notification-${g.id}`,children:[a.jsx(So,{className:"h-3 w-3"}),"Delete"]})]})]})]})]})},g.id))})})]})]})}function eT(){const{data:e=[]}=Pt({queryKey:["/api/notifications"],refetchInterval:15e3}),t=e.filter(i=>i.type==="voice_call_waiting"&&i.isRead===!1),n=t.length>0,r=t.length,s=t.map(i=>{var l;const o=(l=i.message)==null?void 0:l.match(/^(.+?) is waiting in your personal voice channel$/);return o?o[1]:null}).filter(Boolean);return{hasWaitingCalls:n,waitingCallCount:r,waitingCallerGamertags:s,voiceCallWaitingNotifications:t}}function Ko({currentPage:e,onNavigate:t,user:n,onLogout:r,pendingMessages:s=0}){const[i,o]=p.useState(!1),{hasWaitingCalls:l}=eT(),c=[{id:"home",label:"Feed",icon:O8},{id:"search",label:"Discover",icon:wo},{id:"connections",label:"Matches",icon:Jt},{id:"messages",label:"Messages",icon:gi,badge:s,hasPhoneIndicator:l},{id:"voice-channels",label:"Voice",icon:Vr,hasPhoneIndicator:l},{id:"profile",label:"Profile",icon:qD}],d=({item:u,isMobile:h=!1})=>{const f=e===u.id,m=u.icon,g=u.id==="profile";return a.jsxs(ee,{variant:f?"default":"ghost",size:h?"default":"sm",onClick:()=>{t(u.id),h&&o(!1)},className:be("relative",h?"justify-start w-full":"flex-col h-16 w-16",f&&"bg-primary text-primary-foreground"),"data-testid":`nav-${u.id}`,children:[g&&n?a.jsxs(a.Fragment,{children:[a.jsxs(Tn,{className:be("h-7 w-7",f&&"ring-2 ring-primary-foreground",h&&"mr-3"),children:[a.jsx(tr,{src:n.profileImageUrl,alt:n.gamertag}),a.jsx(Cn,{className:"bg-primary text-primary-foreground text-xs",children:n.gamertag.slice(0,2).toUpperCase()})]}),h&&a.jsx("span",{children:u.label}),!h&&a.jsx("span",{className:"text-xs mt-1",children:u.label})]}):a.jsxs(a.Fragment,{children:[a.jsx(m,{className:be("h-5 w-5",h&&"mr-3")}),h&&a.jsx("span",{children:u.label}),!h&&a.jsx("span",{className:"text-xs mt-1",children:u.label})]}),(u.badge??0)>0&&a.jsx($e,{variant:"destructive",className:be("absolute text-xs px-1 py-0 min-w-[16px] h-4",h?"-top-1 -right-1":"-top-2 -right-2"),children:(u.badge??0)>99?"99+":u.badge}),u.hasPhoneIndicator&&a.jsx("div",{className:be("absolute bg-green-500 rounded-full p-1 flex items-center justify-center",h?"bottom-0 right-0":"bottom-1 right-1"),title:"Active voice call",children:a.jsx(Vr,{className:"h-2.5 w-2.5 text-white"})})]})};return a.jsxs(a.Fragment,{children:[a.jsxs("nav",{className:"hidden md:flex fixed left-0 top-0 h-full w-20 bg-card border-r border-card-border flex-col items-center py-6 z-50",children:[a.jsx("div",{className:"mb-8",children:a.jsx("div",{className:"w-10 h-10 bg-primary rounded-lg flex items-center justify-center",children:a.jsx("span",{className:"text-primary-foreground font-bold text-lg",children:"GM"})})}),a.jsx("div",{className:"flex flex-col gap-2 flex-1",children:c.map(u=>a.jsx(d,{item:u},u.id))}),a.jsxs("div",{className:"flex flex-col gap-2",children:[a.jsx("div",{className:"flex items-center justify-center",children:a.jsx(BP,{})}),a.jsxs(m$,{children:[a.jsx(g$,{asChild:!0,children:a.jsxs(ee,{variant:"ghost",size:"sm",className:"flex-col h-16 w-16","data-testid":"nav-menu",children:[a.jsx(R8,{className:"h-5 w-5"}),a.jsx("span",{className:"text-xs mt-1",children:"Menu"})]})}),a.jsxs(zk,{align:"end",className:"w-48",children:[a.jsxs(Fh,{onClick:()=>t("settings"),"data-testid":"nav-settings",children:[a.jsx(NE,{className:"h-4 w-4 mr-2"}),"Settings"]}),n&&a.jsxs(a.Fragment,{children:[a.jsx(sh,{}),a.jsxs(Fh,{onClick:r,"data-testid":"nav-logout",children:[a.jsx(_E,{className:"h-4 w-4 mr-2"}),"Logout"]})]})]})]})]})]}),a.jsxs("header",{className:"md:hidden fixed top-0 left-0 right-0 h-16 bg-card border-b border-card-border flex items-center justify-between px-4 z-50",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-8 h-8 bg-primary rounded-md flex items-center justify-center",children:a.jsx("span",{className:"text-primary-foreground font-bold text-sm",children:"GM"})}),a.jsx("h1",{className:"font-bold text-lg text-foreground",children:"GameMatch"})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[n&&a.jsxs(Tn,{className:"h-8 w-8",children:[a.jsx(tr,{src:n.profileImageUrl,alt:n.gamertag}),a.jsx(Cn,{className:"bg-primary text-primary-foreground text-xs",children:n.gamertag.slice(0,2).toUpperCase()})]}),a.jsx(BP,{}),a.jsx(ee,{variant:"ghost",size:"sm",onClick:()=>o(!i),"data-testid":"button-mobile-menu",children:i?a.jsx(Ot,{className:"h-5 w-5"}):a.jsx(VD,{className:"h-5 w-5"})})]})]}),i&&a.jsx("div",{className:"md:hidden fixed inset-0 z-40 bg-background/80 backdrop-blur-sm",children:a.jsx("div",{className:"fixed right-0 top-16 h-[calc(100vh-4rem)] w-64 bg-card border-l border-card-border p-4",children:a.jsxs("div",{className:"space-y-2",children:[c.map(u=>a.jsx(d,{item:u,isMobile:!0},u.id)),a.jsxs("div",{className:"border-t border-border pt-4 mt-4 space-y-2",children:[a.jsxs(ee,{variant:"ghost",onClick:()=>{t("settings"),o(!1)},className:"justify-start w-full","data-testid":"nav-settings-mobile",children:[a.jsx(NE,{className:"h-5 w-5 mr-3"}),"Settings"]}),n&&a.jsxs(ee,{variant:"ghost",onClick:()=>{r==null||r(),o(!1)},className:"justify-start w-full text-destructive hover:text-destructive","data-testid":"nav-logout-mobile",children:[a.jsx(_E,{className:"h-5 w-5 mr-3"}),"Logout"]})]})]})})}),a.jsx("nav",{className:"md:hidden fixed bottom-0 left-0 right-0 h-16 bg-card border-t border-card-border flex items-center justify-around z-50",children:c.slice(0,5).map(u=>{const h=e===u.id,f=u.icon,m=u.id==="profile";return a.jsxs(ee,{variant:"ghost",size:"sm",onClick:()=>t(u.id),className:be("relative flex-col h-12 w-12 p-0",h&&"text-primary"),"data-testid":`nav-mobile-${u.id}`,children:[m&&n?a.jsxs(Tn,{className:be("h-6 w-6",h&&"ring-2 ring-primary"),children:[a.jsx(tr,{src:n.profileImageUrl,alt:n.gamertag}),a.jsx(Cn,{className:"bg-primary text-primary-foreground text-xs",children:n.gamertag.slice(0,2).toUpperCase()})]}):a.jsx(f,{className:"h-5 w-5"}),a.jsx("span",{className:"text-xs mt-1",children:u.label}),(u.badge??0)>0&&a.jsx($e,{variant:"destructive",className:"absolute -top-1 -right-1 text-xs px-1 py-0 min-w-[16px] h-4",children:(u.badge??0)>99?"99+":u.badge})]},u.id)})})]})}function cn({className:e,...t}){return a.jsx("div",{className:be("animate-pulse rounded-md bg-muted",e),...t})}var Moe=Symbol("radix.slottable");function Doe(e){const t=({children:n})=>a.jsx(a.Fragment,{children:n});return t.displayName=`${e}.Slottable`,t.__radixId=Moe,t}var X$="AlertDialog",[Ooe]=Mn(X$,[y$]),Sa=y$(),Z$=e=>{const{__scopeAlertDialog:t,...n}=e,r=Sa(t);return a.jsx(qk,{...r,...n,modal:!0})};Z$.displayName=X$;var Loe="AlertDialogTrigger",e3=p.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,s=Sa(n);return a.jsx(Kk,{...s,...r,ref:t})});e3.displayName=Loe;var Foe="AlertDialogPortal",t3=e=>{const{__scopeAlertDialog:t,...n}=e,r=Sa(t);return a.jsx(Qk,{...r,...n})};t3.displayName=Foe;var $oe="AlertDialogOverlay",n3=p.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,s=Sa(n);return a.jsx(Df,{...s,...r,ref:t})});n3.displayName=$oe;var Jc="AlertDialogContent",[Uoe,Voe]=Ooe(Jc),Boe=Doe("AlertDialogContent"),r3=p.forwardRef((e,t)=>{const{__scopeAlertDialog:n,children:r,...s}=e,i=Sa(n),o=p.useRef(null),l=We(t,o),c=p.useRef(null);return a.jsx(yae,{contentName:Jc,titleName:s3,docsSlug:"alert-dialog",children:a.jsx(Uoe,{scope:n,cancelRef:c,children:a.jsxs(Of,{role:"alertdialog",...i,...s,ref:l,onOpenAutoFocus:pe(s.onOpenAutoFocus,d=>{var u;d.preventDefault(),(u=c.current)==null||u.focus({preventScroll:!0})}),onPointerDownOutside:d=>d.preventDefault(),onInteractOutside:d=>d.preventDefault(),children:[a.jsx(Boe,{children:r}),a.jsx(Goe,{contentRef:o})]})})})});r3.displayName=Jc;var s3="AlertDialogTitle",i3=p.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,s=Sa(n);return a.jsx(Lf,{...s,...r,ref:t})});i3.displayName=s3;var a3="AlertDialogDescription",o3=p.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,s=Sa(n);return a.jsx(Ff,{...s,...r,ref:t})});o3.displayName=a3;var zoe="AlertDialogAction",l3=p.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,s=Sa(n);return a.jsx(zv,{...s,...r,ref:t})});l3.displayName=zoe;var c3="AlertDialogCancel",d3=p.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,{cancelRef:s}=Voe(c3,n),i=Sa(n),o=We(t,s);return a.jsx(zv,{...i,...r,ref:o})});d3.displayName=c3;var Goe=({contentRef:e})=>{const t=`\`${Jc}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${Jc}\` by passing a \`${a3}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${Jc}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return p.useEffect(()=>{var r;document.getElementById((r=e.current)==null?void 0:r.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},Woe=Z$,Hoe=e3,qoe=t3,u3=n3,h3=r3,f3=l3,p3=d3,m3=i3,g3=o3;const v3=Woe,y3=Hoe,Koe=qoe,x3=p.forwardRef(({className:e,...t},n)=>a.jsx(u3,{className:be("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:n}));x3.displayName=u3.displayName;const tT=p.forwardRef(({className:e,...t},n)=>a.jsxs(Koe,{children:[a.jsx(x3,{}),a.jsx(h3,{ref:n,className:be("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));tT.displayName=h3.displayName;const nT=({className:e,...t})=>a.jsx("div",{className:be("flex flex-col space-y-2 text-center sm:text-left",e),...t});nT.displayName="AlertDialogHeader";const rT=({className:e,...t})=>a.jsx("div",{className:be("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});rT.displayName="AlertDialogFooter";const sT=p.forwardRef(({className:e,...t},n)=>a.jsx(m3,{ref:n,className:be("text-lg font-semibold",e),...t}));sT.displayName=m3.displayName;const iT=p.forwardRef(({className:e,...t},n)=>a.jsx(g3,{ref:n,className:be("text-sm text-muted-foreground",e),...t}));iT.displayName=g3.displayName;const aT=p.forwardRef(({className:e,...t},n)=>a.jsx(f3,{ref:n,className:be(gk(),e),...t}));aT.displayName=f3.displayName;const oT=p.forwardRef(({className:e,...t},n)=>a.jsx(p3,{ref:n,className:be(gk({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));oT.displayName=p3.displayName;var qv="Collapsible",[Qoe,b3]=Mn(qv),[Joe,lT]=Qoe(qv),w3=p.forwardRef((e,t)=>{const{__scopeCollapsible:n,open:r,defaultOpen:s,disabled:i,onOpenChange:o,...l}=e,[c,d]=qr({prop:r,defaultProp:s??!1,onChange:o,caller:qv});return a.jsx(Joe,{scope:n,disabled:i,contentId:is(),open:c,onOpenToggle:p.useCallback(()=>d(u=>!u),[d]),children:a.jsx(Re.div,{"data-state":hT(c),"data-disabled":i?"":void 0,...l,ref:t})})});w3.displayName=qv;var S3="CollapsibleTrigger",cT=p.forwardRef((e,t)=>{const{__scopeCollapsible:n,...r}=e,s=lT(S3,n);return a.jsx(Re.button,{type:"button","aria-controls":s.contentId,"aria-expanded":s.open||!1,"data-state":hT(s.open),"data-disabled":s.disabled?"":void 0,disabled:s.disabled,...r,ref:t,onClick:pe(e.onClick,s.onOpenToggle)})});cT.displayName=S3;var dT="CollapsibleContent",uT=p.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=lT(dT,e.__scopeCollapsible);return a.jsx(Pn,{present:n||s.open,children:({present:i})=>a.jsx(Yoe,{...r,ref:t,present:i})})});uT.displayName=dT;var Yoe=p.forwardRef((e,t)=>{const{__scopeCollapsible:n,present:r,children:s,...i}=e,o=lT(dT,n),[l,c]=p.useState(r),d=p.useRef(null),u=We(t,d),h=p.useRef(0),f=h.current,m=p.useRef(0),g=m.current,v=o.open||l,x=p.useRef(v),S=p.useRef(void 0);return p.useEffect(()=>{const y=requestAnimationFrame(()=>x.current=!1);return()=>cancelAnimationFrame(y)},[]),on(()=>{const y=d.current;if(y){S.current=S.current||{transitionDuration:y.style.transitionDuration,animationName:y.style.animationName},y.style.transitionDuration="0s",y.style.animationName="none";const b=y.getBoundingClientRect();h.current=b.height,m.current=b.width,x.current||(y.style.transitionDuration=S.current.transitionDuration,y.style.animationName=S.current.animationName),c(r)}},[o.open,r]),a.jsx(Re.div,{"data-state":hT(o.open),"data-disabled":o.disabled?"":void 0,id:o.contentId,hidden:!v,...i,ref:u,style:{"--radix-collapsible-content-height":f?`${f}px`:void 0,"--radix-collapsible-content-width":g?`${g}px`:void 0,...e.style},children:v&&s})});function hT(e){return e?"open":"closed"}var k3=w3,Xoe=cT,Zoe=uT,li="Accordion",ele=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[fT,tle,nle]=pf(li),[Kv]=Mn(li,[nle,b3]),pT=b3(),T3=xe.forwardRef((e,t)=>{const{type:n,...r}=e,s=r,i=r;return a.jsx(fT.Provider,{scope:e.__scopeAccordion,children:n==="multiple"?a.jsx(ale,{...i,ref:t}):a.jsx(ile,{...s,ref:t})})});T3.displayName=li;var[C3,rle]=Kv(li),[E3,sle]=Kv(li,{collapsible:!1}),ile=xe.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:s=()=>{},collapsible:i=!1,...o}=e,[l,c]=qr({prop:n,defaultProp:r??"",onChange:s,caller:li});return a.jsx(C3,{scope:e.__scopeAccordion,value:xe.useMemo(()=>l?[l]:[],[l]),onItemOpen:c,onItemClose:xe.useCallback(()=>i&&c(""),[i,c]),children:a.jsx(E3,{scope:e.__scopeAccordion,collapsible:i,children:a.jsx(_3,{...o,ref:t})})})}),ale=xe.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:s=()=>{},...i}=e,[o,l]=qr({prop:n,defaultProp:r??[],onChange:s,caller:li}),c=xe.useCallback(u=>l((h=[])=>[...h,u]),[l]),d=xe.useCallback(u=>l((h=[])=>h.filter(f=>f!==u)),[l]);return a.jsx(C3,{scope:e.__scopeAccordion,value:o,onItemOpen:c,onItemClose:d,children:a.jsx(E3,{scope:e.__scopeAccordion,collapsible:!0,children:a.jsx(_3,{...i,ref:t})})})}),[ole,Qv]=Kv(li),_3=xe.forwardRef((e,t)=>{const{__scopeAccordion:n,disabled:r,dir:s,orientation:i="vertical",...o}=e,l=xe.useRef(null),c=We(l,t),d=tle(n),h=ec(s)==="ltr",f=pe(e.onKeyDown,m=>{var L;if(!ele.includes(m.key))return;const g=m.target,v=d().filter(N=>{var O;return!((O=N.ref.current)!=null&&O.disabled)}),x=v.findIndex(N=>N.ref.current===g),S=v.length;if(x===-1)return;m.preventDefault();let y=x;const b=0,w=S-1,C=()=>{y=x+1,y>w&&(y=b)},I=()=>{y=x-1,y<b&&(y=w)};switch(m.key){case"Home":y=b;break;case"End":y=w;break;case"ArrowRight":i==="horizontal"&&(h?C():I());break;case"ArrowDown":i==="vertical"&&C();break;case"ArrowLeft":i==="horizontal"&&(h?I():C());break;case"ArrowUp":i==="vertical"&&I();break}const R=y%S;(L=v[R].ref.current)==null||L.focus()});return a.jsx(ole,{scope:n,disabled:r,direction:s,orientation:i,children:a.jsx(fT.Slot,{scope:n,children:a.jsx(Re.div,{...o,"data-orientation":i,ref:c,onKeyDown:r?void 0:f})})})}),Tg="AccordionItem",[lle,mT]=Kv(Tg),P3=xe.forwardRef((e,t)=>{const{__scopeAccordion:n,value:r,...s}=e,i=Qv(Tg,n),o=rle(Tg,n),l=pT(n),c=is(),d=r&&o.value.includes(r)||!1,u=i.disabled||e.disabled;return a.jsx(lle,{scope:n,open:d,disabled:u,triggerId:c,children:a.jsx(k3,{"data-orientation":i.orientation,"data-state":M3(d),...l,...s,ref:t,disabled:u,open:d,onOpenChange:h=>{h?o.onItemOpen(r):o.onItemClose(r)}})})});P3.displayName=Tg;var N3="AccordionHeader",I3=xe.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,s=Qv(li,n),i=mT(N3,n);return a.jsx(Re.h3,{"data-orientation":s.orientation,"data-state":M3(i.open),"data-disabled":i.disabled?"":void 0,...r,ref:t})});I3.displayName=N3;var Xw="AccordionTrigger",A3=xe.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,s=Qv(li,n),i=mT(Xw,n),o=sle(Xw,n),l=pT(n);return a.jsx(fT.ItemSlot,{scope:n,children:a.jsx(Xoe,{"aria-disabled":i.open&&!o.collapsible||void 0,"data-orientation":s.orientation,id:i.triggerId,...l,...r,ref:t})})});A3.displayName=Xw;var R3="AccordionContent",j3=xe.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,s=Qv(li,n),i=mT(R3,n),o=pT(n);return a.jsx(Zoe,{role:"region","aria-labelledby":i.triggerId,"data-orientation":s.orientation,...o,...r,ref:t,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...e.style}})});j3.displayName=R3;function M3(e){return e?"open":"closed"}var cle=T3,dle=P3,ule=I3,D3=A3,O3=j3;const L3=cle,Ec=p.forwardRef(({className:e,...t},n)=>a.jsx(dle,{ref:n,className:be("border-b",e),...t}));Ec.displayName="AccordionItem";const _c=p.forwardRef(({className:e,children:t,...n},r)=>a.jsx(ule,{className:"flex",children:a.jsxs(D3,{ref:r,className:be("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",e),...n,children:[t,a.jsx(vf,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));_c.displayName=D3.displayName;const Pc=p.forwardRef(({className:e,children:t,...n},r)=>a.jsx(O3,{ref:r,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...n,children:a.jsx("div",{className:be("pb-4 pt-0",e),children:t})}));Pc.displayName=O3.displayName;var $f=e=>e.type==="checkbox",al=e=>e instanceof Date,Fr=e=>e==null;const F3=e=>typeof e=="object";var En=e=>!Fr(e)&&!Array.isArray(e)&&F3(e)&&!al(e),$3=e=>En(e)&&e.target?$f(e.target)?e.target.checked:e.target.value:e,hle=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,U3=(e,t)=>e.has(hle(t)),fle=e=>{const t=e.constructor&&e.constructor.prototype;return En(t)&&t.hasOwnProperty("isPrototypeOf")},gT=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Vt(e){let t;const n=Array.isArray(e),r=typeof FileList<"u"?e instanceof FileList:!1;if(e instanceof Date)t=new Date(e);else if(!(gT&&(e instanceof Blob||r))&&(n||En(e)))if(t=n?[]:Object.create(Object.getPrototypeOf(e)),!n&&!fle(e))t=e;else for(const s in e)e.hasOwnProperty(s)&&(t[s]=Vt(e[s]));else return e;return t}var Jv=e=>/^\w*$/.test(e),Dt=e=>e===void 0,Yv=e=>Array.isArray(e)?e.filter(Boolean):[],vT=e=>Yv(e.replace(/["|']|\]/g,"").split(/\.|\[/)),Se=(e,t,n)=>{if(!t||!En(e))return n;const r=(Jv(t)?[t]:vT(t)).reduce((s,i)=>Fr(s)?s:s[i],e);return Dt(r)||r===e?Dt(e[t])?n:e[t]:r},Xr=e=>typeof e=="boolean",_t=(e,t,n)=>{let r=-1;const s=Jv(t)?[t]:vT(t),i=s.length,o=i-1;for(;++r<i;){const l=s[r];let c=n;if(r!==o){const d=e[l];c=En(d)||Array.isArray(d)?d:isNaN(+s[r+1])?{}:[]}if(l==="__proto__"||l==="constructor"||l==="prototype")return;e[l]=c,e=e[l]}};const Cg={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},ks={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},$i={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},yT=xe.createContext(null);yT.displayName="HookFormContext";const Uf=()=>xe.useContext(yT),ple=e=>{const{children:t,...n}=e;return xe.createElement(yT.Provider,{value:n},t)};var V3=(e,t,n,r=!0)=>{const s={defaultValues:t._defaultValues};for(const i in e)Object.defineProperty(s,i,{get:()=>{const o=i;return t._proxyFormState[o]!==ks.all&&(t._proxyFormState[o]=!r||ks.all),n&&(n[o]=!0),e[o]}});return s};const Xv=typeof window<"u"?xe.useLayoutEffect:xe.useEffect;function mle(e){const t=Uf(),{control:n=t.control,disabled:r,name:s,exact:i}=e||{},[o,l]=xe.useState(n._formState),c=xe.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1});return Xv(()=>n._subscribe({name:s,formState:c.current,exact:i,callback:d=>{!r&&l({...n._formState,...d})}}),[s,r,i]),xe.useEffect(()=>{c.current.isValid&&n._setValid(!0)},[n]),xe.useMemo(()=>V3(o,n,c.current,!1),[o,n])}var ts=e=>typeof e=="string",Zw=(e,t,n,r,s)=>ts(e)?(r&&t.watch.add(e),Se(n,e,s)):Array.isArray(e)?e.map(i=>(r&&t.watch.add(i),Se(n,i))):(r&&(t.watchAll=!0),n),eS=e=>Fr(e)||!F3(e);function Hs(e,t,n=new WeakSet){if(eS(e)||eS(t))return Object.is(e,t);if(al(e)&&al(t))return e.getTime()===t.getTime();const r=Object.keys(e),s=Object.keys(t);if(r.length!==s.length)return!1;if(n.has(e)||n.has(t))return!0;n.add(e),n.add(t);for(const i of r){const o=e[i];if(!s.includes(i))return!1;if(i!=="ref"){const l=t[i];if(al(o)&&al(l)||En(o)&&En(l)||Array.isArray(o)&&Array.isArray(l)?!Hs(o,l,n):!Object.is(o,l))return!1}}return!0}function gle(e){const t=Uf(),{control:n=t.control,name:r,defaultValue:s,disabled:i,exact:o,compute:l}=e||{},c=xe.useRef(s),d=xe.useRef(l),u=xe.useRef(void 0),h=xe.useRef(n),f=xe.useRef(r);d.current=l;const[m,g]=xe.useState(()=>{const w=n._getWatch(r,c.current);return d.current?d.current(w):w}),v=xe.useCallback(w=>{const C=Zw(r,n._names,w||n._formValues,!1,c.current);return d.current?d.current(C):C},[n._formValues,n._names,r]),x=xe.useCallback(w=>{if(!i){const C=Zw(r,n._names,w||n._formValues,!1,c.current);if(d.current){const I=d.current(C);Hs(I,u.current)||(g(I),u.current=I)}else g(C)}},[n._formValues,n._names,i,r]);Xv(()=>((h.current!==n||!Hs(f.current,r))&&(h.current=n,f.current=r,x()),n._subscribe({name:r,formState:{values:!0},exact:o,callback:w=>{x(w.values)}})),[n,o,r,x]),xe.useEffect(()=>n._removeUnmounted());const S=h.current!==n,y=f.current,b=xe.useMemo(()=>{if(i)return null;const w=!S&&!Hs(y,r);return S||w?v():null},[i,S,r,y,v]);return b!==null?b:m}function vle(e){const t=Uf(),{name:n,disabled:r,control:s=t.control,shouldUnregister:i,defaultValue:o,exact:l=!0}=e,c=U3(s._names.array,n),d=xe.useMemo(()=>Se(s._formValues,n,Se(s._defaultValues,n,o)),[s,n,o]),u=gle({control:s,name:n,defaultValue:d,exact:l}),h=mle({control:s,name:n,exact:l}),f=xe.useRef(e),m=xe.useRef(void 0),g=xe.useRef(s.register(n,{...e.rules,value:u,...Xr(e.disabled)?{disabled:e.disabled}:{}}));f.current=e;const v=xe.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!Se(h.errors,n)},isDirty:{enumerable:!0,get:()=>!!Se(h.dirtyFields,n)},isTouched:{enumerable:!0,get:()=>!!Se(h.touchedFields,n)},isValidating:{enumerable:!0,get:()=>!!Se(h.validatingFields,n)},error:{enumerable:!0,get:()=>Se(h.errors,n)}}),[h,n]),x=xe.useCallback(w=>g.current.onChange({target:{value:$3(w),name:n},type:Cg.CHANGE}),[n]),S=xe.useCallback(()=>g.current.onBlur({target:{value:Se(s._formValues,n),name:n},type:Cg.BLUR}),[n,s._formValues]),y=xe.useCallback(w=>{const C=Se(s._fields,n);C&&w&&(C._f.ref={focus:()=>w.focus&&w.focus(),select:()=>w.select&&w.select(),setCustomValidity:I=>w.setCustomValidity(I),reportValidity:()=>w.reportValidity()})},[s._fields,n]),b=xe.useMemo(()=>({name:n,value:u,...Xr(r)||h.disabled?{disabled:h.disabled||r}:{},onChange:x,onBlur:S,ref:y}),[n,r,h.disabled,x,S,y,u]);return xe.useEffect(()=>{const w=s._options.shouldUnregister||i,C=m.current;C&&C!==n&&!c&&s.unregister(C),s.register(n,{...f.current.rules,...Xr(f.current.disabled)?{disabled:f.current.disabled}:{}});const I=(R,L)=>{const N=Se(s._fields,R);N&&N._f&&(N._f.mount=L)};if(I(n,!0),w){const R=Vt(Se(s._options.defaultValues,n,f.current.defaultValue));_t(s._defaultValues,n,R),Dt(Se(s._formValues,n))&&_t(s._formValues,n,R)}return!c&&s.register(n),m.current=n,()=>{(c?w&&!s._state.action:w)?s.unregister(n):I(n,!1)}},[n,s,c,i]),xe.useEffect(()=>{s._setDisabledField({disabled:r,name:n})},[r,n,s]),xe.useMemo(()=>({field:b,formState:h,fieldState:v}),[b,h,v])}const yle=e=>e.render(vle(e));var B3=(e,t,n,r,s)=>t?{...n[e],types:{...n[e]&&n[e].types?n[e].types:{},[r]:s||!0}}:{},Br=e=>Array.isArray(e)?e:[e],zP=()=>{let e=[];return{get observers(){return e},next:s=>{for(const i of e)i.next&&i.next(s)},subscribe:s=>(e.push(s),{unsubscribe:()=>{e=e.filter(i=>i!==s)}}),unsubscribe:()=>{e=[]}}};function z3(e,t){const n={};for(const r in e)if(e.hasOwnProperty(r)){const s=e[r],i=t[r];if(s&&En(s)&&i){const o=z3(s,i);En(o)&&(n[r]=o)}else e[r]&&(n[r]=i)}return n}var hr=e=>En(e)&&!Object.keys(e).length,xT=e=>e.type==="file",qs=e=>typeof e=="function",Eg=e=>{if(!gT)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},G3=e=>e.type==="select-multiple",bT=e=>e.type==="radio",xle=e=>bT(e)||$f(e),Nx=e=>Eg(e)&&e.isConnected;function ble(e,t){const n=t.slice(0,-1).length;let r=0;for(;r<n;)e=Dt(e)?r++:e[t[r++]];return e}function wle(e){for(const t in e)if(e.hasOwnProperty(t)&&!Dt(e[t]))return!1;return!0}function ln(e,t){const n=Array.isArray(t)?t:Jv(t)?[t]:vT(t),r=n.length===1?e:ble(e,n),s=n.length-1,i=n[s];return r&&delete r[i],s!==0&&(En(r)&&hr(r)||Array.isArray(r)&&wle(r))&&ln(e,n.slice(0,-1)),e}var Sle=e=>{for(const t in e)if(qs(e[t]))return!0;return!1};function W3(e){return Array.isArray(e)||En(e)&&!Sle(e)}function tS(e,t={}){for(const n in e){const r=e[n];W3(r)?(t[n]=Array.isArray(r)?[]:{},tS(r,t[n])):Dt(r)||(t[n]=!0)}return t}function uc(e,t,n){n||(n=tS(t));for(const r in e){const s=e[r];if(W3(s))Dt(t)||eS(n[r])?n[r]=tS(s,Array.isArray(s)?[]:{}):uc(s,Fr(t)?{}:t[r],n[r]);else{const i=t[r];n[r]=!Hs(s,i)}}return n}const GP={value:!1,isValid:!1},WP={value:!0,isValid:!0};var H3=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(n=>n&&n.checked&&!n.disabled).map(n=>n.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!Dt(e[0].attributes.value)?Dt(e[0].value)||e[0].value===""?WP:{value:e[0].value,isValid:!0}:WP:GP}return GP},q3=(e,{valueAsNumber:t,valueAsDate:n,setValueAs:r})=>Dt(e)?e:t?e===""?NaN:e&&+e:n&&ts(e)?new Date(e):r?r(e):e;const HP={isValid:!1,value:null};var K3=e=>Array.isArray(e)?e.reduce((t,n)=>n&&n.checked&&!n.disabled?{isValid:!0,value:n.value}:t,HP):HP;function qP(e){const t=e.ref;return xT(t)?t.files:bT(t)?K3(e.refs).value:G3(t)?[...t.selectedOptions].map(({value:n})=>n):$f(t)?H3(e.refs).value:q3(Dt(t.value)?e.ref.value:t.value,e)}var kle=(e,t,n,r)=>{const s={};for(const i of e){const o=Se(t,i);o&&_t(s,i,o._f)}return{criteriaMode:n,names:[...e],fields:s,shouldUseNativeValidation:r}},_g=e=>e instanceof RegExp,Cu=e=>Dt(e)?e:_g(e)?e.source:En(e)?_g(e.value)?e.value.source:e.value:e,Nc=e=>({isOnSubmit:!e||e===ks.onSubmit,isOnBlur:e===ks.onBlur,isOnChange:e===ks.onChange,isOnAll:e===ks.all,isOnTouch:e===ks.onTouched});const KP="AsyncFunction";var Tle=e=>!!e&&!!e.validate&&!!(qs(e.validate)&&e.validate.constructor.name===KP||En(e.validate)&&Object.values(e.validate).find(t=>t.constructor.name===KP)),Cle=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate),nS=(e,t,n)=>!n&&(t.watchAll||t.watch.has(e)||[...t.watch].some(r=>e.startsWith(r)&&/^\.\w+/.test(e.slice(r.length))));const Yc=(e,t,n,r)=>{for(const s of n||Object.keys(e)){const i=Se(e,s);if(i){const{_f:o,...l}=i;if(o){if(o.refs&&o.refs[0]&&t(o.refs[0],s)&&!r)return!0;if(o.ref&&t(o.ref,o.name)&&!r)return!0;if(Yc(l,t))break}else if(En(l)&&Yc(l,t))break}}};function QP(e,t,n){const r=Se(e,n);if(r||Jv(n))return{error:r,name:n};const s=n.split(".");for(;s.length;){const i=s.join("."),o=Se(t,i),l=Se(e,i);if(o&&!Array.isArray(o)&&n!==i)return{name:n};if(l&&l.type)return{name:i,error:l};if(l&&l.root&&l.root.type)return{name:`${i}.root`,error:l.root};s.pop()}return{name:n}}var Ele=(e,t,n,r)=>{n(e);const{name:s,...i}=e;return hr(i)||Object.keys(i).length>=Object.keys(t).length||Object.keys(i).find(o=>t[o]===(!r||ks.all))},_le=(e,t,n)=>!e||!t||e===t||Br(e).some(r=>r&&(n?r===t:r.startsWith(t)||t.startsWith(r))),Ple=(e,t,n,r,s)=>s.isOnAll?!1:!n&&s.isOnTouch?!(t||e):(n?r.isOnBlur:s.isOnBlur)?!e:(n?r.isOnChange:s.isOnChange)?e:!0,Nle=(e,t)=>!Yv(Se(e,t)).length&&ln(e,t),Q3=(e,t,n)=>{const r=Br(Se(e,n));return _t(r,"root",t[n]),_t(e,n,r),e};function JP(e,t,n="validate"){if(ts(e)||Array.isArray(e)&&e.every(ts)||Xr(e)&&!e)return{type:n,message:ts(e)?e:"",ref:t}}var dc=e=>En(e)&&!_g(e)?e:{value:e,message:""},rS=async(e,t,n,r,s,i)=>{const{ref:o,refs:l,required:c,maxLength:d,minLength:u,min:h,max:f,pattern:m,validate:g,name:v,valueAsNumber:x,mount:S}=e._f,y=Se(n,v);if(!S||t.has(v))return{};const b=l?l[0]:o,w=H=>{s&&b.reportValidity&&(b.setCustomValidity(Xr(H)?"":H||""),b.reportValidity())},C={},I=bT(o),R=$f(o),L=I||R,N=(x||xT(o))&&Dt(o.value)&&Dt(y)||Eg(o)&&o.value===""||y===""||Array.isArray(y)&&!y.length,O=B3.bind(null,v,r,C),G=(H,re,X,Q=$i.maxLength,V=$i.minLength)=>{const te=H?re:X;C[v]={type:H?Q:V,message:te,ref:o,...O(H?Q:V,te)}};if(i?!Array.isArray(y)||!y.length:c&&(!L&&(N||Fr(y))||Xr(y)&&!y||R&&!H3(l).isValid||I&&!K3(l).isValid)){const{value:H,message:re}=ts(c)?{value:!!c,message:c}:dc(c);if(H&&(C[v]={type:$i.required,message:re,ref:b,...O($i.required,re)},!r))return w(re),C}if(!N&&(!Fr(h)||!Fr(f))){let H,re;const X=dc(f),Q=dc(h);if(!Fr(y)&&!isNaN(y)){const V=o.valueAsNumber||y&&+y;Fr(X.value)||(H=V>X.value),Fr(Q.value)||(re=V<Q.value)}else{const V=o.valueAsDate||new Date(y),te=M=>new Date(new Date().toDateString()+" "+M),k=o.type=="time",E=o.type=="week";ts(X.value)&&y&&(H=k?te(y)>te(X.value):E?y>X.value:V>new Date(X.value)),ts(Q.value)&&y&&(re=k?te(y)<te(Q.value):E?y<Q.value:V<new Date(Q.value))}if((H||re)&&(G(!!H,X.message,Q.message,$i.max,$i.min),!r))return w(C[v].message),C}if((d||u)&&!N&&(ts(y)||i&&Array.isArray(y))){const H=dc(d),re=dc(u),X=!Fr(H.value)&&y.length>+H.value,Q=!Fr(re.value)&&y.length<+re.value;if((X||Q)&&(G(X,H.message,re.message),!r))return w(C[v].message),C}if(m&&!N&&ts(y)){const{value:H,message:re}=dc(m);if(_g(H)&&!y.match(H)&&(C[v]={type:$i.pattern,message:re,ref:o,...O($i.pattern,re)},!r))return w(re),C}if(g){if(qs(g)){const H=await g(y,n),re=JP(H,b);if(re&&(C[v]={...re,...O($i.validate,re.message)},!r))return w(re.message),C}else if(En(g)){let H={};for(const re in g){if(!hr(H)&&!r)break;const X=JP(await g[re](y,n),b,re);X&&(H={...X,...O(re,X.message)},w(X.message),r&&(C[v]=H))}if(!hr(H)&&(C[v]={ref:b,...H},!r))return C}}return w(!0),C};const Ile={mode:ks.onSubmit,reValidateMode:ks.onChange,shouldFocusError:!0};function Ale(e={}){let t={...Ile,...e},n={submitCount:0,isDirty:!1,isReady:!1,isLoading:qs(t.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1},r={},s=En(t.defaultValues)||En(t.values)?Vt(t.defaultValues||t.values)||{}:{},i=t.shouldUnregister?{}:Vt(s),o={action:!1,mount:!1,watch:!1},l={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},c,d=0;const u={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let h={...u};const f={array:zP(),state:zP()},m=t.criteriaMode===ks.all,g=U=>J=>{clearTimeout(d),d=setTimeout(U,J)},v=async U=>{if(!t.disabled&&(u.isValid||h.isValid||U)){const J=t.resolver?hr((await R()).errors):await N(r,!0);J!==n.isValid&&f.state.next({isValid:J})}},x=(U,J)=>{!t.disabled&&(u.isValidating||u.validatingFields||h.isValidating||h.validatingFields)&&((U||Array.from(l.mount)).forEach(Y=>{Y&&(J?_t(n.validatingFields,Y,J):ln(n.validatingFields,Y))}),f.state.next({validatingFields:n.validatingFields,isValidating:!hr(n.validatingFields)}))},S=(U,J=[],Y,ce,he=!0,fe=!0)=>{if(ce&&Y&&!t.disabled){if(o.action=!0,fe&&Array.isArray(Se(r,U))){const je=Y(Se(r,U),ce.argA,ce.argB);he&&_t(r,U,je)}if(fe&&Array.isArray(Se(n.errors,U))){const je=Y(Se(n.errors,U),ce.argA,ce.argB);he&&_t(n.errors,U,je),Nle(n.errors,U)}if((u.touchedFields||h.touchedFields)&&fe&&Array.isArray(Se(n.touchedFields,U))){const je=Y(Se(n.touchedFields,U),ce.argA,ce.argB);he&&_t(n.touchedFields,U,je)}(u.dirtyFields||h.dirtyFields)&&(n.dirtyFields=uc(s,i)),f.state.next({name:U,isDirty:G(U,J),dirtyFields:n.dirtyFields,errors:n.errors,isValid:n.isValid})}else _t(i,U,J)},y=(U,J)=>{_t(n.errors,U,J),f.state.next({errors:n.errors})},b=U=>{n.errors=U,f.state.next({errors:n.errors,isValid:!1})},w=(U,J,Y,ce)=>{const he=Se(r,U);if(he){const fe=Se(i,U,Dt(Y)?Se(s,U):Y);Dt(fe)||ce&&ce.defaultChecked||J?_t(i,U,J?fe:qP(he._f)):X(U,fe),o.mount&&!o.action&&v()}},C=(U,J,Y,ce,he)=>{let fe=!1,je=!1;const ct={name:U};if(!t.disabled){if(!Y||ce){(u.isDirty||h.isDirty)&&(je=n.isDirty,n.isDirty=ct.isDirty=G(),fe=je!==ct.isDirty);const Ze=Hs(Se(s,U),J);je=!!Se(n.dirtyFields,U),Ze?ln(n.dirtyFields,U):_t(n.dirtyFields,U,!0),ct.dirtyFields=n.dirtyFields,fe=fe||(u.dirtyFields||h.dirtyFields)&&je!==!Ze}if(Y){const Ze=Se(n.touchedFields,U);Ze||(_t(n.touchedFields,U,Y),ct.touchedFields=n.touchedFields,fe=fe||(u.touchedFields||h.touchedFields)&&Ze!==Y)}fe&&he&&f.state.next(ct)}return fe?ct:{}},I=(U,J,Y,ce)=>{const he=Se(n.errors,U),fe=(u.isValid||h.isValid)&&Xr(J)&&n.isValid!==J;if(t.delayError&&Y?(c=g(()=>y(U,Y)),c(t.delayError)):(clearTimeout(d),c=null,Y?_t(n.errors,U,Y):ln(n.errors,U)),(Y?!Hs(he,Y):he)||!hr(ce)||fe){const je={...ce,...fe&&Xr(J)?{isValid:J}:{},errors:n.errors,name:U};n={...n,...je},f.state.next(je)}},R=async U=>{x(U,!0);const J=await t.resolver(i,t.context,kle(U||l.mount,r,t.criteriaMode,t.shouldUseNativeValidation));return x(U),J},L=async U=>{const{errors:J}=await R(U);if(U)for(const Y of U){const ce=Se(J,Y);ce?_t(n.errors,Y,ce):ln(n.errors,Y)}else n.errors=J;return J},N=async(U,J,Y={valid:!0})=>{for(const ce in U){const he=U[ce];if(he){const{_f:fe,...je}=he;if(fe){const ct=l.array.has(fe.name),Ze=he._f&&Tle(he._f);Ze&&u.validatingFields&&x([fe.name],!0);const Zt=await rS(he,l.disabled,i,m,t.shouldUseNativeValidation&&!J,ct);if(Ze&&u.validatingFields&&x([fe.name]),Zt[fe.name]&&(Y.valid=!1,J))break;!J&&(Se(Zt,fe.name)?ct?Q3(n.errors,Zt,fe.name):_t(n.errors,fe.name,Zt[fe.name]):ln(n.errors,fe.name))}!hr(je)&&await N(je,J,Y)}}return Y.valid},O=()=>{for(const U of l.unMount){const J=Se(r,U);J&&(J._f.refs?J._f.refs.every(Y=>!Nx(Y)):!Nx(J._f.ref))&&W(U)}l.unMount=new Set},G=(U,J)=>!t.disabled&&(U&&J&&_t(i,U,J),!Hs(M(),s)),H=(U,J,Y)=>Zw(U,l,{...o.mount?i:Dt(J)?s:ts(U)?{[U]:J}:J},Y,J),re=U=>Yv(Se(o.mount?i:s,U,t.shouldUnregister?Se(s,U,[]):[])),X=(U,J,Y={})=>{const ce=Se(r,U);let he=J;if(ce){const fe=ce._f;fe&&(!fe.disabled&&_t(i,U,q3(J,fe)),he=Eg(fe.ref)&&Fr(J)?"":J,G3(fe.ref)?[...fe.ref.options].forEach(je=>je.selected=he.includes(je.value)):fe.refs?$f(fe.ref)?fe.refs.forEach(je=>{(!je.defaultChecked||!je.disabled)&&(Array.isArray(he)?je.checked=!!he.find(ct=>ct===je.value):je.checked=he===je.value||!!he)}):fe.refs.forEach(je=>je.checked=je.value===he):xT(fe.ref)?fe.ref.value="":(fe.ref.value=he,fe.ref.type||f.state.next({name:U,values:Vt(i)})))}(Y.shouldDirty||Y.shouldTouch)&&C(U,he,Y.shouldTouch,Y.shouldDirty,!0),Y.shouldValidate&&E(U)},Q=(U,J,Y)=>{for(const ce in J){if(!J.hasOwnProperty(ce))return;const he=J[ce],fe=U+"."+ce,je=Se(r,fe);(l.array.has(U)||En(he)||je&&!je._f)&&!al(he)?Q(fe,he,Y):X(fe,he,Y)}},V=(U,J,Y={})=>{const ce=Se(r,U),he=l.array.has(U),fe=Vt(J);_t(i,U,fe),he?(f.array.next({name:U,values:Vt(i)}),(u.isDirty||u.dirtyFields||h.isDirty||h.dirtyFields)&&Y.shouldDirty&&f.state.next({name:U,dirtyFields:uc(s,i),isDirty:G(U,fe)})):ce&&!ce._f&&!Fr(fe)?Q(U,fe,Y):X(U,fe,Y),nS(U,l)&&f.state.next({...n,name:U}),f.state.next({name:o.mount?U:void 0,values:Vt(i)})},te=async U=>{o.mount=!0;const J=U.target;let Y=J.name,ce=!0;const he=Se(r,Y),fe=Ze=>{ce=Number.isNaN(Ze)||al(Ze)&&isNaN(Ze.getTime())||Hs(Ze,Se(i,Y,Ze))},je=Nc(t.mode),ct=Nc(t.reValidateMode);if(he){let Ze,Zt;const gn=J.type?qP(he._f):$3(U),Qe=U.type===Cg.BLUR||U.type===Cg.FOCUS_OUT,ht=!Cle(he._f)&&!t.resolver&&!Se(n.errors,Y)&&!he._f.deps||Ple(Qe,Se(n.touchedFields,Y),n.isSubmitted,ct,je),qe=nS(Y,l,Qe);_t(i,Y,gn),Qe?(!J||!J.readOnly)&&(he._f.onBlur&&he._f.onBlur(U),c&&c(0)):he._f.onChange&&he._f.onChange(U);const wt=C(Y,gn,Qe),ar=!hr(wt)||qe;if(!Qe&&f.state.next({name:Y,type:U.type,values:Vt(i)}),ht)return(u.isValid||h.isValid)&&(t.mode==="onBlur"?Qe&&v():Qe||v()),ar&&f.state.next({name:Y,...qe?{}:wt});if(!Qe&&qe&&f.state.next({...n}),t.resolver){const{errors:or}=await R([Y]);if(fe(gn),ce){const ft=QP(n.errors,r,Y),Ve=QP(or,r,ft.name||Y);Ze=Ve.error,Y=Ve.name,Zt=hr(or)}}else x([Y],!0),Ze=(await rS(he,l.disabled,i,m,t.shouldUseNativeValidation))[Y],x([Y]),fe(gn),ce&&(Ze?Zt=!1:(u.isValid||h.isValid)&&(Zt=await N(r,!0)));ce&&(he._f.deps&&(!Array.isArray(he._f.deps)||he._f.deps.length>0)&&E(he._f.deps),I(Y,Zt,Ze,wt))}},k=(U,J)=>{if(Se(n.errors,J)&&U.focus)return U.focus(),1},E=async(U,J={})=>{let Y,ce;const he=Br(U);if(t.resolver){const fe=await L(Dt(U)?U:he);Y=hr(fe),ce=U?!he.some(je=>Se(fe,je)):Y}else U?(ce=(await Promise.all(he.map(async fe=>{const je=Se(r,fe);return await N(je&&je._f?{[fe]:je}:je)}))).every(Boolean),!(!ce&&!n.isValid)&&v()):ce=Y=await N(r);return f.state.next({...!ts(U)||(u.isValid||h.isValid)&&Y!==n.isValid?{}:{name:U},...t.resolver||!U?{isValid:Y}:{},errors:n.errors}),J.shouldFocus&&!ce&&Yc(r,k,U?he:l.mount),ce},M=(U,J)=>{let Y={...o.mount?i:s};return J&&(Y=z3(J.dirtyFields?n.dirtyFields:n.touchedFields,Y)),Dt(U)?Y:ts(U)?Se(Y,U):U.map(ce=>Se(Y,ce))},A=(U,J)=>({invalid:!!Se((J||n).errors,U),isDirty:!!Se((J||n).dirtyFields,U),error:Se((J||n).errors,U),isValidating:!!Se(n.validatingFields,U),isTouched:!!Se((J||n).touchedFields,U)}),F=U=>{U&&Br(U).forEach(J=>ln(n.errors,J)),f.state.next({errors:U?n.errors:{}})},q=(U,J,Y)=>{const ce=(Se(r,U,{_f:{}})._f||{}).ref,he=Se(n.errors,U)||{},{ref:fe,message:je,type:ct,...Ze}=he;_t(n.errors,U,{...Ze,...J,ref:ce}),f.state.next({name:U,errors:n.errors,isValid:!1}),Y&&Y.shouldFocus&&ce&&ce.focus&&ce.focus()},P=(U,J)=>qs(U)?f.state.subscribe({next:Y=>"values"in Y&&U(H(void 0,J),Y)}):H(U,J,!0),j=U=>f.state.subscribe({next:J=>{_le(U.name,J.name,U.exact)&&Ele(J,U.formState||u,Fn,U.reRenderRoot)&&U.callback({values:{...i},...n,...J,defaultValues:s})}}).unsubscribe,$=U=>(o.mount=!0,h={...h,...U.formState},j({...U,formState:h})),W=(U,J={})=>{for(const Y of U?Br(U):l.mount)l.mount.delete(Y),l.array.delete(Y),J.keepValue||(ln(r,Y),ln(i,Y)),!J.keepError&&ln(n.errors,Y),!J.keepDirty&&ln(n.dirtyFields,Y),!J.keepTouched&&ln(n.touchedFields,Y),!J.keepIsValidating&&ln(n.validatingFields,Y),!t.shouldUnregister&&!J.keepDefaultValue&&ln(s,Y);f.state.next({values:Vt(i)}),f.state.next({...n,...J.keepDirty?{isDirty:G()}:{}}),!J.keepIsValid&&v()},ie=({disabled:U,name:J})=>{(Xr(U)&&o.mount||U||l.disabled.has(J))&&(U?l.disabled.add(J):l.disabled.delete(J))},Z=(U,J={})=>{let Y=Se(r,U);const ce=Xr(J.disabled)||Xr(t.disabled);return _t(r,U,{...Y||{},_f:{...Y&&Y._f?Y._f:{ref:{name:U}},name:U,mount:!0,...J}}),l.mount.add(U),Y?ie({disabled:Xr(J.disabled)?J.disabled:t.disabled,name:U}):w(U,!0,J.value),{...ce?{disabled:J.disabled||t.disabled}:{},...t.progressive?{required:!!J.required,min:Cu(J.min),max:Cu(J.max),minLength:Cu(J.minLength),maxLength:Cu(J.maxLength),pattern:Cu(J.pattern)}:{},name:U,onChange:te,onBlur:te,ref:he=>{if(he){Z(U,J),Y=Se(r,U);const fe=Dt(he.value)&&he.querySelectorAll&&he.querySelectorAll("input,select,textarea")[0]||he,je=xle(fe),ct=Y._f.refs||[];if(je?ct.find(Ze=>Ze===fe):fe===Y._f.ref)return;_t(r,U,{_f:{...Y._f,...je?{refs:[...ct.filter(Nx),fe,...Array.isArray(Se(s,U))?[{}]:[]],ref:{type:fe.type,name:U}}:{ref:fe}}}),w(U,!1,void 0,fe)}else Y=Se(r,U,{}),Y._f&&(Y._f.mount=!1),(t.shouldUnregister||J.shouldUnregister)&&!(U3(l.array,U)&&o.action)&&l.unMount.add(U)}}},ne=()=>t.shouldFocusError&&Yc(r,k,l.mount),ae=U=>{Xr(U)&&(f.state.next({disabled:U}),Yc(r,(J,Y)=>{const ce=Se(r,Y);ce&&(J.disabled=ce._f.disabled||U,Array.isArray(ce._f.refs)&&ce._f.refs.forEach(he=>{he.disabled=ce._f.disabled||U}))},0,!1))},ge=(U,J)=>async Y=>{let ce;Y&&(Y.preventDefault&&Y.preventDefault(),Y.persist&&Y.persist());let he=Vt(i);if(f.state.next({isSubmitting:!0}),t.resolver){const{errors:fe,values:je}=await R();n.errors=fe,he=Vt(je)}else await N(r);if(l.disabled.size)for(const fe of l.disabled)ln(he,fe);if(ln(n.errors,"root"),hr(n.errors)){f.state.next({errors:{}});try{await U(he,Y)}catch(fe){ce=fe}}else J&&await J({...n.errors},Y),ne(),setTimeout(ne);if(f.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:hr(n.errors)&&!ce,submitCount:n.submitCount+1,errors:n.errors}),ce)throw ce},Le=(U,J={})=>{Se(r,U)&&(Dt(J.defaultValue)?V(U,Vt(Se(s,U))):(V(U,J.defaultValue),_t(s,U,Vt(J.defaultValue))),J.keepTouched||ln(n.touchedFields,U),J.keepDirty||(ln(n.dirtyFields,U),n.isDirty=J.defaultValue?G(U,Vt(Se(s,U))):G()),J.keepError||(ln(n.errors,U),u.isValid&&v()),f.state.next({...n}))},Ct=(U,J={})=>{const Y=U?Vt(U):s,ce=Vt(Y),he=hr(U),fe=he?s:ce;if(J.keepDefaultValues||(s=Y),!J.keepValues){if(J.keepDirtyValues){const je=new Set([...l.mount,...Object.keys(uc(s,i))]);for(const ct of Array.from(je))Se(n.dirtyFields,ct)?_t(fe,ct,Se(i,ct)):V(ct,Se(fe,ct))}else{if(gT&&Dt(U))for(const je of l.mount){const ct=Se(r,je);if(ct&&ct._f){const Ze=Array.isArray(ct._f.refs)?ct._f.refs[0]:ct._f.ref;if(Eg(Ze)){const Zt=Ze.closest("form");if(Zt){Zt.reset();break}}}}if(J.keepFieldsRef)for(const je of l.mount)V(je,Se(fe,je));else r={}}i=t.shouldUnregister?J.keepDefaultValues?Vt(s):{}:Vt(fe),f.array.next({values:{...fe}}),f.state.next({values:{...fe}})}l={mount:J.keepDirtyValues?l.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!u.isValid||!!J.keepIsValid||!!J.keepDirtyValues||!t.shouldUnregister&&!hr(fe),o.watch=!!t.shouldUnregister,o.action=!1,J.keepErrors||(n.errors={}),f.state.next({submitCount:J.keepSubmitCount?n.submitCount:0,isDirty:he?!1:J.keepDirty?n.isDirty:!!(J.keepDefaultValues&&!Hs(U,s)),isSubmitted:J.keepIsSubmitted?n.isSubmitted:!1,dirtyFields:he?{}:J.keepDirtyValues?J.keepDefaultValues&&i?uc(s,i):n.dirtyFields:J.keepDefaultValues&&U?uc(s,U):J.keepDirty?n.dirtyFields:{},touchedFields:J.keepTouched?n.touchedFields:{},errors:J.keepErrors?n.errors:{},isSubmitSuccessful:J.keepIsSubmitSuccessful?n.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:s})},pn=(U,J)=>Ct(qs(U)?U(i):U,J),mn=(U,J={})=>{const Y=Se(r,U),ce=Y&&Y._f;if(ce){const he=ce.refs?ce.refs[0]:ce.ref;he.focus&&(he.focus(),J.shouldSelect&&qs(he.select)&&he.select())}},Fn=U=>{n={...n,...U}},Ee={control:{register:Z,unregister:W,getFieldState:A,handleSubmit:ge,setError:q,_subscribe:j,_runSchema:R,_focusError:ne,_getWatch:H,_getDirty:G,_setValid:v,_setFieldArray:S,_setDisabledField:ie,_setErrors:b,_getFieldArray:re,_reset:Ct,_resetDefaultValues:()=>qs(t.defaultValues)&&t.defaultValues().then(U=>{pn(U,t.resetOptions),f.state.next({isLoading:!1})}),_removeUnmounted:O,_disableForm:ae,_subjects:f,_proxyFormState:u,get _fields(){return r},get _formValues(){return i},get _state(){return o},set _state(U){o=U},get _defaultValues(){return s},get _names(){return l},set _names(U){l=U},get _formState(){return n},get _options(){return t},set _options(U){t={...t,...U}}},subscribe:$,trigger:E,register:Z,handleSubmit:ge,watch:P,setValue:V,getValues:M,reset:pn,resetField:Le,clearErrors:F,unregister:W,setError:q,setFocus:mn,getFieldState:A};return{...Ee,formControl:Ee}}var Aa=()=>{if(typeof crypto<"u"&&crypto.randomUUID)return crypto.randomUUID();const e=typeof performance>"u"?Date.now():performance.now()*1e3;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const n=(Math.random()*16+e)%16|0;return(t=="x"?n:n&3|8).toString(16)})},Ix=(e,t,n={})=>n.shouldFocus||Dt(n.shouldFocus)?n.focusName||`${e}.${Dt(n.focusIndex)?t:n.focusIndex}.`:"",Ax=(e,t)=>[...e,...Br(t)],Rx=e=>Array.isArray(e)?e.map(()=>{}):void 0;function jx(e,t,n){return[...e.slice(0,t),...Br(n),...e.slice(t)]}var Mx=(e,t,n)=>Array.isArray(e)?(Dt(e[n])&&(e[n]=void 0),e.splice(n,0,e.splice(t,1)[0]),e):[],Dx=(e,t)=>[...Br(t),...Br(e)];function Rle(e,t){let n=0;const r=[...e];for(const s of t)r.splice(s-n,1),n++;return Yv(r).length?r:[]}var Ox=(e,t)=>Dt(t)?[]:Rle(e,Br(t).sort((n,r)=>n-r)),Lx=(e,t,n)=>{[e[t],e[n]]=[e[n],e[t]]},YP=(e,t,n)=>(e[t]=n,e);function gm(e){const t=Uf(),{control:n=t.control,name:r,keyName:s="id",shouldUnregister:i,rules:o}=e,[l,c]=xe.useState(n._getFieldArray(r)),d=xe.useRef(n._getFieldArray(r).map(Aa)),u=xe.useRef(!1);n._names.array.add(r),xe.useMemo(()=>o&&l.length>=0&&n.register(r,o),[n,r,l.length,o]),Xv(()=>n._subjects.array.subscribe({next:({values:w,name:C})=>{if(C===r||!C){const I=Se(w,r);Array.isArray(I)&&(c(I),d.current=I.map(Aa))}}}).unsubscribe,[n,r]);const h=xe.useCallback(w=>{u.current=!0,n._setFieldArray(r,w)},[n,r]),f=(w,C)=>{const I=Br(Vt(w)),R=Ax(n._getFieldArray(r),I);n._names.focus=Ix(r,R.length-1,C),d.current=Ax(d.current,I.map(Aa)),h(R),c(R),n._setFieldArray(r,R,Ax,{argA:Rx(w)})},m=(w,C)=>{const I=Br(Vt(w)),R=Dx(n._getFieldArray(r),I);n._names.focus=Ix(r,0,C),d.current=Dx(d.current,I.map(Aa)),h(R),c(R),n._setFieldArray(r,R,Dx,{argA:Rx(w)})},g=w=>{const C=Ox(n._getFieldArray(r),w);d.current=Ox(d.current,w),h(C),c(C),!Array.isArray(Se(n._fields,r))&&_t(n._fields,r,void 0),n._setFieldArray(r,C,Ox,{argA:w})},v=(w,C,I)=>{const R=Br(Vt(C)),L=jx(n._getFieldArray(r),w,R);n._names.focus=Ix(r,w,I),d.current=jx(d.current,w,R.map(Aa)),h(L),c(L),n._setFieldArray(r,L,jx,{argA:w,argB:Rx(C)})},x=(w,C)=>{const I=n._getFieldArray(r);Lx(I,w,C),Lx(d.current,w,C),h(I),c(I),n._setFieldArray(r,I,Lx,{argA:w,argB:C},!1)},S=(w,C)=>{const I=n._getFieldArray(r);Mx(I,w,C),Mx(d.current,w,C),h(I),c(I),n._setFieldArray(r,I,Mx,{argA:w,argB:C},!1)},y=(w,C)=>{const I=Vt(C),R=YP(n._getFieldArray(r),w,I);d.current=[...R].map((L,N)=>!L||N===w?Aa():d.current[N]),h(R),c([...R]),n._setFieldArray(r,R,YP,{argA:w,argB:I},!0,!1)},b=w=>{const C=Br(Vt(w));d.current=C.map(Aa),h([...C]),c([...C]),n._setFieldArray(r,[...C],I=>I,{},!0,!1)};return xe.useEffect(()=>{if(n._state.action=!1,nS(r,n._names)&&n._subjects.state.next({...n._formState}),u.current&&(!Nc(n._options.mode).isOnSubmit||n._formState.isSubmitted)&&!Nc(n._options.reValidateMode).isOnSubmit)if(n._options.resolver)n._runSchema([r]).then(w=>{const C=Se(w.errors,r),I=Se(n._formState.errors,r);(I?!C&&I.type||C&&(I.type!==C.type||I.message!==C.message):C&&C.type)&&(C?_t(n._formState.errors,r,C):ln(n._formState.errors,r),n._subjects.state.next({errors:n._formState.errors}))});else{const w=Se(n._fields,r);w&&w._f&&!(Nc(n._options.reValidateMode).isOnSubmit&&Nc(n._options.mode).isOnSubmit)&&rS(w,n._names.disabled,n._formValues,n._options.criteriaMode===ks.all,n._options.shouldUseNativeValidation,!0).then(C=>!hr(C)&&n._subjects.state.next({errors:Q3(n._formState.errors,C,r)}))}n._subjects.state.next({name:r,values:Vt(n._formValues)}),n._names.focus&&Yc(n._fields,(w,C)=>{if(n._names.focus&&C.startsWith(n._names.focus)&&w.focus)return w.focus(),1}),n._names.focus="",n._setValid(),u.current=!1},[l,r,n]),xe.useEffect(()=>(!Se(n._formValues,r)&&n._setFieldArray(r),()=>{const w=(C,I)=>{const R=Se(n._fields,C);R&&R._f&&(R._f.mount=I)};n._options.shouldUnregister||i?n.unregister(r):w(r,!1)}),[r,n,s,i]),{swap:xe.useCallback(x,[h,r,n]),move:xe.useCallback(S,[h,r,n]),prepend:xe.useCallback(m,[h,r,n]),append:xe.useCallback(f,[h,r,n]),remove:xe.useCallback(g,[h,r,n]),insert:xe.useCallback(v,[h,r,n]),update:xe.useCallback(y,[h,r,n]),replace:xe.useCallback(b,[h,r,n]),fields:xe.useMemo(()=>l.map((w,C)=>({...w,[s]:d.current[C]||Aa()})),[l,s])}}function Zv(e={}){const t=xe.useRef(void 0),n=xe.useRef(void 0),[r,s]=xe.useState({isDirty:!1,isValidating:!1,isLoading:qs(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,isReady:!1,defaultValues:qs(e.defaultValues)?void 0:e.defaultValues});if(!t.current)if(e.formControl)t.current={...e.formControl,formState:r},e.defaultValues&&!qs(e.defaultValues)&&e.formControl.reset(e.defaultValues,e.resetOptions);else{const{formControl:o,...l}=Ale(e);t.current={...l,formState:r}}const i=t.current.control;return i._options=e,Xv(()=>{const o=i._subscribe({formState:i._proxyFormState,callback:()=>s({...i._formState}),reRenderRoot:!0});return s(l=>({...l,isReady:!0})),i._formState.isReady=!0,o},[i]),xe.useEffect(()=>i._disableForm(e.disabled),[i,e.disabled]),xe.useEffect(()=>{e.mode&&(i._options.mode=e.mode),e.reValidateMode&&(i._options.reValidateMode=e.reValidateMode)},[i,e.mode,e.reValidateMode]),xe.useEffect(()=>{e.errors&&(i._setErrors(e.errors),i._focusError())},[i,e.errors]),xe.useEffect(()=>{e.shouldUnregister&&i._subjects.state.next({values:i._getWatch()})},[i,e.shouldUnregister]),xe.useEffect(()=>{if(i._proxyFormState.isDirty){const o=i._getDirty();o!==r.isDirty&&i._subjects.state.next({isDirty:o})}},[i,r.isDirty]),xe.useEffect(()=>{var o;e.values&&!Hs(e.values,n.current)?(i._reset(e.values,{keepFieldsRef:!0,...i._options.resetOptions}),!((o=i._options.resetOptions)===null||o===void 0)&&o.keepIsValid||i._setValid(),n.current=e.values,s(l=>({...l}))):i._resetDefaultValues()},[i,e.values]),xe.useEffect(()=>{i._state.mount||(i._setValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),t.current.formState=V3(r,i),t.current}const XP=(e,t,n)=>{if(e&&"reportValidity"in e){const r=Se(n,t);e.setCustomValidity(r&&r.message||""),e.reportValidity()}},J3=(e,t)=>{for(const n in t.fields){const r=t.fields[n];r&&r.ref&&"reportValidity"in r.ref?XP(r.ref,n,e):r.refs&&r.refs.forEach(s=>XP(s,n,e))}},jle=(e,t)=>{t.shouldUseNativeValidation&&J3(e,t);const n={};for(const r in e){const s=Se(t.fields,r),i=Object.assign(e[r]||{},{ref:s&&s.ref});if(Mle(t.names||Object.keys(e),r)){const o=Object.assign({},Se(n,r));_t(o,"root",i),_t(n,r,o)}else _t(n,r,i)}return n},Mle=(e,t)=>e.some(n=>n.startsWith(t+"."));var Dle=function(e,t){for(var n={};e.length;){var r=e[0],s=r.code,i=r.message,o=r.path.join(".");if(!n[o])if("unionErrors"in r){var l=r.unionErrors[0].errors[0];n[o]={message:l.message,type:l.code}}else n[o]={message:i,type:s};if("unionErrors"in r&&r.unionErrors.forEach(function(u){return u.errors.forEach(function(h){return e.push(h)})}),t){var c=n[o].types,d=c&&c[r.code];n[o]=B3(o,t,n,s,d?[].concat(d,r.message):r.message)}e.shift()}return n},ey=function(e,t,n){return n===void 0&&(n={}),function(r,s,i){try{return Promise.resolve(function(o,l){try{var c=Promise.resolve(e[n.mode==="sync"?"parse":"parseAsync"](r,t)).then(function(d){return i.shouldUseNativeValidation&&J3({},i),{errors:{},values:n.raw?r:d}})}catch(d){return l(d)}return c&&c.then?c.then(void 0,l):c}(0,function(o){if(function(l){return Array.isArray(l==null?void 0:l.errors)}(o))return{values:{},errors:jle(Dle(o.errors,!i.shouldUseNativeValidation&&i.criteriaMode==="all"),i)};throw o}))}catch(o){return Promise.reject(o)}}},bt;(function(e){e.assertEqual=s=>{};function t(s){}e.assertIs=t;function n(s){throw new Error}e.assertNever=n,e.arrayToEnum=s=>{const i={};for(const o of s)i[o]=o;return i},e.getValidEnumValues=s=>{const i=e.objectKeys(s).filter(l=>typeof s[s[l]]!="number"),o={};for(const l of i)o[l]=s[l];return e.objectValues(o)},e.objectValues=s=>e.objectKeys(s).map(function(i){return s[i]}),e.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const o in s)Object.prototype.hasOwnProperty.call(s,o)&&i.push(o);return i},e.find=(s,i)=>{for(const o of s)if(i(o))return o},e.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&Number.isFinite(s)&&Math.floor(s)===s;function r(s,i=" | "){return s.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}e.joinValues=r,e.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(bt||(bt={}));var sS;(function(e){e.mergeShapes=(t,n)=>({...t,...n})})(sS||(sS={}));const Pe=bt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Hi=e=>{switch(typeof e){case"undefined":return Pe.undefined;case"string":return Pe.string;case"number":return Number.isNaN(e)?Pe.nan:Pe.number;case"boolean":return Pe.boolean;case"function":return Pe.function;case"bigint":return Pe.bigint;case"symbol":return Pe.symbol;case"object":return Array.isArray(e)?Pe.array:e===null?Pe.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?Pe.promise:typeof Map<"u"&&e instanceof Map?Pe.map:typeof Set<"u"&&e instanceof Set?Pe.set:typeof Date<"u"&&e instanceof Date?Pe.date:Pe.object;default:return Pe.unknown}},ve=bt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),Ole=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:");class ls extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=t}format(t){const n=t||function(i){return i.message},r={_errors:[]},s=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(s);else if(o.code==="invalid_return_type")s(o.returnTypeError);else if(o.code==="invalid_arguments")s(o.argumentsError);else if(o.path.length===0)r._errors.push(n(o));else{let l=r,c=0;for(;c<o.path.length;){const d=o.path[c];c===o.path.length-1?(l[d]=l[d]||{_errors:[]},l[d]._errors.push(n(o))):l[d]=l[d]||{_errors:[]},l=l[d],c++}}};return s(this),r}static assert(t){if(!(t instanceof ls))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,bt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=n=>n.message){const n={},r=[];for(const s of this.issues)if(s.path.length>0){const i=s.path[0];n[i]=n[i]||[],n[i].push(t(s))}else r.push(t(s));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}ls.create=e=>new ls(e);const Ad=(e,t)=>{let n;switch(e.code){case ve.invalid_type:e.received===Pe.undefined?n="Required":n=`Expected ${e.expected}, received ${e.received}`;break;case ve.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,bt.jsonStringifyReplacer)}`;break;case ve.unrecognized_keys:n=`Unrecognized key(s) in object: ${bt.joinValues(e.keys,", ")}`;break;case ve.invalid_union:n="Invalid input";break;case ve.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${bt.joinValues(e.options)}`;break;case ve.invalid_enum_value:n=`Invalid enum value. Expected ${bt.joinValues(e.options)}, received '${e.received}'`;break;case ve.invalid_arguments:n="Invalid function arguments";break;case ve.invalid_return_type:n="Invalid function return type";break;case ve.invalid_date:n="Invalid date";break;case ve.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:bt.assertNever(e.validation):e.validation!=="regex"?n=`Invalid ${e.validation}`:n="Invalid";break;case ve.too_small:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="bigint"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:n="Invalid input";break;case ve.too_big:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?n=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:n="Invalid input";break;case ve.custom:n="Invalid input";break;case ve.invalid_intersection_types:n="Intersection results could not be merged";break;case ve.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case ve.not_finite:n="Number must be finite";break;default:n=t.defaultError,bt.assertNever(e)}return{message:n}};let Y3=Ad;function Lle(e){Y3=e}function Pg(){return Y3}const Ng=e=>{const{data:t,path:n,errorMaps:r,issueData:s}=e,i=[...n,...s.path||[]],o={...s,path:i};if(s.message!==void 0)return{...s,path:i,message:s.message};let l="";const c=r.filter(d=>!!d).slice().reverse();for(const d of c)l=d(o,{data:t,defaultError:l}).message;return{...s,path:i,message:l}},Fle=[];function Te(e,t){const n=Pg(),r=Ng({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===Ad?void 0:Ad].filter(s=>!!s)});e.common.issues.push(r)}class yr{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,n){const r=[];for(const s of n){if(s.status==="aborted")return Ge;s.status==="dirty"&&t.dirty(),r.push(s.value)}return{status:t.value,value:r}}static async mergeObjectAsync(t,n){const r=[];for(const s of n){const i=await s.key,o=await s.value;r.push({key:i,value:o})}return yr.mergeObjectSync(t,r)}static mergeObjectSync(t,n){const r={};for(const s of n){const{key:i,value:o}=s;if(i.status==="aborted"||o.status==="aborted")return Ge;i.status==="dirty"&&t.dirty(),o.status==="dirty"&&t.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||s.alwaysSet)&&(r[i.value]=o.value)}return{status:t.value,value:r}}}const Ge=Object.freeze({status:"aborted"}),Ic=e=>({status:"dirty",value:e}),Rr=e=>({status:"valid",value:e}),iS=e=>e.status==="aborted",aS=e=>e.status==="dirty",Bl=e=>e.status==="valid",Uh=e=>typeof Promise<"u"&&e instanceof Promise;var De;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(De||(De={}));class _i{constructor(t,n,r,s){this._cachedPath=[],this.parent=t,this.data=n,this._path=r,this._key=s}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const ZP=(e,t)=>{if(Bl(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new ls(e.common.issues);return this._error=n,this._error}}};function nt(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:r,description:s}=e;if(t&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:s}:{errorMap:(o,l)=>{const{message:c}=e;return o.code==="invalid_enum_value"?{message:c??l.defaultError}:typeof l.data>"u"?{message:c??r??l.defaultError}:o.code!=="invalid_type"?{message:l.defaultError}:{message:c??n??l.defaultError}},description:s}}class ot{get description(){return this._def.description}_getType(t){return Hi(t.data)}_getOrReturnCtx(t,n){return n||{common:t.parent.common,data:t.data,parsedType:Hi(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new yr,ctx:{common:t.parent.common,data:t.data,parsedType:Hi(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const n=this._parse(t);if(Uh(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(t){const n=this._parse(t);return Promise.resolve(n)}parse(t,n){const r=this.safeParse(t,n);if(r.success)return r.data;throw r.error}safeParse(t,n){const r={common:{issues:[],async:(n==null?void 0:n.async)??!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Hi(t)},s=this._parseSync({data:t,path:r.path,parent:r});return ZP(r,s)}"~validate"(t){var r,s;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Hi(t)};if(!this["~standard"].async)try{const i=this._parseSync({data:t,path:[],parent:n});return Bl(i)?{value:i.value}:{issues:n.common.issues}}catch(i){(s=(r=i==null?void 0:i.message)==null?void 0:r.toLowerCase())!=null&&s.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:n}).then(i=>Bl(i)?{value:i.value}:{issues:n.common.issues})}async parseAsync(t,n){const r=await this.safeParseAsync(t,n);if(r.success)return r.data;throw r.error}async safeParseAsync(t,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Hi(t)},s=this._parse({data:t,path:r.path,parent:r}),i=await(Uh(s)?s:Promise.resolve(s));return ZP(r,i)}refine(t,n){const r=s=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(s):n;return this._refinement((s,i)=>{const o=t(s),l=()=>i.addIssue({code:ve.custom,...r(s)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(l(),!1)):o?!0:(l(),!1)})}refinement(t,n){return this._refinement((r,s)=>t(r)?!0:(s.addIssue(typeof n=="function"?n(r,s):n),!1))}_refinement(t){return new ai({schema:this,typeName:He.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return Ti.create(this,this._def)}nullable(){return Ro.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ei.create(this)}promise(){return jd.create(this,this._def)}or(t){return Gh.create([this,t],this._def)}and(t){return Wh.create(this,t,this._def)}transform(t){return new ai({...nt(this._def),schema:this,typeName:He.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const n=typeof t=="function"?t:()=>t;return new Jh({...nt(this._def),innerType:this,defaultValue:n,typeName:He.ZodDefault})}brand(){return new wT({typeName:He.ZodBranded,type:this,...nt(this._def)})}catch(t){const n=typeof t=="function"?t:()=>t;return new Yh({...nt(this._def),innerType:this,catchValue:n,typeName:He.ZodCatch})}describe(t){const n=this.constructor;return new n({...this._def,description:t})}pipe(t){return Vf.create(this,t)}readonly(){return Xh.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const $le=/^c[^\s-]{8,}$/i,Ule=/^[0-9a-z]+$/,Vle=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Ble=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,zle=/^[a-z0-9_-]{21}$/i,Gle=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Wle=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Hle=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,qle="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Fx;const Kle=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Qle=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Jle=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Yle=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Xle=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Zle=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,X3="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",ece=new RegExp(`^${X3}$`);function Z3(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`);const n=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${n}`}function tce(e){return new RegExp(`^${Z3(e)}$`)}function eU(e){let t=`${X3}T${Z3(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function nce(e,t){return!!((t==="v4"||!t)&&Kle.test(e)||(t==="v6"||!t)&&Jle.test(e))}function rce(e,t){if(!Gle.test(e))return!1;try{const[n]=e.split(".");if(!n)return!1;const r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),s=JSON.parse(atob(r));return!(typeof s!="object"||s===null||"typ"in s&&(s==null?void 0:s.typ)!=="JWT"||!s.alg||t&&s.alg!==t)}catch{return!1}}function sce(e,t){return!!((t==="v4"||!t)&&Qle.test(e)||(t==="v6"||!t)&&Yle.test(e))}class Js extends ot{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==Pe.string){const i=this._getOrReturnCtx(t);return Te(i,{code:ve.invalid_type,expected:Pe.string,received:i.parsedType}),Ge}const r=new yr;let s;for(const i of this._def.checks)if(i.kind==="min")t.data.length<i.value&&(s=this._getOrReturnCtx(t,s),Te(s,{code:ve.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")t.data.length>i.value&&(s=this._getOrReturnCtx(t,s),Te(s,{code:ve.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const o=t.data.length>i.value,l=t.data.length<i.value;(o||l)&&(s=this._getOrReturnCtx(t,s),o?Te(s,{code:ve.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):l&&Te(s,{code:ve.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")Hle.test(t.data)||(s=this._getOrReturnCtx(t,s),Te(s,{validation:"email",code:ve.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")Fx||(Fx=new RegExp(qle,"u")),Fx.test(t.data)||(s=this._getOrReturnCtx(t,s),Te(s,{validation:"emoji",code:ve.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")Ble.test(t.data)||(s=this._getOrReturnCtx(t,s),Te(s,{validation:"uuid",code:ve.invalid_string,message:i.message}),r.dirty());else if(i.kind==="nanoid")zle.test(t.data)||(s=this._getOrReturnCtx(t,s),Te(s,{validation:"nanoid",code:ve.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")$le.test(t.data)||(s=this._getOrReturnCtx(t,s),Te(s,{validation:"cuid",code:ve.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")Ule.test(t.data)||(s=this._getOrReturnCtx(t,s),Te(s,{validation:"cuid2",code:ve.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")Vle.test(t.data)||(s=this._getOrReturnCtx(t,s),Te(s,{validation:"ulid",code:ve.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(t.data)}catch{s=this._getOrReturnCtx(t,s),Te(s,{validation:"url",code:ve.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(t.data)||(s=this._getOrReturnCtx(t,s),Te(s,{validation:"regex",code:ve.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?t.data=t.data.trim():i.kind==="includes"?t.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(t,s),Te(s,{code:ve.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?t.data=t.data.toLowerCase():i.kind==="toUpperCase"?t.data=t.data.toUpperCase():i.kind==="startsWith"?t.data.startsWith(i.value)||(s=this._getOrReturnCtx(t,s),Te(s,{code:ve.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?t.data.endsWith(i.value)||(s=this._getOrReturnCtx(t,s),Te(s,{code:ve.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?eU(i).test(t.data)||(s=this._getOrReturnCtx(t,s),Te(s,{code:ve.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="date"?ece.test(t.data)||(s=this._getOrReturnCtx(t,s),Te(s,{code:ve.invalid_string,validation:"date",message:i.message}),r.dirty()):i.kind==="time"?tce(i).test(t.data)||(s=this._getOrReturnCtx(t,s),Te(s,{code:ve.invalid_string,validation:"time",message:i.message}),r.dirty()):i.kind==="duration"?Wle.test(t.data)||(s=this._getOrReturnCtx(t,s),Te(s,{validation:"duration",code:ve.invalid_string,message:i.message}),r.dirty()):i.kind==="ip"?nce(t.data,i.version)||(s=this._getOrReturnCtx(t,s),Te(s,{validation:"ip",code:ve.invalid_string,message:i.message}),r.dirty()):i.kind==="jwt"?rce(t.data,i.alg)||(s=this._getOrReturnCtx(t,s),Te(s,{validation:"jwt",code:ve.invalid_string,message:i.message}),r.dirty()):i.kind==="cidr"?sce(t.data,i.version)||(s=this._getOrReturnCtx(t,s),Te(s,{validation:"cidr",code:ve.invalid_string,message:i.message}),r.dirty()):i.kind==="base64"?Xle.test(t.data)||(s=this._getOrReturnCtx(t,s),Te(s,{validation:"base64",code:ve.invalid_string,message:i.message}),r.dirty()):i.kind==="base64url"?Zle.test(t.data)||(s=this._getOrReturnCtx(t,s),Te(s,{validation:"base64url",code:ve.invalid_string,message:i.message}),r.dirty()):bt.assertNever(i);return{status:r.value,value:t.data}}_regex(t,n,r){return this.refinement(s=>t.test(s),{validation:n,code:ve.invalid_string,...De.errToObj(r)})}_addCheck(t){return new Js({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...De.errToObj(t)})}url(t){return this._addCheck({kind:"url",...De.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...De.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...De.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...De.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...De.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...De.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...De.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...De.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...De.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...De.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...De.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...De.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(t==null?void 0:t.offset)??!1,local:(t==null?void 0:t.local)??!1,...De.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...De.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...De.errToObj(t)})}regex(t,n){return this._addCheck({kind:"regex",regex:t,...De.errToObj(n)})}includes(t,n){return this._addCheck({kind:"includes",value:t,position:n==null?void 0:n.position,...De.errToObj(n==null?void 0:n.message)})}startsWith(t,n){return this._addCheck({kind:"startsWith",value:t,...De.errToObj(n)})}endsWith(t,n){return this._addCheck({kind:"endsWith",value:t,...De.errToObj(n)})}min(t,n){return this._addCheck({kind:"min",value:t,...De.errToObj(n)})}max(t,n){return this._addCheck({kind:"max",value:t,...De.errToObj(n)})}length(t,n){return this._addCheck({kind:"length",value:t,...De.errToObj(n)})}nonempty(t){return this.min(1,De.errToObj(t))}trim(){return new Js({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Js({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Js({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxLength(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}Js.create=e=>new Js({checks:[],typeName:He.ZodString,coerce:(e==null?void 0:e.coerce)??!1,...nt(e)});function ice(e,t){const n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,s=n>r?n:r,i=Number.parseInt(e.toFixed(s).replace(".","")),o=Number.parseInt(t.toFixed(s).replace(".",""));return i%o/10**s}class No extends ot{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==Pe.number){const i=this._getOrReturnCtx(t);return Te(i,{code:ve.invalid_type,expected:Pe.number,received:i.parsedType}),Ge}let r;const s=new yr;for(const i of this._def.checks)i.kind==="int"?bt.isInteger(t.data)||(r=this._getOrReturnCtx(t,r),Te(r,{code:ve.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(r=this._getOrReturnCtx(t,r),Te(r,{code:ve.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(r=this._getOrReturnCtx(t,r),Te(r,{code:ve.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?ice(t.data,i.value)!==0&&(r=this._getOrReturnCtx(t,r),Te(r,{code:ve.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(t.data)||(r=this._getOrReturnCtx(t,r),Te(r,{code:ve.not_finite,message:i.message}),s.dirty()):bt.assertNever(i);return{status:s.value,value:t.data}}gte(t,n){return this.setLimit("min",t,!0,De.toString(n))}gt(t,n){return this.setLimit("min",t,!1,De.toString(n))}lte(t,n){return this.setLimit("max",t,!0,De.toString(n))}lt(t,n){return this.setLimit("max",t,!1,De.toString(n))}setLimit(t,n,r,s){return new No({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:De.toString(s)}]})}_addCheck(t){return new No({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:De.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:De.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:De.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:De.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:De.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:De.toString(n)})}finite(t){return this._addCheck({kind:"finite",message:De.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:De.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:De.toString(t)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&bt.isInteger(t.value))}get isFinite(){let t=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(t===null||r.value<t)&&(t=r.value)}return Number.isFinite(n)&&Number.isFinite(t)}}No.create=e=>new No({checks:[],typeName:He.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...nt(e)});class Io extends ot{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==Pe.bigint)return this._getInvalidInput(t);let r;const s=new yr;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(r=this._getOrReturnCtx(t,r),Te(r,{code:ve.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(r=this._getOrReturnCtx(t,r),Te(r,{code:ve.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?t.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(t,r),Te(r,{code:ve.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):bt.assertNever(i);return{status:s.value,value:t.data}}_getInvalidInput(t){const n=this._getOrReturnCtx(t);return Te(n,{code:ve.invalid_type,expected:Pe.bigint,received:n.parsedType}),Ge}gte(t,n){return this.setLimit("min",t,!0,De.toString(n))}gt(t,n){return this.setLimit("min",t,!1,De.toString(n))}lte(t,n){return this.setLimit("max",t,!0,De.toString(n))}lt(t,n){return this.setLimit("max",t,!1,De.toString(n))}setLimit(t,n,r,s){return new Io({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:De.toString(s)}]})}_addCheck(t){return new Io({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:De.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:De.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:De.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:De.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:De.toString(n)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}Io.create=e=>new Io({checks:[],typeName:He.ZodBigInt,coerce:(e==null?void 0:e.coerce)??!1,...nt(e)});class Vh extends ot{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==Pe.boolean){const r=this._getOrReturnCtx(t);return Te(r,{code:ve.invalid_type,expected:Pe.boolean,received:r.parsedType}),Ge}return Rr(t.data)}}Vh.create=e=>new Vh({typeName:He.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...nt(e)});class zl extends ot{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==Pe.date){const i=this._getOrReturnCtx(t);return Te(i,{code:ve.invalid_type,expected:Pe.date,received:i.parsedType}),Ge}if(Number.isNaN(t.data.getTime())){const i=this._getOrReturnCtx(t);return Te(i,{code:ve.invalid_date}),Ge}const r=new yr;let s;for(const i of this._def.checks)i.kind==="min"?t.data.getTime()<i.value&&(s=this._getOrReturnCtx(t,s),Te(s,{code:ve.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?t.data.getTime()>i.value&&(s=this._getOrReturnCtx(t,s),Te(s,{code:ve.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):bt.assertNever(i);return{status:r.value,value:new Date(t.data.getTime())}}_addCheck(t){return new zl({...this._def,checks:[...this._def.checks,t]})}min(t,n){return this._addCheck({kind:"min",value:t.getTime(),message:De.toString(n)})}max(t,n){return this._addCheck({kind:"max",value:t.getTime(),message:De.toString(n)})}get minDate(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t!=null?new Date(t):null}}zl.create=e=>new zl({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:He.ZodDate,...nt(e)});class Ig extends ot{_parse(t){if(this._getType(t)!==Pe.symbol){const r=this._getOrReturnCtx(t);return Te(r,{code:ve.invalid_type,expected:Pe.symbol,received:r.parsedType}),Ge}return Rr(t.data)}}Ig.create=e=>new Ig({typeName:He.ZodSymbol,...nt(e)});class Bh extends ot{_parse(t){if(this._getType(t)!==Pe.undefined){const r=this._getOrReturnCtx(t);return Te(r,{code:ve.invalid_type,expected:Pe.undefined,received:r.parsedType}),Ge}return Rr(t.data)}}Bh.create=e=>new Bh({typeName:He.ZodUndefined,...nt(e)});class zh extends ot{_parse(t){if(this._getType(t)!==Pe.null){const r=this._getOrReturnCtx(t);return Te(r,{code:ve.invalid_type,expected:Pe.null,received:r.parsedType}),Ge}return Rr(t.data)}}zh.create=e=>new zh({typeName:He.ZodNull,...nt(e)});class Rd extends ot{constructor(){super(...arguments),this._any=!0}_parse(t){return Rr(t.data)}}Rd.create=e=>new Rd({typeName:He.ZodAny,...nt(e)});class Tl extends ot{constructor(){super(...arguments),this._unknown=!0}_parse(t){return Rr(t.data)}}Tl.create=e=>new Tl({typeName:He.ZodUnknown,...nt(e)});class xa extends ot{_parse(t){const n=this._getOrReturnCtx(t);return Te(n,{code:ve.invalid_type,expected:Pe.never,received:n.parsedType}),Ge}}xa.create=e=>new xa({typeName:He.ZodNever,...nt(e)});class Ag extends ot{_parse(t){if(this._getType(t)!==Pe.undefined){const r=this._getOrReturnCtx(t);return Te(r,{code:ve.invalid_type,expected:Pe.void,received:r.parsedType}),Ge}return Rr(t.data)}}Ag.create=e=>new Ag({typeName:He.ZodVoid,...nt(e)});class ei extends ot{_parse(t){const{ctx:n,status:r}=this._processInputParams(t),s=this._def;if(n.parsedType!==Pe.array)return Te(n,{code:ve.invalid_type,expected:Pe.array,received:n.parsedType}),Ge;if(s.exactLength!==null){const o=n.data.length>s.exactLength.value,l=n.data.length<s.exactLength.value;(o||l)&&(Te(n,{code:o?ve.too_big:ve.too_small,minimum:l?s.exactLength.value:void 0,maximum:o?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&n.data.length<s.minLength.value&&(Te(n,{code:ve.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&n.data.length>s.maxLength.value&&(Te(n,{code:ve.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((o,l)=>s.type._parseAsync(new _i(n,o,n.path,l)))).then(o=>yr.mergeArray(r,o));const i=[...n.data].map((o,l)=>s.type._parseSync(new _i(n,o,n.path,l)));return yr.mergeArray(r,i)}get element(){return this._def.type}min(t,n){return new ei({...this._def,minLength:{value:t,message:De.toString(n)}})}max(t,n){return new ei({...this._def,maxLength:{value:t,message:De.toString(n)}})}length(t,n){return new ei({...this._def,exactLength:{value:t,message:De.toString(n)}})}nonempty(t){return this.min(1,t)}}ei.create=(e,t)=>new ei({type:e,minLength:null,maxLength:null,exactLength:null,typeName:He.ZodArray,...nt(t)});function hc(e){if(e instanceof Kt){const t={};for(const n in e.shape){const r=e.shape[n];t[n]=Ti.create(hc(r))}return new Kt({...e._def,shape:()=>t})}else return e instanceof ei?new ei({...e._def,type:hc(e.element)}):e instanceof Ti?Ti.create(hc(e.unwrap())):e instanceof Ro?Ro.create(hc(e.unwrap())):e instanceof Pi?Pi.create(e.items.map(t=>hc(t))):e}class Kt extends ot{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),n=bt.objectKeys(t);return this._cached={shape:t,keys:n},this._cached}_parse(t){if(this._getType(t)!==Pe.object){const d=this._getOrReturnCtx(t);return Te(d,{code:ve.invalid_type,expected:Pe.object,received:d.parsedType}),Ge}const{status:r,ctx:s}=this._processInputParams(t),{shape:i,keys:o}=this._getCached(),l=[];if(!(this._def.catchall instanceof xa&&this._def.unknownKeys==="strip"))for(const d in s.data)o.includes(d)||l.push(d);const c=[];for(const d of o){const u=i[d],h=s.data[d];c.push({key:{status:"valid",value:d},value:u._parse(new _i(s,h,s.path,d)),alwaysSet:d in s.data})}if(this._def.catchall instanceof xa){const d=this._def.unknownKeys;if(d==="passthrough")for(const u of l)c.push({key:{status:"valid",value:u},value:{status:"valid",value:s.data[u]}});else if(d==="strict")l.length>0&&(Te(s,{code:ve.unrecognized_keys,keys:l}),r.dirty());else if(d!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const d=this._def.catchall;for(const u of l){const h=s.data[u];c.push({key:{status:"valid",value:u},value:d._parse(new _i(s,h,s.path,u)),alwaysSet:u in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const d=[];for(const u of c){const h=await u.key,f=await u.value;d.push({key:h,value:f,alwaysSet:u.alwaysSet})}return d}).then(d=>yr.mergeObjectSync(r,d)):yr.mergeObjectSync(r,c)}get shape(){return this._def.shape()}strict(t){return De.errToObj,new Kt({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(n,r)=>{var i,o;const s=((o=(i=this._def).errorMap)==null?void 0:o.call(i,n,r).message)??r.defaultError;return n.code==="unrecognized_keys"?{message:De.errToObj(t).message??s}:{message:s}}}:{}})}strip(){return new Kt({...this._def,unknownKeys:"strip"})}passthrough(){return new Kt({...this._def,unknownKeys:"passthrough"})}extend(t){return new Kt({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new Kt({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:He.ZodObject})}setKey(t,n){return this.augment({[t]:n})}catchall(t){return new Kt({...this._def,catchall:t})}pick(t){const n={};for(const r of bt.objectKeys(t))t[r]&&this.shape[r]&&(n[r]=this.shape[r]);return new Kt({...this._def,shape:()=>n})}omit(t){const n={};for(const r of bt.objectKeys(this.shape))t[r]||(n[r]=this.shape[r]);return new Kt({...this._def,shape:()=>n})}deepPartial(){return hc(this)}partial(t){const n={};for(const r of bt.objectKeys(this.shape)){const s=this.shape[r];t&&!t[r]?n[r]=s:n[r]=s.optional()}return new Kt({...this._def,shape:()=>n})}required(t){const n={};for(const r of bt.objectKeys(this.shape))if(t&&!t[r])n[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof Ti;)i=i._def.innerType;n[r]=i}return new Kt({...this._def,shape:()=>n})}keyof(){return tU(bt.objectKeys(this.shape))}}Kt.create=(e,t)=>new Kt({shape:()=>e,unknownKeys:"strip",catchall:xa.create(),typeName:He.ZodObject,...nt(t)});Kt.strictCreate=(e,t)=>new Kt({shape:()=>e,unknownKeys:"strict",catchall:xa.create(),typeName:He.ZodObject,...nt(t)});Kt.lazycreate=(e,t)=>new Kt({shape:e,unknownKeys:"strip",catchall:xa.create(),typeName:He.ZodObject,...nt(t)});class Gh extends ot{_parse(t){const{ctx:n}=this._processInputParams(t),r=this._def.options;function s(i){for(const l of i)if(l.result.status==="valid")return l.result;for(const l of i)if(l.result.status==="dirty")return n.common.issues.push(...l.ctx.common.issues),l.result;const o=i.map(l=>new ls(l.ctx.common.issues));return Te(n,{code:ve.invalid_union,unionErrors:o}),Ge}if(n.common.async)return Promise.all(r.map(async i=>{const o={...n,common:{...n.common,issues:[]},parent:null};return{result:await i._parseAsync({data:n.data,path:n.path,parent:o}),ctx:o}})).then(s);{let i;const o=[];for(const c of r){const d={...n,common:{...n.common,issues:[]},parent:null},u=c._parseSync({data:n.data,path:n.path,parent:d});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:d}),d.common.issues.length&&o.push(d.common.issues)}if(i)return n.common.issues.push(...i.ctx.common.issues),i.result;const l=o.map(c=>new ls(c));return Te(n,{code:ve.invalid_union,unionErrors:l}),Ge}}get options(){return this._def.options}}Gh.create=(e,t)=>new Gh({options:e,typeName:He.ZodUnion,...nt(t)});const Bi=e=>e instanceof qh?Bi(e.schema):e instanceof ai?Bi(e.innerType()):e instanceof Kh?[e.value]:e instanceof Ao?e.options:e instanceof Qh?bt.objectValues(e.enum):e instanceof Jh?Bi(e._def.innerType):e instanceof Bh?[void 0]:e instanceof zh?[null]:e instanceof Ti?[void 0,...Bi(e.unwrap())]:e instanceof Ro?[null,...Bi(e.unwrap())]:e instanceof wT||e instanceof Xh?Bi(e.unwrap()):e instanceof Yh?Bi(e._def.innerType):[];class ty extends ot{_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==Pe.object)return Te(n,{code:ve.invalid_type,expected:Pe.object,received:n.parsedType}),Ge;const r=this.discriminator,s=n.data[r],i=this.optionsMap.get(s);return i?n.common.async?i._parseAsync({data:n.data,path:n.path,parent:n}):i._parseSync({data:n.data,path:n.path,parent:n}):(Te(n,{code:ve.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),Ge)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,n,r){const s=new Map;for(const i of n){const o=Bi(i.shape[t]);if(!o.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const l of o){if(s.has(l))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(l)}`);s.set(l,i)}}return new ty({typeName:He.ZodDiscriminatedUnion,discriminator:t,options:n,optionsMap:s,...nt(r)})}}function oS(e,t){const n=Hi(e),r=Hi(t);if(e===t)return{valid:!0,data:e};if(n===Pe.object&&r===Pe.object){const s=bt.objectKeys(t),i=bt.objectKeys(e).filter(l=>s.indexOf(l)!==-1),o={...e,...t};for(const l of i){const c=oS(e[l],t[l]);if(!c.valid)return{valid:!1};o[l]=c.data}return{valid:!0,data:o}}else if(n===Pe.array&&r===Pe.array){if(e.length!==t.length)return{valid:!1};const s=[];for(let i=0;i<e.length;i++){const o=e[i],l=t[i],c=oS(o,l);if(!c.valid)return{valid:!1};s.push(c.data)}return{valid:!0,data:s}}else return n===Pe.date&&r===Pe.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class Wh extends ot{_parse(t){const{status:n,ctx:r}=this._processInputParams(t),s=(i,o)=>{if(iS(i)||iS(o))return Ge;const l=oS(i.value,o.value);return l.valid?((aS(i)||aS(o))&&n.dirty(),{status:n.value,value:l.data}):(Te(r,{code:ve.invalid_intersection_types}),Ge)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,o])=>s(i,o)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}Wh.create=(e,t,n)=>new Wh({left:e,right:t,typeName:He.ZodIntersection,...nt(n)});class Pi extends ot{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==Pe.array)return Te(r,{code:ve.invalid_type,expected:Pe.array,received:r.parsedType}),Ge;if(r.data.length<this._def.items.length)return Te(r,{code:ve.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Ge;!this._def.rest&&r.data.length>this._def.items.length&&(Te(r,{code:ve.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const i=[...r.data].map((o,l)=>{const c=this._def.items[l]||this._def.rest;return c?c._parse(new _i(r,o,r.path,l)):null}).filter(o=>!!o);return r.common.async?Promise.all(i).then(o=>yr.mergeArray(n,o)):yr.mergeArray(n,i)}get items(){return this._def.items}rest(t){return new Pi({...this._def,rest:t})}}Pi.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Pi({items:e,typeName:He.ZodTuple,rest:null,...nt(t)})};class Hh extends ot{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==Pe.object)return Te(r,{code:ve.invalid_type,expected:Pe.object,received:r.parsedType}),Ge;const s=[],i=this._def.keyType,o=this._def.valueType;for(const l in r.data)s.push({key:i._parse(new _i(r,l,r.path,l)),value:o._parse(new _i(r,r.data[l],r.path,l)),alwaysSet:l in r.data});return r.common.async?yr.mergeObjectAsync(n,s):yr.mergeObjectSync(n,s)}get element(){return this._def.valueType}static create(t,n,r){return n instanceof ot?new Hh({keyType:t,valueType:n,typeName:He.ZodRecord,...nt(r)}):new Hh({keyType:Js.create(),valueType:t,typeName:He.ZodRecord,...nt(n)})}}class Rg extends ot{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==Pe.map)return Te(r,{code:ve.invalid_type,expected:Pe.map,received:r.parsedType}),Ge;const s=this._def.keyType,i=this._def.valueType,o=[...r.data.entries()].map(([l,c],d)=>({key:s._parse(new _i(r,l,r.path,[d,"key"])),value:i._parse(new _i(r,c,r.path,[d,"value"]))}));if(r.common.async){const l=new Map;return Promise.resolve().then(async()=>{for(const c of o){const d=await c.key,u=await c.value;if(d.status==="aborted"||u.status==="aborted")return Ge;(d.status==="dirty"||u.status==="dirty")&&n.dirty(),l.set(d.value,u.value)}return{status:n.value,value:l}})}else{const l=new Map;for(const c of o){const d=c.key,u=c.value;if(d.status==="aborted"||u.status==="aborted")return Ge;(d.status==="dirty"||u.status==="dirty")&&n.dirty(),l.set(d.value,u.value)}return{status:n.value,value:l}}}}Rg.create=(e,t,n)=>new Rg({valueType:t,keyType:e,typeName:He.ZodMap,...nt(n)});class Gl extends ot{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==Pe.set)return Te(r,{code:ve.invalid_type,expected:Pe.set,received:r.parsedType}),Ge;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(Te(r,{code:ve.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),n.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(Te(r,{code:ve.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),n.dirty());const i=this._def.valueType;function o(c){const d=new Set;for(const u of c){if(u.status==="aborted")return Ge;u.status==="dirty"&&n.dirty(),d.add(u.value)}return{status:n.value,value:d}}const l=[...r.data.values()].map((c,d)=>i._parse(new _i(r,c,r.path,d)));return r.common.async?Promise.all(l).then(c=>o(c)):o(l)}min(t,n){return new Gl({...this._def,minSize:{value:t,message:De.toString(n)}})}max(t,n){return new Gl({...this._def,maxSize:{value:t,message:De.toString(n)}})}size(t,n){return this.min(t,n).max(t,n)}nonempty(t){return this.min(1,t)}}Gl.create=(e,t)=>new Gl({valueType:e,minSize:null,maxSize:null,typeName:He.ZodSet,...nt(t)});class Xc extends ot{constructor(){super(...arguments),this.validate=this.implement}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==Pe.function)return Te(n,{code:ve.invalid_type,expected:Pe.function,received:n.parsedType}),Ge;function r(l,c){return Ng({data:l,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,Pg(),Ad].filter(d=>!!d),issueData:{code:ve.invalid_arguments,argumentsError:c}})}function s(l,c){return Ng({data:l,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,Pg(),Ad].filter(d=>!!d),issueData:{code:ve.invalid_return_type,returnTypeError:c}})}const i={errorMap:n.common.contextualErrorMap},o=n.data;if(this._def.returns instanceof jd){const l=this;return Rr(async function(...c){const d=new ls([]),u=await l._def.args.parseAsync(c,i).catch(m=>{throw d.addIssue(r(c,m)),d}),h=await Reflect.apply(o,this,u);return await l._def.returns._def.type.parseAsync(h,i).catch(m=>{throw d.addIssue(s(h,m)),d})})}else{const l=this;return Rr(function(...c){const d=l._def.args.safeParse(c,i);if(!d.success)throw new ls([r(c,d.error)]);const u=Reflect.apply(o,this,d.data),h=l._def.returns.safeParse(u,i);if(!h.success)throw new ls([s(u,h.error)]);return h.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new Xc({...this._def,args:Pi.create(t).rest(Tl.create())})}returns(t){return new Xc({...this._def,returns:t})}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,n,r){return new Xc({args:t||Pi.create([]).rest(Tl.create()),returns:n||Tl.create(),typeName:He.ZodFunction,...nt(r)})}}class qh extends ot{get schema(){return this._def.getter()}_parse(t){const{ctx:n}=this._processInputParams(t);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}qh.create=(e,t)=>new qh({getter:e,typeName:He.ZodLazy,...nt(t)});class Kh extends ot{_parse(t){if(t.data!==this._def.value){const n=this._getOrReturnCtx(t);return Te(n,{received:n.data,code:ve.invalid_literal,expected:this._def.value}),Ge}return{status:"valid",value:t.data}}get value(){return this._def.value}}Kh.create=(e,t)=>new Kh({value:e,typeName:He.ZodLiteral,...nt(t)});function tU(e,t){return new Ao({values:e,typeName:He.ZodEnum,...nt(t)})}class Ao extends ot{_parse(t){if(typeof t.data!="string"){const n=this._getOrReturnCtx(t),r=this._def.values;return Te(n,{expected:bt.joinValues(r),received:n.parsedType,code:ve.invalid_type}),Ge}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const n=this._getOrReturnCtx(t),r=this._def.values;return Te(n,{received:n.data,code:ve.invalid_enum_value,options:r}),Ge}return Rr(t.data)}get options(){return this._def.values}get enum(){const t={};for(const n of this._def.values)t[n]=n;return t}get Values(){const t={};for(const n of this._def.values)t[n]=n;return t}get Enum(){const t={};for(const n of this._def.values)t[n]=n;return t}extract(t,n=this._def){return Ao.create(t,{...this._def,...n})}exclude(t,n=this._def){return Ao.create(this.options.filter(r=>!t.includes(r)),{...this._def,...n})}}Ao.create=tU;class Qh extends ot{_parse(t){const n=bt.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(t);if(r.parsedType!==Pe.string&&r.parsedType!==Pe.number){const s=bt.objectValues(n);return Te(r,{expected:bt.joinValues(s),received:r.parsedType,code:ve.invalid_type}),Ge}if(this._cache||(this._cache=new Set(bt.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const s=bt.objectValues(n);return Te(r,{received:r.data,code:ve.invalid_enum_value,options:s}),Ge}return Rr(t.data)}get enum(){return this._def.values}}Qh.create=(e,t)=>new Qh({values:e,typeName:He.ZodNativeEnum,...nt(t)});class jd extends ot{unwrap(){return this._def.type}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==Pe.promise&&n.common.async===!1)return Te(n,{code:ve.invalid_type,expected:Pe.promise,received:n.parsedType}),Ge;const r=n.parsedType===Pe.promise?n.data:Promise.resolve(n.data);return Rr(r.then(s=>this._def.type.parseAsync(s,{path:n.path,errorMap:n.common.contextualErrorMap})))}}jd.create=(e,t)=>new jd({type:e,typeName:He.ZodPromise,...nt(t)});class ai extends ot{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===He.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:n,ctx:r}=this._processInputParams(t),s=this._def.effect||null,i={addIssue:o=>{Te(r,o),o.fatal?n.abort():n.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const o=s.transform(r.data,i);if(r.common.async)return Promise.resolve(o).then(async l=>{if(n.value==="aborted")return Ge;const c=await this._def.schema._parseAsync({data:l,path:r.path,parent:r});return c.status==="aborted"?Ge:c.status==="dirty"||n.value==="dirty"?Ic(c.value):c});{if(n.value==="aborted")return Ge;const l=this._def.schema._parseSync({data:o,path:r.path,parent:r});return l.status==="aborted"?Ge:l.status==="dirty"||n.value==="dirty"?Ic(l.value):l}}if(s.type==="refinement"){const o=l=>{const c=s.refinement(l,i);if(r.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return l};if(r.common.async===!1){const l=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return l.status==="aborted"?Ge:(l.status==="dirty"&&n.dirty(),o(l.value),{status:n.value,value:l.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(l=>l.status==="aborted"?Ge:(l.status==="dirty"&&n.dirty(),o(l.value).then(()=>({status:n.value,value:l.value}))))}if(s.type==="transform")if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Bl(o))return Ge;const l=s.transform(o.value,i);if(l instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:l}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>Bl(o)?Promise.resolve(s.transform(o.value,i)).then(l=>({status:n.value,value:l})):Ge);bt.assertNever(s)}}ai.create=(e,t,n)=>new ai({schema:e,typeName:He.ZodEffects,effect:t,...nt(n)});ai.createWithPreprocess=(e,t,n)=>new ai({schema:t,effect:{type:"preprocess",transform:e},typeName:He.ZodEffects,...nt(n)});class Ti extends ot{_parse(t){return this._getType(t)===Pe.undefined?Rr(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Ti.create=(e,t)=>new Ti({innerType:e,typeName:He.ZodOptional,...nt(t)});class Ro extends ot{_parse(t){return this._getType(t)===Pe.null?Rr(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Ro.create=(e,t)=>new Ro({innerType:e,typeName:He.ZodNullable,...nt(t)});class Jh extends ot{_parse(t){const{ctx:n}=this._processInputParams(t);let r=n.data;return n.parsedType===Pe.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}Jh.create=(e,t)=>new Jh({innerType:e,typeName:He.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...nt(t)});class Yh extends ot{_parse(t){const{ctx:n}=this._processInputParams(t),r={...n,common:{...n.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return Uh(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new ls(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new ls(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}Yh.create=(e,t)=>new Yh({innerType:e,typeName:He.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...nt(t)});class jg extends ot{_parse(t){if(this._getType(t)!==Pe.nan){const r=this._getOrReturnCtx(t);return Te(r,{code:ve.invalid_type,expected:Pe.nan,received:r.parsedType}),Ge}return{status:"valid",value:t.data}}}jg.create=e=>new jg({typeName:He.ZodNaN,...nt(e)});const ace=Symbol("zod_brand");class wT extends ot{_parse(t){const{ctx:n}=this._processInputParams(t),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class Vf extends ot{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?Ge:i.status==="dirty"?(n.dirty(),Ic(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?Ge:s.status==="dirty"?(n.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(t,n){return new Vf({in:t,out:n,typeName:He.ZodPipeline})}}class Xh extends ot{_parse(t){const n=this._def.innerType._parse(t),r=s=>(Bl(s)&&(s.value=Object.freeze(s.value)),s);return Uh(n)?n.then(s=>r(s)):r(n)}unwrap(){return this._def.innerType}}Xh.create=(e,t)=>new Xh({innerType:e,typeName:He.ZodReadonly,...nt(t)});function eN(e,t){const n=typeof e=="function"?e(t):typeof e=="string"?{message:e}:e;return typeof n=="string"?{message:n}:n}function ST(e,t={},n){return e?Rd.create().superRefine((r,s)=>{const i=e(r);if(i instanceof Promise)return i.then(o=>{if(!o){const l=eN(t,r),c=l.fatal??n??!0;s.addIssue({code:"custom",...l,fatal:c})}});if(!i){const o=eN(t,r),l=o.fatal??n??!0;s.addIssue({code:"custom",...o,fatal:l})}}):Rd.create()}const oce={object:Kt.lazycreate};var He;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(He||(He={}));const lce=(e,t={message:`Input not instance of ${e.name}`})=>ST(n=>n instanceof e,t),et=Js.create,Bf=No.create,cce=jg.create,dce=Io.create,kT=Vh.create,uce=zl.create,hce=Ig.create,fce=Bh.create,nU=zh.create,Mg=Rd.create,pce=Tl.create,mce=xa.create,gce=Ag.create,ol=ei.create,ns=Kt.create,vce=Kt.strictCreate,TT=Gh.create,yce=ty.create,xce=Wh.create,bce=Pi.create,rU=Hh.create,wce=Rg.create,Sce=Gl.create,kce=Xc.create,Tce=qh.create,sU=Kh.create,Md=Ao.create,Cce=Qh.create,Ece=jd.create,tN=ai.create,_ce=Ti.create,Pce=Ro.create,Nce=ai.createWithPreprocess,Ice=Vf.create,Ace=()=>et().optional(),Rce=()=>Bf().optional(),jce=()=>kT().optional(),Mce={string:e=>Js.create({...e,coerce:!0}),number:e=>No.create({...e,coerce:!0}),boolean:e=>Vh.create({...e,coerce:!0}),bigint:e=>Io.create({...e,coerce:!0}),date:e=>zl.create({...e,coerce:!0})},Dce=Ge,Oce=Object.freeze(Object.defineProperty({__proto__:null,BRAND:ace,DIRTY:Ic,EMPTY_PATH:Fle,INVALID:Ge,NEVER:Dce,OK:Rr,ParseStatus:yr,Schema:ot,ZodAny:Rd,ZodArray:ei,ZodBigInt:Io,ZodBoolean:Vh,ZodBranded:wT,ZodCatch:Yh,ZodDate:zl,ZodDefault:Jh,ZodDiscriminatedUnion:ty,ZodEffects:ai,ZodEnum:Ao,ZodError:ls,get ZodFirstPartyTypeKind(){return He},ZodFunction:Xc,ZodIntersection:Wh,ZodIssueCode:ve,ZodLazy:qh,ZodLiteral:Kh,ZodMap:Rg,ZodNaN:jg,ZodNativeEnum:Qh,ZodNever:xa,ZodNull:zh,ZodNullable:Ro,ZodNumber:No,ZodObject:Kt,ZodOptional:Ti,ZodParsedType:Pe,ZodPipeline:Vf,ZodPromise:jd,ZodReadonly:Xh,ZodRecord:Hh,ZodSchema:ot,ZodSet:Gl,ZodString:Js,ZodSymbol:Ig,ZodTransformer:ai,ZodTuple:Pi,ZodType:ot,ZodUndefined:Bh,ZodUnion:Gh,ZodUnknown:Tl,ZodVoid:Ag,addIssueToContext:Te,any:Mg,array:ol,bigint:dce,boolean:kT,coerce:Mce,custom:ST,date:uce,datetimeRegex:eU,defaultErrorMap:Ad,discriminatedUnion:yce,effect:tN,enum:Md,function:kce,getErrorMap:Pg,getParsedType:Hi,instanceof:lce,intersection:xce,isAborted:iS,isAsync:Uh,isDirty:aS,isValid:Bl,late:oce,lazy:Tce,literal:sU,makeIssue:Ng,map:wce,nan:cce,nativeEnum:Cce,never:mce,null:nU,nullable:Pce,number:Bf,object:ns,get objectUtil(){return sS},oboolean:jce,onumber:Rce,optional:_ce,ostring:Ace,pipeline:Ice,preprocess:Nce,promise:Ece,quotelessJson:Ole,record:rU,set:Sce,setErrorMap:Lle,strictObject:vce,string:et,symbol:hce,transformer:tN,tuple:bce,undefined:fce,union:TT,unknown:pce,get util(){return bt},void:gce},Symbol.toStringTag,{value:"Module"})),Zh=ple,iU=p.createContext({}),Tt=({...e})=>a.jsx(iU.Provider,{value:{name:e.name},children:a.jsx(yle,{...e})}),ny=()=>{const e=p.useContext(iU),t=p.useContext(aU),{getFieldState:n,formState:r}=Uf(),s=n(e.name,r);if(!e)throw new Error("useFormField should be used within <FormField>");const{id:i}=t;return{id:i,name:e.name,formItemId:`${i}-form-item`,formDescriptionId:`${i}-form-item-description`,formMessageId:`${i}-form-item-message`,...s}},aU=p.createContext({}),vt=p.forwardRef(({className:e,...t},n)=>{const r=p.useId();return a.jsx(aU.Provider,{value:{id:r},children:a.jsx("div",{ref:n,className:be("space-y-2",e),...t})})});vt.displayName="FormItem";const dt=p.forwardRef(({className:e,...t},n)=>{const{error:r,formItemId:s}=ny();return a.jsx(Xn,{ref:n,className:be(r&&"text-destructive",e),htmlFor:s,...t})});dt.displayName="FormLabel";const yt=p.forwardRef(({...e},t)=>{const{error:n,formItemId:r,formDescriptionId:s,formMessageId:i}=ny();return a.jsx(A2,{ref:t,id:r,"aria-describedby":n?`${s} ${i}`:`${s}`,"aria-invalid":!!n,...e})});yt.displayName="FormControl";const zi=p.forwardRef(({className:e,...t},n)=>{const{formDescriptionId:r}=ny();return a.jsx("p",{ref:n,id:r,className:be("text-sm text-muted-foreground",e),...t})});zi.displayName="FormDescription";const xt=p.forwardRef(({className:e,children:t,...n},r)=>{const{error:s,formMessageId:i}=ny(),o=s?String((s==null?void 0:s.message)??""):t;return o?a.jsx("p",{ref:r,id:i,className:be("text-sm font-medium text-destructive",e),...n,children:o}):null});xt.displayName="FormMessage";function Lce(e){const t=Fce(e),n=p.forwardRef((r,s)=>{const{children:i,...o}=r,l=p.Children.toArray(i),c=l.find(Uce);if(c){const d=c.props.children,u=l.map(h=>h===c?p.Children.count(d)>1?p.Children.only(null):p.isValidElement(d)?d.props.children:null:h);return a.jsx(t,{...o,ref:s,children:p.isValidElement(d)?p.cloneElement(d,void 0,u):null})}return a.jsx(t,{...o,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}function Fce(e){const t=p.forwardRef((n,r)=>{const{children:s,...i}=n;if(p.isValidElement(s)){const o=Bce(s),l=Vce(i,s.props);return s.type!==p.Fragment&&(l.ref=r?Ii(r,o):o),p.cloneElement(s,l)}return p.Children.count(s)>1?p.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var $ce=Symbol("radix.slottable");function Uce(e){return p.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===$ce}function Vce(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...l)=>{const c=i(...l);return s(...l),c}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function Bce(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function ry(e){const t=p.useRef({value:e,previous:e});return p.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var zce=[" ","Enter","ArrowUp","ArrowDown"],Gce=[" ","Enter"],Wl="Select",[sy,iy,Wce]=pf(Wl),[tu]=Mn(Wl,[Wce,Oo]),ay=Oo(),[Hce,Vo]=tu(Wl),[qce,Kce]=tu(Wl),oU=e=>{const{__scopeSelect:t,children:n,open:r,defaultOpen:s,onOpenChange:i,value:o,defaultValue:l,onValueChange:c,dir:d,name:u,autoComplete:h,disabled:f,required:m,form:g}=e,v=ay(t),[x,S]=p.useState(null),[y,b]=p.useState(null),[w,C]=p.useState(!1),I=ec(d),[R,L]=qr({prop:r,defaultProp:s??!1,onChange:i,caller:Wl}),[N,O]=qr({prop:o,defaultProp:l,onChange:c,caller:Wl}),G=p.useRef(null),H=x?g||!!x.closest("form"):!0,[re,X]=p.useState(new Set),Q=Array.from(re).map(V=>V.props.value).join(";");return a.jsx($0,{...v,children:a.jsxs(Hce,{required:m,scope:t,trigger:x,onTriggerChange:S,valueNode:y,onValueNodeChange:b,valueNodeHasChildren:w,onValueNodeHasChildrenChange:C,contentId:is(),value:N,onValueChange:O,open:R,onOpenChange:L,dir:I,triggerPointerDownPosRef:G,disabled:f,children:[a.jsx(sy.Provider,{scope:t,children:a.jsx(qce,{scope:e.__scopeSelect,onNativeOptionAdd:p.useCallback(V=>{X(te=>new Set(te).add(V))},[]),onNativeOptionRemove:p.useCallback(V=>{X(te=>{const k=new Set(te);return k.delete(V),k})},[]),children:n})}),H?a.jsxs(AU,{"aria-hidden":!0,required:m,tabIndex:-1,name:u,autoComplete:h,value:N,onChange:V=>O(V.target.value),disabled:f,form:g,children:[N===void 0?a.jsx("option",{value:""}):null,Array.from(re)]},Q):null]})})};oU.displayName=Wl;var lU="SelectTrigger",cU=p.forwardRef((e,t)=>{const{__scopeSelect:n,disabled:r=!1,...s}=e,i=ay(n),o=Vo(lU,n),l=o.disabled||r,c=We(t,o.onTriggerChange),d=iy(n),u=p.useRef("touch"),[h,f,m]=jU(v=>{const x=d().filter(b=>!b.disabled),S=x.find(b=>b.value===o.value),y=MU(x,v,S);y!==void 0&&o.onValueChange(y.value)}),g=v=>{l||(o.onOpenChange(!0),m()),v&&(o.triggerPointerDownPosRef.current={x:Math.round(v.pageX),y:Math.round(v.pageY)})};return a.jsx(xf,{asChild:!0,...i,children:a.jsx(Re.button,{type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":RU(o.value)?"":void 0,...s,ref:c,onClick:pe(s.onClick,v=>{v.currentTarget.focus(),u.current!=="mouse"&&g(v)}),onPointerDown:pe(s.onPointerDown,v=>{u.current=v.pointerType;const x=v.target;x.hasPointerCapture(v.pointerId)&&x.releasePointerCapture(v.pointerId),v.button===0&&v.ctrlKey===!1&&v.pointerType==="mouse"&&(g(v),v.preventDefault())}),onKeyDown:pe(s.onKeyDown,v=>{const x=h.current!=="";!(v.ctrlKey||v.altKey||v.metaKey)&&v.key.length===1&&f(v.key),!(x&&v.key===" ")&&zce.includes(v.key)&&(g(),v.preventDefault())})})})});cU.displayName=lU;var dU="SelectValue",uU=p.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:s,children:i,placeholder:o="",...l}=e,c=Vo(dU,n),{onValueNodeHasChildrenChange:d}=c,u=i!==void 0,h=We(t,c.onValueNodeChange);return on(()=>{d(u)},[d,u]),a.jsx(Re.span,{...l,ref:h,style:{pointerEvents:"none"},children:RU(c.value)?a.jsx(a.Fragment,{children:o}):i})});uU.displayName=dU;var Qce="SelectIcon",hU=p.forwardRef((e,t)=>{const{__scopeSelect:n,children:r,...s}=e;return a.jsx(Re.span,{"aria-hidden":!0,...s,ref:t,children:r||""})});hU.displayName=Qce;var Jce="SelectPortal",fU=e=>a.jsx(Bd,{asChild:!0,...e});fU.displayName=Jce;var Hl="SelectContent",pU=p.forwardRef((e,t)=>{const n=Vo(Hl,e.__scopeSelect),[r,s]=p.useState();if(on(()=>{s(new DocumentFragment)},[]),!n.open){const i=r;return i?Ql.createPortal(a.jsx(mU,{scope:e.__scopeSelect,children:a.jsx(sy.Slot,{scope:e.__scopeSelect,children:a.jsx("div",{children:e.children})})}),i):null}return a.jsx(gU,{...e,ref:t})});pU.displayName=Hl;var Fs=10,[mU,Bo]=tu(Hl),Yce="SelectContentImpl",Xce=Lce("SelectContent.RemoveScroll"),gU=p.forwardRef((e,t)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:s,onEscapeKeyDown:i,onPointerDownOutside:o,side:l,sideOffset:c,align:d,alignOffset:u,arrowPadding:h,collisionBoundary:f,collisionPadding:m,sticky:g,hideWhenDetached:v,avoidCollisions:x,...S}=e,y=Vo(Hl,n),[b,w]=p.useState(null),[C,I]=p.useState(null),R=We(t,W=>w(W)),[L,N]=p.useState(null),[O,G]=p.useState(null),H=iy(n),[re,X]=p.useState(!1),Q=p.useRef(!1);p.useEffect(()=>{if(b)return Lv(b)},[b]),Ov();const V=p.useCallback(W=>{const[ie,...Z]=H().map(ge=>ge.ref.current),[ne]=Z.slice(-1),ae=document.activeElement;for(const ge of W)if(ge===ae||(ge==null||ge.scrollIntoView({block:"nearest"}),ge===ie&&C&&(C.scrollTop=0),ge===ne&&C&&(C.scrollTop=C.scrollHeight),ge==null||ge.focus(),document.activeElement!==ae))return},[H,C]),te=p.useCallback(()=>V([L,b]),[V,L,b]);p.useEffect(()=>{re&&te()},[re,te]);const{onOpenChange:k,triggerPointerDownPosRef:E}=y;p.useEffect(()=>{if(b){let W={x:0,y:0};const ie=ne=>{var ae,ge;W={x:Math.abs(Math.round(ne.pageX)-(((ae=E.current)==null?void 0:ae.x)??0)),y:Math.abs(Math.round(ne.pageY)-(((ge=E.current)==null?void 0:ge.y)??0))}},Z=ne=>{W.x<=10&&W.y<=10?ne.preventDefault():b.contains(ne.target)||k(!1),document.removeEventListener("pointermove",ie),E.current=null};return E.current!==null&&(document.addEventListener("pointermove",ie),document.addEventListener("pointerup",Z,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",ie),document.removeEventListener("pointerup",Z,{capture:!0})}}},[b,k,E]),p.useEffect(()=>{const W=()=>k(!1);return window.addEventListener("blur",W),window.addEventListener("resize",W),()=>{window.removeEventListener("blur",W),window.removeEventListener("resize",W)}},[k]);const[M,A]=jU(W=>{const ie=H().filter(ae=>!ae.disabled),Z=ie.find(ae=>ae.ref.current===document.activeElement),ne=MU(ie,W,Z);ne&&setTimeout(()=>ne.ref.current.focus())}),F=p.useCallback((W,ie,Z)=>{const ne=!Q.current&&!Z;(y.value!==void 0&&y.value===ie||ne)&&(N(W),ne&&(Q.current=!0))},[y.value]),q=p.useCallback(()=>b==null?void 0:b.focus(),[b]),P=p.useCallback((W,ie,Z)=>{const ne=!Q.current&&!Z;(y.value!==void 0&&y.value===ie||ne)&&G(W)},[y.value]),j=r==="popper"?lS:vU,$=j===lS?{side:l,sideOffset:c,align:d,alignOffset:u,arrowPadding:h,collisionBoundary:f,collisionPadding:m,sticky:g,hideWhenDetached:v,avoidCollisions:x}:{};return a.jsx(mU,{scope:n,content:b,viewport:C,onViewportChange:I,itemRefCallback:F,selectedItem:L,onItemLeave:q,itemTextRefCallback:P,focusSelectedItem:te,selectedItemText:O,position:r,isPositioned:re,searchRef:M,children:a.jsx(Rf,{as:Xce,allowPinchZoom:!0,children:a.jsx(Af,{asChild:!0,trapped:y.open,onMountAutoFocus:W=>{W.preventDefault()},onUnmountAutoFocus:pe(s,W=>{var ie;(ie=y.trigger)==null||ie.focus({preventScroll:!0}),W.preventDefault()}),children:a.jsx(Yl,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:W=>W.preventDefault(),onDismiss:()=>y.onOpenChange(!1),children:a.jsx(j,{role:"listbox",id:y.contentId,"data-state":y.open?"open":"closed",dir:y.dir,onContextMenu:W=>W.preventDefault(),...S,...$,onPlaced:()=>X(!0),ref:R,style:{display:"flex",flexDirection:"column",outline:"none",...S.style},onKeyDown:pe(S.onKeyDown,W=>{const ie=W.ctrlKey||W.altKey||W.metaKey;if(W.key==="Tab"&&W.preventDefault(),!ie&&W.key.length===1&&A(W.key),["ArrowUp","ArrowDown","Home","End"].includes(W.key)){let ne=H().filter(ae=>!ae.disabled).map(ae=>ae.ref.current);if(["ArrowUp","End"].includes(W.key)&&(ne=ne.slice().reverse()),["ArrowUp","ArrowDown"].includes(W.key)){const ae=W.target,ge=ne.indexOf(ae);ne=ne.slice(ge+1)}setTimeout(()=>V(ne)),W.preventDefault()}})})})})})})});gU.displayName=Yce;var Zce="SelectItemAlignedPosition",vU=p.forwardRef((e,t)=>{const{__scopeSelect:n,onPlaced:r,...s}=e,i=Vo(Hl,n),o=Bo(Hl,n),[l,c]=p.useState(null),[d,u]=p.useState(null),h=We(t,R=>u(R)),f=iy(n),m=p.useRef(!1),g=p.useRef(!0),{viewport:v,selectedItem:x,selectedItemText:S,focusSelectedItem:y}=o,b=p.useCallback(()=>{if(i.trigger&&i.valueNode&&l&&d&&v&&x&&S){const R=i.trigger.getBoundingClientRect(),L=d.getBoundingClientRect(),N=i.valueNode.getBoundingClientRect(),O=S.getBoundingClientRect();if(i.dir!=="rtl"){const ae=O.left-L.left,ge=N.left-ae,Le=R.left-ge,Ct=R.width+Le,pn=Math.max(Ct,L.width),mn=window.innerWidth-Fs,Fn=Yw(ge,[Fs,Math.max(Fs,mn-pn)]);l.style.minWidth=Ct+"px",l.style.left=Fn+"px"}else{const ae=L.right-O.right,ge=window.innerWidth-N.right-ae,Le=window.innerWidth-R.right-ge,Ct=R.width+Le,pn=Math.max(Ct,L.width),mn=window.innerWidth-Fs,Fn=Yw(ge,[Fs,Math.max(Fs,mn-pn)]);l.style.minWidth=Ct+"px",l.style.right=Fn+"px"}const G=f(),H=window.innerHeight-Fs*2,re=v.scrollHeight,X=window.getComputedStyle(d),Q=parseInt(X.borderTopWidth,10),V=parseInt(X.paddingTop,10),te=parseInt(X.borderBottomWidth,10),k=parseInt(X.paddingBottom,10),E=Q+V+re+k+te,M=Math.min(x.offsetHeight*5,E),A=window.getComputedStyle(v),F=parseInt(A.paddingTop,10),q=parseInt(A.paddingBottom,10),P=R.top+R.height/2-Fs,j=H-P,$=x.offsetHeight/2,W=x.offsetTop+$,ie=Q+V+W,Z=E-ie;if(ie<=P){const ae=G.length>0&&x===G[G.length-1].ref.current;l.style.bottom="0px";const ge=d.clientHeight-v.offsetTop-v.offsetHeight,Le=Math.max(j,$+(ae?q:0)+ge+te),Ct=ie+Le;l.style.height=Ct+"px"}else{const ae=G.length>0&&x===G[0].ref.current;l.style.top="0px";const Le=Math.max(P,Q+v.offsetTop+(ae?F:0)+$)+Z;l.style.height=Le+"px",v.scrollTop=ie-P+v.offsetTop}l.style.margin=`${Fs}px 0`,l.style.minHeight=M+"px",l.style.maxHeight=H+"px",r==null||r(),requestAnimationFrame(()=>m.current=!0)}},[f,i.trigger,i.valueNode,l,d,v,x,S,i.dir,r]);on(()=>b(),[b]);const[w,C]=p.useState();on(()=>{d&&C(window.getComputedStyle(d).zIndex)},[d]);const I=p.useCallback(R=>{R&&g.current===!0&&(b(),y==null||y(),g.current=!1)},[b,y]);return a.jsx(tde,{scope:n,contentWrapper:l,shouldExpandOnScrollRef:m,onScrollButtonChange:I,children:a.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:w},children:a.jsx(Re.div,{...s,ref:h,style:{boxSizing:"border-box",maxHeight:"100%",...s.style}})})})});vU.displayName=Zce;var ede="SelectPopperPosition",lS=p.forwardRef((e,t)=>{const{__scopeSelect:n,align:r="start",collisionPadding:s=Fs,...i}=e,o=ay(n);return a.jsx(pv,{...o,...i,ref:t,align:r,collisionPadding:s,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});lS.displayName=ede;var[tde,CT]=tu(Hl,{}),cS="SelectViewport",yU=p.forwardRef((e,t)=>{const{__scopeSelect:n,nonce:r,...s}=e,i=Bo(cS,n),o=CT(cS,n),l=We(t,i.onViewportChange),c=p.useRef(0);return a.jsxs(a.Fragment,{children:[a.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),a.jsx(sy.Slot,{scope:n,children:a.jsx(Re.div,{"data-radix-select-viewport":"",role:"presentation",...s,ref:l,style:{position:"relative",flex:1,overflow:"hidden auto",...s.style},onScroll:pe(s.onScroll,d=>{const u=d.currentTarget,{contentWrapper:h,shouldExpandOnScrollRef:f}=o;if(f!=null&&f.current&&h){const m=Math.abs(c.current-u.scrollTop);if(m>0){const g=window.innerHeight-Fs*2,v=parseFloat(h.style.minHeight),x=parseFloat(h.style.height),S=Math.max(v,x);if(S<g){const y=S+m,b=Math.min(g,y),w=y-b;h.style.height=b+"px",h.style.bottom==="0px"&&(u.scrollTop=w>0?w:0,h.style.justifyContent="flex-end")}}}c.current=u.scrollTop})})})]})});yU.displayName=cS;var xU="SelectGroup",[nde,rde]=tu(xU),sde=p.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,s=is();return a.jsx(nde,{scope:n,id:s,children:a.jsx(Re.div,{role:"group","aria-labelledby":s,...r,ref:t})})});sde.displayName=xU;var bU="SelectLabel",wU=p.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,s=rde(bU,n);return a.jsx(Re.div,{id:s.id,...r,ref:t})});wU.displayName=bU;var Dg="SelectItem",[ide,SU]=tu(Dg),kU=p.forwardRef((e,t)=>{const{__scopeSelect:n,value:r,disabled:s=!1,textValue:i,...o}=e,l=Vo(Dg,n),c=Bo(Dg,n),d=l.value===r,[u,h]=p.useState(i??""),[f,m]=p.useState(!1),g=We(t,y=>{var b;return(b=c.itemRefCallback)==null?void 0:b.call(c,y,r,s)}),v=is(),x=p.useRef("touch"),S=()=>{s||(l.onValueChange(r),l.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return a.jsx(ide,{scope:n,value:r,disabled:s,textId:v,isSelected:d,onItemTextChange:p.useCallback(y=>{h(b=>b||((y==null?void 0:y.textContent)??"").trim())},[]),children:a.jsx(sy.ItemSlot,{scope:n,value:r,disabled:s,textValue:u,children:a.jsx(Re.div,{role:"option","aria-labelledby":v,"data-highlighted":f?"":void 0,"aria-selected":d&&f,"data-state":d?"checked":"unchecked","aria-disabled":s||void 0,"data-disabled":s?"":void 0,tabIndex:s?void 0:-1,...o,ref:g,onFocus:pe(o.onFocus,()=>m(!0)),onBlur:pe(o.onBlur,()=>m(!1)),onClick:pe(o.onClick,()=>{x.current!=="mouse"&&S()}),onPointerUp:pe(o.onPointerUp,()=>{x.current==="mouse"&&S()}),onPointerDown:pe(o.onPointerDown,y=>{x.current=y.pointerType}),onPointerMove:pe(o.onPointerMove,y=>{var b;x.current=y.pointerType,s?(b=c.onItemLeave)==null||b.call(c):x.current==="mouse"&&y.currentTarget.focus({preventScroll:!0})}),onPointerLeave:pe(o.onPointerLeave,y=>{var b;y.currentTarget===document.activeElement&&((b=c.onItemLeave)==null||b.call(c))}),onKeyDown:pe(o.onKeyDown,y=>{var w;((w=c.searchRef)==null?void 0:w.current)!==""&&y.key===" "||(Gce.includes(y.key)&&S(),y.key===" "&&y.preventDefault())})})})})});kU.displayName=Dg;var Uu="SelectItemText",TU=p.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:s,...i}=e,o=Vo(Uu,n),l=Bo(Uu,n),c=SU(Uu,n),d=Kce(Uu,n),[u,h]=p.useState(null),f=We(t,S=>h(S),c.onItemTextChange,S=>{var y;return(y=l.itemTextRefCallback)==null?void 0:y.call(l,S,c.value,c.disabled)}),m=u==null?void 0:u.textContent,g=p.useMemo(()=>a.jsx("option",{value:c.value,disabled:c.disabled,children:m},c.value),[c.disabled,c.value,m]),{onNativeOptionAdd:v,onNativeOptionRemove:x}=d;return on(()=>(v(g),()=>x(g)),[v,x,g]),a.jsxs(a.Fragment,{children:[a.jsx(Re.span,{id:c.textId,...i,ref:f}),c.isSelected&&o.valueNode&&!o.valueNodeHasChildren?Ql.createPortal(i.children,o.valueNode):null]})});TU.displayName=Uu;var CU="SelectItemIndicator",EU=p.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return SU(CU,n).isSelected?a.jsx(Re.span,{"aria-hidden":!0,...r,ref:t}):null});EU.displayName=CU;var dS="SelectScrollUpButton",_U=p.forwardRef((e,t)=>{const n=Bo(dS,e.__scopeSelect),r=CT(dS,e.__scopeSelect),[s,i]=p.useState(!1),o=We(t,r.onScrollButtonChange);return on(()=>{if(n.viewport&&n.isPositioned){let l=function(){const d=c.scrollTop>0;i(d)};const c=n.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[n.viewport,n.isPositioned]),s?a.jsx(NU,{...e,ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=n;l&&c&&(l.scrollTop=l.scrollTop-c.offsetHeight)}}):null});_U.displayName=dS;var uS="SelectScrollDownButton",PU=p.forwardRef((e,t)=>{const n=Bo(uS,e.__scopeSelect),r=CT(uS,e.__scopeSelect),[s,i]=p.useState(!1),o=We(t,r.onScrollButtonChange);return on(()=>{if(n.viewport&&n.isPositioned){let l=function(){const d=c.scrollHeight-c.clientHeight,u=Math.ceil(c.scrollTop)<d;i(u)};const c=n.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[n.viewport,n.isPositioned]),s?a.jsx(NU,{...e,ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=n;l&&c&&(l.scrollTop=l.scrollTop+c.offsetHeight)}}):null});PU.displayName=uS;var NU=p.forwardRef((e,t)=>{const{__scopeSelect:n,onAutoScroll:r,...s}=e,i=Bo("SelectScrollButton",n),o=p.useRef(null),l=iy(n),c=p.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return p.useEffect(()=>()=>c(),[c]),on(()=>{var u;const d=l().find(h=>h.ref.current===document.activeElement);(u=d==null?void 0:d.ref.current)==null||u.scrollIntoView({block:"nearest"})},[l]),a.jsx(Re.div,{"aria-hidden":!0,...s,ref:t,style:{flexShrink:0,...s.style},onPointerDown:pe(s.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(r,50))}),onPointerMove:pe(s.onPointerMove,()=>{var d;(d=i.onItemLeave)==null||d.call(i),o.current===null&&(o.current=window.setInterval(r,50))}),onPointerLeave:pe(s.onPointerLeave,()=>{c()})})}),ade="SelectSeparator",IU=p.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return a.jsx(Re.div,{"aria-hidden":!0,...r,ref:t})});IU.displayName=ade;var hS="SelectArrow",ode=p.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,s=ay(n),i=Vo(hS,n),o=Bo(hS,n);return i.open&&o.position==="popper"?a.jsx(mv,{...s,...r,ref:t}):null});ode.displayName=hS;var lde="SelectBubbleInput",AU=p.forwardRef(({__scopeSelect:e,value:t,...n},r)=>{const s=p.useRef(null),i=We(r,s),o=ry(t);return p.useEffect(()=>{const l=s.current;if(!l)return;const c=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(c,"value").set;if(o!==t&&u){const h=new Event("change",{bubbles:!0});u.call(l,t),l.dispatchEvent(h)}},[o,t]),a.jsx(Re.select,{...n,style:{...fD,...n.style},ref:i,defaultValue:t})});AU.displayName=lde;function RU(e){return e===""||e===void 0}function jU(e){const t=rn(e),n=p.useRef(""),r=p.useRef(0),s=p.useCallback(o=>{const l=n.current+o;t(l),function c(d){n.current=d,window.clearTimeout(r.current),d!==""&&(r.current=window.setTimeout(()=>c(""),1e3))}(l)},[t]),i=p.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return p.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,s,i]}function MU(e,t,n){const s=t.length>1&&Array.from(t).every(d=>d===t[0])?t[0]:t,i=n?e.indexOf(n):-1;let o=cde(e,Math.max(i,0));s.length===1&&(o=o.filter(d=>d!==n));const c=o.find(d=>d.textValue.toLowerCase().startsWith(s.toLowerCase()));return c!==n?c:void 0}function cde(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var dde=oU,DU=cU,ude=uU,hde=hU,fde=fU,OU=pU,pde=yU,LU=wU,FU=kU,mde=TU,gde=EU,$U=_U,UU=PU,VU=IU;const In=dde,An=ude,wn=p.forwardRef(({className:e,children:t,...n},r)=>a.jsxs(DU,{ref:r,className:be("flex h-9 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...n,children:[t,a.jsx(hde,{asChild:!0,children:a.jsx(vf,{className:"h-4 w-4 opacity-50"})})]}));wn.displayName=DU.displayName;const BU=p.forwardRef(({className:e,...t},n)=>a.jsx($U,{ref:n,className:be("flex cursor-default items-center justify-center py-1",e),...t,children:a.jsx(_0,{className:"h-4 w-4"})}));BU.displayName=$U.displayName;const zU=p.forwardRef(({className:e,...t},n)=>a.jsx(UU,{ref:n,className:be("flex cursor-default items-center justify-center py-1",e),...t,children:a.jsx(vf,{className:"h-4 w-4"})}));zU.displayName=UU.displayName;const Sn=p.forwardRef(({className:e,children:t,position:n="popper",...r},s)=>a.jsx(fde,{children:a.jsxs(OU,{ref:s,className:be("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:n,...r,children:[a.jsx(BU,{}),a.jsx(pde,{className:be("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),a.jsx(zU,{})]})}));Sn.displayName=OU.displayName;const vde=p.forwardRef(({className:e,...t},n)=>a.jsx(LU,{ref:n,className:be("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));vde.displayName=LU.displayName;const at=p.forwardRef(({className:e,children:t,...n},r)=>a.jsxs(FU,{ref:r,className:be("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(gde,{children:a.jsx(Zr,{className:"h-4 w-4"})})}),a.jsx(mde,{children:t})]}));at.displayName=FU.displayName;const yde=p.forwardRef(({className:e,...t},n)=>a.jsx(VU,{ref:n,className:be("-mx-1 my-1 h-px bg-muted",e),...t}));yde.displayName=VU.displayName;const xde=["Valorant","League of Legends","CS2","Apex Legends","Rocket League","Overwatch 2","Dota 2","Fortnite","Call of Duty","FIFA 24","BGMI","Indus","Scarfall","PUBG","Free Fire","Minecraft","GTA V","Rainbow Six Siege","Destiny 2","Warzone"].sort(),bde=ns({gameName:et().min(1,"Game name is required"),currentRank:et().min(1,"Current rank is required"),highestRank:et().min(1,"Highest rank is required"),hoursPlayed:Bf().min(0,"Hours played must be 0 or more").max(1e5),achievementDetails:ol(ns({title:et().min(1,"Title is required"),photoUrl:et().optional(),link:et().url("Must be a valid URL").optional().or(sU(""))})).min(1,"At least 1 achievement is required").max(3,"Maximum 3 achievements allowed"),clipUrls:ol(ns({title:et().min(1,"Title is required"),link:et().url("Must be a valid URL").min(1,"Link is required")})).min(1,"At least 1 clip is required").max(3,"Maximum 3 clips allowed"),statsPhotoUrl:et().optional(),statsPhotoDate:et().min(1,"Stats date is required"),customSections:ol(ns({heading:et().min(1,"Heading is required"),fields:ol(ns({type:Md(["text","photo","link"]).default("text"),label:et().min(1,"Label is required"),value:et().min(1,"Value is required")}))})).optional()});function wde({open:e,onOpenChange:t,userId:n,profile:r,onSuccess:s}){const{toast:i}=Wn(),o=!!r,[l,c]=p.useState("default"),[d,u]=p.useState(!1),h=r!=null&&r.clipUrls&&Array.isArray(r.clipUrls)?r.clipUrls:[],f=r!=null&&r.achievementDetails&&Array.isArray(r.achievementDetails)?r.achievementDetails.slice(0,3):[],m=r!=null&&r.customSections&&Array.isArray(r.customSections)?r.customSections:[],g=Zv({resolver:ey(bde),defaultValues:{gameName:(r==null?void 0:r.gameName)||"",currentRank:(r==null?void 0:r.currentRank)||"",highestRank:(r==null?void 0:r.highestRank)||"",hoursPlayed:(r==null?void 0:r.hoursPlayed)||0,achievementDetails:f.length>0?f:[{title:"",photoUrl:"",link:""}],clipUrls:h.length>0?h:[{title:"",link:""}],statsPhotoUrl:(r==null?void 0:r.statsPhotoUrl)||"",statsPhotoDate:(r==null?void 0:r.statsPhotoDate)||"",customSections:m}}),{fields:v,append:x,remove:S}=gm({control:g.control,name:"achievementDetails"}),{fields:y,append:b,remove:w}=gm({control:g.control,name:"clipUrls"}),{fields:C,append:I,remove:R}=gm({control:g.control,name:"customSections"});p.useEffect(()=>{if(e){const Q=r!=null&&r.clipUrls&&Array.isArray(r.clipUrls)?r.clipUrls:[],V=r!=null&&r.achievementDetails&&Array.isArray(r.achievementDetails)?r.achievementDetails.slice(0,3):[],te=r!=null&&r.customSections&&Array.isArray(r.customSections)?r.customSections:[];g.reset({gameName:(r==null?void 0:r.gameName)||"",currentRank:(r==null?void 0:r.currentRank)||"",highestRank:(r==null?void 0:r.highestRank)||"",hoursPlayed:(r==null?void 0:r.hoursPlayed)||0,achievementDetails:V.length>0?V:[{title:"",photoUrl:"",link:""}],clipUrls:Q.length>0?Q:[{title:"",link:""}],statsPhotoUrl:(r==null?void 0:r.statsPhotoUrl)||"",statsPhotoDate:(r==null?void 0:r.statsPhotoDate)||"",customSections:te.map(k=>({...k,fields:k.fields.map(E=>({...E,type:E.type||"text"}))}))})}},[e,r,g]);const L=async(Q,V)=>{var k;const te=(k=Q.target.files)==null?void 0:k[0];if(te){if(te.size>5*1024*1024){i({title:"Error",description:"File size must be less than 5MB",variant:"destructive"});return}u(!0);try{const E=new FormData;E.append("file",te);const M=await fetch(lt("/api/upload-photo"),{method:"POST",credentials:"include",body:E});if(!M.ok)throw new Error("Upload failed");const A=await M.json();g.setValue(V,A.url),i({title:"Success",description:"Photo uploaded successfully!"})}catch{i({title:"Error",description:"Failed to upload photo. Please try again.",variant:"destructive"})}finally{u(!1)}}},N=async(Q,V)=>{var k;const te=(k=Q.target.files)==null?void 0:k[0];if(te){if(te.size>5*1024*1024){i({title:"Error",description:"File size must be less than 5MB",variant:"destructive"});return}u(!0);try{const E=new FormData;E.append("file",te);const M=await fetch(lt("/api/upload-photo"),{method:"POST",credentials:"include",body:E});if(!M.ok)throw new Error("Upload failed");const A=await M.json();g.setValue(`achievementDetails.${V}.photoUrl`,A.url),i({title:"Success",description:"Photo uploaded successfully!"})}catch{i({title:"Error",description:"Failed to upload photo. Please try again.",variant:"destructive"})}finally{u(!1)}}},O=Nt({mutationFn:async Q=>(await kt("POST","/api/game-profiles",Q)).json(),onSuccess:()=>{ze.invalidateQueries({queryKey:["/api/users",n,"game-profiles"]}),i({title:"Success",description:"Game profile created successfully!"}),t(!1),g.reset(),s==null||s()},onError:Q=>{i({title:"Error",description:Q.message||"Failed to create game profile",variant:"destructive"})}}),G=Nt({mutationFn:async Q=>(await kt("PATCH",`/api/game-profiles/${r.id}`,Q)).json(),onSuccess:()=>{ze.invalidateQueries({queryKey:["/api/users",n,"game-profiles"]}),i({title:"Success",description:"Game profile updated successfully!"}),t(!1),s==null||s()},onError:Q=>{i({title:"Error",description:Q.message||"Failed to update game profile",variant:"destructive"})}}),H=Nt({mutationFn:async()=>await kt("DELETE",`/api/game-profiles/${r.id}`),onSuccess:()=>{ze.invalidateQueries({queryKey:["/api/users",n,"game-profiles"]}),i({title:"Success",description:"Game profile deleted successfully!"}),t(!1),s==null||s()},onError:Q=>{i({title:"Error",description:Q.message||"Failed to delete game profile",variant:"destructive"})}}),re=Q=>{var q,P;const{customSections:V,achievementDetails:te,...k}=Q,E=te==null?void 0:te.filter(j=>j.title.trim()),M=(q=Q.clipUrls)==null?void 0:q.filter(j=>j.title.trim()&&j.link.trim()),A=V==null?void 0:V.filter(j=>j.heading.trim()&&j.fields.length>0),F={...k,achievementDetails:E,clipUrls:M,customSections:A!=null&&A.length?A:void 0,statsPhotoUrl:((P=k.statsPhotoUrl)==null?void 0:P.trim())||void 0};o?G.mutate(F):O.mutate(F)},X=O.isPending||G.isPending||H.isPending;return a.jsx(gr,{open:e,onOpenChange:t,children:a.jsxs(nr,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[a.jsxs(rr,{children:[a.jsx(sr,{"data-testid":"dialog-title-game-profile",children:o?"Edit Game Profile":"Add Game Profile"}),a.jsx($h,{children:o?"Update your gaming achievements and stats":"Showcase your skills and achievements for this game"})]}),a.jsxs(Ll,{value:l,onValueChange:c,className:"w-full",children:[a.jsxs(_o,{className:"grid w-full grid-cols-2",children:[a.jsx(_r,{value:"default","data-testid":"tab-default-portfolio",children:"Default Portfolio"}),a.jsx(_r,{value:"custom","data-testid":"tab-custom-portfolio",children:"Add more..."})]}),a.jsx(si,{value:"default",className:"mt-6",children:a.jsx(Zh,{...g,children:a.jsxs("form",{onSubmit:g.handleSubmit(re),className:"space-y-6",children:[a.jsxs(L3,{type:"multiple",defaultValue:["game-info","performance","achievements","clips"],className:"w-full",children:[a.jsxs(Ec,{value:"game-info",children:[a.jsx(_c,{className:"hover:no-underline",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qp,{className:"h-5 w-5 text-primary"}),a.jsx("span",{className:"text-lg font-semibold",children:"Game Information"})]})}),a.jsx(Pc,{className:"space-y-4 pt-4",children:a.jsx(Ne,{className:"p-4 bg-muted/50",children:a.jsx(Tt,{control:g.control,name:"gameName",render:({field:Q})=>a.jsxs(vt,{children:[a.jsx(dt,{children:"Game Name *"}),a.jsxs(In,{onValueChange:Q.onChange,defaultValue:Q.value,disabled:o,children:[a.jsx(yt,{children:a.jsx(wn,{"data-testid":"select-game-name",children:a.jsx(An,{placeholder:"Select a game"})})}),a.jsx(Sn,{children:xde.map(V=>a.jsx(at,{value:V,children:V},V))})]}),a.jsx(zi,{children:o?"Game cannot be changed after creation":"Choose the game for this profile"}),a.jsx(xt,{})]})})})})]}),a.jsxs(Ec,{value:"performance",children:[a.jsx(_c,{className:"hover:no-underline",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(il,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-400"}),a.jsx("span",{className:"text-lg font-semibold",children:"Performance Metrics"})]})}),a.jsx(Pc,{className:"space-y-4 pt-4",children:a.jsx(Ne,{className:"p-4 bg-muted/50",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(Tt,{control:g.control,name:"currentRank",render:({field:Q})=>a.jsxs(vt,{children:[a.jsx(dt,{children:"Current Rank *"}),a.jsx(yt,{children:a.jsx(tt,{placeholder:"e.g., Diamond II",...Q,"data-testid":"input-current-rank"})}),a.jsx(xt,{})]})}),a.jsx(Tt,{control:g.control,name:"highestRank",render:({field:Q})=>a.jsxs(vt,{children:[a.jsx(dt,{children:"Highest Rank *"}),a.jsx(yt,{children:a.jsx(tt,{placeholder:"e.g., Immortal I",...Q,"data-testid":"input-highest-rank"})}),a.jsx(xt,{})]})})]}),a.jsx(Tt,{control:g.control,name:"hoursPlayed",render:({field:Q})=>a.jsxs(vt,{children:[a.jsx(dt,{children:"Hours Played *"}),a.jsx(yt,{children:a.jsx(tt,{type:"number",placeholder:"e.g., 1500",...Q,onChange:V=>Q.onChange(V.target.value?parseInt(V.target.value):0),value:Q.value,"data-testid":"input-hours-played"})}),a.jsx(zi,{children:"Total hours played in this game"}),a.jsx(xt,{})]})}),a.jsx(aa,{className:"my-4"}),a.jsxs("div",{className:"space-y-4",children:[a.jsx(dt,{children:"Stats Screenshot *"}),a.jsx(zi,{children:"Upload your in-game stats screenshot"}),a.jsx(Tt,{control:g.control,name:"statsPhotoUrl",render:({field:Q})=>a.jsxs(vt,{children:[a.jsx(dt,{children:"Screenshot"}),a.jsx(yt,{children:a.jsxs("div",{className:"space-y-2",children:[a.jsx(tt,{type:"file",accept:"image/*",onChange:V=>L(V,"statsPhotoUrl"),disabled:d,"data-testid":"input-stats-photo-file"}),Q.value&&a.jsxs("div",{className:"text-sm text-muted-foreground",children:["Current photo: ",Q.value]})]})}),a.jsx(xt,{})]})}),a.jsx(Tt,{control:g.control,name:"statsPhotoDate",render:({field:Q})=>a.jsxs(vt,{children:[a.jsx(dt,{className:"block",children:"Stats Date *"}),a.jsx(yt,{children:a.jsx(tt,{type:"date",...Q,className:"w-full block","data-testid":"input-stats-photo-date"})}),a.jsx(zi,{children:"When were these stats recorded?"}),a.jsx(xt,{})]})})]})]})})})]}),a.jsxs(Ec,{value:"achievements",children:[a.jsx(_c,{className:"hover:no-underline",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(OD,{className:"h-5 w-5 text-purple-600 dark:text-purple-400"}),a.jsx("span",{className:"text-lg font-semibold",children:"Achievements (Max 3) *"})]})}),a.jsx(Pc,{className:"space-y-4 pt-4",children:a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(zi,{children:"Add your top 3 tournament wins, rankings, and major accomplishments"}),v.length<3&&a.jsxs(ee,{type:"button",variant:"outline",size:"sm",onClick:()=>x({title:"",photoUrl:"",link:""}),"data-testid":"button-add-achievement-detail",children:[a.jsx(Nr,{className:"h-4 w-4 mr-2"}),"Add Achievement"]})]}),a.jsx("div",{className:"space-y-4",children:v.map((Q,V)=>a.jsx(Ne,{className:"p-4 bg-muted/50",children:a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-start justify-between gap-2",children:[a.jsx(Tt,{control:g.control,name:`achievementDetails.${V}.title`,render:({field:te})=>a.jsxs(vt,{className:"flex-1",children:[a.jsx(dt,{children:"Achievement Title *"}),a.jsx(yt,{children:a.jsx(tt,{placeholder:"e.g., 1st Place in Regional Championship 2024",...te,"data-testid":`input-achievement-detail-title-${V}`})}),a.jsx(xt,{})]})}),a.jsx(ee,{type:"button",variant:"ghost",size:"icon",onClick:()=>S(V),className:"mt-8","data-testid":`button-remove-achievement-detail-${V}`,children:a.jsx(Ot,{className:"h-4 w-4"})})]}),a.jsx(Tt,{control:g.control,name:`achievementDetails.${V}.photoUrl`,render:({field:te})=>a.jsxs(vt,{children:[a.jsx(dt,{children:"Photo (Optional)"}),a.jsx(yt,{children:a.jsxs("div",{className:"space-y-2",children:[a.jsx(tt,{type:"file",accept:"image/*",onChange:k=>N(k,V),disabled:d,"data-testid":`input-achievement-detail-photo-${V}`}),te.value&&a.jsx("div",{className:"text-sm text-muted-foreground",children:"Photo uploaded"})]})}),a.jsx(xt,{})]})}),a.jsx(Tt,{control:g.control,name:`achievementDetails.${V}.link`,render:({field:te})=>a.jsxs(vt,{children:[a.jsx(dt,{children:"Link (Optional)"}),a.jsx(yt,{children:a.jsx(tt,{placeholder:"https://tournament.gg/results/2024",...te,"data-testid":`input-achievement-detail-link-${V}`})}),a.jsx(zi,{children:"Link to tournament results or proof"}),a.jsx(xt,{})]})})]})},Q.id))})]})})]}),a.jsxs(Ec,{value:"clips",children:[a.jsx(_c,{className:"hover:no-underline",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(sw,{className:"h-5 w-5 text-red-600 dark:text-red-400"}),a.jsx("span",{className:"text-lg font-semibold",children:"Best Clips & Highlights (Max 3) *"})]})}),a.jsx(Pc,{className:"space-y-4 pt-4",children:a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(zi,{children:"Add your top 3 gameplay clips from YouTube, Twitch, or other platforms"}),y.length<3&&a.jsxs(ee,{type:"button",variant:"outline",size:"sm",onClick:()=>b({title:"",link:""}),"data-testid":"button-add-clip",children:[a.jsx(Nr,{className:"h-4 w-4 mr-2"}),"Add Clip"]})]}),a.jsx("div",{className:"space-y-4",children:y.map((Q,V)=>a.jsx(Ne,{className:"p-4 bg-muted/50",children:a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-start justify-between gap-2",children:[a.jsx(Tt,{control:g.control,name:`clipUrls.${V}.title`,render:({field:te})=>a.jsxs(vt,{className:"flex-1",children:[a.jsx(dt,{children:"Clip Title *"}),a.jsx(yt,{children:a.jsx(tt,{placeholder:"e.g., Epic 1v5 Clutch",...te,"data-testid":`input-clip-title-${V}`})}),a.jsx(xt,{})]})}),a.jsx(ee,{type:"button",variant:"ghost",size:"icon",onClick:()=>w(V),className:"mt-8","data-testid":`button-remove-clip-${V}`,children:a.jsx(Ot,{className:"h-4 w-4"})})]}),a.jsx(Tt,{control:g.control,name:`clipUrls.${V}.link`,render:({field:te})=>a.jsxs(vt,{children:[a.jsx(dt,{children:"Link *"}),a.jsx(yt,{children:a.jsx(tt,{placeholder:"https://youtube.com/watch?v=...",...te,"data-testid":`input-clip-link-${V}`})}),a.jsx(xt,{})]})})]})},Q.id))})]})})]})]}),a.jsx(aa,{}),a.jsxs("div",{className:"flex justify-between items-center",children:[o&&a.jsxs(ee,{type:"button",variant:"destructive",onClick:()=>{confirm("Are you sure you want to delete this game profile?")&&H.mutate()},disabled:X,"data-testid":"button-delete-profile",children:[a.jsx(So,{className:"h-4 w-4 mr-2"}),"Delete Profile"]}),a.jsxs("div",{className:`flex gap-2 ${o?"":"ml-auto"}`,children:[a.jsx(ee,{type:"button",variant:"outline",onClick:()=>t(!1),disabled:X,"data-testid":"button-cancel",children:"Cancel"}),a.jsx(ee,{type:"submit",disabled:X,"data-testid":"button-save-profile",children:X?"Saving...":o?"Update Profile":"Create Profile"})]})]})]})})}),a.jsx(si,{value:"custom",className:"mt-6",children:a.jsx(Zh,{...g,children:a.jsxs("form",{onSubmit:g.handleSubmit(re),className:"space-y-6",children:[a.jsxs(Ne,{children:[a.jsx(an,{children:a.jsx(mr,{className:"text-lg",children:"Custom Sections"})}),a.jsxs(Fe,{className:"space-y-4",children:[a.jsx(zi,{children:"Create custom sections with your own headings and fields. All fields from the default portfolio are still required."}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(dt,{children:"Custom Sections"}),a.jsxs(ee,{type:"button",variant:"outline",size:"sm",onClick:()=>I({heading:"",fields:[{type:"text",label:"",value:""}]}),"data-testid":"button-add-custom-section",children:[a.jsx(Nr,{className:"h-4 w-4 mr-2"}),"Add Section"]})]}),a.jsx("div",{className:"space-y-6",children:C.map((Q,V)=>a.jsx(Ne,{className:"p-4 bg-muted/50",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-start justify-between gap-2",children:[a.jsx(Tt,{control:g.control,name:`customSections.${V}.heading`,render:({field:te})=>a.jsxs(vt,{className:"flex-1",children:[a.jsx(dt,{children:"Section Heading"}),a.jsx(yt,{children:a.jsx(tt,{placeholder:"e.g., Streaming Experience",...te,"data-testid":`input-custom-section-heading-${V}`})}),a.jsx(xt,{})]})}),a.jsx(ee,{type:"button",variant:"ghost",size:"icon",onClick:()=>R(V),className:"mt-8","data-testid":`button-remove-custom-section-${V}`,children:a.jsx(Ot,{className:"h-4 w-4"})})]}),a.jsx(Sde,{form:g,sectionIndex:V,uploadingPhoto:d,setUploadingPhoto:u})]})},Q.id))})]})]}),a.jsx(aa,{}),a.jsxs("div",{className:"flex justify-between items-center",children:[o&&a.jsxs(ee,{type:"button",variant:"destructive",onClick:()=>{confirm("Are you sure you want to delete this game profile?")&&H.mutate()},disabled:X,"data-testid":"button-delete-profile-custom",children:[a.jsx(So,{className:"h-4 w-4 mr-2"}),"Delete Profile"]}),a.jsxs("div",{className:`flex gap-2 ${o?"":"ml-auto"}`,children:[a.jsx(ee,{type:"button",variant:"outline",onClick:()=>t(!1),disabled:X,"data-testid":"button-cancel-custom",children:"Cancel"}),a.jsx(ee,{type:"submit",disabled:X,"data-testid":"button-save-profile-custom",children:X?"Saving...":o?"Update Profile":"Create Profile"})]})]})]})})})]})]})})}function Sde({form:e,sectionIndex:t,uploadingPhoto:n,setUploadingPhoto:r}){const{fields:s,append:i,remove:o}=gm({control:e.control,name:`customSections.${t}.fields`}),{toast:l}=Wn(),c=async(d,u)=>{var f;const h=(f=d.target.files)==null?void 0:f[0];if(h){if(h.size>5*1024*1024){l({title:"Error",description:"File size must be less than 5MB",variant:"destructive"});return}r(!0);try{const m=new FormData;m.append("file",h);const g=await fetch(lt("/api/upload-photo"),{method:"POST",credentials:"include",body:m});if(!g.ok)throw new Error("Upload failed");const v=await g.json();e.setValue(`customSections.${t}.fields.${u}.value`,v.url),l({title:"Success",description:"Photo uploaded successfully!"})}catch{l({title:"Error",description:"Failed to upload photo. Please try again.",variant:"destructive"})}finally{r(!1)}}};return a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(dt,{children:"Fields"}),a.jsxs(ee,{type:"button",variant:"outline",size:"sm",onClick:()=>i({type:"text",label:"",value:""}),"data-testid":`button-add-custom-field-${t}`,children:[a.jsx(Nr,{className:"h-4 w-4 mr-2"}),"Add Field"]})]}),a.jsx("div",{className:"space-y-3",children:s.map((d,u)=>a.jsxs("div",{className:"flex gap-2 items-start",children:[a.jsx(Tt,{control:e.control,name:`customSections.${t}.fields.${u}.type`,render:({field:h})=>a.jsxs(vt,{className:"w-28",children:[a.jsxs(In,{onValueChange:h.onChange,value:h.value||"text",children:[a.jsx(yt,{children:a.jsx(wn,{"data-testid":`select-field-type-${t}-${u}`,children:a.jsx(An,{placeholder:"Type"})})}),a.jsxs(Sn,{children:[a.jsx(at,{value:"text",children:"Text"}),a.jsx(at,{value:"photo",children:"Photo"}),a.jsx(at,{value:"link",children:"Link"})]})]}),a.jsx(xt,{})]})}),a.jsx(Tt,{control:e.control,name:`customSections.${t}.fields.${u}.label`,render:({field:h})=>a.jsxs(vt,{className:"flex-1",children:[a.jsx(yt,{children:a.jsx(tt,{placeholder:"Label (e.g., Platform)",...h,"data-testid":`input-custom-field-label-${t}-${u}`})}),a.jsx(xt,{})]})}),a.jsx(Tt,{control:e.control,name:`customSections.${t}.fields.${u}.value`,render:({field:h})=>{const f=e.watch(`customSections.${t}.fields.${u}.type`)||"text";return f==="photo"?a.jsxs(vt,{className:"flex-1",children:[a.jsx(yt,{children:a.jsxs("div",{className:"flex gap-2",children:[a.jsx(tt,{type:"file",accept:"image/*",onChange:m=>c(m,u),disabled:n,className:"flex-1","data-testid":`input-custom-field-photo-${t}-${u}`}),h.value&&a.jsx("img",{src:h.value,alt:"Preview",className:"h-9 w-9 object-cover rounded"})]})}),a.jsx(xt,{})]}):a.jsxs(vt,{className:"flex-1",children:[a.jsx(yt,{children:a.jsx(tt,{placeholder:f==="link"?"URL (e.g., https://...)":"Value (e.g., Twitch)",...h,"data-testid":`input-custom-field-value-${t}-${u}`})}),a.jsx(xt,{})]})}}),a.jsx(ee,{type:"button",variant:"ghost",size:"icon",onClick:()=>o(u),"data-testid":`button-remove-custom-field-${t}-${u}`,children:a.jsx(Ot,{className:"h-4 w-4"})})]},d.id))})]})}const ef=p.forwardRef(({className:e,...t},n)=>a.jsx("textarea",{className:be("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:n,...t}));ef.displayName="Textarea";const le=Symbol.for("drizzle:entityKind");function xn(e,t){if(!e||typeof e!="object")return!1;if(e instanceof t)return!0;if(!Object.prototype.hasOwnProperty.call(t,le))throw new Error(`Class "${t.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let n=Object.getPrototypeOf(e).constructor;if(n)for(;n;){if(le in n&&n[le]===t[le])return!0;n=Object.getPrototypeOf(n)}return!1}var jN;jN=le;class Dd{constructor(t,n){z(this,"name");z(this,"keyAsName");z(this,"primary");z(this,"notNull");z(this,"default");z(this,"defaultFn");z(this,"onUpdateFn");z(this,"hasDefault");z(this,"isUnique");z(this,"uniqueName");z(this,"uniqueType");z(this,"dataType");z(this,"columnType");z(this,"enumValues");z(this,"generated");z(this,"generatedIdentity");z(this,"config");this.table=t,this.config=n,this.name=n.name,this.keyAsName=n.keyAsName,this.notNull=n.notNull,this.default=n.default,this.defaultFn=n.defaultFn,this.onUpdateFn=n.onUpdateFn,this.hasDefault=n.hasDefault,this.primary=n.primaryKey,this.isUnique=n.isUnique,this.uniqueName=n.uniqueName,this.uniqueType=n.uniqueType,this.dataType=n.dataType,this.columnType=n.columnType,this.generated=n.generated,this.generatedIdentity=n.generatedIdentity}mapFromDriverValue(t){return t}mapToDriverValue(t){return t}shouldDisableInsert(){return this.config.generated!==void 0&&this.config.generated.type!=="byDefault"}}z(Dd,jN,"Column");var MN;MN=le;class GU{constructor(t,n,r){z(this,"config");z(this,"$default",this.$defaultFn);z(this,"$onUpdate",this.$onUpdateFn);this.config={name:t,keyAsName:t==="",notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:n,columnType:r,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(t){return this.config.default=t,this.config.hasDefault=!0,this}$defaultFn(t){return this.config.defaultFn=t,this.config.hasDefault=!0,this}$onUpdateFn(t){return this.config.onUpdateFn=t,this.config.hasDefault=!0,this}primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(t){this.config.name===""&&(this.config.name=t)}}z(GU,MN,"ColumnBuilder");const Zc=Symbol.for("drizzle:Name");var DN;DN=le;class WU{constructor(t,n){z(this,"reference");z(this,"_onUpdate","no action");z(this,"_onDelete","no action");this.reference=()=>{const{name:r,columns:s,foreignColumns:i}=t();return{name:r,columns:s,foreignTable:i[0].table,foreignColumns:i}},n&&(this._onUpdate=n.onUpdate,this._onDelete=n.onDelete)}onUpdate(t){return this._onUpdate=t===void 0?"no action":t,this}onDelete(t){return this._onDelete=t===void 0?"no action":t,this}build(t){return new HU(t,this)}}z(WU,DN,"PgForeignKeyBuilder");var ON;ON=le;class HU{constructor(t,n){z(this,"reference");z(this,"onUpdate");z(this,"onDelete");this.table=t,this.reference=n.reference,this.onUpdate=n._onUpdate,this.onDelete=n._onDelete}getName(){const{name:t,columns:n,foreignColumns:r}=this.reference(),s=n.map(l=>l.name),i=r.map(l=>l.name),o=[this.table[Zc],...s,r[0].table[Zc],...i];return t??`${o.join("_")}_fk`}}z(HU,ON,"PgForeignKey");function kde(e,...t){return e(...t)}function Tde(e){return new QU(e)}function qU(e,t){return`${e[Zc]}_${t.join("_")}_unique`}var LN;LN=le;class KU{constructor(t,n){z(this,"columns");z(this,"nullsNotDistinctConfig",!1);this.name=n,this.columns=t}nullsNotDistinct(){return this.nullsNotDistinctConfig=!0,this}build(t){return new JU(t,this.columns,this.nullsNotDistinctConfig,this.name)}}z(KU,LN,"PgUniqueConstraintBuilder");var FN;FN=le;class QU{constructor(t){z(this,"name");this.name=t}on(...t){return new KU(t,this.name)}}z(QU,FN,"PgUniqueOnConstraintBuilder");var $N;$N=le;class JU{constructor(t,n,r,s){z(this,"columns");z(this,"name");z(this,"nullsNotDistinct",!1);this.table=t,this.columns=n,this.name=s??qU(this.table,this.columns.map(i=>i.name)),this.nullsNotDistinct=r}getName(){return this.name}}z(JU,$N,"PgUniqueConstraint");function nN(e,t,n){for(let r=t;r<e.length;r++){const s=e[r];if(s==="\\"){r++;continue}if(s==='"')return[e.slice(t,r).replace(/\\/g,""),r+1];if(!n&&(s===","||s==="}"))return[e.slice(t,r).replace(/\\/g,""),r]}return[e.slice(t).replace(/\\/g,""),e.length]}function YU(e,t=0){const n=[];let r=t,s=!1;for(;r<e.length;){const i=e[r];if(i===","){(s||r===t)&&n.push(""),s=!0,r++;continue}if(s=!1,i==="\\"){r+=2;continue}if(i==='"'){const[c,d]=nN(e,r+1,!0);n.push(c),r=d;continue}if(i==="}")return[n,r+1];if(i==="{"){const[c,d]=YU(e,r+1);n.push(c),r=d;continue}const[o,l]=nN(e,r,!1);n.push(o),r=l}return[n,r]}function Cde(e){const[t]=YU(e,1);return t}function XU(e){return`{${e.map(t=>Array.isArray(t)?XU(t):typeof t=="string"?`"${t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${t}`).join(",")}}`}var UN,VN;class gt extends(VN=GU,UN=le,VN){constructor(){super(...arguments);z(this,"foreignKeyConfigs",[])}array(n){return new eV(this.config.name,this,n)}references(n,r={}){return this.foreignKeyConfigs.push({ref:n,actions:r}),this}unique(n,r){return this.config.isUnique=!0,this.config.uniqueName=n,this.config.uniqueType=r==null?void 0:r.nulls,this}generatedAlwaysAs(n){return this.config.generated={as:n,type:"always",mode:"stored"},this}buildForeignKeys(n,r){return this.foreignKeyConfigs.map(({ref:s,actions:i})=>kde((o,l)=>{const c=new WU(()=>{const d=o();return{columns:[n],foreignColumns:[d]}});return l.onUpdate&&c.onUpdate(l.onUpdate),l.onDelete&&c.onDelete(l.onDelete),c.build(r)},s,i))}buildExtraConfigColumn(n){return new ZU(n,this.config)}}z(gt,UN,"PgColumnBuilder");var BN,zN;class Xe extends(zN=Dd,BN=le,zN){constructor(t,n){n.uniqueName||(n.uniqueName=qU(t,[n.name])),super(t,n),this.table=t}}z(Xe,BN,"PgColumn");var GN,WN;class ZU extends(WN=Xe,GN=le,WN){constructor(){super(...arguments);z(this,"indexConfig",{order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass});z(this,"defaultConfig",{order:"asc",nulls:"last",opClass:void 0})}getSQLType(){return this.getSQLType()}asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(n){return this.indexConfig.opClass=n,this}}z(ZU,GN,"ExtraConfigColumn");var HN;HN=le;class vm{constructor(t,n,r,s){z(this,"name");z(this,"keyAsName");z(this,"type");z(this,"indexConfig");this.name=t,this.keyAsName=n,this.type=r,this.indexConfig=s}}z(vm,HN,"IndexedColumn");var qN,KN;class eV extends(KN=gt,qN=le,KN){constructor(t,n,r){super(t,"array","PgArray"),this.config.baseBuilder=n,this.config.size=r}build(t){const n=this.config.baseBuilder.build(t);return new fS(t,this.config,n)}}z(eV,qN,"PgArrayBuilder");var QN,JN;const Ug=class Ug extends(JN=Xe,QN=le,JN){constructor(n,r,s,i){super(n,r);z(this,"size");this.baseColumn=s,this.range=i,this.size=r.size}getSQLType(){return`${this.baseColumn.getSQLType()}[${typeof this.size=="number"?this.size:""}]`}mapFromDriverValue(n){return typeof n=="string"&&(n=Cde(n)),n.map(r=>this.baseColumn.mapFromDriverValue(r))}mapToDriverValue(n,r=!1){const s=n.map(i=>i===null?null:xn(this.baseColumn,Ug)?this.baseColumn.mapToDriverValue(i,!0):this.baseColumn.mapToDriverValue(i));return r?s:XU(s)}};z(Ug,QN,"PgArray");let fS=Ug;const pS=Symbol.for("drizzle:isPgEnum");function Ede(e){return!!e&&typeof e=="function"&&pS in e&&e[pS]===!0}var YN,XN;class tV extends(XN=gt,YN=le,XN){constructor(t,n){super(t,"string","PgEnumColumn"),this.config.enum=n}build(t){return new nV(t,this.config)}}z(tV,YN,"PgEnumColumnBuilder");var ZN,e1;class nV extends(e1=Xe,ZN=le,e1){constructor(n,r){super(n,r);z(this,"enum",this.config.enum);z(this,"enumValues",this.config.enum.enumValues);this.enum=r.enum}getSQLType(){return this.enum.enumName}}z(nV,ZN,"PgEnumColumn");function zf(e,t){return _de(e,t,void 0)}function _de(e,t,n){const r=Object.assign(s=>new tV(s??"",r),{enumName:e,enumValues:t,schema:n,[pS]:!0});return r}var t1;t1=le;class ET{constructor(t,n,r,s=!1){this._={brand:"Subquery",sql:t,selectedFields:n,alias:r,isWith:s}}}z(ET,t1,"Subquery");const Pde={startActiveSpan(e,t){return t()}},ed=Symbol.for("drizzle:ViewBaseConfig"),$x=Symbol.for("drizzle:Schema"),rN=Symbol.for("drizzle:Columns"),sN=Symbol.for("drizzle:ExtraConfigColumns"),Ux=Symbol.for("drizzle:OriginalName"),Vx=Symbol.for("drizzle:BaseName"),Og=Symbol.for("drizzle:IsAlias"),iN=Symbol.for("drizzle:ExtraConfigBuilder"),rV=Symbol.for("drizzle:IsDrizzleTable");var n1,r1,s1,i1,a1,o1,l1,c1,d1,u1;u1=le,d1=Zc,c1=Ux,l1=$x,o1=rN,a1=sN,i1=Vx,s1=Og,r1=rV,n1=iN;class Er{constructor(t,n,r){z(this,d1);z(this,c1);z(this,l1);z(this,o1);z(this,a1);z(this,i1);z(this,s1,!1);z(this,r1,!0);z(this,n1);this[Zc]=this[Ux]=t,this[$x]=n,this[Vx]=r}}z(Er,u1,"Table"),z(Er,"Symbol",{Name:Zc,Schema:$x,OriginalName:Ux,Columns:rN,ExtraConfigColumns:sN,BaseName:Vx,IsAlias:Og,ExtraConfigBuilder:iN});function sV(e){return typeof e=="object"&&e!==null&&rV in e}function Nde(e){return e!=null&&typeof e.getSQL=="function"}function Ide(e){var n;const t={sql:"",params:[]};for(const r of e)t.sql+=r.sql,t.params.push(...r.params),(n=r.typings)!=null&&n.length&&(t.typings||(t.typings=[]),t.typings.push(...r.typings));return t}var h1;h1=le;class ys{constructor(t){z(this,"value");this.value=Array.isArray(t)?t:[t]}getSQL(){return new sn([this])}}z(ys,h1,"StringChunk");var f1;f1=le;const el=class el{constructor(t){z(this,"decoder",iV);z(this,"shouldInlineParams",!1);this.queryChunks=t}append(t){return this.queryChunks.push(...t.queryChunks),this}toQuery(t){return Pde.startActiveSpan("drizzle.buildSQL",n=>{const r=this.buildQueryFromSourceParams(this.queryChunks,t);return n==null||n.setAttributes({"drizzle.query.text":r.sql,"drizzle.query.params":JSON.stringify(r.params)}),r})}buildQueryFromSourceParams(t,n){const r=Object.assign({},n,{inlineParams:n.inlineParams||this.shouldInlineParams,paramStartIndex:n.paramStartIndex||{value:0}}),{casing:s,escapeName:i,escapeParam:o,prepareTyping:l,inlineParams:c,paramStartIndex:d}=r;return Ide(t.map(u=>{var h;if(xn(u,ys))return{sql:u.value.join(""),params:[]};if(xn(u,Lg))return{sql:i(u.value),params:[]};if(u===void 0)return{sql:"",params:[]};if(Array.isArray(u)){const f=[new ys("(")];for(const[m,g]of u.entries())f.push(g),m<u.length-1&&f.push(new ys(", "));return f.push(new ys(")")),this.buildQueryFromSourceParams(f,r)}if(xn(u,el))return this.buildQueryFromSourceParams(u.queryChunks,{...r,inlineParams:c||u.shouldInlineParams});if(xn(u,Er)){const f=u[Er.Symbol.Schema],m=u[Er.Symbol.Name];return{sql:f===void 0||u[Og]?i(m):i(f)+"."+i(m),params:[]}}if(xn(u,Dd)){const f=s.getColumnCasing(u);if(n.invokeSource==="indexes")return{sql:i(f),params:[]};const m=u.table[Er.Symbol.Schema];return{sql:u.table[Og]||m===void 0?i(u.table[Er.Symbol.Name])+"."+i(f):i(m)+"."+i(u.table[Er.Symbol.Name])+"."+i(f),params:[]}}if(xn(u,lV)){const f=u[ed].schema,m=u[ed].name;return{sql:f===void 0||u[ed].isAlias?i(m):i(f)+"."+i(m),params:[]}}if(xn(u,_T)){if(xn(u.value,Fg))return{sql:o(d.value++,u),params:[u],typings:["none"]};const f=u.value===null?null:u.encoder.mapToDriverValue(u.value);if(xn(f,el))return this.buildQueryFromSourceParams([f],r);if(c)return{sql:this.mapInlineParam(f,r),params:[]};let m=["none"];return l&&(m=[l(u.encoder)]),{sql:o(d.value++,f),params:[f],typings:m}}return xn(u,Fg)?{sql:o(d.value++,u),params:[u],typings:["none"]}:xn(u,el.Aliased)&&u.fieldAlias!==void 0?{sql:i(u.fieldAlias),params:[]}:xn(u,ET)?u._.isWith?{sql:i(u._.alias),params:[]}:this.buildQueryFromSourceParams([new ys("("),u._.sql,new ys(") "),new Lg(u._.alias)],r):Ede(u)?u.schema?{sql:i(u.schema)+"."+i(u.enumName),params:[]}:{sql:i(u.enumName),params:[]}:Nde(u)?(h=u.shouldOmitSQLParens)!=null&&h.call(u)?this.buildQueryFromSourceParams([u.getSQL()],r):this.buildQueryFromSourceParams([new ys("("),u.getSQL(),new ys(")")],r):c?{sql:this.mapInlineParam(u,r),params:[]}:{sql:o(d.value++,u),params:[u],typings:["none"]}}))}mapInlineParam(t,{escapeString:n}){if(t===null)return"null";if(typeof t=="number"||typeof t=="boolean")return t.toString();if(typeof t=="string")return n(t);if(typeof t=="object"){const r=t.toString();return n(r==="[object Object]"?JSON.stringify(t):r)}throw new Error("Unexpected param value: "+t)}getSQL(){return this}as(t){return t===void 0?this:new el.Aliased(this,t)}mapWith(t){return this.decoder=typeof t=="function"?{mapFromDriverValue:t}:t,this}inlineParams(){return this.shouldInlineParams=!0,this}if(t){return t?this:void 0}};z(el,f1,"SQL");let sn=el;var p1;p1=le;class Lg{constructor(t){z(this,"brand");this.value=t}getSQL(){return new sn([this])}}z(Lg,p1,"Name");const iV={mapFromDriverValue:e=>e},aV={mapToDriverValue:e=>e};({...iV,...aV});var m1;m1=le;class _T{constructor(t,n=aV){z(this,"brand");this.value=t,this.encoder=n}getSQL(){return new sn([this])}}z(_T,m1,"Param");function hn(e,...t){const n=[];(t.length>0||e.length>0&&e[0]!=="")&&n.push(new ys(e[0]));for(const[r,s]of t.entries())n.push(s,new ys(e[r+1]));return new sn(n)}(e=>{function t(){return new sn([])}e.empty=t;function n(c){return new sn(c)}e.fromList=n;function r(c){return new sn([new ys(c)])}e.raw=r;function s(c,d){const u=[];for(const[h,f]of c.entries())h>0&&d!==void 0&&u.push(d),u.push(f);return new sn(u)}e.join=s;function i(c){return new Lg(c)}e.identifier=i;function o(c){return new Fg(c)}e.placeholder=o;function l(c,d){return new _T(c,d)}e.param=l})(hn||(hn={}));(e=>{var n;n=le;const r=class r{constructor(i,o){z(this,"isSelectionField",!1);this.sql=i,this.fieldAlias=o}getSQL(){return this.sql}clone(){return new r(this.sql,this.fieldAlias)}};z(r,n,"SQL.Aliased");let t=r;e.Aliased=t})(sn||(sn={}));var g1;g1=le;class Fg{constructor(t){this.name=t}getSQL(){return new sn([this])}}z(Fg,g1,"Placeholder");const oV=Symbol.for("drizzle:IsDrizzleView");var v1,y1,x1;x1=le,y1=ed,v1=oV;class lV{constructor({name:t,schema:n,selectedFields:r,query:s}){z(this,y1);z(this,v1,!0);this[ed]={name:t,originalName:t,schema:n,selectedFields:r,query:s,isExisting:!s,isAlias:!1}}getSQL(){return new sn([this])}}z(lV,x1,"View");function Ade(e){return typeof e=="object"&&e!==null&&oV in e}Dd.prototype.getSQL=function(){return new sn([this])};Er.prototype.getSQL=function(){return new sn([this])};ET.prototype.getSQL=function(){return new sn([this])};function Rde(e){return e[Er.Symbol.Columns]}function jde(e){return e[ed].selectedFields}function qn(e,t){return{name:typeof e=="string"&&e.length>0?e:"",config:typeof e=="object"?e:t}}var b1,w1;class Gf extends(w1=gt,b1=le,w1){generatedAlwaysAsIdentity(t){if(t){const{name:n,...r}=t;this.config.generatedIdentity={type:"always",sequenceName:n,sequenceOptions:r}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(t){if(t){const{name:n,...r}=t;this.config.generatedIdentity={type:"byDefault",sequenceName:n,sequenceOptions:r}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}}z(Gf,b1,"PgIntColumnBaseBuilder");var S1,k1;class cV extends(k1=Gf,S1=le,k1){constructor(t){super(t,"number","PgBigInt53")}build(t){return new dV(t,this.config)}}z(cV,S1,"PgBigInt53Builder");var T1,C1;class dV extends(C1=Xe,T1=le,C1){getSQLType(){return"bigint"}mapFromDriverValue(t){return typeof t=="number"?t:Number(t)}}z(dV,T1,"PgBigInt53");var E1,_1;class uV extends(_1=Gf,E1=le,_1){constructor(t){super(t,"bigint","PgBigInt64")}build(t){return new hV(t,this.config)}}z(uV,E1,"PgBigInt64Builder");var P1,N1;class hV extends(N1=Xe,P1=le,N1){getSQLType(){return"bigint"}mapFromDriverValue(t){return BigInt(t)}}z(hV,P1,"PgBigInt64");function Mde(e,t){const{name:n,config:r}=qn(e,t);return r.mode==="number"?new cV(n):new uV(n)}var I1,A1;class fV extends(A1=gt,I1=le,A1){constructor(t){super(t,"number","PgBigSerial53"),this.config.hasDefault=!0,this.config.notNull=!0}build(t){return new pV(t,this.config)}}z(fV,I1,"PgBigSerial53Builder");var R1,j1;class pV extends(j1=Xe,R1=le,j1){getSQLType(){return"bigserial"}mapFromDriverValue(t){return typeof t=="number"?t:Number(t)}}z(pV,R1,"PgBigSerial53");var M1,D1;class mV extends(D1=gt,M1=le,D1){constructor(t){super(t,"bigint","PgBigSerial64"),this.config.hasDefault=!0}build(t){return new gV(t,this.config)}}z(mV,M1,"PgBigSerial64Builder");var O1,L1;class gV extends(L1=Xe,O1=le,L1){getSQLType(){return"bigserial"}mapFromDriverValue(t){return BigInt(t)}}z(gV,O1,"PgBigSerial64");function Dde(e,t){const{name:n,config:r}=qn(e,t);return r.mode==="number"?new fV(n):new mV(n)}var F1,$1;class vV extends($1=gt,F1=le,$1){constructor(t){super(t,"boolean","PgBoolean")}build(t){return new yV(t,this.config)}}z(vV,F1,"PgBooleanBuilder");var U1,V1;class yV extends(V1=Xe,U1=le,V1){getSQLType(){return"boolean"}}z(yV,U1,"PgBoolean");function Ni(e){return new vV(e??"")}var B1,z1;class xV extends(z1=gt,B1=le,z1){constructor(t,n){super(t,"string","PgChar"),this.config.length=n.length,this.config.enumValues=n.enum}build(t){return new bV(t,this.config)}}z(xV,B1,"PgCharBuilder");var G1,W1;class bV extends(W1=Xe,G1=le,W1){constructor(){super(...arguments);z(this,"length",this.config.length);z(this,"enumValues",this.config.enumValues)}getSQLType(){return this.length===void 0?"char":`char(${this.length})`}}z(bV,G1,"PgChar");function Ode(e,t={}){const{name:n,config:r}=qn(e,t);return new xV(n,r)}var H1,q1;class wV extends(q1=gt,H1=le,q1){constructor(t){super(t,"string","PgCidr")}build(t){return new SV(t,this.config)}}z(wV,H1,"PgCidrBuilder");var K1,Q1;class SV extends(Q1=Xe,K1=le,Q1){getSQLType(){return"cidr"}}z(SV,K1,"PgCidr");function Lde(e){return new wV(e??"")}var J1,Y1;class kV extends(Y1=gt,J1=le,Y1){constructor(t,n,r){super(t,"custom","PgCustomColumn"),this.config.fieldConfig=n,this.config.customTypeParams=r}build(t){return new TV(t,this.config)}}z(kV,J1,"PgCustomColumnBuilder");var X1,Z1;class TV extends(Z1=Xe,X1=le,Z1){constructor(n,r){super(n,r);z(this,"sqlName");z(this,"mapTo");z(this,"mapFrom");this.sqlName=r.customTypeParams.dataType(r.fieldConfig),this.mapTo=r.customTypeParams.toDriver,this.mapFrom=r.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(n){return typeof this.mapFrom=="function"?this.mapFrom(n):n}mapToDriverValue(n){return typeof this.mapTo=="function"?this.mapTo(n):n}}z(TV,X1,"PgCustomColumn");function Fde(e){return(t,n)=>{const{name:r,config:s}=qn(t,n);return new kV(r,s,e)}}var eI,tI;class nu extends(tI=gt,eI=le,tI){defaultNow(){return this.default(hn`now()`)}}z(nu,eI,"PgDateColumnBaseBuilder");var nI,rI;class CV extends(rI=nu,nI=le,rI){constructor(t){super(t,"date","PgDate")}build(t){return new EV(t,this.config)}}z(CV,nI,"PgDateBuilder");var sI,iI;class EV extends(iI=Xe,sI=le,iI){getSQLType(){return"date"}mapFromDriverValue(t){return new Date(t)}mapToDriverValue(t){return t.toISOString()}}z(EV,sI,"PgDate");var aI,oI;class _V extends(oI=nu,aI=le,oI){constructor(t){super(t,"string","PgDateString")}build(t){return new PV(t,this.config)}}z(_V,aI,"PgDateStringBuilder");var lI,cI;class PV extends(cI=Xe,lI=le,cI){getSQLType(){return"date"}}z(PV,lI,"PgDateString");function $de(e,t){const{name:n,config:r}=qn(e,t);return(r==null?void 0:r.mode)==="date"?new CV(n):new _V(n)}var dI,uI;class NV extends(uI=gt,dI=le,uI){constructor(t){super(t,"number","PgDoublePrecision")}build(t){return new IV(t,this.config)}}z(NV,dI,"PgDoublePrecisionBuilder");var hI,fI;class IV extends(fI=Xe,hI=le,fI){getSQLType(){return"double precision"}mapFromDriverValue(t){return typeof t=="string"?Number.parseFloat(t):t}}z(IV,hI,"PgDoublePrecision");function Ude(e){return new NV(e??"")}var pI,mI;class AV extends(mI=gt,pI=le,mI){constructor(t){super(t,"string","PgInet")}build(t){return new RV(t,this.config)}}z(AV,pI,"PgInetBuilder");var gI,vI;class RV extends(vI=Xe,gI=le,vI){getSQLType(){return"inet"}}z(RV,gI,"PgInet");function Vde(e){return new AV(e??"")}var yI,xI;class jV extends(xI=Gf,yI=le,xI){constructor(t){super(t,"number","PgInteger")}build(t){return new MV(t,this.config)}}z(jV,yI,"PgIntegerBuilder");var bI,wI;class MV extends(wI=Xe,bI=le,wI){getSQLType(){return"integer"}mapFromDriverValue(t){return typeof t=="string"?Number.parseInt(t):t}}z(MV,bI,"PgInteger");function oy(e){return new jV(e??"")}var SI,kI;class DV extends(kI=gt,SI=le,kI){constructor(t,n){super(t,"string","PgInterval"),this.config.intervalConfig=n}build(t){return new OV(t,this.config)}}z(DV,SI,"PgIntervalBuilder");var TI,CI;class OV extends(CI=Xe,TI=le,CI){constructor(){super(...arguments);z(this,"fields",this.config.intervalConfig.fields);z(this,"precision",this.config.intervalConfig.precision)}getSQLType(){const n=this.fields?` ${this.fields}`:"",r=this.precision?`(${this.precision})`:"";return`interval${n}${r}`}}z(OV,TI,"PgInterval");function Bde(e,t={}){const{name:n,config:r}=qn(e,t);return new DV(n,r)}var EI,_I;class LV extends(_I=gt,EI=le,_I){constructor(t){super(t,"json","PgJson")}build(t){return new FV(t,this.config)}}z(LV,EI,"PgJsonBuilder");var PI,NI;class FV extends(NI=Xe,PI=le,NI){constructor(t,n){super(t,n)}getSQLType(){return"json"}mapToDriverValue(t){return JSON.stringify(t)}mapFromDriverValue(t){if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t}}z(FV,PI,"PgJson");function zde(e){return new LV(e??"")}var II,AI;class $V extends(AI=gt,II=le,AI){constructor(t){super(t,"json","PgJsonb")}build(t){return new UV(t,this.config)}}z($V,II,"PgJsonbBuilder");var RI,jI;class UV extends(jI=Xe,RI=le,jI){constructor(t,n){super(t,n)}getSQLType(){return"jsonb"}mapToDriverValue(t){return JSON.stringify(t)}mapFromDriverValue(t){if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t}}z(UV,RI,"PgJsonb");function ra(e){return new $V(e??"")}var MI,DI;class VV extends(DI=gt,MI=le,DI){constructor(t){super(t,"array","PgLine")}build(t){return new BV(t,this.config)}}z(VV,MI,"PgLineBuilder");var OI,LI;class BV extends(LI=Xe,OI=le,LI){getSQLType(){return"line"}mapFromDriverValue(t){const[n,r,s]=t.slice(1,-1).split(",");return[Number.parseFloat(n),Number.parseFloat(r),Number.parseFloat(s)]}mapToDriverValue(t){return`{${t[0]},${t[1]},${t[2]}}`}}z(BV,OI,"PgLine");var FI,$I;class zV extends($I=gt,FI=le,$I){constructor(t){super(t,"json","PgLineABC")}build(t){return new GV(t,this.config)}}z(zV,FI,"PgLineABCBuilder");var UI,VI;class GV extends(VI=Xe,UI=le,VI){getSQLType(){return"line"}mapFromDriverValue(t){const[n,r,s]=t.slice(1,-1).split(",");return{a:Number.parseFloat(n),b:Number.parseFloat(r),c:Number.parseFloat(s)}}mapToDriverValue(t){return`{${t.a},${t.b},${t.c}}`}}z(GV,UI,"PgLineABC");function Gde(e,t){const{name:n,config:r}=qn(e,t);return!(r!=null&&r.mode)||r.mode==="tuple"?new VV(n):new zV(n)}var BI,zI;class WV extends(zI=gt,BI=le,zI){constructor(t){super(t,"string","PgMacaddr")}build(t){return new HV(t,this.config)}}z(WV,BI,"PgMacaddrBuilder");var GI,WI;class HV extends(WI=Xe,GI=le,WI){getSQLType(){return"macaddr"}}z(HV,GI,"PgMacaddr");function Wde(e){return new WV(e??"")}var HI,qI;class qV extends(qI=gt,HI=le,qI){constructor(t){super(t,"string","PgMacaddr8")}build(t){return new KV(t,this.config)}}z(qV,HI,"PgMacaddr8Builder");var KI,QI;class KV extends(QI=Xe,KI=le,QI){getSQLType(){return"macaddr8"}}z(KV,KI,"PgMacaddr8");function Hde(e){return new qV(e??"")}var JI,YI;class QV extends(YI=gt,JI=le,YI){constructor(t,n,r){super(t,"string","PgNumeric"),this.config.precision=n,this.config.scale=r}build(t){return new JV(t,this.config)}}z(QV,JI,"PgNumericBuilder");var XI,ZI;class JV extends(ZI=Xe,XI=le,ZI){constructor(n,r){super(n,r);z(this,"precision");z(this,"scale");this.precision=r.precision,this.scale=r.scale}getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}}z(JV,XI,"PgNumeric");function qde(e,t){const{name:n,config:r}=qn(e,t);return new QV(n,r==null?void 0:r.precision,r==null?void 0:r.scale)}var eA,tA;class YV extends(tA=gt,eA=le,tA){constructor(t){super(t,"array","PgPointTuple")}build(t){return new XV(t,this.config)}}z(YV,eA,"PgPointTupleBuilder");var nA,rA;class XV extends(rA=Xe,nA=le,rA){getSQLType(){return"point"}mapFromDriverValue(t){if(typeof t=="string"){const[n,r]=t.slice(1,-1).split(",");return[Number.parseFloat(n),Number.parseFloat(r)]}return[t.x,t.y]}mapToDriverValue(t){return`(${t[0]},${t[1]})`}}z(XV,nA,"PgPointTuple");var sA,iA;class ZV extends(iA=gt,sA=le,iA){constructor(t){super(t,"json","PgPointObject")}build(t){return new e5(t,this.config)}}z(ZV,sA,"PgPointObjectBuilder");var aA,oA;class e5 extends(oA=Xe,aA=le,oA){getSQLType(){return"point"}mapFromDriverValue(t){if(typeof t=="string"){const[n,r]=t.slice(1,-1).split(",");return{x:Number.parseFloat(n),y:Number.parseFloat(r)}}return t}mapToDriverValue(t){return`(${t.x},${t.y})`}}z(e5,aA,"PgPointObject");function Kde(e,t){const{name:n,config:r}=qn(e,t);return!(r!=null&&r.mode)||r.mode==="tuple"?new YV(n):new ZV(n)}function Qde(e){const t=[];for(let n=0;n<e.length;n+=2)t.push(Number.parseInt(e.slice(n,n+2),16));return new Uint8Array(t)}function aN(e,t){const n=new ArrayBuffer(8),r=new DataView(n);for(let s=0;s<8;s++)r.setUint8(s,e[t+s]);return r.getFloat64(0,!0)}function t5(e){const t=Qde(e);let n=0;const r=t[n];n+=1;const s=new DataView(t.buffer),i=s.getUint32(n,r===1);if(n+=4,i&536870912&&(s.getUint32(n,r===1),n+=4),(i&65535)===1){const o=aN(t,n);n+=8;const l=aN(t,n);return n+=8,[o,l]}throw new Error("Unsupported geometry type")}var lA,cA;class n5 extends(cA=gt,lA=le,cA){constructor(t){super(t,"array","PgGeometry")}build(t){return new r5(t,this.config)}}z(n5,lA,"PgGeometryBuilder");var dA,uA;class r5 extends(uA=Xe,dA=le,uA){getSQLType(){return"geometry(point)"}mapFromDriverValue(t){return t5(t)}mapToDriverValue(t){return`point(${t[0]} ${t[1]})`}}z(r5,dA,"PgGeometry");var hA,fA;class s5 extends(fA=gt,hA=le,fA){constructor(t){super(t,"json","PgGeometryObject")}build(t){return new i5(t,this.config)}}z(s5,hA,"PgGeometryObjectBuilder");var pA,mA;class i5 extends(mA=Xe,pA=le,mA){getSQLType(){return"geometry(point)"}mapFromDriverValue(t){const n=t5(t);return{x:n[0],y:n[1]}}mapToDriverValue(t){return`point(${t.x} ${t.y})`}}z(i5,pA,"PgGeometryObject");function Jde(e,t){const{name:n,config:r}=qn(e,t);return!(r!=null&&r.mode)||r.mode==="tuple"?new n5(n):new s5(n)}var gA,vA;class a5 extends(vA=gt,gA=le,vA){constructor(t,n){super(t,"number","PgReal"),this.config.length=n}build(t){return new o5(t,this.config)}}z(a5,gA,"PgRealBuilder");var yA,xA;class o5 extends(xA=Xe,yA=le,xA){constructor(n,r){super(n,r);z(this,"mapFromDriverValue",n=>typeof n=="string"?Number.parseFloat(n):n)}getSQLType(){return"real"}}z(o5,yA,"PgReal");function mS(e){return new a5(e??"")}var bA,wA;class l5 extends(wA=gt,bA=le,wA){constructor(t){super(t,"number","PgSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(t){return new c5(t,this.config)}}z(l5,bA,"PgSerialBuilder");var SA,kA;class c5 extends(kA=Xe,SA=le,kA){getSQLType(){return"serial"}}z(c5,SA,"PgSerial");function Yde(e){return new l5(e??"")}var TA,CA;class d5 extends(CA=Gf,TA=le,CA){constructor(t){super(t,"number","PgSmallInt")}build(t){return new u5(t,this.config)}}z(d5,TA,"PgSmallIntBuilder");var EA,_A;class u5 extends(_A=Xe,EA=le,_A){constructor(){super(...arguments);z(this,"mapFromDriverValue",n=>typeof n=="string"?Number(n):n)}getSQLType(){return"smallint"}}z(u5,EA,"PgSmallInt");function Xde(e){return new d5(e??"")}var PA,NA;class h5 extends(NA=gt,PA=le,NA){constructor(t){super(t,"number","PgSmallSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(t){return new f5(t,this.config)}}z(h5,PA,"PgSmallSerialBuilder");var IA,AA;class f5 extends(AA=Xe,IA=le,AA){getSQLType(){return"smallserial"}}z(f5,IA,"PgSmallSerial");function Zde(e){return new h5(e??"")}var RA,jA;class p5 extends(jA=gt,RA=le,jA){constructor(t,n){super(t,"string","PgText"),this.config.enumValues=n.enum}build(t){return new m5(t,this.config)}}z(p5,RA,"PgTextBuilder");var MA,DA;class m5 extends(DA=Xe,MA=le,DA){constructor(){super(...arguments);z(this,"enumValues",this.config.enumValues)}getSQLType(){return"text"}}z(m5,MA,"PgText");function _s(e,t={}){const{name:n,config:r}=qn(e,t);return new p5(n,r)}var OA,LA;class g5 extends(LA=nu,OA=le,LA){constructor(t,n,r){super(t,"string","PgTime"),this.withTimezone=n,this.precision=r,this.config.withTimezone=n,this.config.precision=r}build(t){return new v5(t,this.config)}}z(g5,OA,"PgTimeBuilder");var FA,$A;class v5 extends($A=Xe,FA=le,$A){constructor(n,r){super(n,r);z(this,"withTimezone");z(this,"precision");this.withTimezone=r.withTimezone,this.precision=r.precision}getSQLType(){return`time${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}z(v5,FA,"PgTime");function eue(e,t={}){const{name:n,config:r}=qn(e,t);return new g5(n,r.withTimezone??!1,r.precision)}var UA,VA;class y5 extends(VA=nu,UA=le,VA){constructor(t,n,r){super(t,"date","PgTimestamp"),this.config.withTimezone=n,this.config.precision=r}build(t){return new x5(t,this.config)}}z(y5,UA,"PgTimestampBuilder");var BA,zA;class x5 extends(zA=Xe,BA=le,zA){constructor(n,r){super(n,r);z(this,"withTimezone");z(this,"precision");z(this,"mapFromDriverValue",n=>new Date(this.withTimezone?n:n+"+0000"));z(this,"mapToDriverValue",n=>n.toISOString());this.withTimezone=r.withTimezone,this.precision=r.precision}getSQLType(){return`timestamp${this.precision===void 0?"":` (${this.precision})`}${this.withTimezone?" with time zone":""}`}}z(x5,BA,"PgTimestamp");var GA,WA;class b5 extends(WA=nu,GA=le,WA){constructor(t,n,r){super(t,"string","PgTimestampString"),this.config.withTimezone=n,this.config.precision=r}build(t){return new w5(t,this.config)}}z(b5,GA,"PgTimestampStringBuilder");var HA,qA;class w5 extends(qA=Xe,HA=le,qA){constructor(n,r){super(n,r);z(this,"withTimezone");z(this,"precision");this.withTimezone=r.withTimezone,this.precision=r.precision}getSQLType(){return`timestamp${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}z(w5,HA,"PgTimestampString");function jt(e,t={}){const{name:n,config:r}=qn(e,t);return(r==null?void 0:r.mode)==="string"?new b5(n,r.withTimezone??!1,r.precision):new y5(n,(r==null?void 0:r.withTimezone)??!1,r==null?void 0:r.precision)}var KA,QA;class S5 extends(QA=gt,KA=le,QA){constructor(t){super(t,"string","PgUUID")}defaultRandom(){return this.default(hn`gen_random_uuid()`)}build(t){return new k5(t,this.config)}}z(S5,KA,"PgUUIDBuilder");var JA,YA;class k5 extends(YA=Xe,JA=le,YA){getSQLType(){return"uuid"}}z(k5,JA,"PgUUID");function tue(e){return new S5(e??"")}var XA,ZA;class T5 extends(ZA=gt,XA=le,ZA){constructor(t,n){super(t,"string","PgVarchar"),this.config.length=n.length,this.config.enumValues=n.enum}build(t){return new C5(t,this.config)}}z(T5,XA,"PgVarcharBuilder");var eR,tR;class C5 extends(tR=Xe,eR=le,tR){constructor(){super(...arguments);z(this,"length",this.config.length);z(this,"enumValues",this.config.enumValues)}getSQLType(){return this.length===void 0?"varchar":`varchar(${this.length})`}}z(C5,eR,"PgVarchar");function we(e,t={}){const{name:n,config:r}=qn(e,t);return new T5(n,r)}var nR,rR;class E5 extends(rR=gt,nR=le,rR){constructor(t,n){super(t,"string","PgBinaryVector"),this.config.dimensions=n.dimensions}build(t){return new _5(t,this.config)}}z(E5,nR,"PgBinaryVectorBuilder");var sR,iR;class _5 extends(iR=Xe,sR=le,iR){constructor(){super(...arguments);z(this,"dimensions",this.config.dimensions)}getSQLType(){return`bit(${this.dimensions})`}}z(_5,sR,"PgBinaryVector");function nue(e,t){const{name:n,config:r}=qn(e,t);return new E5(n,r)}var aR,oR;class P5 extends(oR=gt,aR=le,oR){constructor(t,n){super(t,"array","PgHalfVector"),this.config.dimensions=n.dimensions}build(t){return new N5(t,this.config)}}z(P5,aR,"PgHalfVectorBuilder");var lR,cR;class N5 extends(cR=Xe,lR=le,cR){constructor(){super(...arguments);z(this,"dimensions",this.config.dimensions)}getSQLType(){return`halfvec(${this.dimensions})`}mapToDriverValue(n){return JSON.stringify(n)}mapFromDriverValue(n){return n.slice(1,-1).split(",").map(r=>Number.parseFloat(r))}}z(N5,lR,"PgHalfVector");function rue(e,t){const{name:n,config:r}=qn(e,t);return new P5(n,r)}var dR,uR;class I5 extends(uR=gt,dR=le,uR){constructor(t,n){super(t,"string","PgSparseVector"),this.config.dimensions=n.dimensions}build(t){return new A5(t,this.config)}}z(I5,dR,"PgSparseVectorBuilder");var hR,fR;class A5 extends(fR=Xe,hR=le,fR){constructor(){super(...arguments);z(this,"dimensions",this.config.dimensions)}getSQLType(){return`sparsevec(${this.dimensions})`}}z(A5,hR,"PgSparseVector");function sue(e,t){const{name:n,config:r}=qn(e,t);return new I5(n,r)}var pR,mR;class R5 extends(mR=gt,pR=le,mR){constructor(t,n){super(t,"array","PgVector"),this.config.dimensions=n.dimensions}build(t){return new j5(t,this.config)}}z(R5,pR,"PgVectorBuilder");var gR,vR;class j5 extends(vR=Xe,gR=le,vR){constructor(){super(...arguments);z(this,"dimensions",this.config.dimensions)}getSQLType(){return`vector(${this.dimensions})`}mapToDriverValue(n){return JSON.stringify(n)}mapFromDriverValue(n){return n.slice(1,-1).split(",").map(r=>Number.parseFloat(r))}}z(j5,gR,"PgVector");function iue(e,t){const{name:n,config:r}=qn(e,t);return new R5(n,r)}function aue(){return{bigint:Mde,bigserial:Dde,boolean:Ni,char:Ode,cidr:Lde,customType:Fde,date:$de,doublePrecision:Ude,inet:Vde,integer:oy,interval:Bde,json:zde,jsonb:ra,line:Gde,macaddr:Wde,macaddr8:Hde,numeric:qde,point:Kde,geometry:Jde,real:mS,serial:Yde,smallint:Xde,smallserial:Zde,text:_s,time:eue,timestamp:jt,uuid:tue,varchar:we,bit:nue,halfvec:rue,sparsevec:sue,vector:iue}}const gS=Symbol.for("drizzle:PgInlineForeignKeys"),oN=Symbol.for("drizzle:EnableRLS");var yR,xR,bR,wR,SR;class ih extends(SR=Er,wR=le,bR=gS,xR=oN,yR=Er.Symbol.ExtraConfigBuilder,SR){constructor(){super(...arguments);z(this,bR,[]);z(this,xR,!1);z(this,yR)}}z(ih,wR,"PgTable"),z(ih,"Symbol",Object.assign({},Er.Symbol,{InlineForeignKeys:gS,EnableRLS:oN}));function oue(e,t,n,r,s=e){const i=new ih(e,r,s),o=typeof t=="function"?t(aue()):t,l=Object.fromEntries(Object.entries(o).map(([u,h])=>{const f=h;f.setName(u);const m=f.build(i);return i[gS].push(...f.buildForeignKeys(m,i)),[u,m]})),c=Object.fromEntries(Object.entries(o).map(([u,h])=>{const f=h;f.setName(u);const m=f.buildExtraConfigColumn(i);return[u,m]})),d=Object.assign(i,l);return d[Er.Symbol.Columns]=l,d[Er.Symbol.ExtraConfigColumns]=c,n&&(d[ih.Symbol.ExtraConfigBuilder]=n),Object.assign(d,{enableRLS:()=>(d[ih.Symbol.EnableRLS]=!0,d)})}const Kn=(e,t,n)=>oue(e,t,n,void 0);var kR;kR=le;class M5{constructor(t,n){this.unique=t,this.name=n}on(...t){return new ym(t.map(n=>{if(xn(n,sn))return n;n=n;const r=new vm(n.name,!!n.keyAsName,n.columnType,n.indexConfig);return n.indexConfig=JSON.parse(JSON.stringify(n.defaultConfig)),r}),this.unique,!1,this.name)}onOnly(...t){return new ym(t.map(n=>{if(xn(n,sn))return n;n=n;const r=new vm(n.name,!!n.keyAsName,n.columnType,n.indexConfig);return n.indexConfig=n.defaultConfig,r}),this.unique,!0,this.name)}using(t,...n){return new ym(n.map(r=>{if(xn(r,sn))return r;r=r;const s=new vm(r.name,!!r.keyAsName,r.columnType,r.indexConfig);return r.indexConfig=JSON.parse(JSON.stringify(r.defaultConfig)),s}),this.unique,!0,this.name,t)}}z(M5,kR,"PgIndexBuilderOn");var TR;TR=le;class ym{constructor(t,n,r,s,i="btree"){z(this,"config");this.config={name:s,columns:t,unique:n,only:r,method:i}}concurrently(){return this.config.concurrently=!0,this}with(t){return this.config.with=t,this}where(t){return this.config.where=t,this}build(t){return new D5(this.config,t)}}z(ym,TR,"PgIndexBuilder");var CR;CR=le;class D5{constructor(t,n){z(this,"config");this.config={...t,table:n}}}z(D5,CR,"PgIndex");function mt(e){return new M5(!1,e)}const qt={INT8_MIN:-128,INT8_MAX:127,INT8_UNSIGNED_MAX:255,INT16_MIN:-32768,INT16_MAX:32767,INT16_UNSIGNED_MAX:65535,INT24_MIN:-8388608,INT24_MAX:8388607,INT24_UNSIGNED_MAX:16777215,INT32_MIN:-2147483648,INT32_MAX:2147483647,INT32_UNSIGNED_MAX:4294967295,INT48_MIN:-0x800000000000,INT48_MAX:0x7fffffffffff,INT48_UNSIGNED_MAX:0xffffffffffff,INT64_MIN:-9223372036854775808n,INT64_MAX:9223372036854775807n,INT64_UNSIGNED_MAX:18446744073709551615n};function dn(e,t){return t.includes(e.columnType)}function lue(e){return"enumValues"in e&&Array.isArray(e.enumValues)&&e.enumValues.length>0}const cue=TT([et(),Bf(),kT(),nU()]),due=TT([cue,rU(Mg()),ol(Mg())]),uue=ST(e=>e instanceof Buffer);function O5(e,t){const n=(t==null?void 0:t.zodInstance)??Oce,r=(t==null?void 0:t.coerce)??{};let s;return lue(e)&&(s=e.enumValues.length?n.enum(e.enumValues):n.string()),s||(dn(e,["PgGeometry","PgPointTuple"])?s=n.tuple([n.number(),n.number()]):dn(e,["PgGeometryObject","PgPointObject"])?s=n.object({x:n.number(),y:n.number()}):dn(e,["PgHalfVector","PgVector"])?(s=n.array(n.number()),s=e.dimensions?s.length(e.dimensions):s):dn(e,["PgLine"])?s=n.tuple([n.number(),n.number(),n.number()]):dn(e,["PgLineABC"])?s=n.object({a:n.number(),b:n.number(),c:n.number()}):dn(e,["PgArray"])?(s=n.array(O5(e.baseColumn,n)),s=e.size?s.length(e.size):s):e.dataType==="array"?s=n.array(n.any()):e.dataType==="number"?s=hue(e,n,r):e.dataType==="bigint"?s=fue(e,n,r):e.dataType==="boolean"?s=r===!0||r.boolean?n.coerce.boolean():n.boolean():e.dataType==="date"?s=r===!0||r.date?n.coerce.date():n.date():e.dataType==="string"?s=pue(e,n,r):e.dataType==="json"?s=due:e.dataType==="custom"?s=n.any():e.dataType==="buffer"&&(s=uue)),s||(s=n.any()),s}function hue(e,t,n){let r=e.getSQLType().includes("unsigned"),s,i,o=!1;dn(e,["MySqlTinyInt","SingleStoreTinyInt"])?(s=r?0:qt.INT8_MIN,i=r?qt.INT8_UNSIGNED_MAX:qt.INT8_MAX,o=!0):dn(e,["PgSmallInt","PgSmallSerial","MySqlSmallInt","SingleStoreSmallInt"])?(s=r?0:qt.INT16_MIN,i=r?qt.INT16_UNSIGNED_MAX:qt.INT16_MAX,o=!0):dn(e,["PgReal","MySqlFloat","MySqlMediumInt","SingleStoreMediumInt","SingleStoreFloat"])?(s=r?0:qt.INT24_MIN,i=r?qt.INT24_UNSIGNED_MAX:qt.INT24_MAX,o=dn(e,["MySqlMediumInt","SingleStoreMediumInt"])):dn(e,["PgInteger","PgSerial","MySqlInt","SingleStoreInt"])?(s=r?0:qt.INT32_MIN,i=r?qt.INT32_UNSIGNED_MAX:qt.INT32_MAX,o=!0):dn(e,["PgDoublePrecision","MySqlReal","MySqlDouble","SingleStoreReal","SingleStoreDouble","SQLiteReal"])?(s=r?0:qt.INT48_MIN,i=r?qt.INT48_UNSIGNED_MAX:qt.INT48_MAX):dn(e,["PgBigInt53","PgBigSerial53","MySqlBigInt53","MySqlSerial","SingleStoreBigInt53","SingleStoreSerial","SQLiteInteger"])?(r=r||dn(e,["MySqlSerial","SingleStoreSerial"]),s=r?0:Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,o=!0):dn(e,["MySqlYear","SingleStoreYear"])?(s=1901,i=2155,o=!0):(s=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER);let l=n===!0||n!=null&&n.number?t.coerce.number():t.number();return l=l.min(s).max(i),o?l.int():l}function fue(e,t,n){const r=e.getSQLType().includes("unsigned"),s=r?0n:qt.INT64_MIN,i=r?qt.INT64_UNSIGNED_MAX:qt.INT64_MAX;return(n===!0||n!=null&&n.bigint?t.coerce.bigint():t.bigint()).min(s).max(i)}function pue(e,t,n){if(dn(e,["PgUUID"]))return t.string().uuid();let r,s,i=!1;dn(e,["PgVarchar","SQLiteText"])?r=e.length:dn(e,["MySqlVarChar","SingleStoreVarChar"])?r=e.length??qt.INT16_UNSIGNED_MAX:dn(e,["MySqlText","SingleStoreText"])&&(e.textType==="longtext"?r=qt.INT32_UNSIGNED_MAX:e.textType==="mediumtext"?r=qt.INT24_UNSIGNED_MAX:e.textType==="text"?r=qt.INT16_UNSIGNED_MAX:r=qt.INT8_UNSIGNED_MAX),dn(e,["PgChar","MySqlChar","SingleStoreChar"])&&(r=e.length,i=!0),dn(e,["PgBinaryVector"])&&(s=/^[01]+$/,r=e.dimensions);let o=n===!0||n!=null&&n.string?t.coerce.string():t.string();return o=s?o.regex(s):o,r&&i?o.length(r):r?o.max(r):o}function L5(e){return sV(e)?Rde(e):jde(e)}function F5(e,t,n,r){const s={};for(const[i,o]of Object.entries(e)){if(!xn(o,Dd)&&!xn(o,sn)&&!xn(o,sn.Aliased)&&typeof o=="object"){const h=sV(o)||Ade(o)?L5(o):o;s[i]=F5(h,t[i]??{},n,r);continue}const l=t[i];if(l!==void 0&&typeof l!="function"){s[i]=l;continue}const c=xn(o,Dd)?o:void 0,d=c?O5(c,r):Mg(),u=typeof l=="function"?l(d):d;n.never(c)||(s[i]=u,c&&(n.nullable(c)&&(s[i]=s[i].nullable()),n.optional(c)&&(s[i]=s[i].optional())))}return ns(s)}const mue={never:e=>{var t,n;return((t=e==null?void 0:e.generated)==null?void 0:t.type)==="always"||((n=e==null?void 0:e.generatedIdentity)==null?void 0:n.type)==="always"},optional:e=>!e.notNull||e.notNull&&e.hasDefault,nullable:e=>!e.notNull},br=(e,t)=>{const n=L5(e);return F5(n,{},mue)},gue=zf("match_request_status",["waiting","connected","declined"]),vue=zf("match_type",["lfg","lfo"]),yue=zf("duration",["short-term","long-term"]),xue=zf("gender",["male","female","custom","prefer_not_to_say"]);zf("notification_type",["connection_request","connection_accepted","connection_declined","match_application","match_accepted","match_declined","voice_channel_invite","voice_channel_invite_accepted","voice_channel_invite_declined"]);Kn("sessions",{sid:we("sid").primaryKey(),sess:ra("sess").notNull(),expire:jt("expire").notNull()},e=>[mt("IDX_session_expire").on(e.expire)]);const _n=Kn("users",{id:we("id").primaryKey().default(hn`gen_random_uuid()`),googleId:we("google_id").unique(),email:we("email").unique(),phoneNumber:we("phone_number").unique(),phoneVerified:Ni("phone_verified").default(!1),firstName:we("first_name"),lastName:we("last_name"),profileImageUrl:we("profile_image_url"),gamertag:we("gamertag").unique().notNull(),bio:_s("bio"),location:we("location"),latitude:mS("latitude"),longitude:mS("longitude"),age:oy("age"),gender:xue("gender"),language:we("language"),preferredGames:_s("preferred_games").array(),showMutualGames:we("show_mutual_games").default("everyone"),showMutualFriends:we("show_mutual_friends").default("everyone"),showMutualHobbies:we("show_mutual_hobbies").default("everyone"),voiceOverlayEnabled:Ni("voice_overlay_enabled").default(!1),createdAt:jt("created_at").defaultNow(),updatedAt:jt("updated_at").defaultNow()},e=>[mt("idx_users_gender").on(e.gender),mt("idx_users_language").on(e.language),mt("idx_users_created_at").on(e.createdAt),mt("idx_users_phone_number").on(e.phoneNumber)]),ly=Kn("match_requests",{id:we("id").primaryKey().default(hn`gen_random_uuid()`),userId:we("user_id").notNull().references(()=>_n.id),gameName:we("game_name").notNull(),gameMode:we("game_mode").notNull(),matchType:vue("match_type").notNull().default("lfg"),duration:yue("duration").notNull().default("short-term"),tournamentName:we("tournament_name"),description:_s("description").notNull(),status:gue("status").notNull().default("waiting"),region:we("region"),createdAt:jt("created_at").defaultNow(),updatedAt:jt("updated_at").defaultNow()},e=>[mt("idx_match_requests_user_id").on(e.userId),mt("idx_match_requests_status").on(e.status),mt("idx_match_requests_game_name").on(e.gameName),mt("idx_match_requests_created_at").on(e.createdAt)]),bue=Kn("connection_requests",{id:we("id").primaryKey().default(hn`gen_random_uuid()`),senderId:we("sender_id").notNull().references(()=>_n.id),receiverId:we("receiver_id").notNull().references(()=>_n.id),status:we("status").notNull().default("pending"),createdAt:jt("created_at").defaultNow(),updatedAt:jt("updated_at").defaultNow()},e=>[mt("idx_connection_requests_sender").on(e.senderId),mt("idx_connection_requests_receiver").on(e.receiverId),mt("idx_connection_requests_status").on(e.status)]),wue=Kn("match_connections",{id:we("id").primaryKey().default(hn`gen_random_uuid()`),requestId:we("request_id").notNull().references(()=>ly.id,{onDelete:"cascade"}),requesterId:we("requester_id").notNull().references(()=>_n.id),accepterId:we("accepter_id").notNull().references(()=>_n.id),status:we("status").notNull().default("pending"),createdAt:jt("created_at").defaultNow(),updatedAt:jt("updated_at").defaultNow()},e=>[mt("idx_match_connections_requester").on(e.requesterId),mt("idx_match_connections_accepter").on(e.accepterId),mt("idx_match_connections_request").on(e.requestId)]),Sue=Kn("hidden_matches",{id:we("id").primaryKey().default(hn`gen_random_uuid()`),userId:we("user_id").notNull().references(()=>_n.id),matchRequestId:we("match_request_id").notNull().references(()=>ly.id,{onDelete:"cascade"}),createdAt:jt("created_at").defaultNow()},e=>[mt("idx_user_hidden_matches").on(e.userId)]),kue=Kn("chat_messages",{id:we("id").primaryKey().default(hn`gen_random_uuid()`),connectionId:we("connection_id").notNull(),senderId:we("sender_id").notNull().references(()=>_n.id),receiverId:we("receiver_id").notNull().references(()=>_n.id),message:_s("message").notNull(),createdAt:jt("created_at").defaultNow()}),Tue=Kn("notifications",{id:we("id").primaryKey().default(hn`gen_random_uuid()`),userId:we("user_id").notNull().references(()=>_n.id,{onDelete:"cascade"}),type:we("type").notNull(),title:we("title").notNull(),message:_s("message").notNull(),relatedUserId:we("related_user_id").references(()=>_n.id),relatedMatchId:we("related_match_id").references(()=>ly.id),actionUrl:we("action_url"),actionData:ra("action_data"),isRead:Ni("is_read").notNull().default(!1),createdAt:jt("created_at").defaultNow()},e=>[mt("idx_user_notifications").on(e.userId),mt("idx_notifications_is_read").on(e.isRead)]),Cue=Kn("game_profiles",{id:we("id").primaryKey().default(hn`gen_random_uuid()`),userId:we("user_id").notNull().references(()=>_n.id,{onDelete:"cascade"}),gameName:we("game_name").notNull(),highestRank:we("highest_rank"),currentRank:we("current_rank"),hoursPlayed:oy("hours_played"),clipUrls:ra("clip_urls"),achievements:_s("achievements").array(),achievementDetails:ra("achievement_details"),stats:ra("stats"),statsPhotoUrl:we("stats_photo_url"),statsPhotoDate:we("stats_photo_date"),customSections:ra("custom_sections"),createdAt:jt("created_at").defaultNow(),updatedAt:jt("updated_at").defaultNow()},e=>[mt("idx_user_game_profiles").on(e.userId)]),Eue=Kn("hobbies",{id:we("id").primaryKey().default(hn`gen_random_uuid()`),userId:we("user_id").notNull().references(()=>_n.id,{onDelete:"cascade"}),category:we("category").notNull(),title:we("title").notNull(),description:_s("description"),link:we("link"),imageUrl:we("image_url"),metadata:ra("metadata"),createdAt:jt("created_at").defaultNow(),updatedAt:jt("updated_at").defaultNow()},e=>[mt("idx_user_hobbies").on(e.userId),mt("idx_hobbies_category").on(e.category)]),_ue=Kn("portfolio_pages",{id:we("id").primaryKey().default(hn`gen_random_uuid()`),userId:we("user_id").notNull().references(()=>_n.id,{onDelete:"cascade"}),themeName:we("theme_name").notNull(),layout:ra("layout").notNull(),prompt:_s("prompt"),isActive:Ni("is_active").notNull().default(!0),createdAt:jt("created_at").defaultNow(),updatedAt:jt("updated_at").defaultNow()},e=>[mt("idx_user_portfolios").on(e.userId)]),$5=Kn("voice_channels",{id:we("id").primaryKey().default(hn`gen_random_uuid()`),connectionId:we("connection_id").notNull().unique(),hmsRoomId:we("hms_room_id"),createdAt:jt("created_at").defaultNow()},e=>[mt("idx_connection_voice_channels").on(e.connectionId)]),PT=Kn("group_voice_channels",{id:we("id").primaryKey().default(hn`gen_random_uuid()`),name:we("name").notNull(),creatorId:we("creator_id").notNull().references(()=>_n.id),hmsRoomId:we("hms_room_id"),inviteCode:we("invite_code").notNull().unique(),isActive:Ni("is_active").notNull().default(!0),createdAt:jt("created_at").defaultNow()},e=>[mt("idx_group_voice_creator").on(e.creatorId),mt("idx_group_voice_invite").on(e.inviteCode)]),Pue=Kn("group_voice_members",{id:we("id").primaryKey().default(hn`gen_random_uuid()`),channelId:we("channel_id").notNull().references(()=>PT.id,{onDelete:"cascade"}),userId:we("user_id").notNull().references(()=>_n.id,{onDelete:"cascade"}),isActive:Ni("is_active").notNull().default(!1),isMuted:Ni("is_muted").notNull().default(!1),joinedAt:jt("joined_at").defaultNow()},e=>[mt("idx_group_voice_channel_members").on(e.channelId),mt("idx_group_voice_user_members").on(e.userId)]),Nue=Kn("group_voice_invites",{id:we("id").primaryKey().default(hn`gen_random_uuid()`),channelId:we("channel_id").notNull().references(()=>PT.id,{onDelete:"cascade"}),inviterId:we("inviter_id").notNull().references(()=>_n.id,{onDelete:"cascade"}),inviteeId:we("invitee_id").notNull().references(()=>_n.id,{onDelete:"cascade"}),status:we("status").notNull().default("pending"),createdAt:jt("created_at").defaultNow(),respondedAt:jt("responded_at")},e=>[mt("idx_group_voice_invites_channel").on(e.channelId),mt("idx_group_voice_invites_invitee").on(e.inviteeId),mt("idx_group_voice_invites_status").on(e.status)]),Iue=Kn("voice_participants",{id:we("id").primaryKey().default(hn`gen_random_uuid()`),voiceChannelId:we("voice_channel_id").notNull().references(()=>$5.id,{onDelete:"cascade"}),userId:we("user_id").notNull().references(()=>_n.id,{onDelete:"cascade"}),isMuted:Ni("is_muted").notNull().default(!1),joinedAt:jt("joined_at").defaultNow()},e=>[mt("idx_voice_channel_participants").on(e.voiceChannelId),mt("idx_user_voice_participants").on(e.userId),Tde("unique_voice_participant").on(e.voiceChannelId,e.userId)]),Aue=Kn("push_subscriptions",{id:we("id").primaryKey().default(hn`gen_random_uuid()`),userId:we("user_id").notNull().references(()=>_n.id,{onDelete:"cascade"}),endpoint:_s("endpoint").notNull().unique(),p256dh:_s("p256dh").notNull(),auth:_s("auth").notNull(),createdAt:jt("created_at").defaultNow()},e=>[mt("idx_user_push_subscriptions").on(e.userId)]);Kn("phone_verification_codes",{id:we("id").primaryKey().default(hn`gen_random_uuid()`),phoneNumber:we("phone_number").notNull(),code:we("code").notNull(),expiresAt:jt("expires_at").notNull(),verified:Ni("verified").notNull().default(!1),attempts:oy("attempts").notNull().default(0),createdAt:jt("created_at").defaultNow()},e=>[mt("idx_phone_verification_phone").on(e.phoneNumber),mt("idx_phone_verification_expires").on(e.expiresAt)]);br(_n);const Rue=ns({gamertag:et().min(3,"Gamertag must be at least 3 characters").max(20,"Gamertag must be at most 20 characters"),firstName:et().optional(),lastName:et().optional(),email:et().email().optional(),phoneNumber:et().optional(),age:Bf().min(13,"You must be at least 13 years old").max(120).optional(),gender:Md(["male","female","custom","prefer_not_to_say"]).optional(),bio:et().max(500).optional(),location:et().optional(),preferredGames:ol(et()).optional()});ns({phoneNumber:et().min(10,"Phone number must be at least 10 digits").max(15,"Phone number must be at most 15 digits")});ns({phoneNumber:et().min(10).max(15),code:et().length(6,"Verification code must be 6 digits")});Rue.extend({phoneNumber:et().min(10).max(15),verificationCode:et().length(6)});br(ly).omit({id:!0,userId:!0,createdAt:!0,updatedAt:!0}).required({matchType:!0,duration:!0});br(bue).omit({id:!0,createdAt:!0,updatedAt:!0});br(wue).omit({id:!0,createdAt:!0,updatedAt:!0});br(Sue).omit({id:!0,createdAt:!0});br(kue).omit({id:!0,createdAt:!0});br(Tue).omit({id:!0,createdAt:!0});br(Cue).omit({id:!0,userId:!0,createdAt:!0,updatedAt:!0});const jue=br(Eue).omit({id:!0,userId:!0,createdAt:!0,updatedAt:!0});br(_ue).omit({id:!0,userId:!0,createdAt:!0,updatedAt:!0});br($5).omit({id:!0,createdAt:!0});br(PT).omit({id:!0,createdAt:!0});br(Pue).omit({id:!0,joinedAt:!0});br(Nue).omit({id:!0,createdAt:!0,respondedAt:!0});br(Iue).omit({id:!0,joinedAt:!0});br(Aue).omit({id:!0,createdAt:!0});const Bx=Md(["everyone","connections","nobody"]);ns({showMutualGames:Bx.optional(),showMutualFriends:Bx.optional(),showMutualHobbies:Bx.optional()});const lN=[{value:"anime",label:"Anime & Manga",icon:Th},{value:"books",label:"Books & Reading",icon:E8},{value:"music",label:"Music",icon:PE},{value:"art",label:"Art & Design",icon:P0},{value:"movies",label:"Movies & TV",icon:D8},{value:"dance",label:"Dance",icon:PE},{value:"writing",label:"Writing",icon:$8},{value:"cooking",label:"Cooking & Food",icon:I8},{value:"travel",label:"Travel",icon:U8},{value:"other",label:"Other",icon:$D}],Mue=jue.extend({title:et().optional(),category:et().min(1,"Category is required")});function Due({userId:e,isOwn:t=!1}){const[n,r]=p.useState(!1),[s,i]=p.useState(!1),[o,l]=p.useState(null),[c,d]=p.useState([{id:"1",title:"",description:"",link:""}]),{data:u=[],isLoading:h}=Pt({queryKey:["/api/users",e,"hobbies"],enabled:n&&!!e}),f=Zv({resolver:ey(Mue),defaultValues:{title:"",category:"",description:""}}),m=Nt({mutationFn:async N=>await kt("POST","/api/hobbies",N),onSuccess:()=>{ze.invalidateQueries({queryKey:["/api/users",e,"hobbies"]}),f.reset(),i(!1)}}),g=Nt({mutationFn:async({id:N,data:O})=>await kt("PATCH",`/api/hobbies/${N}`,O),onSuccess:()=>{ze.invalidateQueries({queryKey:["/api/users",e,"hobbies"]}),f.reset(),l(null),i(!1)}}),v=Nt({mutationFn:async N=>await kt("DELETE",`/api/hobbies/${N}`),onSuccess:()=>{ze.invalidateQueries({queryKey:["/api/users",e,"hobbies"]})}}),x=async N=>{if(o){if(!N.title||!N.title.trim()){f.setError("title",{message:"Title is required"});return}g.mutate({id:o.id,data:N})}else{const O=c.filter(G=>G.title.trim());if(O.length===0)return;try{for(const G of O)await m.mutateAsync({category:N.category,title:G.title.trim(),description:G.description.trim()||void 0,link:G.link.trim()||void 0});ze.invalidateQueries({queryKey:["/api/users",e,"hobbies"]}),f.reset(),d([{id:"1",title:"",description:"",link:""}]),i(!1)}catch(G){console.error("Error creating hobbies:",G)}}},S=()=>{d([...c,{id:Date.now().toString(),title:"",description:"",link:""}])},y=N=>{c.length>1&&d(c.filter(O=>O.id!==N))},b=(N,O,G)=>{d(c.map(H=>H.id===N?{...H,[O]:G}:H))},w=N=>{l(N),f.reset({title:N.title,category:N.category,description:N.description||""}),i(!0)},C=N=>{confirm("Are you sure you want to delete this item?")&&v.mutate(N)},I=()=>{f.reset(),l(null),i(!1),d([{id:"1",title:"",description:"",link:""}])},R=N=>{l(null),f.reset({title:"",category:N,description:""}),i(!0)},L=u.reduce((N,O)=>(N[O.category]||(N[O.category]=[]),N[O.category].push(O),N),{});return a.jsxs(gr,{open:n,onOpenChange:r,children:[a.jsx(Vl,{asChild:!0,children:a.jsxs(ee,{variant:"outline",className:"gap-2","data-testid":"button-view-custom-portfolio",children:[a.jsx(Th,{className:"h-4 w-4"}),t?"Edit Custom Portfolio":"View Custom Portfolio"]})}),a.jsxs(nr,{className:"max-w-full sm:max-w-3xl lg:max-w-5xl h-[90vh]",children:[a.jsx(rr,{children:a.jsxs(sr,{className:"flex items-center gap-2",children:[a.jsx(Th,{className:"h-5 w-5"}),"Custom Portfolio & Interests"]})}),a.jsx(Hv,{className:"flex-1 pr-4",children:a.jsxs("div",{className:"space-y-6",children:[t&&a.jsx("div",{className:"flex justify-end",children:a.jsx(ee,{onClick:()=>i(!s),variant:s?"outline":"default",className:"gap-2","data-testid":"button-add-interest",children:s?a.jsx(a.Fragment,{children:"Cancel"}):a.jsxs(a.Fragment,{children:[a.jsx(Nr,{className:"h-4 w-4"}),"Add Interest"]})})}),s&&t&&a.jsxs(Ne,{children:[a.jsx(an,{children:a.jsx(mr,{className:"text-lg",children:o?"Edit Interest":"Add New Interest"})}),a.jsx(Fe,{children:a.jsx(Zh,{...f,children:a.jsxs("form",{onSubmit:f.handleSubmit(x),className:"space-y-4",children:[a.jsx(Tt,{control:f.control,name:"category",render:({field:N})=>a.jsxs(vt,{children:[a.jsx(dt,{children:"Category"}),a.jsxs(In,{onValueChange:N.onChange,value:N.value,children:[a.jsx(yt,{children:a.jsx(wn,{"data-testid":"select-category",children:a.jsx(An,{placeholder:"Select a category"})})}),a.jsx(Sn,{children:lN.map(O=>a.jsx(at,{value:O.value,children:O.label},O.value))})]}),a.jsx(xt,{})]})}),o?a.jsxs(a.Fragment,{children:[a.jsx(Tt,{control:f.control,name:"title",render:({field:N})=>a.jsxs(vt,{children:[a.jsx(dt,{children:"Title"}),a.jsx(yt,{children:a.jsx(tt,{placeholder:"e.g., One Piece, Harry Potter, Swing Dancing",...N,"data-testid":"input-title"})}),a.jsx(xt,{})]})}),a.jsx(Tt,{control:f.control,name:"description",render:({field:N})=>a.jsxs(vt,{children:[a.jsx(dt,{children:"Description (Optional)"}),a.jsx(yt,{children:a.jsx(ef,{placeholder:"Share more about this interest...",...N,value:N.value||"","data-testid":"input-description"})}),a.jsx(xt,{})]})})]}):a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(dt,{children:"Titles"}),a.jsxs(ee,{type:"button",variant:"outline",size:"sm",onClick:S,className:"gap-1","data-testid":"button-add-title",children:[a.jsx(Nr,{className:"h-4 w-4"}),"Add Title"]})]}),c.map((N,O)=>a.jsx(Ne,{className:"p-4",children:a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs(dt,{children:["Title ",O+1]}),a.jsx(tt,{placeholder:"e.g., One Piece, Harry Potter, Swing Dancing",value:N.title,onChange:G=>b(N.id,"title",G.target.value),"data-testid":`input-title-${O}`,className:"mt-2"})]}),c.length>1&&a.jsx(ee,{type:"button",variant:"ghost",size:"icon",onClick:()=>y(N.id),"data-testid":`button-remove-title-${O}`,className:"mt-6",children:a.jsx(Ot,{className:"h-4 w-4"})})]}),a.jsxs("div",{children:[a.jsx(dt,{children:"Description (Optional)"}),a.jsx(ef,{placeholder:"Share more about this interest...",value:N.description,onChange:G=>b(N.id,"description",G.target.value),"data-testid":`input-description-${O}`,className:"mt-2"})]}),a.jsxs("div",{children:[a.jsx(dt,{children:"Link (Optional)"}),a.jsx(tt,{type:"url",placeholder:"https://example.com/your-content",value:N.link,onChange:G=>b(N.id,"link",G.target.value),"data-testid":`input-link-${O}`,className:"mt-2"})]})]})},N.id))]}),o&&a.jsx(Tt,{control:f.control,name:"link",render:({field:N})=>a.jsxs(vt,{children:[a.jsx(dt,{children:"Link (Optional)"}),a.jsx(yt,{children:a.jsx(tt,{type:"url",placeholder:"https://example.com/your-content",...N,value:N.value||"","data-testid":"input-link"})}),a.jsx(xt,{})]})}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(ee,{type:"submit",disabled:m.isPending||g.isPending,"data-testid":"button-save-interest",children:[o?"Update":"Add"," Interest"]}),a.jsx(ee,{type:"button",variant:"outline",onClick:I,"data-testid":"button-cancel-interest",children:"Cancel"})]})]})})})]}),h?a.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading interests..."}):u.length===0?a.jsx("div",{className:"text-center py-8 text-muted-foreground",children:t?"No interests added yet. Add your first interest to get started!":"This user hasn't added any interests yet."}):a.jsx("div",{className:"space-y-6",children:lN.map(N=>{const O=L[N.value];if(!O||O.length===0)return null;const G=N.icon;return a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx(G,{className:"h-5 w-5 text-primary"}),a.jsx("h3",{className:"text-lg font-semibold",children:N.label}),a.jsx($e,{variant:"secondary",children:O.length}),t&&a.jsx(ee,{variant:"ghost",size:"icon",className:"h-7 w-7 ml-auto",onClick:()=>R(N.value),"data-testid":`button-add-to-${N.value}`,children:a.jsx(Nr,{className:"h-4 w-4"})})]}),a.jsx(aa,{className:"mb-3"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:O.map(H=>a.jsx(Ne,{"data-testid":`card-hobby-${H.id}`,children:a.jsx(Fe,{className:"pt-6",children:a.jsxs("div",{className:"flex justify-between items-start gap-2",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-semibold mb-1","data-testid":`text-hobby-title-${H.id}`,children:H.title}),H.description&&a.jsx("p",{className:"text-sm text-muted-foreground mb-2","data-testid":`text-hobby-description-${H.id}`,children:H.description}),H.link&&a.jsx("a",{href:H.link,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-primary hover:underline inline-flex items-center gap-1","data-testid":`link-hobby-${H.id}`,children:"View Link "})]}),t&&a.jsxs("div",{className:"flex gap-1",children:[a.jsx(ee,{variant:"ghost",size:"icon",onClick:()=>w(H),"data-testid":`button-edit-hobby-${H.id}`,children:a.jsx(iw,{className:"h-4 w-4"})}),a.jsx(ee,{variant:"ghost",size:"icon",onClick:()=>C(H.id),"data-testid":`button-delete-hobby-${H.id}`,children:a.jsx(So,{className:"h-4 w-4"})})]})]})})},H.id))})]},N.value)})})]})})]})]})}function Oue({userId:e,isOwn:t=!1}){const{data:n,isLoading:r}=Pt({queryKey:["/api/mutuals",e],enabled:!t&&!!e});if(t||!e)return null;if(r)return a.jsx(Ne,{children:a.jsx(Fe,{className:"p-6",children:a.jsx("p",{className:"text-center text-muted-foreground",children:"Loading mutual connections..."})})});if(!n)return null;const s=n.mutualGames&&n.mutualGames.length>0,i=n.mutualFriends&&n.mutualFriends.length>0,o=n.mutualHobbies&&n.mutualHobbies.length>0;return!s&&!i&&!o?null:a.jsxs(Ne,{"data-testid":"card-mutuals",children:[a.jsx(an,{children:a.jsxs(mr,{className:"text-lg flex items-center gap-2",children:[a.jsx(Jt,{className:"h-5 w-5"}),"Things in Common"]})}),a.jsxs(Fe,{className:"space-y-6",children:[s&&a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx(ia,{className:"h-4 w-4 text-primary"}),a.jsx("h3",{className:"font-semibold",children:"Mutual Games"}),a.jsx($e,{variant:"secondary",children:n.mutualGames.length})]}),a.jsx(aa,{className:"mb-3"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:n.mutualGames.map(l=>a.jsx($e,{variant:"outline","data-testid":`badge-mutual-game-${l}`,children:l},l))})]}),!s&&n.mutualGames===void 0&&a.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[a.jsx(Yy,{className:"h-4 w-4"}),a.jsx("span",{children:"Mutual games are private"})]}),i&&a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx(Jt,{className:"h-4 w-4 text-primary"}),a.jsx("h3",{className:"font-semibold",children:"Mutual Friends"}),a.jsx($e,{variant:"secondary",children:n.mutualFriends.length})]}),a.jsx(aa,{className:"mb-3"}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:n.mutualFriends.slice(0,6).map(l=>a.jsxs("div",{className:"flex items-center gap-2","data-testid":`mutual-friend-${l.id}`,children:[a.jsxs(Tn,{className:"h-8 w-8",children:[a.jsx(tr,{src:l.profileImageUrl||void 0,alt:l.gamertag}),a.jsx(Cn,{className:"text-xs",children:l.gamertag.slice(0,2).toUpperCase()})]}),a.jsx("span",{className:"text-sm",children:l.gamertag})]},l.id))}),n.mutualFriends.length>6&&a.jsxs("p",{className:"text-xs text-muted-foreground mt-3",children:["+",n.mutualFriends.length-6," more mutual friends"]})]}),!i&&n.mutualFriends===void 0&&a.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[a.jsx(Yy,{className:"h-4 w-4"}),a.jsx("span",{children:"Mutual friends are private"})]}),o&&a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx($D,{className:"h-4 w-4 text-primary"}),a.jsx("h3",{className:"font-semibold",children:"Mutual Interests"}),a.jsx($e,{variant:"secondary",children:n.mutualHobbies.length})]}),a.jsx(aa,{className:"mb-3"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:n.mutualHobbies.map(l=>a.jsxs($e,{variant:"outline","data-testid":`badge-mutual-hobby-${l.category}`,children:[l.category.charAt(0).toUpperCase()+l.category.slice(1)," (",l.count,")"]},l.category))})]}),!o&&n.mutualHobbies===void 0&&a.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[a.jsx(Yy,{className:"h-4 w-4"}),a.jsx("span",{children:"Mutual interests are private"})]})]})]})}function NT({id:e,gamertag:t,firstName:n,lastName:r,profileImageUrl:s,bio:i,location:o,latitude:l,longitude:c,age:d,preferredGames:u=[],isOwn:h=!1,currentUserId:f,onEdit:m,onMessage:g,onAddGame:v}){const x=n&&r?`${n} ${r}`:t,S=n&&r?`${n[0]}${r[0]}`.toUpperCase():t.slice(0,2).toUpperCase(),[y,b]=p.useState(null),[w,C]=p.useState(!1),[I,R]=p.useState(void 0),[L,N]=p.useState({}),O=p.useRef(null),{toast:G}=Wn(),{getContainerClass:H}=Ri(),[,re]=Jl(),{data:X=[]}=Pt({queryKey:["/api/connection-requests"],enabled:!h&&!!f,retry:!1}),Q=!h&&X.some(P=>P.status==="accepted"&&(P.senderId===f&&P.receiverId===e||P.receiverId===f&&P.senderId===e)),{data:V=[],isLoading:te,refetch:k}=Pt({queryKey:["/api/users",e,"game-profiles"],enabled:!!e}),E=Nt({mutationFn:async P=>{const j=new FormData;j.append("file",P);const $=await fetch(lt("/api/upload-photo"),{method:"POST",credentials:"include",body:j});if(!$.ok)throw new Error("Failed to upload photo");return $.json()},onSuccess:async P=>{await kt("PATCH","/api/user/profile",{profileImageUrl:P.url}),ze.invalidateQueries({queryKey:["/api/user"]}),ze.invalidateQueries({queryKey:["/api/users",e]}),G({title:"Success",description:"Profile photo updated successfully"})},onError:P=>{G({title:"Error",description:P.message||"Failed to upload photo",variant:"destructive"})}}),M=P=>{var $;const j=($=P.target.files)==null?void 0:$[0];if(j){if(j.size>5*1024*1024){G({title:"Error",description:"File size must be less than 5MB",variant:"destructive"});return}if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(j.type)){G({title:"Error",description:"Only image files (JPEG, PNG, GIF, WebP) are allowed",variant:"destructive"});return}E.mutate(j)}},A=()=>{R(void 0),C(!0)},F=P=>{R(P),C(!0)},q=()=>{g?g():re("/messages")};return a.jsxs("div",{className:`w-full ${H()} mx-auto space-y-6`,children:[a.jsx(Ne,{children:a.jsx(an,{className:"pb-4",children:a.jsxs("div",{className:"flex flex-col md:flex-row items-center md:items-start gap-6",children:[a.jsxs("div",{className:"relative",children:[a.jsxs(Tn,{className:"h-24 w-24 border-4 border-primary/20",children:[a.jsx(tr,{src:s,alt:t}),a.jsx(Cn,{className:"bg-primary text-primary-foreground text-2xl font-bold",children:S})]}),h&&a.jsxs(a.Fragment,{children:[a.jsx(ee,{size:"icon",variant:"secondary",className:"absolute bottom-0 right-0 h-8 w-8 rounded-full shadow-lg",onClick:()=>{var P;return(P=O.current)==null?void 0:P.click()},disabled:E.isPending,"data-testid":"button-upload-photo",children:E.isPending?a.jsx(Rl,{className:"h-4 w-4 animate-spin"}):a.jsx(_8,{className:"h-4 w-4"})}),a.jsx("input",{ref:O,type:"file",accept:"image/*",onChange:M,className:"hidden","data-testid":"input-photo-file"})]})]}),a.jsxs("div",{className:"flex-1 text-center md:text-left space-y-3",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-foreground","data-testid":`text-display-name-${e}`,children:x}),n&&r&&a.jsxs("p",{className:"text-lg text-muted-foreground","data-testid":`text-gamertag-${e}`,children:["@",t]})]}),i&&a.jsx("p",{className:"text-sm text-muted-foreground max-w-2xl","data-testid":`text-bio-${e}`,children:i}),a.jsxs("div",{className:"flex flex-wrap gap-3 items-center justify-center md:justify-start text-sm text-muted-foreground",children:[o&&a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(lv,{className:"h-4 w-4"}),a.jsx("span",{"data-testid":`text-location-${e}`,children:o})]}),d&&a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(LD,{className:"h-4 w-4"}),a.jsxs("span",{"data-testid":`text-age-${e}`,children:[d," years old"]})]})]})]}),a.jsxs("div",{className:"flex flex-col gap-2",children:[a.jsx("div",{className:"flex gap-2",children:h?a.jsxs(a.Fragment,{children:[a.jsxs(ee,{size:"sm",variant:"outline",onClick:m,"data-testid":"button-edit-profile",children:[a.jsx(iw,{className:"h-4 w-4 mr-2"}),"Edit Profile"]}),a.jsxs(ee,{size:"sm",onClick:A,"data-testid":"button-add-game-profile",children:[a.jsx(Nr,{className:"h-4 w-4 mr-2"}),"Add Game"]})]}):Q?a.jsxs(ee,{size:"sm",onClick:q,"data-testid":"button-message-user",children:[a.jsx(gi,{className:"h-4 w-4 mr-2"}),"Message"]}):null}),a.jsx(Due,{userId:e,isOwn:h})]})]})})}),a.jsx(Oue,{userId:e,isOwn:h}),te?a.jsx(Ne,{children:a.jsx(Fe,{className:"p-12 text-center",children:a.jsx("p",{className:"text-muted-foreground",children:"Loading game profiles..."})})}):V.length===0?a.jsx(Ne,{children:a.jsxs(Fe,{className:"p-12 text-center space-y-4",children:[a.jsx(ia,{className:"h-16 w-16 text-muted-foreground/50 mx-auto"}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No game profiles yet"}),a.jsx("p",{className:"text-muted-foreground max-w-md mx-auto",children:h?"Start building your gaming portfolio by adding your first game profile!":`${x} hasn't added any game profiles yet.`})]}),h&&a.jsxs(ee,{onClick:A,"data-testid":"button-add-first-game",children:[a.jsx(Nr,{className:"h-4 w-4 mr-2"}),"Add Your First Game"]})]})}):a.jsxs(Ne,{children:[a.jsx(an,{children:a.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2",children:[a.jsx(ia,{className:"h-5 w-5 text-primary"}),"Gaming Profiles (",V.length,")"]})}),a.jsx(Fe,{children:a.jsx(L3,{type:"single",collapsible:!0,className:"w-full",children:V.map(P=>a.jsxs(Ec,{value:P.id,children:[a.jsxs("div",{className:"flex items-center justify-between gap-4 px-1",children:[a.jsx(_c,{className:"hover:no-underline flex-1",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(ia,{className:"h-5 w-5 text-primary"}),a.jsx("span",{className:"text-lg font-semibold",children:P.gameName}),P.currentRank&&a.jsx($e,{variant:"outline",className:"ml-2",children:P.currentRank})]})}),h&&a.jsxs(ee,{size:"sm",variant:"outline",onClick:()=>F(P),className:"flex-shrink-0","data-testid":`button-edit-game-${P.gameName.toLowerCase().replace(/\s+/g,"-")}`,children:[a.jsx(iw,{className:"h-4 w-4 mr-2"}),"Edit ",P.gameName," Profile"]})]}),a.jsxs(Pc,{className:"space-y-6 pt-6",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[P.currentRank&&a.jsx(Ne,{className:"bg-gradient-to-br from-primary/5 to-primary/10 border-primary/20",children:a.jsxs(Fe,{className:"p-4 space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2 text-primary",children:[a.jsx(Qp,{className:"h-5 w-5"}),a.jsx("span",{className:"text-sm font-semibold",children:"Current Rank"})]}),a.jsx("p",{className:"text-2xl font-bold","data-testid":`text-current-rank-${P.id}`,children:P.currentRank})]})}),P.highestRank&&a.jsx(Ne,{className:"bg-gradient-to-br from-yellow-500/5 to-yellow-500/10 border-yellow-500/20",children:a.jsxs(Fe,{className:"p-4 space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2 text-yellow-600 dark:text-yellow-400",children:[a.jsx(il,{className:"h-5 w-5"}),a.jsx("span",{className:"text-sm font-semibold",children:"Highest Rank"})]}),a.jsx("p",{className:"text-2xl font-bold","data-testid":`text-highest-rank-${P.id}`,children:P.highestRank})]})}),P.hoursPlayed!==null&&P.hoursPlayed!==void 0&&a.jsx(Ne,{className:"bg-gradient-to-br from-blue-500/5 to-blue-500/10 border-blue-500/20",children:a.jsxs(Fe,{className:"p-4 space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2 text-blue-600 dark:text-blue-400",children:[a.jsx(ov,{className:"h-5 w-5"}),a.jsx("span",{className:"text-sm font-semibold",children:"Hours Played"})]}),a.jsx("p",{className:"text-2xl font-bold","data-testid":`text-hours-played-${P.id}`,children:P.hoursPlayed.toLocaleString()})]})})]}),(()=>{const j=Array.isArray(P.achievementDetails)?P.achievementDetails:[];return j.length>0&&a.jsxs("div",{className:"space-y-3",children:[a.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[a.jsx(OD,{className:"h-5 w-5 text-purple-600 dark:text-purple-400"}),"Esport Achievements"]}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:j.map(($,W)=>a.jsxs(Ne,{className:"bg-purple-500/5 border-purple-500/20 overflow-hidden",children:[$.photoUrl&&a.jsx("div",{className:"aspect-video bg-muted relative",children:a.jsx("img",{src:$.photoUrl,alt:$.title,className:"w-full h-full object-cover"})}),a.jsxs(Fe,{className:"p-4 space-y-2",children:[a.jsx("p",{className:"font-semibold","data-testid":`text-achievement-title-${P.id}-${W}`,children:$.title}),$.link&&a.jsx("a",{href:$.link,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-primary hover:underline inline-flex items-center gap-1",children:"View Details "})]})]},W))})]})})(),(()=>{const j=Array.isArray(P.clipUrls)?P.clipUrls:[];return j.length>0&&a.jsxs("div",{className:"space-y-3",children:[a.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[a.jsx(sw,{className:"h-5 w-5 text-red-600 dark:text-red-400"}),"Best Clips & Highlights"]}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:j.map(($,W)=>a.jsxs(gr,{children:[a.jsx(Vl,{asChild:!0,children:a.jsx(Ne,{className:"cursor-pointer hover:bg-accent/50 transition-colors bg-gradient-to-br from-red-500/5 to-red-500/10 border-red-500/20","data-testid":`card-clip-${P.id}-${W}`,children:a.jsxs(Fe,{className:"p-4 flex items-center gap-3",children:[a.jsx(sw,{className:"h-8 w-8 text-red-600 dark:text-red-400 flex-shrink-0"}),a.jsxs("div",{className:"text-left flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm font-semibold truncate",children:$.title}),a.jsx("p",{className:"text-xs text-muted-foreground truncate",children:$.link})]})]})})}),a.jsxs(nr,{className:"max-w-4xl",children:[a.jsx(rr,{children:a.jsx(sr,{children:$.title})}),a.jsx("div",{className:"aspect-video w-full bg-black rounded-lg overflow-hidden",children:$.link.includes("youtube.com")||$.link.includes("youtu.be")?a.jsx("iframe",{src:$.link.replace("watch?v=","embed/").replace("youtu.be/","youtube.com/embed/"),className:"w-full h-full",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}):$.link.includes("twitch.tv")?a.jsx("iframe",{src:$.link.replace("twitch.tv/","player.twitch.tv/?video=").replace("clips/","player.twitch.tv/?clip="),className:"w-full h-full",allowFullScreen:!0}):a.jsx("div",{className:"flex items-center justify-center h-full",children:a.jsx("a",{href:$.link,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"Open Clip in New Tab"})})})]})]},W))})]})})(),P.statsPhotoUrl&&a.jsxs("div",{className:"space-y-3",children:[a.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[a.jsx(Qp,{className:"h-5 w-5 text-primary"}),"Stats Screenshot",P.statsPhotoDate&&a.jsxs("span",{className:"text-sm font-normal text-muted-foreground ml-2",children:["(",P.statsPhotoDate,")"]})]}),a.jsx(Ne,{className:"overflow-hidden",children:a.jsx("img",{src:P.statsPhotoUrl,alt:"Stats screenshot",className:"w-full h-auto"})})]}),(()=>{const j=Array.isArray(P.customSections)?P.customSections:[];return j.length===0?null:a.jsx("div",{className:"space-y-3",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[a.jsx(Qp,{className:"h-5 w-5 text-primary"}),"Custom Additions"]}),a.jsxs(gr,{children:[a.jsx(Vl,{asChild:!0,children:a.jsx(ee,{variant:"outline",size:"sm","data-testid":`button-toggle-custom-${P.id}`,children:"Check Out More"})}),a.jsxs(nr,{className:"max-w-3xl max-h-[80vh] overflow-y-auto",children:[a.jsx(rr,{children:a.jsxs(sr,{children:["Custom Additions - ",P.gameName]})}),a.jsx("div",{className:"space-y-4 mt-4",children:j.map(($,W)=>a.jsxs("div",{className:"space-y-3",children:[a.jsx("h4",{className:"text-base font-semibold text-primary",children:$.heading}),a.jsx(Ne,{className:"bg-muted/30",children:a.jsx(Fe,{className:"p-4",children:a.jsx("dl",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:$.fields.map((ie,Z)=>a.jsxs("div",{className:"space-y-1",children:[a.jsx("dt",{className:"text-sm text-muted-foreground",children:ie.label}),a.jsx("dd",{className:"text-sm font-semibold","data-testid":`text-custom-${P.id}-${W}-${Z}`,children:ie.value})]},Z))})})})]},W))})]})]})]})})})()]})]},P.id))})})]}),a.jsx(wde,{open:w,onOpenChange:C,userId:e,profile:I,onSuccess:()=>{C(!1),R(void 0)}})]})}function xi({userId:e,gamertag:t,profileImageUrl:n,children:r,trigger:s,connectionId:i,currentUserId:o}){const[l,c]=p.useState(!1),{toast:d}=Wn(),{data:u,isLoading:h}=Pt({queryKey:["/api/users",e],queryFn:async()=>{const C=await fetch(lt(`/api/users/${e}`),{credentials:"include"});if(!C.ok)throw new Error("Failed to fetch user profile");return C.json()},enabled:l,retry:!1}),{data:f=[]}=Pt({queryKey:["/api/connection-requests"],queryFn:async()=>{const C=await fetch(lt("/api/connection-requests"),{credentials:"include"});if(!C.ok)throw new Error("Failed to fetch connection requests");return C.json()},enabled:l&&!!o,retry:!1}),m=Nt({mutationFn:async()=>{if(!i)throw new Error("No connection ID");return await kt("DELETE",`/api/connection-requests/${i}`)},onSuccess:()=>{ze.invalidateQueries({queryKey:["/api/connection-requests"]}),ze.invalidateQueries({queryKey:["/api/user/connections"]}),c(!1),d({title:"Connection Removed",description:`You have disconnected from ${t||"this user"}`})},onError:()=>{d({title:"Error",description:"Failed to remove connection",variant:"destructive"})}}),g=Nt({mutationFn:async C=>await kt("POST","/api/connection-requests",{receiverId:C}),onSuccess:()=>{ze.invalidateQueries({queryKey:["/api/connection-requests"]}),d({title:"Connection Request Sent",description:"Your connection request has been sent successfully."})},onError:C=>{d({title:"Unable to Connect",description:C.message||"Failed to send connection request",variant:"destructive"})}}),v=f.find(C=>(C.status==="pending"||C.status==="accepted")&&(C.senderId===o&&C.receiverId===e||C.receiverId===o&&C.senderId===e)),x=f.find(C=>C.status==="pending"&&C.senderId===o&&C.receiverId===e),S=(v==null?void 0:v.status)==="accepted",y=o&&o!==e&&!i&&!S,b=()=>{if(v){v.status==="accepted"?d({title:"Already Connected",description:"You already have a friend connection with this user."}):d({title:"Request Already Sent",description:"You already have a pending connection request with this user."});return}g.mutate(e)},w=a.jsxs("button",{className:"flex items-center gap-3 hover:opacity-80 transition-opacity","data-testid":`button-view-profile-${e}`,children:[a.jsxs(Tn,{className:"h-10 w-10",children:[a.jsx(tr,{src:n,alt:t||"User"}),a.jsx(Cn,{className:"bg-primary text-primary-foreground font-semibold",children:(t||"U").slice(0,2).toUpperCase()})]}),r]});return a.jsxs(gr,{open:l,onOpenChange:c,children:[a.jsx(Vl,{asChild:!0,children:s||w}),a.jsxs(nr,{className:"max-w-full sm:max-w-3xl lg:max-w-5xl max-h-[90vh] overflow-y-auto",children:[a.jsx(rr,{children:a.jsx(sr,{children:"Player Profile"})}),a.jsx("div",{className:"overflow-y-auto max-h-[calc(90vh-8rem)]",children:h?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx(Rl,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):u?a.jsx(NT,{id:u.id,gamertag:u.gamertag||"Unknown",firstName:u.firstName??void 0,lastName:u.lastName??void 0,profileImageUrl:u.profileImageUrl??void 0,bio:u.bio??void 0,location:u.location??void 0,latitude:u.latitude??void 0,longitude:u.longitude??void 0,age:u.age??void 0,preferredGames:u.preferredGames??void 0,isOwn:!1}):a.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Profile not found"})}),i&&a.jsx("div",{className:"pt-4 border-t mt-4",children:a.jsxs(v3,{children:[a.jsx(y3,{asChild:!0,children:a.jsxs(ee,{variant:"outline",size:"sm",className:"w-full gap-2 text-destructive hover:text-destructive hover:bg-destructive/10 border-destructive/30","data-testid":"button-disconnect-profile",children:[a.jsx(HD,{className:"h-4 w-4"}),"Remove Connection"]})}),a.jsxs(tT,{children:[a.jsxs(nT,{children:[a.jsxs(sT,{children:["Disconnect from ",t||"this user","?"]}),a.jsxs(iT,{children:["This will remove your connection with ",t||"this user",". Your chat history will be lost, and you'll need to send a new connection request to reconnect."]})]}),a.jsxs(rT,{children:[a.jsx(oT,{"data-testid":"button-cancel-disconnect-profile",children:"Cancel"}),a.jsx(aT,{onClick:()=>m.mutate(),disabled:m.isPending,className:"bg-destructive hover:bg-destructive/90","data-testid":"button-confirm-disconnect-profile",children:m.isPending?"Disconnecting...":"Disconnect"})]})]})]})}),y&&a.jsx("div",{className:"pt-4 border-t mt-4",children:x?a.jsxs(ee,{variant:"secondary",size:"sm",className:"w-full gap-2",disabled:!0,"data-testid":"button-request-sent-profile",children:[a.jsx(Km,{className:"h-4 w-4"}),"Sent"]}):a.jsxs(ee,{variant:"default",size:"sm",className:"w-full gap-2",onClick:b,disabled:g.isPending,"data-testid":"button-connect-profile",children:[a.jsx(Km,{className:"h-4 w-4"}),g.isPending?"Sending Request...":"Connect"]})})]})]})}function Rp({id:e,userId:t,gamertag:n,profileImageUrl:r,gameName:s,gameMode:i,description:o,region:l,tournamentName:c,status:d,timeAgo:u,onAccept:h,onDecline:f,onDelete:m,isOwn:g=!1,currentUserId:v}){const x=y=>{switch(y){case"connected":return"bg-green-600 text-white";case"declined":return"bg-red-600 text-white";default:return"bg-blue-600 text-white"}},S=y=>{switch(y){case"connected":return"Connected";case"declined":return"Declined";default:return"Looking for teammates"}};return a.jsxs(Ne,{className:"hover-elevate transition-all duration-200 border-card-border","data-testid":`card-match-request-${e}`,children:[a.jsx(an,{className:"pb-2 pt-3",children:a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsx("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:a.jsx(xi,{userId:t,gamertag:n,profileImageUrl:r,currentUserId:v,children:a.jsxs("div",{className:"min-w-0",children:[a.jsx("h3",{className:"font-semibold text-sm text-foreground hover:text-primary cursor-pointer truncate","data-testid":`text-gamertag-${e}`,children:n}),a.jsxs("div",{className:"flex items-center gap-1.5 mt-0.5 flex-wrap",children:[a.jsx($e,{variant:"secondary",className:"text-xs font-medium px-1.5 py-0",children:s}),a.jsxs($e,{variant:"outline",className:"text-xs px-1.5 py-0",children:[a.jsx(Jt,{className:"w-3 h-3 mr-1"}),i]})]})]})})}),a.jsxs("div",{className:"flex flex-col items-end gap-1 shrink-0",children:[a.jsx($e,{className:`text-xs font-medium whitespace-nowrap ${x(d)}`,"data-testid":`status-${d}-${e}`,children:S(d)}),g&&a.jsxs(ee,{size:"sm",variant:"ghost",onClick:m,className:"h-6 px-2 text-xs text-red-500 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-950","data-testid":`button-delete-${e}`,children:[a.jsx(So,{className:"h-3 w-3 mr-1"}),"Delete"]})]})]})}),a.jsxs(Fe,{className:"py-2 space-y-2",children:[a.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2","data-testid":`text-description-${e}`,children:o}),a.jsxs("div",{className:"flex items-center gap-3 text-xs text-muted-foreground flex-wrap",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(ov,{className:"w-3 h-3"}),a.jsx("span",{children:u})]}),l&&a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(lv,{className:"w-3 h-3"}),a.jsx("span",{children:l})]}),c&&a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(il,{className:"w-3 h-3"}),a.jsx("span",{className:"truncate max-w-[150px]",children:c})]})]}),!g&&d==="waiting"&&a.jsxs("div",{className:"flex gap-2 pt-1",children:[a.jsx(ee,{size:"sm",variant:"default",onClick:h,className:"flex-1 h-8","data-testid":`button-accept-${e}`,children:"Apply to Match"}),a.jsx(ee,{size:"sm",variant:"outline",onClick:f,className:"h-8","data-testid":`button-decline-${e}`,children:"Pass"})]})]})]})}function cN({slotId:e,format:t="auto",className:n=""}){return p.useEffect(()=>{try{window.adsbygoogle=window.adsbygoogle||[],window.adsbygoogle.push({})}catch(r){console.error("AdSense error:",r)}},[e]),a.jsx("div",{className:n,children:a.jsx("ins",{className:"adsbygoogle",style:{display:"block"},"data-ad-client":"ca-pub-4278995521540923","data-ad-slot":e,"data-ad-format":t,"data-full-width-responsive":"true"})})}function cy(){const[e,t]=p.useState(!1),[n,r]=p.useState(null),[s,i]=p.useState([]),o=p.useRef(null),{user:l,isAuthenticated:c}=mk(),d=l;return p.useEffect(()=>{let h;if(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")h=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws`;else{console.warn("WebSocket: VITE_API_URL not configured. Set it to your backend URL.");return}let f=0;const m=5;let g=null;const v=()=>{try{const S=new WebSocket(h);o.current=S,S.onopen=()=>{console.log("WebSocket connected"),t(!0),f=0},S.onmessage=y=>{try{const b=JSON.parse(y.data);console.log("WebSocket message received:",b),r(b),i(w=>[...w.slice(-50),b])}catch(b){console.error("Error parsing WebSocket message:",b)}},S.onclose=y=>{if(console.log("WebSocket disconnected:",y.code,y.reason),t(!1),f<m){const b=Math.pow(2,f)*1e3;f++,g=setTimeout(()=>{v()},b)}},S.onerror=y=>{console.error("WebSocket error:",y),t(!1)}}catch(S){console.error("Error creating WebSocket connection:",S),t(!1)}},x=setTimeout(()=>{v()},500);return()=>{clearTimeout(x),g&&clearTimeout(g),o.current&&o.current.close()}},[c,d==null?void 0:d.id]),{isConnected:e,lastMessage:n,messages:s,sendMessage:h=>{var f;((f=o.current)==null?void 0:f.readyState)===WebSocket.OPEN&&o.current.send(JSON.stringify(h))}}}function Lue({onFilterChange:e,activeFilters:t={}}){var y,b;const[n,r]=p.useState(t.search||""),[s,i]=p.useState(!1),o=["Valorant","League of Legends","CS2","Apex Legends","Rocket League","Overwatch 2","Dota 2","Fortnite","Call of Duty","FIFA 24"],l=["1v1","2v2","3v3","5v5","Team"],c=["NA West","NA East","NA Central","EU West","EU East","Asia","Oceania"],d=[{value:"male",label:"Male"},{value:"female",label:"Female"},{value:"custom",label:"Custom"},{value:"prefer_not_to_say",label:"Prefer not to say"}],u=["English","Spanish","French","German","Italian","Portuguese","Chinese","Japanese","Korean","Arabic","Hindi","Russian"],h=[{value:"5",label:"Within 5km"},{value:"10",label:"Within 10km"},{value:"25",label:"Within 25km"},{value:"50",label:"Within 50km"},{value:"100",label:"Within 100km"}],f=["Bronze","Silver","Gold","Platinum","Diamond","Master","Grandmaster","Challenger","Immortal","Radiant"],m=w=>{r(w),e({...t,search:w})},g=(w,C)=>{const I={...t,[w]:C==="all"?void 0:C};e(I)},v=w=>{const C={...t};delete C[w],e(C)},x=()=>{r(""),e({})},S=Object.keys(t).some(w=>t[w]);return a.jsxs("div",{className:"space-y-4",children:[a.jsx(Ne,{className:"mb-6",children:a.jsx(Fe,{className:"p-4",children:a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(wo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground pointer-events-none z-10"}),a.jsx(tt,{placeholder:"Search games, descriptions, or gamer tags...",value:n,onChange:w=>m(w.target.value),className:"pl-10 pr-4 overflow-x-auto whitespace-nowrap",style:{textOverflow:"clip",scrollbarWidth:"none",msOverflowStyle:"none"},"data-testid":"input-search"})]}),a.jsxs(ee,{variant:"outline",size:"default",onClick:()=>i(!s),className:"gap-2 shrink-0","data-testid":"button-toggle-filters",children:[a.jsx(qm,{className:"h-4 w-4"}),"Filters",S&&a.jsx($e,{variant:"secondary",className:"ml-1 px-1 py-0 text-xs",children:Object.keys(t).filter(w=>t[w]).length})]}),S&&a.jsx(ee,{variant:"ghost",size:"default",onClick:x,className:"text-muted-foreground hover:text-foreground shrink-0","data-testid":"button-clear-all-filters",children:"Clear all"})]})})}),S&&a.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.game&&a.jsxs($e,{variant:"secondary",className:"gap-1 pr-1",children:["Game: ",t.game,a.jsx(ee,{variant:"ghost",size:"sm",className:"h-auto p-0 hover:bg-transparent",onClick:()=>v("game"),"data-testid":"button-clear-game-filter",children:a.jsx(Ot,{className:"h-3 w-3"})})]}),t.mode&&a.jsxs($e,{variant:"secondary",className:"gap-1 pr-1",children:["Mode: ",t.mode,a.jsx(ee,{variant:"ghost",size:"sm",className:"h-auto p-0 hover:bg-transparent",onClick:()=>v("mode"),"data-testid":"button-clear-mode-filter",children:a.jsx(Ot,{className:"h-3 w-3"})})]}),t.region&&a.jsxs($e,{variant:"secondary",className:"gap-1 pr-1",children:["Region: ",t.region,a.jsx(ee,{variant:"ghost",size:"sm",className:"h-auto p-0 hover:bg-transparent",onClick:()=>v("region"),"data-testid":"button-clear-region-filter",children:a.jsx(Ot,{className:"h-3 w-3"})})]}),t.gender&&a.jsxs($e,{variant:"secondary",className:"gap-1 pr-1",children:["Gender: ",((y=d.find(w=>w.value===t.gender))==null?void 0:y.label)||t.gender,a.jsx(ee,{variant:"ghost",size:"sm",className:"h-auto p-0 hover:bg-transparent",onClick:()=>v("gender"),"data-testid":"button-clear-gender-filter",children:a.jsx(Ot,{className:"h-3 w-3"})})]}),t.language&&a.jsxs($e,{variant:"secondary",className:"gap-1 pr-1",children:["Language: ",t.language,a.jsx(ee,{variant:"ghost",size:"sm",className:"h-auto p-0 hover:bg-transparent",onClick:()=>v("language"),"data-testid":"button-clear-language-filter",children:a.jsx(Ot,{className:"h-3 w-3"})})]}),t.distance&&a.jsxs($e,{variant:"secondary",className:"gap-1 pr-1",children:["Distance: ",((b=h.find(w=>w.value===t.distance))==null?void 0:b.label)||`Within ${t.distance}km`,a.jsx(ee,{variant:"ghost",size:"sm",className:"h-auto p-0 hover:bg-transparent",onClick:()=>v("distance"),"data-testid":"button-clear-distance-filter",children:a.jsx(Ot,{className:"h-3 w-3"})})]}),t.rank&&a.jsxs($e,{variant:"secondary",className:"gap-1 pr-1",children:["Rank: ",t.rank,a.jsx(ee,{variant:"ghost",size:"sm",className:"h-auto p-0 hover:bg-transparent",onClick:()=>v("rank"),"data-testid":"button-clear-rank-filter",children:a.jsx(Ot,{className:"h-3 w-3"})})]})]}),s&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 p-4 bg-card rounded-lg border",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium text-foreground",children:"Game"}),a.jsxs(In,{value:t.game||"all",onValueChange:w=>g("game",w),children:[a.jsx(wn,{"data-testid":"select-game-filter",children:a.jsx(An,{placeholder:"All games"})}),a.jsxs(Sn,{children:[a.jsx(at,{value:"all",children:"All games"}),o.map(w=>a.jsx(at,{value:w,children:w},w))]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium text-foreground",children:"Mode"}),a.jsxs(In,{value:t.mode||"all",onValueChange:w=>g("mode",w),children:[a.jsx(wn,{"data-testid":"select-mode-filter",children:a.jsx(An,{placeholder:"All modes"})}),a.jsxs(Sn,{children:[a.jsx(at,{value:"all",children:"All modes"}),l.map(w=>a.jsx(at,{value:w,children:w},w))]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium text-foreground",children:"Region"}),a.jsxs(In,{value:t.region||"all",onValueChange:w=>g("region",w),children:[a.jsx(wn,{"data-testid":"select-region-filter",children:a.jsx(An,{placeholder:"All regions"})}),a.jsxs(Sn,{children:[a.jsx(at,{value:"all",children:"All regions"}),c.map(w=>a.jsx(at,{value:w,children:w},w))]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium text-foreground",children:"Gender"}),a.jsxs(In,{value:t.gender||"all",onValueChange:w=>g("gender",w),children:[a.jsx(wn,{"data-testid":"select-gender-filter",children:a.jsx(An,{placeholder:"All genders"})}),a.jsxs(Sn,{children:[a.jsx(at,{value:"all",children:"All genders"}),d.map(w=>a.jsx(at,{value:w.value,children:w.label},w.value))]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium text-foreground",children:"Language"}),a.jsxs(In,{value:t.language||"all",onValueChange:w=>g("language",w),children:[a.jsx(wn,{"data-testid":"select-language-filter",children:a.jsx(An,{placeholder:"All languages"})}),a.jsxs(Sn,{children:[a.jsx(at,{value:"all",children:"All languages"}),u.map(w=>a.jsx(at,{value:w,children:w},w))]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium text-foreground",children:"Distance"}),a.jsxs(In,{value:t.distance||"all",onValueChange:w=>g("distance",w),children:[a.jsx(wn,{"data-testid":"select-distance-filter",children:a.jsx(An,{placeholder:"All distances"})}),a.jsxs(Sn,{children:[a.jsx(at,{value:"all",children:"All distances"}),h.map(w=>a.jsx(at,{value:w.value,children:w.label},w.value))]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium text-foreground",children:"Rank"}),a.jsxs(In,{value:t.rank||"all",onValueChange:w=>g("rank",w),children:[a.jsx(wn,{"data-testid":"select-rank-filter",children:a.jsx(An,{placeholder:"All ranks"})}),a.jsxs(Sn,{children:[a.jsx(at,{value:"all",children:"All ranks"}),f.map(w=>a.jsx(at,{value:w,children:w},w))]})]})]})]})]})}function Fue(e){if(!e)return"Unknown";const t=new Date,n=new Date(e),r=t.getTime()-n.getTime(),s=Math.floor(r/(1e3*60)),i=Math.floor(r/(1e3*60*60)),o=Math.floor(r/(1e3*60*60*24));return s<1?"Just now":s<60?`${s} minute${s>1?"s":""} ago`:i<24?`${i} hour${i>1?"s":""} ago`:`${o} day${o>1?"s":""} ago`}function dN({onCreateMatch:e,onAcceptMatch:t,onDeclineMatch:n,onDeleteMatch:r,currentUserId:s="user1"}){const i=ff(),{isConnected:o,lastMessage:l}=cy(),{getContainerClass:c}=Ri(),[d,u]=p.useState({}),[h,f]=p.useState(!1),[m,g]=p.useState(!1),[v,x]=p.useState(null),[S,y]=p.useState(null),[b,w]=p.useState(1);p.useEffect(()=>{w(1)},[d]),p.useEffect(()=>{d.distance&&!v&&(navigator.geolocation?navigator.geolocation.getCurrentPosition(P=>{x({latitude:P.coords.latitude,longitude:P.coords.longitude}),y(null)},P=>{console.error("Error getting location:",P),y("Unable to get your location. Distance filter disabled."),u(j=>({...j,distance:void 0}))}):(y("Geolocation not supported. Distance filter disabled."),u(P=>({...P,distance:void 0}))))},[d.distance,v]);const{data:C,isLoading:I,isFetching:R,refetch:L}=Pt({queryKey:["/api/match-requests",d,v,b],queryFn:async()=>{const P=new URLSearchParams;d.game&&P.append("game",d.game),d.mode&&P.append("mode",d.mode),d.region&&P.append("region",d.region),d.gender&&P.append("gender",d.gender),d.language&&P.append("language",d.language),d.distance&&v&&(P.append("latitude",v.latitude.toString()),P.append("longitude",v.longitude.toString()),P.append("maxDistance",d.distance)),P.append("page",b.toString()),P.append("limit","10");const j=await fetch(lt(`/api/match-requests?${P}`),{credentials:"include"});if(!j.ok)throw new Error("Failed to fetch match requests");return j.json()},retry:!1}),N=(C==null?void 0:C.matchRequests)||[],O=(C==null?void 0:C.totalPages)||1,{data:G=[]}=Pt({queryKey:["/api/hidden-matches"],queryFn:async()=>{const P=await fetch(lt("/api/hidden-matches"),{credentials:"include"});if(!P.ok){if(P.status===401)return[];throw new Error("Failed to fetch hidden matches")}return P.json()},retry:!1}),{data:H=[]}=Pt({queryKey:["/api/user/connections"],queryFn:async()=>{const P=await fetch(lt("/api/user/connections"),{credentials:"include"});if(!P.ok){if(P.status===401)return[];throw new Error("Failed to fetch connections")}return P.json()},retry:!1}),re=p.useMemo(()=>H.map(P=>P.requestId),[H]),X=p.useMemo(()=>N.filter(P=>P.gamertag).map(P=>({...P,gamertag:P.gamertag||"Unknown Player",profileImageUrl:P.profileImageUrl??void 0,region:P.region??void 0,tournamentName:P.tournamentName??void 0,timeAgo:Fue(P.createdAt)})),[N]);p.useEffect(()=>{if(!l)return;const{type:P,data:j}=l;switch(P){case"match_request_created":i.invalidateQueries({queryKey:["/api/match-requests"]});break;case"match_request_updated":i.setQueryData(["/api/match-requests",d,v],$=>!$||!j?$:$.map(W=>W.id===j.id?{...W,...j}:W));break;case"match_request_deleted":i.setQueryData(["/api/match-requests",d,v],$=>!$||!(j!=null&&j.id)?$:$.filter(W=>W.id!==j.id));break}},[l,i,d]);const Q=P=>{if(re.includes(P.id)&&P.userId!==s||!h&&G.includes(P.id)||h&&!G.includes(P.id))return!1;if(d.search){const j=d.search.toLowerCase();if(!P.gameName.toLowerCase().includes(j)&&!P.description.toLowerCase().includes(j)&&!P.gamertag.toLowerCase().includes(j))return!1}return!(d.game&&!P.gameName.toLowerCase().includes(d.game.toLowerCase())||d.mode&&P.gameMode!==d.mode||d.region&&P.region!==d.region)},V=X.filter(P=>{if(P.matchType!=="lfg"||!Q(P))return!1;const j=m?"long-term":"short-term";return P.duration===j}),te=X.filter(P=>{if(P.matchType!=="lfo"||!Q(P))return!1;const j=m?"long-term":"short-term";return P.duration===j}),k=V.filter(P=>P.userId===s),E=V.filter(P=>P.userId!==s),M=te.filter(P=>P.userId===s),A=te.filter(P=>P.userId!==s),F=()=>{L()},q=()=>a.jsx("div",{className:"space-y-4",children:[...Array(3)].map((P,j)=>a.jsxs(Ne,{children:[a.jsx(an,{className:"pb-3",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(cn,{className:"h-10 w-10 rounded-full"}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(cn,{className:"h-4 w-24"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(cn,{className:"h-5 w-16"}),a.jsx(cn,{className:"h-5 w-12"})]})]})]}),a.jsx(cn,{className:"h-5 w-20"})]})}),a.jsxs(Fe,{children:[a.jsx(cn,{className:"h-4 w-full mb-2"}),a.jsx(cn,{className:"h-4 w-3/4 mb-4"}),a.jsxs("div",{className:"flex gap-4",children:[a.jsx(cn,{className:"h-3 w-16"}),a.jsx(cn,{className:"h-3 w-20"})]})]})]},j))});return a.jsxs("div",{className:`${c()} mx-auto space-y-4 md:space-y-6`,children:[a.jsxs("div",{className:"mb-6 flex flex-col sm:flex-row sm:items-start gap-3",children:[a.jsxs("div",{children:[a.jsxs("h1",{className:"text-2xl font-bold text-foreground mb-2 flex items-center gap-2",children:[a.jsx(Jp,{className:"h-6 w-6 text-primary"}),"Match Feed",a.jsxs("div",{className:"flex items-center gap-1",children:[o?a.jsx(G8,{className:"h-4 w-4 text-green-500"}):a.jsx(z8,{className:"h-4 w-4 text-red-500"}),a.jsx("span",{className:"text-xs text-muted-foreground",children:o?"Live":"Offline"})]})]}),a.jsx("p",{className:"text-muted-foreground",children:"Discover and apply to match requests"})]}),a.jsxs("div",{className:"flex gap-1.5 sm:gap-2 flex-wrap sm:ml-auto",children:[a.jsxs(ee,{variant:h?"default":"outline",size:"sm",onClick:()=>f(!h),"data-testid":"button-toggle-hidden",className:"h-8 px-2 sm:px-3",children:[h?a.jsx(M8,{className:"h-4 w-4 sm:mr-1"}):a.jsx(j8,{className:"h-4 w-4 sm:mr-1"}),a.jsx("span",{className:"hidden sm:inline",children:h?"Show All":"Hidden"})]}),a.jsxs(ee,{variant:m?"default":"outline",size:"sm",onClick:()=>g(!m),"data-testid":"button-duration-long-term",className:`h-8 px-2 sm:px-3 ${m?"shadow-lg shadow-primary/50 ring-2 ring-primary/30":""}`,children:[a.jsx(ov,{className:"h-4 w-4 sm:mr-2"}),a.jsx("span",{className:"hidden sm:inline",children:"Long Term"}),m&&a.jsx("span",{className:"ml-1 sm:ml-2 text-xs",children:""})]}),a.jsx(ee,{variant:"outline",size:"sm",onClick:F,disabled:R,"data-testid":"button-refresh-feed",className:`h-8 px-2 sm:px-3 transition-transform ${R?"scale-95":"hover:scale-105"}`,children:a.jsx(bl,{className:`h-4 w-4 ${R?"animate-spin":""}`})}),a.jsxs(ee,{onClick:e,size:"sm",className:"gap-1 sm:gap-2 h-8 px-2 sm:px-3","data-testid":"button-create-match",children:[a.jsx(Nr,{className:"h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Create"})]})]})]}),S&&a.jsx("div",{className:"p-4 bg-yellow-500/10 border border-yellow-500/20 rounded-lg",children:a.jsx("p",{className:"text-sm text-yellow-600 dark:text-yellow-400",children:S})}),a.jsx(Lue,{onFilterChange:u,activeFilters:d}),a.jsx("div",{className:"my-6",children:a.jsx(cN,{slotId:"7186282934",format:"horizontal",className:"text-center"})}),a.jsxs(Ll,{defaultValue:"lfg",className:"w-full",children:[a.jsxs(_o,{className:"grid w-full grid-cols-2",children:[a.jsxs(_r,{value:"lfg",className:"gap-1 sm:gap-2","data-testid":"tab-lfg",children:[a.jsx(Jt,{className:"h-4 w-4 flex-shrink-0"}),a.jsxs("span",{className:"text-xs sm:text-sm",children:["LFG ",a.jsx("span",{className:"hidden sm:inline",children:"(Looking for Group)"})]})]}),a.jsxs(_r,{value:"lfo",className:"gap-1 sm:gap-2","data-testid":"tab-lfo",children:[a.jsx(Jp,{className:"h-4 w-4 flex-shrink-0"}),a.jsxs("span",{className:"text-xs sm:text-sm",children:["LFO ",a.jsx("span",{className:"hidden sm:inline",children:"(Looking for Opponent)"})]})]})]}),a.jsx(si,{value:"lfg",className:"mt-6 space-y-4",children:I?a.jsx(q,{}):V.length===0?a.jsx(Ne,{children:a.jsxs(Fe,{className:"py-12 text-center",children:[a.jsx(Jt,{className:"h-16 w-16 text-muted-foreground/50 mx-auto mb-4"}),a.jsxs("div",{className:"text-muted-foreground space-y-2",children:[a.jsx("p",{className:"text-lg font-semibold",children:"No LFG matches found"}),a.jsx("p",{className:"text-sm",children:"Looking for teammates to form a group? Create a match request to find players!"})]}),a.jsxs(ee,{onClick:e,className:"mt-4 gap-2","data-testid":"button-create-lfg-match",children:[a.jsx(Nr,{className:"h-4 w-4"}),"Create LFG Request"]})]})}):a.jsxs(a.Fragment,{children:[k.length>0&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2 pt-2",children:[a.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Your Posts"}),a.jsx($e,{variant:"secondary",className:"text-xs",children:k.length})]}),a.jsx("div",{className:"space-y-4",children:k.map(P=>a.jsx(Rp,{id:P.id,userId:P.userId,gamertag:P.gamertag,profileImageUrl:P.profileImageUrl,gameName:P.gameName,gameMode:P.gameMode,description:P.description,region:P.region,tournamentName:P.tournamentName,status:P.status,timeAgo:P.timeAgo,isOwn:!0,currentUserId:s,onAccept:()=>t(P.id,P.userId),onDecline:()=>n(P.id),onDelete:()=>r(P.id)},P.id))})]}),E.length>0&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2 pt-2",children:[a.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Available Matches"}),a.jsx($e,{variant:"secondary",className:"text-xs",children:E.length})]}),a.jsx("div",{className:"space-y-4",children:E.map((P,j)=>a.jsxs("div",{children:[a.jsx(Rp,{id:P.id,userId:P.userId,gamertag:P.gamertag,profileImageUrl:P.profileImageUrl,gameName:P.gameName,gameMode:P.gameMode,description:P.description,region:P.region,tournamentName:P.tournamentName,status:P.status,timeAgo:P.timeAgo,isOwn:!1,currentUserId:s,onAccept:()=>t(P.id,P.userId),onDecline:()=>n(P.id),onDelete:()=>r(P.id)}),j===2&&E.length>3&&a.jsx("div",{className:"my-4",children:a.jsx(cN,{slotId:"7186282935",format:"horizontal",className:"text-center"})})]},P.id))})]})]})}),a.jsx(si,{value:"lfo",className:"mt-6 space-y-4",children:I?a.jsx(q,{}):te.length===0?a.jsx(Ne,{children:a.jsxs(Fe,{className:"py-12 text-center",children:[a.jsx(Jp,{className:"h-16 w-16 text-muted-foreground/50 mx-auto mb-4"}),a.jsxs("div",{className:"text-muted-foreground space-y-2",children:[a.jsx("p",{className:"text-lg font-semibold",children:"No LFO matches found"}),a.jsx("p",{className:"text-sm",children:"Looking for opponents to compete against? Create a match request to find challengers!"})]}),a.jsxs(ee,{onClick:e,className:"mt-4 gap-2","data-testid":"button-create-lfo-match",children:[a.jsx(Nr,{className:"h-4 w-4"}),"Create LFO Request"]})]})}):a.jsxs(a.Fragment,{children:[M.length>0&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2 pt-2",children:[a.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Your Posts"}),a.jsx($e,{variant:"secondary",className:"text-xs",children:M.length})]}),a.jsx("div",{className:"space-y-4",children:M.map(P=>a.jsx(Rp,{id:P.id,userId:P.userId,gamertag:P.gamertag,profileImageUrl:P.profileImageUrl,gameName:P.gameName,gameMode:P.gameMode,description:P.description,region:P.region,tournamentName:P.tournamentName,status:P.status,timeAgo:P.timeAgo,isOwn:!0,currentUserId:s,onAccept:()=>t(P.id,P.userId),onDecline:()=>n(P.id),onDelete:()=>r(P.id)},P.id))})]}),A.length>0&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2 pt-2",children:[a.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Available Matches"}),a.jsx($e,{variant:"secondary",className:"text-xs",children:A.length})]}),a.jsx("div",{className:"space-y-4",children:A.map(P=>a.jsx(Rp,{id:P.id,userId:P.userId,gamertag:P.gamertag,profileImageUrl:P.profileImageUrl,gameName:P.gameName,gameMode:P.gameMode,description:P.description,region:P.region,tournamentName:P.tournamentName,status:P.status,timeAgo:P.timeAgo,isOwn:!1,currentUserId:s,onAccept:()=>t(P.id,P.userId),onDecline:()=>n(P.id),onDelete:()=>r(P.id)},P.id))})]})]})})]}),O>1&&a.jsxs("div",{className:"flex justify-center items-center gap-2 mt-6",children:[a.jsx(ee,{variant:"outline",size:"sm",onClick:()=>w(P=>Math.max(1,P-1)),disabled:b===1,"data-testid":"button-previous-page",children:"Previous"}),a.jsxs("span",{className:"text-sm text-muted-foreground",children:["Page ",b," of ",O]}),a.jsx(ee,{variant:"outline",size:"sm",onClick:()=>w(P=>Math.min(O,P+1)),disabled:b===O,"data-testid":"button-next-page",children:"Next"})]}),o&&a.jsx("div",{className:"text-center text-xs text-muted-foreground mt-4",children:" Live updates enabled  New matches appear automatically"})]})}const $ue=ns({gameName:et().min(1,"Game name is required"),gameMode:et().min(1,"Game mode is required"),matchType:Md(["lfg","lfo"],{required_error:"Match type is required"}),duration:Md(["short-term","long-term"],{required_error:"Duration is required"}),description:et().min(10,"Description must be at least 10 characters"),tournamentName:et().optional(),region:et().min(1,"Region is required")});function Uue({onSubmit:e,onCancel:t,isLoading:n}){const{getContainerClass:r}=Ri(),s=Zv({resolver:ey($ue),defaultValues:{gameName:"",gameMode:"",matchType:"lfg",duration:"short-term",description:"",tournamentName:"",region:""}}),i=["Valorant","League of Legends","CS2","Apex Legends","Rocket League","Overwatch 2","Dota 2","Fortnite","Call of Duty","FIFA 24"],o=["1v1","2v2","3v3","5v5","Team"],l=["NA West","NA East","NA Central","EU West","EU East","Asia","Oceania"],c=d=>{e(d),s.reset()};return a.jsxs(Ne,{className:`w-full ${r()} mx-auto`,children:[a.jsx(an,{children:a.jsxs(mr,{className:"flex items-center gap-2 text-xl",children:[a.jsx(ia,{className:"h-5 w-5 text-primary"}),"Create Match Request"]})}),a.jsx(Fe,{children:a.jsx(Zh,{...s,children:a.jsxs("form",{onSubmit:s.handleSubmit(c),className:"space-y-6",children:[a.jsx(Tt,{control:s.control,name:"matchType",render:({field:d})=>a.jsxs(vt,{children:[a.jsx(dt,{children:"Match Type"}),a.jsx(yt,{children:a.jsx(Ll,{value:d.value,onValueChange:d.onChange,className:"w-full",children:a.jsxs(_o,{className:"grid w-full grid-cols-2",children:[a.jsxs(_r,{value:"lfg",className:"gap-2","data-testid":"tab-match-type-lfg",children:[a.jsx(Jt,{className:"h-4 w-4"}),"LFG (Looking for Group)"]}),a.jsxs(_r,{value:"lfo",className:"gap-2","data-testid":"tab-match-type-lfo",children:[a.jsx(Jp,{className:"h-4 w-4"}),"LFO (Looking for Opponent)"]})]})})}),a.jsx(xt,{})]})}),a.jsx(Tt,{control:s.control,name:"duration",render:({field:d})=>a.jsxs(vt,{children:[a.jsx(dt,{children:"Duration"}),a.jsx(yt,{children:a.jsx(Ll,{value:d.value,onValueChange:d.onChange,className:"w-full",children:a.jsxs(_o,{className:"grid w-full grid-cols-2",children:[a.jsxs(_r,{value:"short-term",className:"gap-2","data-testid":"tab-duration-short",children:[a.jsx(QD,{className:"h-4 w-4"}),"Short-term"]}),a.jsxs(_r,{value:"long-term",className:"gap-2","data-testid":"tab-duration-long",children:[a.jsx(ov,{className:"h-4 w-4"}),"Long-term"]})]})})}),a.jsx(xt,{})]})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(Tt,{control:s.control,name:"gameName",render:({field:d})=>a.jsxs(vt,{children:[a.jsx(dt,{children:"Game"}),a.jsxs(In,{onValueChange:d.onChange,value:d.value,children:[a.jsx(yt,{children:a.jsx(wn,{"data-testid":"select-game-name",children:a.jsx(An,{placeholder:"Select a game"})})}),a.jsx(Sn,{children:i.map(u=>a.jsx(at,{value:u,children:u},u))})]}),a.jsx(xt,{})]})}),a.jsx(Tt,{control:s.control,name:"gameMode",render:({field:d})=>a.jsxs(vt,{children:[a.jsx(dt,{children:"Game Mode"}),a.jsxs(In,{onValueChange:d.onChange,value:d.value,children:[a.jsx(yt,{children:a.jsx(wn,{"data-testid":"select-game-mode",children:a.jsx(An,{placeholder:"Select mode"})})}),a.jsx(Sn,{children:o.map(u=>a.jsx(at,{value:u,children:u},u))})]}),a.jsx(xt,{})]})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(Tt,{control:s.control,name:"region",render:({field:d})=>a.jsxs(vt,{children:[a.jsx(dt,{children:"Region"}),a.jsxs(In,{onValueChange:d.onChange,value:d.value,children:[a.jsx(yt,{children:a.jsx(wn,{"data-testid":"select-region",children:a.jsx(An,{placeholder:"Select region"})})}),a.jsx(Sn,{children:l.map(u=>a.jsx(at,{value:u,children:u},u))})]}),a.jsx(xt,{})]})}),a.jsx(Tt,{control:s.control,name:"tournamentName",render:({field:d})=>a.jsxs(vt,{children:[a.jsx(dt,{children:"Tournament (Optional)"}),a.jsx(yt,{children:a.jsx(tt,{placeholder:"e.g., Spring Championship",...d,"data-testid":"input-tournament-name"})}),a.jsx(xt,{})]})})]}),a.jsx(Tt,{control:s.control,name:"description",render:({field:d})=>a.jsxs(vt,{children:[a.jsx(dt,{children:"Description"}),a.jsx(yt,{children:a.jsx(ef,{placeholder:"Describe what you're looking for, your skill level, requirements, etc.",className:"min-h-[100px] resize-none",...d,"data-testid":"textarea-description"})}),a.jsx(xt,{})]})}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsxs(ee,{type:"submit",className:"flex-1 gap-2",disabled:n,"data-testid":"button-create-match",children:[a.jsx(Nr,{className:"h-4 w-4"}),n?"Creating...":"Create Match Request"]}),t&&a.jsx(ee,{type:"button",variant:"outline",onClick:t,disabled:n,"data-testid":"button-cancel",children:"Cancel"})]})]})})})]})}const Vue=ns({gamertag:et().min(3,"Gamertag must be at least 3 characters").max(20,"Gamertag must be less than 20 characters"),firstName:et().optional(),lastName:et().optional(),bio:et().max(200,"Bio must be less than 200 characters").optional(),location:et().optional(),age:et().optional().refine(e=>!e||e.trim()===""||parseInt(e)>=13&&parseInt(e)<=100,"Age must be between 13 and 100")});function Bue({user:e,onComplete:t,onCancel:n}){var C;const[r,s]=p.useState((e==null?void 0:e.preferredGames)||[]),[i,o]=p.useState(""),[l,c]=p.useState(e!=null&&e.latitude&&(e!=null&&e.longitude)?{latitude:e.latitude,longitude:e.longitude}:null),[d,u]=p.useState("idle"),{toast:h}=Wn(),f=ff(),{getContainerClass:m}=Ri();p.useEffect(()=>{!l&&navigator.geolocation&&(u("requesting"),navigator.geolocation.getCurrentPosition(I=>{c({latitude:I.coords.latitude,longitude:I.coords.longitude}),u("granted")},I=>{console.error("Error getting location:",I),u("denied")}))},[]);const g=Zv({resolver:ey(Vue),defaultValues:{gamertag:(e==null?void 0:e.gamertag)||"",firstName:(e==null?void 0:e.firstName)||"",lastName:(e==null?void 0:e.lastName)||"",bio:(e==null?void 0:e.bio)||"",location:(e==null?void 0:e.location)||"",age:((C=e==null?void 0:e.age)==null?void 0:C.toString())||""}}),v=Nt({mutationFn:async I=>{const R={...I,age:I.age&&I.age.trim()!==""?parseInt(I.age):void 0,preferredGames:I.preferredGames,latitude:l==null?void 0:l.latitude,longitude:l==null?void 0:l.longitude};return(await kt("PATCH","/api/user/profile",R)).json()},onSuccess:()=>{h({title:"Profile updated successfully!",description:"Your gaming profile has been saved."}),f.invalidateQueries({queryKey:["/api/auth/user"]}),t==null||t()},onError:I=>{h({title:"Error updating profile",description:I.message||"Something went wrong. Please try again.",variant:"destructive"})}}),x=["Valorant","CS2","Apex Legends","League of Legends","Fortnite","Overwatch 2","Rocket League","Call of Duty","FIFA","Dota 2","Rainbow Six Siege","Minecraft","Among Us","Fall Guys","Genshin Impact"],S=()=>{i.trim()&&!r.includes(i.trim())&&(s([...r,i.trim()]),o(""))},y=I=>{s(r.filter(R=>R!==I))},b=I=>{r.includes(I)||s([...r,I])},w=I=>{v.mutate({...I,preferredGames:r})};return a.jsx("div",{className:`${m()} mx-auto`,children:a.jsxs(Ne,{children:[a.jsxs(an,{className:"space-y-2 pb-6",children:[a.jsx(mr,{className:"text-center text-2xl",children:e!=null&&e.gamertag?"Edit Your Profile & Settings":"Setup Your Gaming Profile"}),a.jsx("p",{className:"text-sm text-muted-foreground text-center",children:e!=null&&e.gamertag?"Update your information, games, and privacy settings":"Tell other players about yourself to find the perfect teammates"})]}),a.jsx(Fe,{className:"space-y-8",children:a.jsx(Zh,{...g,children:a.jsxs("form",{onSubmit:g.handleSubmit(w),className:"space-y-8",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b",children:[a.jsx(qD,{className:"h-5 w-5 text-primary"}),a.jsx("h3",{className:"text-lg font-semibold",children:"Basic Information"})]}),a.jsx(Tt,{control:g.control,name:"gamertag",render:({field:I})=>a.jsxs(vt,{children:[a.jsx(dt,{children:"Gamertag *"}),a.jsx(yt,{children:a.jsx(tt,{placeholder:"Enter your gamertag",...I,"data-testid":"input-gamertag"})}),a.jsx(xt,{})]})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(Tt,{control:g.control,name:"firstName",render:({field:I})=>a.jsxs(vt,{children:[a.jsx(dt,{children:"First Name"}),a.jsx(yt,{children:a.jsx(tt,{placeholder:"Your first name",...I,"data-testid":"input-firstname"})}),a.jsx(xt,{})]})}),a.jsx(Tt,{control:g.control,name:"lastName",render:({field:I})=>a.jsxs(vt,{children:[a.jsx(dt,{children:"Last Name"}),a.jsx(yt,{children:a.jsx(tt,{placeholder:"Your last name",...I,"data-testid":"input-lastname"})}),a.jsx(xt,{})]})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(Tt,{control:g.control,name:"age",render:({field:I})=>a.jsxs(vt,{children:[a.jsx(dt,{children:"Age"}),a.jsx(yt,{children:a.jsx(tt,{type:"number",placeholder:"Your age",...I,onChange:R=>I.onChange(R.target.value),"data-testid":"input-age"})}),a.jsx(xt,{})]})}),a.jsx(Tt,{control:g.control,name:"location",render:({field:I})=>a.jsxs(vt,{children:[a.jsx(dt,{children:"Location"}),a.jsx(yt,{children:a.jsxs("div",{className:"relative",children:[a.jsx(tt,{placeholder:"City, Country",...I,"data-testid":"input-location"}),d==="granted"&&l&&a.jsx(lv,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-green-500"})]})}),d==="granted"&&a.jsx("p",{className:"text-xs text-muted-foreground",children:"GPS coordinates captured for location-based search"}),d==="denied"&&a.jsx("p",{className:"text-xs text-yellow-600 dark:text-yellow-400",children:"Location permission denied - distance filtering won't work"}),a.jsx(xt,{})]})})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b",children:[a.jsx(Kp,{className:"h-5 w-5 text-primary"}),a.jsx("h3",{className:"text-lg font-semibold",children:"About You"})]}),a.jsx(Tt,{control:g.control,name:"bio",render:({field:I})=>a.jsxs(vt,{children:[a.jsx(dt,{children:"Bio"}),a.jsx(yt,{children:a.jsx(ef,{placeholder:"Tell other players about your gaming style, goals, and what you're looking for in teammates...",className:"resize-none",rows:4,...I,"data-testid":"input-bio"})}),a.jsx(xt,{})]})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b",children:[a.jsx(ia,{className:"h-5 w-5 text-primary"}),a.jsx("h3",{className:"text-lg font-semibold",children:"Your Games"})]}),a.jsx("div",{children:a.jsx("p",{className:"text-sm text-muted-foreground",children:"Select the games you play and want to find teammates for"})}),a.jsx("div",{className:"flex flex-wrap gap-2",children:r.map(I=>a.jsxs($e,{variant:"secondary",className:"flex items-center gap-1","data-testid":`badge-game-${I.toLowerCase().replace(/\s+/g,"-")}`,children:[I,a.jsx(Ot,{className:"h-3 w-3 cursor-pointer hover:text-destructive",onClick:()=>y(I),"data-testid":`button-remove-game-${I.toLowerCase().replace(/\s+/g,"-")}`})]},I))}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(tt,{placeholder:"Add a game...",value:i,onChange:I=>o(I.target.value),onKeyPress:I=>I.key==="Enter"&&(I.preventDefault(),S()),"data-testid":"input-new-game"}),a.jsx(ee,{type:"button",variant:"outline",size:"icon",onClick:S,"data-testid":"button-add-game",children:a.jsx(Nr,{className:"h-4 w-4"})})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Or select from popular games:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:x.filter(I=>!r.includes(I)).slice(0,8).map(I=>a.jsx($e,{variant:"outline",className:"cursor-pointer hover:bg-secondary",onClick:()=>b(I),"data-testid":`button-popular-game-${I.toLowerCase().replace(/\s+/g,"-")}`,children:I},I))})]})]}),a.jsxs("div",{className:"flex gap-3 pt-6",children:[a.jsx(ee,{type:"submit",disabled:v.isPending,className:"flex-1","data-testid":"button-save-profile",children:v.isPending?"Saving...":"Save Profile"}),n&&a.jsx(ee,{type:"button",variant:"outline",onClick:n,disabled:v.isPending,"data-testid":"button-cancel-profile",children:"Cancel"})]})]})})})]})})}function zue(e){const t=Gue(e),n=p.forwardRef((r,s)=>{const{children:i,...o}=r,l=p.Children.toArray(i),c=l.find(Hue);if(c){const d=c.props.children,u=l.map(h=>h===c?p.Children.count(d)>1?p.Children.only(null):p.isValidElement(d)?d.props.children:null:h);return a.jsx(t,{...o,ref:s,children:p.isValidElement(d)?p.cloneElement(d,void 0,u):null})}return a.jsx(t,{...o,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}function Gue(e){const t=p.forwardRef((n,r)=>{const{children:s,...i}=n;if(p.isValidElement(s)){const o=Kue(s),l=que(i,s.props);return s.type!==p.Fragment&&(l.ref=r?Ii(r,o):o),p.cloneElement(s,l)}return p.Children.count(s)>1?p.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var Wue=Symbol("radix.slottable");function Hue(e){return p.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===Wue}function que(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...l)=>{const c=i(...l);return s(...l),c}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function Kue(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var dy="Popover",[U5]=Mn(dy,[Oo]),Wf=Oo(),[Que,zo]=U5(dy),V5=e=>{const{__scopePopover:t,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:o=!1}=e,l=Wf(t),c=p.useRef(null),[d,u]=p.useState(!1),[h,f]=qr({prop:r,defaultProp:s??!1,onChange:i,caller:dy});return a.jsx($0,{...l,children:a.jsx(Que,{scope:t,contentId:is(),triggerRef:c,open:h,onOpenChange:f,onOpenToggle:p.useCallback(()=>f(m=>!m),[f]),hasCustomAnchor:d,onCustomAnchorAdd:p.useCallback(()=>u(!0),[]),onCustomAnchorRemove:p.useCallback(()=>u(!1),[]),modal:o,children:n})})};V5.displayName=dy;var B5="PopoverAnchor",Jue=p.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=zo(B5,n),i=Wf(n),{onCustomAnchorAdd:o,onCustomAnchorRemove:l}=s;return p.useEffect(()=>(o(),()=>l()),[o,l]),a.jsx(xf,{...i,...r,ref:t})});Jue.displayName=B5;var z5="PopoverTrigger",G5=p.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=zo(z5,n),i=Wf(n),o=We(t,s.triggerRef),l=a.jsx(Re.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":Q5(s.open),...r,ref:o,onClick:pe(e.onClick,s.onOpenToggle)});return s.hasCustomAnchor?l:a.jsx(xf,{asChild:!0,...i,children:l})});G5.displayName=z5;var IT="PopoverPortal",[Yue,Xue]=U5(IT,{forceMount:void 0}),W5=e=>{const{__scopePopover:t,forceMount:n,children:r,container:s}=e,i=zo(IT,t);return a.jsx(Yue,{scope:t,forceMount:n,children:a.jsx(Pn,{present:n||i.open,children:a.jsx(Bd,{asChild:!0,container:s,children:r})})})};W5.displayName=IT;var Od="PopoverContent",H5=p.forwardRef((e,t)=>{const n=Xue(Od,e.__scopePopover),{forceMount:r=n.forceMount,...s}=e,i=zo(Od,e.__scopePopover);return a.jsx(Pn,{present:r||i.open,children:i.modal?a.jsx(ehe,{...s,ref:t}):a.jsx(the,{...s,ref:t})})});H5.displayName=Od;var Zue=zue("PopoverContent.RemoveScroll"),ehe=p.forwardRef((e,t)=>{const n=zo(Od,e.__scopePopover),r=p.useRef(null),s=We(t,r),i=p.useRef(!1);return p.useEffect(()=>{const o=r.current;if(o)return Lv(o)},[]),a.jsx(Rf,{as:Zue,allowPinchZoom:!0,children:a.jsx(q5,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:pe(e.onCloseAutoFocus,o=>{var l;o.preventDefault(),i.current||(l=n.triggerRef.current)==null||l.focus()}),onPointerDownOutside:pe(e.onPointerDownOutside,o=>{const l=o.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,d=l.button===2||c;i.current=d},{checkForDefaultPrevented:!1}),onFocusOutside:pe(e.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})})}),the=p.forwardRef((e,t)=>{const n=zo(Od,e.__scopePopover),r=p.useRef(!1),s=p.useRef(!1);return a.jsx(q5,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,l;(o=e.onCloseAutoFocus)==null||o.call(e,i),i.defaultPrevented||(r.current||(l=n.triggerRef.current)==null||l.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var c,d;(c=e.onInteractOutside)==null||c.call(e,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const o=i.target;((d=n.triggerRef.current)==null?void 0:d.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),q5=p.forwardRef((e,t)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,disableOutsidePointerEvents:o,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:d,onInteractOutside:u,...h}=e,f=zo(Od,n),m=Wf(n);return Ov(),a.jsx(Af,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:a.jsx(Yl,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:u,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:d,onDismiss:()=>f.onOpenChange(!1),children:a.jsx(pv,{"data-state":Q5(f.open),role:"dialog",id:f.contentId,...m,...h,ref:t,style:{...h.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),K5="PopoverClose",nhe=p.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=zo(K5,n);return a.jsx(Re.button,{type:"button",...r,ref:t,onClick:pe(e.onClick,()=>s.onOpenChange(!1))})});nhe.displayName=K5;var rhe="PopoverArrow",she=p.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=Wf(n);return a.jsx(mv,{...s,...r,ref:t})});she.displayName=rhe;function Q5(e){return e?"open":"closed"}var ihe=V5,ahe=G5,ohe=W5,J5=H5;const vS=ihe,yS=ahe,$g=p.forwardRef(({className:e,align:t="center",sideOffset:n=4,...r},s)=>a.jsx(ohe,{children:a.jsx(J5,{ref:s,align:t,sideOffset:n,className:be("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]",e),...r})}));$g.displayName=J5.displayName;const Y5=k3,X5=cT,Z5=uT;function eB({connectionId:e,currentUserId:t,otherUserId:n,otherUserName:r}){const[s,i]=p.useState(""),o=p.useRef(null),{lastMessage:l}=cy();Wn();const c=pr(Zs),{data:d=[],isLoading:u}=Pt({queryKey:["/api/messages",e],queryFn:async()=>{const y=await fetch(lt(`/api/messages/${e}`),{credentials:"include"});if(!y.ok)throw new Error("Failed to fetch messages");return y.json()},retry:!1}),{data:h}=Pt({queryKey:["/api/voice/channel",e],queryFn:async()=>{const y=await fetch(lt(`/api/voice/channel/${e}`),{credentials:"include"});if(!y.ok)throw new Error("Failed to fetch voice channel");return y.json()},retry:!1,refetchInterval:5e3}),f=Nt({mutationFn:async y=>{const b=await fetch(lt("/api/messages"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({connectionId:e,receiverId:n,message:y})});if(!b.ok)throw new Error("Failed to send message");return b.json()},onSuccess:()=>{i(""),ze.invalidateQueries({queryKey:["/api/messages",e]})}});p.useEffect(()=>{if(!l)return;const{type:y,data:b}=l;y==="new_message"&&(b==null?void 0:b.connectionId)===e&&ze.invalidateQueries({queryKey:["/api/messages",e]}),(y==="voice_participant_joined"||y==="voice_participant_left"||y==="voice_participant_muted")&&(b==null?void 0:b.connectionId)===e&&ze.invalidateQueries({queryKey:["/api/voice/channel",e]})},[l,e]),p.useEffect(()=>{o.current&&(o.current.scrollTop=o.current.scrollHeight)},[d]);const m=y=>{y.preventDefault(),!(!s.trim()||f.isPending)&&f.mutate(s.trim())},g=y=>y?new Date(y).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",x=((h==null?void 0:h.participants)||[]).filter(y=>y.userId!==t),S=x.length>0;return a.jsxs("div",{className:"flex flex-col h-full",children:[S&&a.jsx("div",{className:"border-b p-3 bg-muted/30",children:a.jsxs("div",{className:"p-2 bg-primary/10 border border-primary/30 rounded-md",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(Jt,{className:"h-4 w-4 text-primary"}),a.jsx("span",{className:"text-sm font-medium text-primary",children:"In Voice Channel:"})]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:x.map(y=>{var b;return a.jsxs("div",{className:"flex items-center gap-1 bg-background/50 rounded-full px-2 py-1",children:[a.jsx(Tn,{className:"h-5 w-5",children:a.jsx(Cn,{className:"text-xs bg-primary/20",children:(((b=y.gamertag)==null?void 0:b[0])||"U").toUpperCase()})}),a.jsx("span",{className:"text-xs font-medium","data-testid":`voice-participant-${y.userId}`,children:y.gamertag||"User"}),y.isMuted&&a.jsx(xl,{className:"h-3 w-3 text-muted-foreground"})]},y.id)})}),a.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Switch to the Voice tab to join the call",c&&" or control audio"]})]})}),a.jsx(Hv,{className:"flex-1 p-4",ref:o,children:u?a.jsx("div",{className:"flex items-center justify-center h-full",children:a.jsx(Rl,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):d.length===0?a.jsx("div",{className:"flex items-center justify-center h-full text-center",children:a.jsxs("div",{children:[a.jsx("p",{className:"text-muted-foreground",children:"No messages yet"}),a.jsxs("p",{className:"text-sm text-muted-foreground/70 mt-1",children:["Start the conversation with ",r||"your teammate","!"]})]})}):a.jsx("div",{className:"space-y-3",children:d.map(y=>{const b=y.senderId===t;return a.jsx("div",{className:`flex ${b?"justify-end":"justify-start"}`,children:a.jsx("div",{className:`max-w-[70%] ${b?"order-2":"order-1"}`,children:a.jsxs("div",{className:`rounded-lg p-3 ${b?"bg-primary text-primary-foreground":"bg-muted"}`,children:[a.jsx("p",{className:"text-sm break-words","data-testid":`message-${y.id}`,children:y.message}),a.jsx("p",{className:`text-xs mt-1 ${b?"text-primary-foreground/70":"text-muted-foreground"}`,children:g(y.createdAt)})]})})},y.id)})})}),a.jsx("div",{className:"border-t p-4",children:a.jsxs("form",{onSubmit:m,className:"flex gap-2",children:[a.jsx(tt,{value:s,onChange:y=>i(y.target.value),placeholder:`Message ${r||"teammate"}...`,disabled:f.isPending,"data-testid":"input-chat-message"}),a.jsx(ee,{type:"submit",size:"icon",disabled:!s.trim()||f.isPending,"data-testid":"button-send-message",children:f.isPending?a.jsx(Rl,{className:"h-4 w-4 animate-spin"}):a.jsx(V8,{className:"h-4 w-4"})})]})})]})}function tB({connectionId:e,currentUserId:t,otherUserId:n,otherUserName:r,hideScreenShare:s=!1}){const i=pk(),o=pr(Zs),l=pr(Kd),c=pr(ok),d=pr(og),u=pr(Qd),{setVoiceChannelActive:h,activeVoiceChannel:f}=P2(),[m,g]=p.useState(!1),[v,x]=p.useState(null),[S,y]=p.useState(null),[b,w]=p.useState({}),[C,I]=p.useState(!1),R=p.useRef(null),L=p.useRef(null),N=p.useRef(null),O=p.useRef(!1),{toast:G}=Wn(),H=l.filter(A=>!A.isLocal),re=H.length>0;p.useEffect(()=>{i.setLogLevel(4),console.log("[HMS] Verbose logging enabled for voice channel"),(async()=>{try{await i.setAudioSettings({maxBitrate:64}),console.log("[HMS] High-quality audio settings configured")}catch(F){console.warn("[HMS] Could not configure audio settings:",F)}})()},[i]),p.useEffect(()=>{(f==null?void 0:f.id)===e&&(f==null?void 0:f.type)==="individual"&&!o&&!m&&!O.current&&(console.log("[HMS] Auto-reconnecting to individual voice channel after navigation"),X())},[f,e,o,m]),p.useEffect(()=>{o&&m&&(console.log("[HMS] Successfully connected to voice channel!"),g(!1),G({title:"Voice connected",description:`You're now in a voice channel with ${r||"teammate"}`}))},[o,m,r,G]),p.useEffect(()=>{if(!o)return;const A=async()=>{if(document.visibilityState==="visible"&&!N.current)try{"wakeLock"in navigator&&(N.current=await navigator.wakeLock.request("screen"),console.log("[Wake Lock] Re-acquired after tab became visible"))}catch(F){console.warn("[Wake Lock] Could not re-acquire wake lock:",F)}};return document.addEventListener("visibilitychange",A),N.current&&N.current.addEventListener("release",()=>{console.log("[Wake Lock] Released by system"),N.current=null}),()=>{document.removeEventListener("visibilitychange",A)}},[o]),p.useEffect(()=>{if(u&&u.length>0){const A=u[u.length-1];if(console.log("[HMS] Notification:",A),A.type===fo.ERROR){const F=A.data;console.error("[HMS] Error received:",{code:F==null?void 0:F.code,message:F==null?void 0:F.message,description:F==null?void 0:F.description,isTerminal:F==null?void 0:F.isTerminal,action:F==null?void 0:F.action}),m&&(g(!1),G({title:"Connection failed",description:`${(F==null?void 0:F.message)||"Could not connect to voice channel"} (Code: ${F==null?void 0:F.code})`,variant:"destructive"}))}A.type===fo.PEER_JOINED&&console.log("[HMS] Peer joined:",A.data),A.type===fo.PEER_LEFT&&console.log("[HMS] Peer left:",A.data)}},[u,m,G]);const X=async()=>{g(!0),O.current=!1;try{o&&(console.log("[HMS] Already connected to a room, leaving first..."),await i.leave(),h(null),await new Promise(q=>setTimeout(q,500)),G({title:"Switched channels",description:"Left previous voice call to join this conversation"})),console.log("[HMS] Requesting auth token for voice channel...");const A=await fetch(lt("/api/voice/join"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:e})});if(!A.ok){const q=await A.json().catch(()=>({message:"Failed to join voice channel"}));throw A.status===503?new Error("Voice service is not configured on this server. Please contact support or set up 100ms credentials."):new Error(q.message||"Failed to join voice channel")}const F=await A.json();console.log("[HMS] Auth token received, room ID:",F.roomId),console.log("[HMS] Attempting to join room..."),await i.join({userName:t,authToken:F.token,settings:{isAudioMuted:!1,isVideoMuted:!0},rememberDeviceSelection:!0});try{"wakeLock"in navigator&&(N.current=await navigator.wakeLock.request("screen"),console.log("[Wake Lock] Acquired to prevent audio interruption in background"))}catch(q){console.warn("[Wake Lock] Could not acquire wake lock:",q)}console.log("[HMS] Join request sent successfully"),h(e,"individual"),G({title:"Connecting...",description:"Joining voice channel"})}catch(A){console.error("[HMS] Error in joinChannel:",A),g(!1);const F=A instanceof Error?A.message:"Could not connect to voice channel";G({title:"Voice channel unavailable",description:F,variant:"destructive"})}},Q=async()=>{try{O.current=!0,await i.leave(),h(null),N.current&&(await N.current.release(),N.current=null,console.log("[Wake Lock] Released")),await fetch(lt("/api/voice/leave"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:e})}),G({title:"Left voice channel",description:"You've disconnected from the voice channel"})}catch(A){console.error("Error leaving channel:",A)}},V=async()=>{await i.setLocalAudioEnabled(!c)},te=async()=>{const A=!C;I(A);for(const F of H)F.audioTrack&&(A?(w(q=>F.id in q?q:{...q,[F.id]:100}),await i.setVolume(0,F.audioTrack)):await i.setVolume(b[F.id]||100,F.audioTrack));G({title:A?"Incoming audio muted":"Incoming audio unmuted",description:A?"You won't hear others in the call":"You can now hear others in the call"})};p.useEffect(()=>{if(!o)return;(async()=>{for(const F of H)F.audioTrack&&C&&(w(q=>F.id in q?q:{...q,[F.id]:100}),await i.setVolume(0,F.audioTrack))})()},[l.map(A=>A.id).join(","),C,o,i]),p.useEffect(()=>{const A=new Set(H.map(F=>F.id));w(F=>{const q={};for(const[P,j]of Object.entries(F))A.has(P)&&(q[P]=j);return q})},[H.map(A=>A.id).join(",")]);const k=async()=>{try{d?(await i.setScreenShareEnabled(!1),G({title:"Screen sharing stopped",description:"Your screen is no longer being shared"})):(await i.setScreenShareEnabled(!0),G({title:"Screen sharing started",description:"Your screen is now visible to others in the channel"}))}catch(A){console.error("Error toggling screen share:",A);const F=A instanceof Error?A.message:"Failed to start screen sharing";G({title:"Screen share error",description:F.includes("Permission denied")?"Screen sharing permission was denied. Please allow screen sharing to continue.":"Failed to start screen sharing. Please try again.",variant:"destructive"})}},E=l.filter(A=>A.auxiliaryTracks.length>0);p.useEffect(()=>{if(s)return;const A=l.find(F=>F.id===v);if(A&&R.current&&A.auxiliaryTracks[0]){const F=A.auxiliaryTracks[0],q=typeof F=="string"?F:F.id;if(q)return i.attachVideo(q,R.current),()=>{R.current&&i.detachVideo(q,R.current)}}},[v,l,i,s]),p.useEffect(()=>{if(s)return;const A=l.find(F=>F.id===S);if(A&&L.current&&A.auxiliaryTracks[0]){const F=A.auxiliaryTracks[0],q=typeof F=="string"?F:F.id;if(q)return i.attachVideo(q,L.current),()=>{L.current&&i.detachVideo(q,L.current)}}},[S,l,i,s]);const M=o&&(f==null?void 0:f.id)===e&&(f==null?void 0:f.type)==="individual";return a.jsxs("div",{className:"space-y-4",children:[M?a.jsx(Ne,{className:"p-4 bg-primary/5 border-primary/20",children:a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"p-2 bg-primary rounded-full",children:a.jsx(Vr,{className:"h-4 w-4 text-primary-foreground"})}),a.jsx("div",{className:"absolute -bottom-1 -right-1 h-3 w-3 bg-emerald-500 dark:bg-emerald-400 rounded-full border-2 border-background animate-pulse"})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-sm",children:"In Voice Channel"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Connected with ",r||"teammate"]})]})]}),a.jsxs(ee,{size:"sm",variant:"destructive",onClick:Q,"data-testid":"button-leave-voice",children:[a.jsx(GD,{className:"h-4 w-4 mr-1"}),"Leave"]})]}),a.jsxs("div",{className:"flex gap-2 pt-2",children:[a.jsx(ee,{size:"sm",variant:c?"secondary":"destructive",onClick:V,className:"flex-1","data-testid":"button-toggle-mic",children:c?a.jsxs(a.Fragment,{children:[a.jsx(wd,{className:"h-4 w-4 mr-1"}),"Mute"]}):a.jsxs(a.Fragment,{children:[a.jsx(xl,{className:"h-4 w-4 mr-1"}),"Unmute"]})}),a.jsx(ee,{size:"sm",variant:C?"destructive":"secondary",onClick:te,className:"flex-1","data-testid":"button-toggle-speaker",title:C?"Unmute incoming audio":"Mute incoming audio",children:C?a.jsxs(a.Fragment,{children:[a.jsx(KD,{className:"h-4 w-4 mr-1"}),"Speaker Off"]}):a.jsxs(a.Fragment,{children:[a.jsx(N0,{className:"h-4 w-4 mr-1"}),"Speaker"]})}),!s&&a.jsx(ee,{size:"sm",variant:d?"default":"secondary",onClick:k,className:"flex-1","data-testid":"button-toggle-screenshare",children:d?a.jsxs(a.Fragment,{children:[a.jsx(zD,{className:"h-4 w-4 mr-1"}),"Stop Sharing"]}):a.jsxs(a.Fragment,{children:[a.jsx(Xu,{className:"h-4 w-4 mr-1"}),"Share Screen"]})})]}),re?a.jsx("div",{className:"bg-emerald-500/10 border-2 border-emerald-500/30 rounded-lg p-3",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"h-3 w-3 bg-emerald-500 rounded-full animate-pulse","data-testid":"teammate-ready-indicator"}),a.jsxs("span",{className:"font-semibold text-sm text-emerald-600 dark:text-emerald-400",children:[r||"Teammate"," is in the voice channel"]})]})}):a.jsx("div",{className:"bg-yellow-500/10 border-2 border-yellow-500/30 rounded-lg p-4 animate-pulse",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("div",{className:"relative",children:[a.jsx(Vr,{className:"h-8 w-8 text-yellow-600 dark:text-yellow-500"}),a.jsx("div",{className:"absolute inset-0 h-8 w-8 bg-yellow-500/30 rounded-full animate-ping"})]}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("h4",{className:"font-semibold text-sm text-yellow-700 dark:text-yellow-500",children:["Waiting for ",r||"teammate","..."]}),a.jsx("p",{className:"text-xs text-yellow-600/90 dark:text-yellow-500/80",children:"You're in the voice channel. Waiting for them to join."})]})]})}),a.jsx("div",{className:"text-xs text-muted-foreground bg-background/50 rounded p-2",children:a.jsxs("p",{className:"flex items-center gap-1",children:[a.jsx("span",{className:"font-semibold",children:"Note:"}),"Voice channels use 100ms for reliable, high-quality voice communication."]})})]})}):a.jsx(Ne,{className:"p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-primary/10 rounded-full",children:a.jsx(Vr,{className:"h-5 w-5 text-primary"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-sm",children:"Voice Channel"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Start a voice channel with ",r||"teammate"]})]})]}),a.jsx(ee,{size:"sm",onClick:X,disabled:m,"data-testid":"button-join-voice",children:m?"Joining...":"Join Voice"})]})}),!s&&M&&E.length>0&&a.jsxs("div",{className:"space-y-2",children:[a.jsx("h3",{className:"font-semibold text-sm",children:"Screen Shares"}),a.jsx("div",{className:"grid gap-2",children:E.map(A=>a.jsx(Ne,{className:"p-3",children:a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Xu,{className:"h-4 w-4 text-primary"}),a.jsx("span",{className:"text-sm font-medium",children:A.name===t?"Your screen":`${A.name}'s screen`})]}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx(ee,{size:"sm",variant:"outline",onClick:()=>x(A.id),"data-testid":`button-fullscreen-${A.id}`,children:a.jsx(UD,{className:"h-3 w-3"})}),a.jsx(ee,{size:"sm",variant:"outline",onClick:()=>y(A.id),"data-testid":`button-minimize-${A.id}`,children:a.jsx(BD,{className:"h-3 w-3"})})]})]})},A.id))})]}),!s&&v&&a.jsx(gr,{open:v!==null,onOpenChange:A=>!A&&x(null),children:a.jsxs(nr,{className:"max-w-[95vw] h-[95vh] flex flex-col",children:[a.jsx(rr,{children:a.jsxs(sr,{children:[r,"'s Screen Share"]})}),a.jsx("div",{className:"flex-1 bg-black rounded-lg overflow-hidden min-h-0",children:a.jsx("video",{ref:R,autoPlay:!0,muted:!0,playsInline:!0,controls:!0,className:"w-full h-full object-contain","data-testid":"fullscreen-video"})})]})}),!s&&S&&a.jsxs("div",{className:"fixed bottom-4 right-4 w-96 bg-background border-2 border-primary rounded-lg shadow-2xl z-[9999]","data-testid":"minimized-screenshare",style:{position:"fixed"},children:[a.jsxs("div",{className:"flex items-center justify-between p-3 bg-primary text-primary-foreground rounded-t-lg",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Xu,{className:"h-4 w-4"}),a.jsxs("span",{className:"text-sm font-medium",children:[r,"'s Screen Share"]})]}),a.jsx(ee,{size:"sm",variant:"ghost",onClick:()=>y(null),className:"h-7 w-7 p-0 hover:bg-primary-foreground/20","data-testid":"button-close-minimized",children:""})]}),a.jsx("div",{className:"aspect-video bg-black rounded-b-lg overflow-hidden",children:a.jsx("video",{ref:L,autoPlay:!0,muted:!0,playsInline:!0,controls:!0,className:"w-full h-full object-contain","data-testid":"minimized-video"})})]})]})}function lhe(e){if(!e)return"Unknown";const t=new Date,n=new Date(e),r=t.getTime()-n.getTime(),s=Math.floor(r/(1e3*60)),i=Math.floor(r/(1e3*60*60)),o=Math.floor(r/(1e3*60*60*24));return s<1?"Just connected":s<60?`${s} minute${s>1?"s":""} ago`:i<24?`${i} hour${i>1?"s":""} ago`:`${o} day${o>1?"s":""} ago`}function che({currentUserId:e}){var A,F,q,P;const{lastMessage:t}=cy(),[n,r]=p.useState(null),[s,i]=p.useState(null),[o,l]=p.useState(null),[c,d]=p.useState("all"),[u,h]=p.useState("all"),[f,m]=p.useState(!1),[g,v]=p.useState(!0),[x,S]=p.useState(""),{toast:y}=Wn(),{getContainerClass:b}=Ri(),{waitingCallerGamertags:w}=eT();if(!e)return a.jsx("div",{className:"p-4 text-center text-muted-foreground",children:"Loading user data..."});const{data:C=[],isLoading:I,isFetching:R,refetch:L}=Pt({queryKey:["/api/user/connections"],queryFn:async()=>{const j=await fetch(lt("/api/user/connections"),{credentials:"include"});if(!j.ok)throw new Error("Failed to fetch connections");return j.json()},retry:!1}),{data:N}=Pt({queryKey:["/api/users",s],queryFn:async()=>{if(!s)throw new Error("No user ID");const j=await fetch(lt(`/api/users/${s}`),{credentials:"include"});if(!j.ok)throw new Error("Failed to fetch user");return j.json()},enabled:!!s}),{data:O}=Pt({queryKey:["/api/match-requests",o],queryFn:async()=>{if(!o)throw new Error("No match ID");const j=await fetch(lt(`/api/match-requests/${o}`),{credentials:"include"});if(!j.ok)throw new Error("Failed to fetch match request");return j.json()},enabled:!!o}),G=()=>{L()};p.useEffect(()=>{if(!t)return;const{type:j}=t;(j==="match_connection_created"||j==="match_connection_updated"||j==="match_connection_deleted")&&ze.invalidateQueries({queryKey:["/api/user/connections"]})},[t]);const H=Nt({mutationFn:async({connectionId:j,status:$})=>await kt("PATCH",`/api/match-connections/${j}/status`,{status:$}),onSuccess:(j,$)=>{ze.invalidateQueries({queryKey:["/api/user/connections"]}),y({title:$.status==="accepted"?"Application Accepted":"Application Declined",description:$.status==="accepted"?"You can now chat and join voice channels with this player":"The application has been declined"})},onError:()=>{y({title:"Error",description:"Failed to update application status",variant:"destructive"})}}),re=Nt({mutationFn:async j=>await kt("DELETE",`/api/match-connections/${j}`,{}),onSuccess:()=>{ze.invalidateQueries({queryKey:["/api/user/connections"]}),y({title:"Connection Deleted",description:"The match connection has been deleted"})},onError:()=>{y({title:"Error",description:"Failed to delete match connection",variant:"destructive"})}}),X=j=>c==="all"?!0:c==="connection"?"senderId"in j:"gameMode"in j&&j.gameMode?j.gameMode===c:!1,Q=j=>{if(!x)return!0;const W=j.requesterId===e?j.accepterGamertag:j.requesterGamertag;return(W==null?void 0:W.toLowerCase().includes(x.toLowerCase()))||!1},V=C.filter(j=>j.status==="pending"&&j.accepterId===e).filter(X).filter(Q),te=C.filter(j=>j.status==="pending"&&j.requesterId===e).filter(X).filter(Q),k=C.filter(j=>j.status==="accepted").filter(X).filter(Q),E=()=>a.jsx("div",{className:"space-y-4",children:[...Array(3)].map((j,$)=>a.jsxs(Ne,{children:[a.jsx(an,{className:"pb-3",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(cn,{className:"h-12 w-12 rounded-full"}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(cn,{className:"h-4 w-32"}),a.jsx(cn,{className:"h-3 w-24"})]})]}),a.jsx(cn,{className:"h-6 w-20"})]})}),a.jsxs(Fe,{children:[a.jsx(cn,{className:"h-4 w-full mb-2"}),a.jsxs("div",{className:"flex gap-2 mb-3",children:[a.jsx(cn,{className:"h-5 w-16"}),a.jsx(cn,{className:"h-5 w-12"})]}),a.jsx(cn,{className:"h-3 w-20"})]})]},$))});if(I)return a.jsxs("div",{className:`${b()} mx-auto`,children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Jt,{className:"h-6 w-6 text-primary"}),a.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Matches"})]}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1 ml-9",children:"Manage your match connections and applications"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx($e,{variant:"secondary",className:"text-sm",children:"Loading..."}),a.jsx(ee,{variant:"outline",size:"sm",onClick:G,disabled:R,"data-testid":"button-refresh-connections",className:`transition-transform ${R?"scale-95":"hover:scale-105"}`,children:a.jsx(bl,{className:`h-4 w-4 ${R?"animate-spin":""}`})})]})]}),a.jsx(E,{})]});const M=(j,$,W)=>{const ie=lhe(j.createdAt),Z=W?j.accepterId:j.requesterId,ne=W?j.accepterGamertag:j.requesterGamertag,ae=W?j.accepterProfileImageUrl:j.requesterProfileImageUrl,ge=ne||Z,Le=ae||void 0;return a.jsxs(Ne,{className:"hover:shadow-md transition-shadow","data-testid":`connection-card-${j.id}`,children:[a.jsx(an,{className:"pb-3",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsx(xi,{userId:Z,gamertag:ge,profileImageUrl:Le,currentUserId:e,trigger:a.jsxs("button",{className:"flex items-center gap-3 hover:opacity-80 transition-opacity w-full text-left","data-testid":`button-view-profile-${Z}`,children:[a.jsxs("div",{className:"relative",children:[a.jsxs(Tn,{className:"h-10 w-10",children:[a.jsx(tr,{src:Le,alt:ge}),a.jsx(Cn,{className:"bg-primary text-primary-foreground font-semibold",children:(ge||"U").slice(0,2).toUpperCase()})]}),w.includes(ge)&&a.jsx("div",{className:"absolute -top-1 -left-1 h-5 w-5 bg-amber-500 dark:bg-amber-400 rounded-full border-2 border-background flex items-center justify-center animate-pulse","data-testid":`waiting-call-indicator-${Z}`,title:"Waiting in voice call",children:a.jsx(Vr,{className:"h-3 w-3 text-white"})})]}),a.jsxs("div",{children:[a.jsx("div",{className:"flex items-center gap-2",children:a.jsx("h3",{className:"font-semibold text-foreground underline-offset-4 hover:underline",children:ge})}),a.jsx("p",{className:"text-sm text-muted-foreground",children:W?"You applied to their match":"They applied to your post"})]})]})}),a.jsx($e,{variant:j.status==="accepted"?"default":"secondary",className:"text-xs","data-testid":`connection-status-${j.id}`,children:j.status})]})}),a.jsx(Fe,{children:a.jsxs("div",{className:"flex items-center justify-between gap-3 text-sm text-muted-foreground",children:[a.jsxs("div",{className:"flex-1 min-w-0 flex items-center gap-4 truncate",children:[a.jsxs("div",{className:"flex items-center gap-1 whitespace-nowrap",children:[a.jsx(LD,{className:"h-3 w-3 flex-shrink-0"}),a.jsx("span",{className:"truncate",children:ie})]}),a.jsxs("div",{className:"flex items-center gap-1 whitespace-nowrap",children:[a.jsx(il,{className:"h-3 w-3 flex-shrink-0"}),a.jsxs("span",{className:"truncate",children:["Match ID: ",j.requestId.slice(-6)]})]})]}),$==="confirm"&&a.jsxs("div",{className:"flex-shrink-0 flex items-center gap-2",children:[a.jsxs(ee,{variant:"ghost",size:"sm",className:"gap-1",onClick:()=>l(j.requestId),"data-testid":`button-match-details-${j.id}`,children:[a.jsx(Kp,{className:"h-4 w-4"}),a.jsx("span",{className:"text-xs",children:"Match Details"})]}),a.jsxs(ee,{variant:"default",size:"sm",className:"gap-1",onClick:()=>H.mutate({connectionId:j.id,status:"accepted"}),disabled:H.isPending,"data-testid":`button-confirm-${j.id}`,children:[a.jsx(nw,{className:"h-4 w-4"}),"Confirm"]}),a.jsxs(ee,{variant:"outline",size:"sm",className:"gap-1",onClick:()=>H.mutate({connectionId:j.id,status:"declined"}),disabled:H.isPending,"data-testid":`button-decline-${j.id}`,children:[a.jsx(Ot,{className:"h-4 w-4"}),"Decline"]})]}),$==="waiting"&&a.jsxs("div",{className:"flex-shrink-0 flex items-center gap-2",children:[a.jsxs(ee,{variant:"ghost",size:"sm",className:"gap-1",onClick:()=>l(j.requestId),"data-testid":`button-match-details-${j.id}`,children:[a.jsx(Kp,{className:"h-4 w-4"}),a.jsx("span",{className:"text-xs",children:"Match Details"})]}),a.jsx($e,{variant:"secondary",className:"text-xs whitespace-nowrap",children:"Waiting for confirmation"}),a.jsxs(ee,{variant:"ghost",size:"sm",className:"gap-1 text-destructive hover:text-destructive",onClick:()=>re.mutate(j.id),disabled:re.isPending,"data-testid":`button-delete-connection-${j.id}`,children:[a.jsx(So,{className:"h-4 w-4"}),"Cancel"]})]}),$==="chat"&&a.jsxs(gr,{open:n===j.id,onOpenChange:Ct=>r(Ct?j.id:null),children:[a.jsxs("div",{className:"flex-shrink-0 flex items-center gap-2",children:[a.jsxs(ee,{variant:"ghost",size:"sm",className:"gap-1 text-primary hover:text-primary",onClick:()=>r(j.id),"data-testid":`button-open-connection-${j.id}`,children:[a.jsx(gi,{className:"h-4 w-4"}),a.jsx(Vr,{className:"h-4 w-4"}),a.jsx("span",{className:"text-xs",children:"Chat & Voice"})]}),a.jsxs(ee,{variant:"ghost",size:"sm",className:"gap-1",onClick:()=>l(j.requestId),"data-testid":`button-match-details-${j.id}`,children:[a.jsx(Kp,{className:"h-4 w-4"}),a.jsx("span",{className:"text-xs",children:"Match Details"})]}),a.jsxs(ee,{variant:"ghost",size:"sm",className:"gap-1 text-destructive hover:text-destructive",onClick:()=>re.mutate(j.id),disabled:re.isPending,"data-testid":`button-disconnect-${j.id}`,children:[a.jsx(So,{className:"h-4 w-4"}),"Disconnect"]})]}),a.jsxs(nr,{className:"max-w-lg h-[600px] flex flex-col p-0",children:[a.jsx(rr,{className:"p-4 pb-3 border-b",children:a.jsxs(sr,{children:["Connect with ",ge]})}),a.jsxs(Ll,{defaultValue:"chat",className:"flex-1 flex flex-col overflow-hidden",children:[a.jsxs(_o,{className:"mx-4 mt-2",children:[a.jsxs(_r,{value:"chat",className:"flex-1","data-testid":"tab-chat",children:[a.jsx(gi,{className:"h-4 w-4 mr-1"}),"Chat"]}),a.jsxs(_r,{value:"voice",className:"flex-1","data-testid":"tab-voice",children:[a.jsx(Vr,{className:"h-4 w-4 mr-1"}),"Voice"]})]}),a.jsx(si,{value:"chat",className:"flex-1 overflow-hidden m-0",children:a.jsx(eB,{connectionId:j.id,currentUserId:e,otherUserId:Z,otherUserName:ge})}),a.jsx(si,{value:"voice",className:"p-4",children:a.jsx(tB,{connectionId:j.id,currentUserId:e,otherUserId:Z,otherUserName:ge,hideScreenShare:!0})})]})]})]})]})})]},j.id)};return C.length===0?a.jsxs("div",{className:`${b()} mx-auto`,children:[a.jsxs("div",{className:"mb-6 flex items-start justify-between",children:[a.jsxs("div",{children:[a.jsxs("h1",{className:"text-2xl font-bold text-foreground mb-2 flex items-center gap-2",children:[a.jsx(Jt,{className:"h-6 w-6 text-primary"}),"Matches"]}),a.jsx("p",{className:"text-muted-foreground",children:"Manage your match connections and applications"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx($e,{variant:"secondary",className:"text-sm",children:"0 connections"}),a.jsx(ee,{variant:"outline",size:"sm",onClick:G,disabled:R,"data-testid":"button-refresh-connections",className:`transition-transform ${R?"scale-95":"hover:scale-105"}`,children:a.jsx(bl,{className:`h-4 w-4 ${R?"animate-spin":""}`})})]})]}),a.jsx(Ne,{className:"mb-6",children:a.jsx(Fe,{className:"p-4",children:a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(wo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground pointer-events-none z-10"}),a.jsx(tt,{type:"text",placeholder:"Search by name or gamertag...",value:x,onChange:j=>S(j.target.value),className:"pl-10 overflow-x-auto whitespace-nowrap",style:{textOverflow:"clip",scrollbarWidth:"none",msOverflowStyle:"none"},"data-testid":"input-search-connections"})]}),a.jsxs(vS,{open:f,onOpenChange:m,children:[a.jsx(yS,{asChild:!0,children:a.jsxs(ee,{variant:"outline",size:"default","data-testid":"button-toggle-request-filters",children:[a.jsx(qm,{className:"h-4 w-4 mr-1"}),"Filter ",c!=="all"&&`(${c})`]})}),a.jsx($g,{className:"w-64","data-testid":"popover-request-filters",children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{children:a.jsx("h4",{className:"font-semibold mb-3",children:"Filter Requests"})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Request Type"}),a.jsxs(In,{value:c,onValueChange:d,children:[a.jsx(wn,{"data-testid":"select-request-type",children:a.jsx(An,{placeholder:"All Requests"})}),a.jsxs(Sn,{children:[a.jsx(at,{value:"all",children:"All Applications"}),a.jsx(at,{value:"1v1",children:"1v1 Match Applications"}),a.jsx(at,{value:"2v2",children:"2v2 Match Applications"}),a.jsx(at,{value:"3v3",children:"3v3 Match Applications"}),a.jsx(at,{value:"squad",children:"Team/Squad Finder"})]})]})]})]})})]})]})})}),a.jsx(Ne,{className:"border-dashed",children:a.jsxs(Fe,{className:"text-center py-12",children:[a.jsx(Jt,{className:"h-16 w-16 text-muted-foreground/50 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No connections yet"}),a.jsx("p",{className:"text-muted-foreground max-w-md mx-auto mb-4",children:"Apply to a match on the Feed tab to get started!"}),a.jsx("p",{className:"text-sm text-muted-foreground/70 max-w-md mx-auto",children:"When you apply to matches or others apply to yours, your gaming connections will appear here."})]})})]}):a.jsxs("div",{className:`${b()} mx-auto`,children:[a.jsxs("div",{className:"mb-6 flex items-start justify-between",children:[a.jsxs("div",{children:[a.jsxs("h1",{className:"text-2xl font-bold text-foreground mb-2 flex items-center gap-2",children:[a.jsx(Jt,{className:"h-6 w-6 text-primary"}),"Matches"]}),a.jsx("p",{className:"text-muted-foreground",children:"Manage your match connections and applications"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs($e,{variant:"secondary",className:"text-sm",children:[C.length," total"]}),a.jsx(ee,{variant:"outline",size:"sm",onClick:G,disabled:R,"data-testid":"button-refresh-connections",className:`transition-transform ${R?"scale-95":"hover:scale-105"}`,children:a.jsx(bl,{className:`h-4 w-4 ${R?"animate-spin":""}`})})]})]}),a.jsx(Ne,{className:"mb-6",children:a.jsx(Fe,{className:"p-4",children:a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(wo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground pointer-events-none z-10"}),a.jsx(tt,{type:"text",placeholder:"Search by name or gamertag...",value:x,onChange:j=>S(j.target.value),className:"pl-10 overflow-x-auto whitespace-nowrap",style:{textOverflow:"clip",scrollbarWidth:"none",msOverflowStyle:"none"},"data-testid":"input-search-connections"})]}),a.jsxs(vS,{open:f,onOpenChange:m,children:[a.jsx(yS,{asChild:!0,children:a.jsxs(ee,{variant:"outline",size:"default","data-testid":"button-toggle-request-filters",children:[a.jsx(qm,{className:"h-4 w-4 mr-1"}),"Filter ",c!=="all"&&`(${c})`]})}),a.jsx($g,{className:"w-64","data-testid":"popover-request-filters",children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{children:a.jsx("h4",{className:"font-semibold mb-3",children:"Filter Requests"})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Request Type"}),a.jsxs(In,{value:c,onValueChange:d,children:[a.jsx(wn,{"data-testid":"select-request-type",children:a.jsx(An,{placeholder:"All Requests"})}),a.jsxs(Sn,{children:[a.jsx(at,{value:"all",children:"All Applications"}),a.jsx(at,{value:"1v1",children:"1v1 Match Applications"}),a.jsx(at,{value:"2v2",children:"2v2 Match Applications"}),a.jsx(at,{value:"3v3",children:"3v3 Match Applications"}),a.jsx(at,{value:"squad",children:"Team/Squad Finder"})]})]})]})]})})]})]})})}),a.jsxs("div",{className:"space-y-8",children:[k.length>0&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("h2",{className:"text-lg font-semibold text-foreground flex items-center gap-2",children:[a.jsx(gi,{className:"h-5 w-5 text-primary"}),"Match Connections"]}),a.jsxs($e,{variant:"default",className:"text-xs",children:[k.length," active"]})]}),a.jsx("div",{className:"space-y-3",children:k.map(j=>M(j,"chat",j.requesterId===e))})]}),(V.length>0||te.length>0)&&a.jsx(Y5,{open:g,onOpenChange:v,children:a.jsxs(Ne,{className:"p-4",children:[a.jsx(X5,{asChild:!0,children:a.jsxs(ee,{variant:"ghost",className:"w-full flex items-center justify-between p-2 hover:bg-accent","data-testid":"button-toggle-pending-requests",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(il,{className:"h-5 w-5 text-primary"}),a.jsx("h2",{className:"text-lg font-semibold",children:"Pending Match Applications"}),a.jsxs($e,{variant:"default",className:"text-xs",children:[V.length+te.length," total"]})]}),g?a.jsx(_0,{className:"h-5 w-5 text-muted-foreground"}):a.jsx(vf,{className:"h-5 w-5 text-muted-foreground"})]})}),a.jsxs(Z5,{className:"space-y-6 mt-4",children:[V.length>0&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h3",{className:"text-md font-semibold text-foreground flex items-center gap-2 px-2",children:[a.jsx(nw,{className:"h-4 w-4 text-green-500"}),"Received Applications",a.jsx($e,{variant:"outline",className:"text-xs",children:V.length})]}),a.jsxs("div",{className:"space-y-3 pl-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(il,{className:"h-4 w-4 text-muted-foreground"}),a.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Match Applications"}),a.jsx($e,{variant:"secondary",className:"text-xs",children:V.length})]}),V.map(j=>M(j,"confirm",!1))]})]}),te.length>0&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h3",{className:"text-md font-semibold text-foreground flex items-center gap-2 px-2",children:[a.jsx(Jt,{className:"h-4 w-4 text-blue-500"}),"Sent Applications",a.jsx($e,{variant:"outline",className:"text-xs",children:te.length})]}),a.jsxs("div",{className:"space-y-3 pl-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(il,{className:"h-4 w-4 text-muted-foreground"}),a.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Match Applications"}),a.jsx($e,{variant:"secondary",className:"text-xs",children:te.length})]}),te.map(j=>M(j,"waiting",!0))]})]})]})]})})]}),a.jsx(gr,{open:!!s,onOpenChange:j=>!j&&i(null),children:a.jsxs(nr,{className:"sm:max-w-md",children:[a.jsxs(rr,{children:[a.jsx(sr,{children:"User Profile"}),a.jsx($h,{children:"View gamer profile details"})]}),N&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs(Tn,{className:"h-20 w-20",children:[a.jsx(tr,{src:N.profileImageUrl||void 0}),a.jsx(Cn,{className:"bg-primary/10 text-primary text-2xl font-semibold",children:((F=(A=N.gamertag)==null?void 0:A[0])==null?void 0:F.toUpperCase())||((P=(q=N.firstName)==null?void 0:q[0])==null?void 0:P.toUpperCase())||"?"})]}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-xl font-bold",children:N.gamertag||N.firstName}),a.jsx("p",{className:"text-sm text-muted-foreground",children:N.email})]})]}),N.bio&&a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold mb-1",children:"Bio"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:N.bio})]}),N.preferredGames&&N.preferredGames.length>0&&a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold mb-2",children:"Preferred Games"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:N.preferredGames.map((j,$)=>a.jsx($e,{variant:"secondary",children:j},$))})]}),N.location&&a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold mb-1",children:"Location"}),a.jsx($e,{variant:"outline",children:N.location})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[N.age&&a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold mb-1 text-sm",children:"Age"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:N.age})]}),N.language&&a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold mb-1 text-sm",children:"Language"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:N.language})]})]})]})]})}),a.jsx(gr,{open:!!o,onOpenChange:j=>!j&&l(null),children:a.jsxs(nr,{className:"sm:max-w-md",children:[a.jsxs(rr,{children:[a.jsx(sr,{children:"Match Request Details"}),a.jsx($h,{children:"Original match request information"})]}),O&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-sm text-muted-foreground",children:"Game"}),a.jsx("p",{className:"text-lg font-semibold",children:O.gameName})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-sm text-muted-foreground",children:"Mode"}),a.jsx($e,{variant:"secondary",children:O.gameMode})]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx($e,{variant:O.matchType==="lfg"?"default":"secondary",children:O.matchType==="lfg"?"Looking for Group":"Looking for Opponent"}),a.jsx($e,{variant:"outline",children:O.duration==="short-term"?"Short-term":"Long-term"})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-sm text-muted-foreground mb-1",children:"Description"}),a.jsx("p",{className:"text-sm",children:O.description})]}),O.region&&a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-sm text-muted-foreground mb-1",children:"Region"}),a.jsx($e,{variant:"outline",children:O.region})]}),O.tournamentName&&a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-sm text-muted-foreground mb-1",children:"Tournament"}),a.jsx("p",{className:"text-sm",children:O.tournamentName})]}),a.jsxs("div",{className:"text-xs text-muted-foreground pt-2 border-t",children:["Match ID: ",O.id]})]})]})})]})}function nB(){const[e,t]=p.useState(new Set),[n,r]=p.useState(new Set),{lastMessage:s}=cy();return p.useEffect(()=>{if(!s)return;const{type:l,data:c,userId:d}=s;l==="user_online"&&d?t(u=>new Set(u).add(d)):l==="user_offline"&&d?(t(u=>{const h=new Set(u);return h.delete(d),h}),r(u=>{const h=new Set(u);return h.delete(d),h})):l==="voice_channel_ready"&&(c!=null&&c.userId)?r(u=>new Set(u).add(c.userId)):l==="voice_channel_left"&&(c!=null&&c.userId)&&r(u=>{const h=new Set(u);return h.delete(c.userId),h})},[s]),{onlineUsers:e,isUserOnline:l=>e.has(l),usersInVoice:n,isUserInVoice:l=>n.has(l)}}function zx(e){if(!e)return"Unknown";const t=new Date,n=new Date(e),r=t.getTime()-n.getTime(),s=Math.floor(r/(1e3*60)),i=Math.floor(r/(1e3*60*60)),o=Math.floor(r/(1e3*60*60*24));return s<1?"Just now":s<60?`${s}m ago`:i<24?`${i}h ago`:`${o}d ago`}function dhe({currentUserId:e,onNavigateToVoiceChannels:t}){const[n,r]=p.useState(null),[s,i]=p.useState("chat"),[o,l]=p.useState(""),[c,d]=p.useState(!0),{toast:u}=Wn(),{isUserOnline:h,isUserInVoice:f}=nB(),{getContainerClass:m}=Ri(),{waitingCallerGamertags:g}=eT();if(!e)return a.jsx("div",{className:"p-4 text-center text-muted-foreground",children:"Loading user data..."});const{data:v=[],isLoading:x,isFetching:S,refetch:y}=Pt({queryKey:["/api/connection-requests"],retry:!1}),b=(V,te)=>{const k=V.senderId===te;return{id:k?V.receiverId:V.senderId,gamertag:k?V.receiverGamertag:V.senderGamertag,profileImageUrl:k?V.receiverProfileImageUrl:V.senderProfileImageUrl}},w=()=>{window.location.reload()},C=Nt({mutationFn:async V=>await kt("PATCH",`/api/connection-requests/${V}/status`,{status:"accepted"}),onSuccess:()=>{ze.invalidateQueries({queryKey:["/api/connection-requests"]}),u({title:"Connection Accepted",description:"You can now chat with this player"})},onError:()=>{u({title:"Error",description:"Failed to accept connection request",variant:"destructive"})}}),I=Nt({mutationFn:async V=>await kt("PATCH",`/api/connection-requests/${V}/status`,{status:"declined"}),onSuccess:()=>{ze.invalidateQueries({queryKey:["/api/connection-requests"]}),u({title:"Connection Declined",description:"The connection request has been declined"})},onError:()=>{u({title:"Error",description:"Failed to decline connection request",variant:"destructive"})}}),R=Nt({mutationFn:async V=>await kt("DELETE",`/api/connection-requests/${V}`),onSuccess:()=>{ze.invalidateQueries({queryKey:["/api/connection-requests"]}),ze.invalidateQueries({queryKey:["/api/user/connections"]}),r(null),u({title:"Connection Removed",description:"You have disconnected from this player"})},onError:()=>{u({title:"Error",description:"Failed to remove connection",variant:"destructive"})}}),L=v.filter(V=>V.status==="pending"&&V.receiverId===e),N=v.filter(V=>V.status==="pending"&&V.senderId===e),O=v.filter(V=>V.status==="accepted"),G=new Map;O.forEach(V=>{const k=b(V,e).id;(!G.has(k)||new Date(V.updatedAt).getTime()>new Date(G.get(k).updatedAt).getTime())&&G.set(k,V)});const H=Array.from(G.values()),re=V=>{if(!o.trim())return!0;const te=b(V,e);return(te.gamertag||te.id).toLowerCase().includes(o.toLowerCase())},X=H.filter(re),Q=()=>a.jsx("div",{className:"space-y-3",children:[...Array(4)].map((V,te)=>a.jsx(Ne,{className:"cursor-pointer hover:shadow-md transition-shadow",children:a.jsx(Fe,{className:"p-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(cn,{className:"h-12 w-12 rounded-full"}),a.jsxs("div",{className:"flex-1 space-y-2",children:[a.jsx(cn,{className:"h-4 w-32"}),a.jsx(cn,{className:"h-3 w-48"})]}),a.jsx(cn,{className:"h-3 w-12"})]})})},te))});return a.jsxs("div",{className:`${m()} mx-auto`,children:[a.jsxs("div",{className:"mb-6 flex items-start justify-between",children:[a.jsxs("div",{children:[a.jsxs("h1",{className:"text-2xl font-bold text-foreground mb-2 flex items-center gap-2",children:[a.jsx(gi,{className:"h-6 w-6 text-primary"}),"Messages"]}),a.jsx("p",{className:"text-muted-foreground",children:"Chat with your connections and teammates"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs($e,{variant:"secondary",className:"text-sm",children:[X.length," conversation",X.length!==1?"s":""]}),t&&a.jsxs(ee,{variant:"default",size:"sm",onClick:t,"data-testid":"button-voice-channels",children:[a.jsx(Jt,{className:"h-4 w-4 mr-1"}),"Voice Channels"]}),a.jsx(ee,{variant:"outline",size:"sm",onClick:w,disabled:S,"data-testid":"button-refresh-messages",className:`transition-transform ${S?"scale-95":"hover:scale-105"}`,children:a.jsx(bl,{className:`h-4 w-4 ${S?"animate-spin":""}`})})]})]}),a.jsx(Ne,{className:"mb-6",children:a.jsx(Fe,{className:"p-4",children:a.jsxs("div",{className:"relative",children:[a.jsx(wo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground pointer-events-none z-10"}),a.jsx(tt,{type:"text",placeholder:"Search by name or gamertag...",value:o,onChange:V=>l(V.target.value),className:"pl-10 overflow-x-auto whitespace-nowrap",style:{textOverflow:"clip",scrollbarWidth:"none",msOverflowStyle:"none"},"data-testid":"input-search-messages"})]})})}),x?a.jsx(Q,{}):a.jsxs("div",{className:"space-y-6",children:[X.length===0&&L.length===0&&N.length===0?a.jsx(Ne,{className:"border-dashed",children:a.jsxs(Fe,{className:"text-center py-12",children:[a.jsx(gi,{className:"h-16 w-16 text-muted-foreground/50 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No conversations yet"}),a.jsx("p",{className:"text-muted-foreground max-w-md mx-auto",children:"Connect with other players through the Discover tab to start chatting here."})]})}):X.length>0?a.jsx("div",{className:"space-y-3",children:X.map(V=>{const te=b(V,e),k=te.gamertag||te.id,E=te.profileImageUrl||void 0,M=te.id,A=zx(V.updatedAt);return a.jsx(Ne,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>{i("chat"),r(V)},"data-testid":`conversation-${V.id}`,children:a.jsx(Fe,{className:"p-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("div",{onClick:F=>F.stopPropagation(),className:"relative",children:[a.jsx(xi,{userId:M,gamertag:k,profileImageUrl:E,connectionId:V.id,currentUserId:e}),h(M)&&a.jsx("div",{className:"absolute -bottom-0.5 -right-0.5 h-3 w-3 bg-emerald-500 dark:bg-emerald-400 rounded-full border-2 border-background","data-testid":`online-indicator-${M}`}),f(M)&&a.jsx("div",{className:"absolute -top-1 -right-1 h-5 w-5 bg-blue-500 dark:bg-blue-400 rounded-full border-2 border-background flex items-center justify-center","data-testid":`voice-indicator-${M}`,children:a.jsx(Vr,{className:"h-3 w-3 text-white"})}),g.includes(k)&&a.jsx("div",{className:"absolute -top-1 -left-1 h-5 w-5 bg-amber-500 dark:bg-amber-400 rounded-full border-2 border-background flex items-center justify-center animate-pulse","data-testid":`waiting-call-indicator-${M}`,title:"Waiting in voice call",children:a.jsx(Vr,{className:"h-3 w-3 text-white"})})]}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("h3",{className:"font-semibold text-foreground truncate",children:k}),a.jsx("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:A})]}),a.jsx("p",{className:"text-sm text-muted-foreground truncate",children:f(M)?"Waiting in voice channel":"Message or voice call"})]}),a.jsxs("div",{className:"flex gap-2",onClick:F=>F.stopPropagation(),children:[a.jsx(ee,{size:"icon",variant:"ghost",onClick:()=>{i("chat"),r(V)},title:"Open messages","data-testid":`button-message-${V.id}`,children:a.jsx(gi,{className:"h-4 w-4"})}),a.jsx(ee,{size:"icon",variant:"ghost",onClick:()=>{i("voice"),r(V)},title:"Start voice call",className:f(M)?"text-primary animate-pulse":"","data-testid":`button-voice-${V.id}`,children:a.jsx(Vr,{className:"h-4 w-4"})})]})]})})},V.id)})}):null,(L.length>0||N.length>0)&&a.jsx(Y5,{open:c,onOpenChange:d,children:a.jsxs(Ne,{className:"p-4 bg-muted/30",children:[a.jsx(X5,{asChild:!0,children:a.jsxs(ee,{variant:"ghost",className:"w-full flex items-center justify-between p-2 hover:bg-accent","data-testid":"button-toggle-pending-requests",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Km,{className:"h-5 w-5 text-primary"}),a.jsx("h2",{className:"text-lg font-semibold",children:"Connection Requests"}),a.jsxs($e,{variant:"default",className:"text-xs",children:[L.length+N.length," pending"]})]}),c?a.jsx(_0,{className:"h-5 w-5 text-muted-foreground"}):a.jsx(vf,{className:"h-5 w-5 text-muted-foreground"})]})}),a.jsxs(Z5,{className:"space-y-4 mt-4",children:[L.length>0&&a.jsxs("div",{className:"space-y-3",children:[a.jsxs("h3",{className:"text-sm font-semibold text-muted-foreground px-2",children:["Incoming (",L.length,")"]}),L.map(V=>{const te=b(V,e),k=te.gamertag||te.id,E=te.profileImageUrl||void 0,M=te.id,A=zx(V.createdAt);return a.jsx(Ne,{className:"hover:shadow-md transition-shadow","data-testid":`connection-request-${V.id}`,children:a.jsx(Fe,{className:"p-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(xi,{userId:M,gamertag:k,profileImageUrl:E,currentUserId:e}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h3",{className:"font-semibold text-foreground truncate",children:k}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:["Wants to connect  ",A]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(ee,{variant:"default",size:"sm",className:"gap-1",onClick:()=>C.mutate(V.id),disabled:C.isPending||I.isPending,"data-testid":`button-accept-${V.id}`,children:[a.jsx(nw,{className:"h-4 w-4"}),"Accept"]}),a.jsxs(ee,{variant:"outline",size:"sm",className:"gap-1",onClick:()=>I.mutate(V.id),disabled:C.isPending||I.isPending,"data-testid":`button-decline-${V.id}`,children:[a.jsx(Ot,{className:"h-4 w-4"}),"Decline"]})]})]})})},V.id)})]}),N.length>0&&a.jsxs("div",{className:"space-y-3",children:[a.jsxs("h3",{className:"text-sm font-semibold text-muted-foreground px-2",children:["Sent (",N.length,")"]}),N.map(V=>{const te=b(V,e),k=te.gamertag||te.id,E=te.profileImageUrl||void 0,M=te.id,A=zx(V.createdAt);return a.jsx(Ne,{className:"hover:shadow-md transition-shadow","data-testid":`connection-sent-${V.id}`,children:a.jsx(Fe,{className:"p-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(xi,{userId:M,gamertag:k,profileImageUrl:E,currentUserId:e}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h3",{className:"font-semibold text-foreground truncate",children:k}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:["Request sent  ",A]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx($e,{variant:"secondary",className:"text-xs",children:"Pending"}),a.jsxs(ee,{variant:"ghost",size:"sm",className:"gap-1 text-destructive hover:text-destructive hover:bg-destructive/10",onClick:()=>R.mutate(V.id),disabled:R.isPending,"data-testid":`button-cancel-request-${V.id}`,children:[a.jsx(Ot,{className:"h-4 w-4"}),"Cancel"]})]})]})})},V.id)})]})]})]})})]}),a.jsx(gr,{open:!!n,onOpenChange:V=>!V&&r(null),children:a.jsx(nr,{className:"max-w-lg h-[600px] flex flex-col p-0",children:n&&(()=>{const V=b(n,e),te=V.gamertag||V.id,k=V.id;return a.jsxs(a.Fragment,{children:[a.jsxs(rr,{className:"p-4 pb-3 border-b",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs(sr,{children:["Chat with ",te]})}),a.jsx("div",{className:"pt-2",children:a.jsxs(v3,{children:[a.jsx(y3,{asChild:!0,children:a.jsxs(ee,{variant:"ghost",size:"sm",className:"gap-1 text-destructive hover:text-destructive hover:bg-destructive/10","data-testid":"button-disconnect",children:[a.jsx(HD,{className:"h-4 w-4"}),"Disconnect"]})}),a.jsxs(tT,{children:[a.jsxs(nT,{children:[a.jsxs(sT,{children:["Disconnect from ",te,"?"]}),a.jsxs(iT,{children:["This will remove your connection with ",te,". Your chat history will be lost, and you'll need to send a new connection request to reconnect."]})]}),a.jsxs(rT,{children:[a.jsx(oT,{"data-testid":"button-cancel-disconnect",children:"Cancel"}),a.jsx(aT,{onClick:()=>R.mutate(n.id),disabled:R.isPending,className:"bg-destructive hover:bg-destructive/90","data-testid":"button-confirm-disconnect",children:R.isPending?"Disconnecting...":"Disconnect"})]})]})]})})]}),a.jsxs(Ll,{value:s,onValueChange:E=>i(E),className:"flex-1 flex flex-col overflow-hidden",children:[a.jsxs(_o,{className:"mx-4 mt-2",children:[a.jsxs(_r,{value:"chat",className:"flex-1","data-testid":"tab-chat",children:[a.jsx(gi,{className:"h-4 w-4 mr-1"}),"Chat"]}),a.jsxs(_r,{value:"voice",className:"flex-1","data-testid":"tab-voice",children:[a.jsx(Vr,{className:"h-4 w-4 mr-1"}),"Voice"]})]}),a.jsx(si,{value:"chat",className:"flex-1 overflow-hidden m-0",children:a.jsx(eB,{connectionId:n.id,currentUserId:e,otherUserId:k,otherUserName:te})}),a.jsx(si,{value:"voice",className:"p-4",children:a.jsx(tB,{connectionId:n.id,currentUserId:e,otherUserId:k,otherUserName:te,hideScreenShare:!0})})]})]})})()})})]})}const uhe=["Valorant","League of Legends","CS2","Apex Legends","Rocket League","Overwatch 2","Dota 2","Fortnite","Call of Duty","FIFA 24"],hhe=["English","Spanish","French","German","Italian","Portuguese","Chinese","Japanese","Korean","Arabic","Hindi","Russian"],fhe=[{value:"male",label:"Male"},{value:"female",label:"Female"},{value:"custom",label:"Custom"},{value:"prefer_not_to_say",label:"Prefer not to say"}],phe=[{value:"5",label:"Within 5km"},{value:"10",label:"Within 10km"},{value:"25",label:"Within 25km"},{value:"50",label:"Within 50km"},{value:"100",label:"Within 100km"},{value:"global",label:"Global"}];function mhe({currentUserId:e}){const[t,n]=p.useState(""),[r,s]=p.useState("all"),[i,o]=p.useState("all"),[l,c]=p.useState("all"),[d,u]=p.useState("global"),[h,f]=p.useState(null),[m,g]=p.useState(null),[v,x]=p.useState(null),[S,y]=p.useState(!1),[b,w]=p.useState(null),[C,I]=p.useState(1),{toast:R}=Wn(),{getContainerClass:L}=Ri(),{isUserOnline:N,isUserInVoice:O}=nB();p.useEffect(()=>{I(1)},[t,r,i,l,d]),p.useEffect(()=>{d!=="global"&&!h&&(navigator.geolocation?navigator.geolocation.getCurrentPosition($=>{f({latitude:$.coords.latitude,longitude:$.coords.longitude}),g(null)},$=>{console.error("Error getting location:",$),g("Unable to get your location. Distance filter disabled."),u("global")}):(g("Geolocation not supported by your browser. Distance filter disabled."),u("global")))},[d,h]);const G=new URLSearchParams;t&&G.append("search",t),r&&r!=="all"&&G.append("gender",r),i&&i!=="all"&&G.append("language",i),l&&l!=="all"&&G.append("game",l),d!=="global"&&h&&(G.append("latitude",h.latitude.toString()),G.append("longitude",h.longitude.toString()),G.append("maxDistance",d)),G.append("page",C.toString()),G.append("limit","9");const H=`/api/users?${G.toString()}`,{data:re,isLoading:X,isFetching:Q,refetch:V}=Pt({queryKey:[H],enabled:!0}),te=(re==null?void 0:re.users)||[],k=(re==null?void 0:re.totalPages)||1,{data:E=[]}=Pt({queryKey:["/api/connection-requests"],queryFn:async()=>{const $=await fetch(lt("/api/connection-requests"),{credentials:"include"});if(!$.ok){if($.status===401)return[];throw new Error("Failed to fetch connection requests")}return $.json()},retry:!1}),{data:M=[]}=Pt({queryKey:["/api/user/connections"],queryFn:async()=>{const $=await fetch(lt("/api/user/connections"),{credentials:"include"});if(!$.ok){if($.status===401)return[];throw new Error("Failed to fetch connections")}return $.json()},retry:!1}),A=Nt({mutationFn:async $=>(w($),await kt("POST","/api/connection-requests",{receiverId:$})),onSuccess:()=>{ze.invalidateQueries({queryKey:["/api/connection-requests"]}),w(null),R({title:"Connection Request Sent",description:"Your connection request has been sent successfully."})},onError:$=>{w(null),R({title:"Unable to Connect",description:$.message||"Failed to send connection request",variant:"destructive"})}}),F=te,q=()=>{n(""),s("all"),o("all"),c("all"),u("global"),I(1)},P=()=>{V()},j=$=>{const W=E.find(ie=>(ie.status==="pending"||ie.status==="accepted")&&(ie.senderId===e&&ie.receiverId===$||ie.receiverId===e&&ie.senderId===$));if(W){W.status==="accepted"?R({title:"Already Connected",description:"You already have a friend connection with this user."}):R({title:"Request Already Sent",description:"You already have a pending connection request with this user."});return}A.mutate($)};return a.jsxs("div",{className:`${L()} mx-auto`,children:[a.jsxs("div",{className:"mb-6 flex items-start justify-between",children:[a.jsxs("div",{children:[a.jsxs("h1",{className:"text-2xl font-bold text-foreground mb-2 flex items-center gap-2",children:[a.jsx(Jt,{className:"h-6 w-6 text-primary"}),"Discover Gamers"]}),a.jsx("p",{className:"text-muted-foreground",children:"Find and connect with gamers worldwide"})]}),a.jsx(ee,{variant:"outline",size:"sm",onClick:P,disabled:Q,"data-testid":"button-refresh-discover",className:`transition-transform ${Q?"scale-95":"hover:scale-105"}`,children:a.jsx(bl,{className:`h-4 w-4 ${Q?"animate-spin":""}`})})]}),m&&a.jsx("div",{className:"mb-4 p-4 bg-yellow-500/10 border border-yellow-500/20 rounded-lg",children:a.jsx("p",{className:"text-sm text-yellow-600 dark:text-yellow-400",children:m})}),a.jsx(Ne,{className:"mb-6",children:a.jsx(Fe,{className:"p-4",children:a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx(wo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground pointer-events-none z-10"}),a.jsx(tt,{type:"text",placeholder:"Search by name or gamertag...",value:t,onChange:$=>n($.target.value),className:"pl-10 overflow-x-auto whitespace-nowrap",style:{textOverflow:"clip",scrollbarWidth:"none",msOverflowStyle:"none"},"data-testid":"input-search-users"})]}),a.jsxs(vS,{open:S,onOpenChange:y,children:[a.jsx(yS,{asChild:!0,children:a.jsxs(ee,{variant:"outline","data-testid":"button-toggle-filters",children:[a.jsx(qm,{className:"h-4 w-4 mr-2"}),"Filters",(r!=="all"||i!=="all"||l!=="all"||d!=="global")&&a.jsx($e,{variant:"secondary",className:"ml-2 h-5 w-5 p-0 flex items-center justify-center rounded-full",children:[r!=="all",i!=="all",l!=="all",d!=="global"].filter(Boolean).length})]})}),a.jsx($g,{className:"w-80","data-testid":"popover-filters",children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{children:a.jsx("h4",{className:"font-semibold mb-3",children:"Filter Gamers"})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Gender"}),a.jsxs(In,{value:r,onValueChange:s,children:[a.jsx(wn,{"data-testid":"select-gender",children:a.jsx(An,{placeholder:"Gender"})}),a.jsxs(Sn,{children:[a.jsx(at,{value:"all",children:"All Genders"}),fhe.map($=>a.jsx(at,{value:$.value,children:$.label},$.value))]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Language"}),a.jsxs(In,{value:i,onValueChange:o,children:[a.jsx(wn,{"data-testid":"select-language",children:a.jsx(An,{placeholder:"Language"})}),a.jsxs(Sn,{children:[a.jsx(at,{value:"all",children:"All Languages"}),hhe.map($=>a.jsx(at,{value:$,children:$},$))]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Preferred Game"}),a.jsxs(In,{value:l,onValueChange:c,children:[a.jsx(wn,{"data-testid":"select-game",children:a.jsx(An,{placeholder:"Game"})}),a.jsxs(Sn,{children:[a.jsx(at,{value:"all",children:"All Games"}),uhe.map($=>a.jsx(at,{value:$,children:$},$))]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Distance"}),a.jsxs(In,{value:d,onValueChange:u,children:[a.jsx(wn,{"data-testid":"select-distance",children:a.jsx(An,{placeholder:"Distance"})}),a.jsx(Sn,{children:phe.map($=>a.jsx(at,{value:$.value,children:$.label},$.value))})]})]}),a.jsx(ee,{variant:"outline",onClick:()=>{q(),y(!1)},className:"w-full","data-testid":"button-clear-filters",children:"Clear All Filters"})]})})]})]})})}),X?a.jsx("div",{className:"flex justify-center py-12",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):F.length===0?a.jsx(Ne,{className:"border-dashed",children:a.jsxs(Fe,{className:"text-center py-12",children:[a.jsx(Jt,{className:"h-16 w-16 text-muted-foreground/50 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"No gamers found"}),a.jsx("p",{className:"text-sm text-muted-foreground max-w-md mx-auto mb-4",children:"Try adjusting your filters or search criteria to find more players"}),a.jsx(ee,{variant:"outline",onClick:q,className:"gap-2","data-testid":"button-clear-filters-main",children:"Clear All Filters"})]})}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:F.map(($,W)=>{var ie,Z,ne,ae;return a.jsx(Ne,{className:"hover:shadow-lg hover:scale-[1.02] transition-all duration-200 cursor-pointer flex flex-col hover-elevate",onClick:()=>x($),"data-testid":`card-user-${$.id}`,children:a.jsx(Fe,{className:"pt-6 flex flex-col flex-1",children:a.jsxs("div",{className:"flex flex-col items-center text-center flex-1",children:[a.jsxs("div",{className:"relative mb-4",children:[a.jsxs(Tn,{className:"h-20 w-20",children:[a.jsx(tr,{src:$.profileImageUrl||void 0,alt:$.gamertag||"User"}),a.jsx(Cn,{className:"bg-primary text-primary-foreground text-xl",children:((Z=(ie=$.gamertag)==null?void 0:ie[0])==null?void 0:Z.toUpperCase())||((ae=(ne=$.firstName)==null?void 0:ne[0])==null?void 0:ae.toUpperCase())||"?"})]}),O($.id)&&a.jsx("div",{className:"absolute -bottom-1 -right-1 bg-blue-500 dark:bg-blue-600 rounded-full p-1.5 border-2 border-background",children:a.jsx(Vr,{className:"h-3 w-3 text-white"})})]}),a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("h3",{className:"font-bold text-lg text-foreground",children:$.gamertag||"No Gamertag"}),a.jsx($e,{variant:"secondary",className:`text-xs ${N($.id)?"bg-green-500/20 dark:bg-green-600/20 text-green-700 dark:text-green-400 border-green-500/30":"bg-gray-500/20 dark:bg-gray-600/20 text-gray-700 dark:text-gray-400 border-gray-500/30"}`,"data-testid":`status-${$.id}`,children:N($.id)?"Online":"Offline"})]}),a.jsx("div",{className:"min-h-[20px] mb-2",children:($.firstName||$.lastName)&&a.jsxs("p",{className:"text-sm text-muted-foreground",children:[$.firstName," ",$.lastName]})}),a.jsx("div",{className:"min-h-[20px] mb-3",children:$.location&&a.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[a.jsx(lv,{className:"h-3 w-3"}),a.jsx("span",{children:$.location})]})}),a.jsx("div",{className:"min-h-[40px] mb-3 flex items-center",children:$.bio&&a.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:$.bio})}),a.jsx("div",{className:"min-h-[28px] mb-4 flex items-center justify-center",children:$.preferredGames&&$.preferredGames.length>0&&a.jsx($e,{variant:"secondary",className:"text-xs",children:$.preferredGames[0]})}),(()=>{const ge=E.some(Le=>Le.status==="pending"&&(Le.senderId===e&&Le.receiverId===$.id||Le.receiverId===e&&Le.senderId===$.id));return a.jsxs(ee,{size:"sm",className:"w-full gap-2",onClick:Le=>{Le.stopPropagation(),j($.id)},disabled:b===$.id||ge,variant:ge?"outline":"default","data-testid":`button-connect-${$.id}`,children:[b===$.id?a.jsx(Rl,{className:"h-4 w-4 animate-spin"}):ge?a.jsx(gi,{className:"h-4 w-4"}):a.jsx(Jt,{className:"h-4 w-4"}),ge?"Sent":"Connect"]})})()]})})},$.id)})}),k>1&&a.jsxs("div",{className:"flex justify-center items-center gap-2 mt-8",children:[a.jsx(ee,{variant:"outline",size:"sm",onClick:()=>I($=>Math.max(1,$-1)),disabled:C===1,"data-testid":"button-previous-page",children:"Previous"}),a.jsx("div",{className:"flex items-center gap-2",children:Array.from({length:Math.min(k,5)},($,W)=>{const ie=C<=3?W+1:C-2+W;return ie>k?null:a.jsx(ee,{variant:C===ie?"default":"outline",size:"sm",onClick:()=>I(ie),"data-testid":`button-page-${ie}`,children:ie},ie)})}),a.jsx(ee,{variant:"outline",size:"sm",onClick:()=>I($=>Math.min(k,$+1)),disabled:C===k,"data-testid":"button-next-page",children:"Next"})]})]}),v&&a.jsx(gr,{open:!!v,onOpenChange:$=>!$&&x(null),children:a.jsxs(nr,{className:"max-w-full sm:max-w-3xl lg:max-w-5xl max-h-[90vh] overflow-y-auto",children:[a.jsx(rr,{children:a.jsx(sr,{children:"Player Profile"})}),a.jsx("div",{className:"overflow-y-auto max-h-[calc(90vh-8rem)]",children:a.jsx(NT,{id:v.id,gamertag:v.gamertag||"Unknown",firstName:v.firstName??void 0,lastName:v.lastName??void 0,profileImageUrl:v.profileImageUrl??void 0,currentUserId:e,bio:v.bio??void 0,location:v.location??void 0,latitude:v.latitude??void 0,longitude:v.longitude??void 0,age:v.age??void 0,preferredGames:v.preferredGames??void 0,isOwn:v.id===e,onMessage:()=>{j(v.id),x(null)}})})]})})]})}var AT="Radio",[ghe,rB]=Mn(AT),[vhe,yhe]=ghe(AT),sB=p.forwardRef((e,t)=>{const{__scopeRadio:n,name:r,checked:s=!1,required:i,disabled:o,value:l="on",onCheck:c,form:d,...u}=e,[h,f]=p.useState(null),m=We(t,x=>f(x)),g=p.useRef(!1),v=h?d||!!h.closest("form"):!0;return a.jsxs(vhe,{scope:n,checked:s,disabled:o,children:[a.jsx(Re.button,{type:"button",role:"radio","aria-checked":s,"data-state":lB(s),"data-disabled":o?"":void 0,disabled:o,value:l,...u,ref:m,onClick:pe(e.onClick,x=>{s||c==null||c(),v&&(g.current=x.isPropagationStopped(),g.current||x.stopPropagation())})}),v&&a.jsx(oB,{control:h,bubbles:!g.current,name:r,value:l,checked:s,required:i,disabled:o,form:d,style:{transform:"translateX(-100%)"}})]})});sB.displayName=AT;var iB="RadioIndicator",aB=p.forwardRef((e,t)=>{const{__scopeRadio:n,forceMount:r,...s}=e,i=yhe(iB,n);return a.jsx(Pn,{present:r||i.checked,children:a.jsx(Re.span,{"data-state":lB(i.checked),"data-disabled":i.disabled?"":void 0,...s,ref:t})})});aB.displayName=iB;var xhe="RadioBubbleInput",oB=p.forwardRef(({__scopeRadio:e,control:t,checked:n,bubbles:r=!0,...s},i)=>{const o=p.useRef(null),l=We(o,i),c=ry(n),d=fv(t);return p.useEffect(()=>{const u=o.current;if(!u)return;const h=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(h,"checked").set;if(c!==n&&m){const g=new Event("click",{bubbles:r});m.call(u,n),u.dispatchEvent(g)}},[c,n,r]),a.jsx(Re.input,{type:"radio","aria-hidden":!0,defaultChecked:n,...s,tabIndex:-1,ref:l,style:{...s.style,...d,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});oB.displayName=xhe;function lB(e){return e?"checked":"unchecked"}var bhe=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],uy="RadioGroup",[whe]=Mn(uy,[Jd,rB]),cB=Jd(),dB=rB(),[She,khe]=whe(uy),uB=p.forwardRef((e,t)=>{const{__scopeRadioGroup:n,name:r,defaultValue:s,value:i,required:o=!1,disabled:l=!1,orientation:c,dir:d,loop:u=!0,onValueChange:h,...f}=e,m=cB(n),g=ec(d),[v,x]=qr({prop:i,defaultProp:s??null,onChange:h,caller:uy});return a.jsx(She,{scope:n,name:r,required:o,disabled:l,value:v,onValueChange:x,children:a.jsx(vk,{asChild:!0,...m,orientation:c,dir:g,loop:u,children:a.jsx(Re.div,{role:"radiogroup","aria-required":o,"aria-orientation":c,"data-disabled":l?"":void 0,dir:g,...f,ref:t})})})});uB.displayName=uy;var hB="RadioGroupItem",fB=p.forwardRef((e,t)=>{const{__scopeRadioGroup:n,disabled:r,...s}=e,i=khe(hB,n),o=i.disabled||r,l=cB(n),c=dB(n),d=p.useRef(null),u=We(t,d),h=i.value===s.value,f=p.useRef(!1);return p.useEffect(()=>{const m=v=>{bhe.includes(v.key)&&(f.current=!0)},g=()=>f.current=!1;return document.addEventListener("keydown",m),document.addEventListener("keyup",g),()=>{document.removeEventListener("keydown",m),document.removeEventListener("keyup",g)}},[]),a.jsx(yk,{asChild:!0,...l,focusable:!o,active:h,children:a.jsx(sB,{disabled:o,required:i.required,checked:h,...c,...s,name:i.name,ref:u,onCheck:()=>i.onValueChange(s.value),onKeyDown:pe(m=>{m.key==="Enter"&&m.preventDefault()}),onFocus:pe(s.onFocus,()=>{var m;f.current&&((m=d.current)==null||m.click())})})})});fB.displayName=hB;var The="RadioGroupIndicator",pB=p.forwardRef((e,t)=>{const{__scopeRadioGroup:n,...r}=e,s=dB(n);return a.jsx(aB,{...s,...r,ref:t})});pB.displayName=The;var mB=uB,gB=fB,Che=pB;const xm=p.forwardRef(({className:e,...t},n)=>a.jsx(mB,{className:be("grid gap-2",e),...t,ref:n}));xm.displayName=mB.displayName;const bm=p.forwardRef(({className:e,...t},n)=>a.jsx(gB,{ref:n,className:be("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:a.jsx(Che,{className:"flex items-center justify-center",children:a.jsx(FD,{className:"h-2.5 w-2.5 fill-current text-current"})})}));bm.displayName=gB.displayName;const Gx=[{value:"everyone",label:"Everyone",description:"Anyone can see this"},{value:"connections",label:"Connections Only",description:"Only your connections can see this"},{value:"nobody",label:"Nobody",description:"Keep this private"}];function Ehe({userId:e}){const{toast:t}=Wn(),n=ff(),{data:r,isLoading:s}=Pt({queryKey:["/api/auth/user"]}),[i,o]=p.useState("everyone"),[l,c]=p.useState("everyone"),[d,u]=p.useState("everyone");p.useEffect(()=>{r&&(o(r.showMutualGames||"everyone"),c(r.showMutualFriends||"everyone"),u(r.showMutualHobbies||"everyone"))},[r]);const h=Nt({mutationFn:async m=>await kt("PATCH","/api/user/privacy",m),onSuccess:()=>{n.invalidateQueries({queryKey:["/api/auth/user"]}),t({title:"Privacy Settings Updated",description:"Your privacy preferences have been saved successfully."})},onError:()=>{t({title:"Update Failed",description:"Failed to update privacy settings. Please try again.",variant:"destructive"})}}),f=()=>{h.mutate({showMutualGames:i,showMutualFriends:l,showMutualHobbies:d})};return s?a.jsx(Ne,{children:a.jsx(Fe,{className:"p-12 text-center",children:a.jsx("p",{className:"text-muted-foreground",children:"Loading privacy settings..."})})}):a.jsxs(Ne,{"data-testid":"card-privacy-settings",children:[a.jsxs(an,{children:[a.jsxs(mr,{className:"flex items-center gap-2",children:[a.jsx(WD,{className:"h-5 w-5"}),"Privacy Settings"]}),a.jsx(Sl,{children:"Control who can see what you have in common with other players"})]}),a.jsxs(Fe,{className:"space-y-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ia,{className:"h-4 w-4 text-primary"}),a.jsx(Xn,{className:"text-base font-semibold",children:"Mutual Games"})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Who can see games you have in common with others"}),a.jsx(xm,{value:i,onValueChange:o,className:"space-y-2","data-testid":"radio-group-mutual-games",disabled:h.isPending,children:Gx.map(m=>a.jsxs("div",{className:"flex items-center space-x-3 space-y-0",children:[a.jsx(bm,{value:m.value,id:`games-${m.value}`,"data-testid":`radio-mutual-games-${m.value}`,disabled:h.isPending}),a.jsx(Xn,{htmlFor:`games-${m.value}`,className:"font-normal cursor-pointer flex-1",children:a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:m.label}),a.jsx("div",{className:"text-sm text-muted-foreground",children:m.description})]})})]},m.value))})]}),a.jsxs("div",{className:"space-y-3 pt-4 border-t",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Jt,{className:"h-4 w-4 text-primary"}),a.jsx(Xn,{className:"text-base font-semibold",children:"Mutual Friends"})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Who can see friends you have in common with others"}),a.jsx(xm,{value:l,onValueChange:c,className:"space-y-2","data-testid":"radio-group-mutual-friends",disabled:h.isPending,children:Gx.map(m=>a.jsxs("div",{className:"flex items-center space-x-3 space-y-0",children:[a.jsx(bm,{value:m.value,id:`friends-${m.value}`,"data-testid":`radio-mutual-friends-${m.value}`,disabled:h.isPending}),a.jsx(Xn,{htmlFor:`friends-${m.value}`,className:"font-normal cursor-pointer flex-1",children:a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:m.label}),a.jsx("div",{className:"text-sm text-muted-foreground",children:m.description})]})})]},m.value))})]}),a.jsxs("div",{className:"space-y-3 pt-4 border-t",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Th,{className:"h-4 w-4 text-primary"}),a.jsx(Xn,{className:"text-base font-semibold",children:"Mutual Hobbies"})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Who can see hobbies/interests you have in common with others"}),a.jsx(xm,{value:d,onValueChange:u,className:"space-y-2","data-testid":"radio-group-mutual-hobbies",disabled:h.isPending,children:Gx.map(m=>a.jsxs("div",{className:"flex items-center space-x-3 space-y-0",children:[a.jsx(bm,{value:m.value,id:`hobbies-${m.value}`,"data-testid":`radio-mutual-hobbies-${m.value}`,disabled:h.isPending}),a.jsx(Xn,{htmlFor:`hobbies-${m.value}`,className:"font-normal cursor-pointer flex-1",children:a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:m.label}),a.jsx("div",{className:"text-sm text-muted-foreground",children:m.description})]})})]},m.value))})]})]}),a.jsx("div",{className:"flex justify-end pt-4 border-t",children:a.jsx(ee,{onClick:f,disabled:h.isPending,"data-testid":"button-save-privacy",children:h.isPending?"Saving...":"Save Privacy Settings"})})]})]})}function vB(){const[e,t]=p.useState(!1),[n,r]=p.useState(!1),[s,i]=p.useState("default"),{toast:o}=Wn();p.useEffect(()=>{const u="serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window;t(u),u&&(i(Notification.permission),l())},[]);const l=async()=>{try{const h=await(await navigator.serviceWorker.ready).pushManager.getSubscription();r(!!h)}catch(u){console.error("Error checking subscription:",u)}},c=Nt({mutationFn:async()=>{const u=await Notification.requestPermission();if(i(u),u!=="granted")throw new Error("Notification permission denied");const h=await navigator.serviceWorker.ready,f=await fetch(lt("/api/push/vapid-public-key"),{credentials:"include"}),{publicKey:m}=await f.json(),g=await h.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:_he(m)});return await kt("POST","/api/push/subscribe",{endpoint:g.endpoint,keys:{p256dh:uN(g.getKey("p256dh")),auth:uN(g.getKey("auth"))}}),g},onSuccess:()=>{r(!0),o({title:"Push Notifications Enabled",description:"You will now receive push notifications for match requests and connections."})},onError:u=>{console.error("Error subscribing to push notifications:",u),o({title:"Failed to Enable Notifications",description:u.message||"Could not subscribe to push notifications.",variant:"destructive"})}}),d=Nt({mutationFn:async()=>{const h=await(await navigator.serviceWorker.ready).pushManager.getSubscription();h&&(await kt("POST","/api/push/unsubscribe",{endpoint:h.endpoint}),await h.unsubscribe())},onSuccess:()=>{r(!1),o({title:"Push Notifications Disabled",description:"You will no longer receive push notifications."})},onError:u=>{console.error("Error unsubscribing from push notifications:",u),o({title:"Error",description:"Could not unsubscribe from push notifications.",variant:"destructive"})}});return{isSupported:e,isSubscribed:n,permission:s,subscribe:c.mutate,unsubscribe:d.mutate,isSubscribing:c.isPending,isUnsubscribing:d.isPending}}function _he(e){const t="=".repeat((4-e.length%4)%4),n=(e+t).replace(/-/g,"+").replace(/_/g,"/"),r=window.atob(n),s=new Uint8Array(r.length);for(let i=0;i<r.length;++i)s[i]=r.charCodeAt(i);return s}function uN(e){const t=new Uint8Array(e);let n="";for(let r=0;r<t.byteLength;r++)n+=String.fromCharCode(t[r]);return window.btoa(n)}function Phe(){const[e,t]=p.useState(!1),{isSupported:n,isSubscribed:r,permission:s,subscribe:i,isSubscribing:o}=vB();p.useEffect(()=>{localStorage.getItem("push-notification-prompt-dismissed")&&t(!0)},[]);const l=()=>{localStorage.setItem("push-notification-prompt-dismissed","true"),t(!0)};return!n||r||e||s==="denied"?null:a.jsxs(Ne,{className:"mb-6 border-primary/50 bg-card/90 backdrop-blur","data-testid":"push-notification-prompt",children:[a.jsx(an,{className:"pb-3",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"rounded-full bg-primary/10 p-2",children:a.jsx(Yu,{className:"h-5 w-5 text-primary"})}),a.jsxs("div",{children:[a.jsx(mr,{className:"text-lg",children:"Enable Push Notifications"}),a.jsx(Sl,{className:"mt-1",children:"Get instant alerts for match requests, connections, and messages"})]})]}),a.jsx(ee,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:l,"data-testid":"button-dismiss-push-prompt",children:a.jsx(Ot,{className:"h-4 w-4"})})]})}),a.jsxs(Fe,{className:"flex gap-2",children:[a.jsx(ee,{onClick:()=>i(),disabled:o,className:"flex-1","data-testid":"button-enable-push-notifications",children:o?"Enabling...":"Enable Notifications"}),a.jsx(ee,{onClick:l,variant:"outline",className:"flex-1","data-testid":"button-maybe-later",children:"Maybe Later"})]})]})}function Nhe(){const{isSupported:e,isSubscribed:t,permission:n,subscribe:r,unsubscribe:s,isSubscribing:i,isUnsubscribing:o}=vB();return e?n==="denied"?a.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[a.jsx(C8,{className:"h-4 w-4"}),a.jsx("span",{children:"Push notifications blocked. Enable them in your browser settings."})]}):a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"space-y-0.5",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Yu,{className:"h-4 w-4"}),a.jsx("span",{className:"font-medium",children:"Push Notifications"})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Receive notifications even when the app is closed"})]}),a.jsx(ee,{onClick:()=>t?s():r(),disabled:i||o,variant:t?"outline":"default",size:"sm","data-testid":"button-toggle-push-notifications",children:i||o?"Processing...":t?"Disable":"Enable"})]}):null}var hy="Switch",[Ihe]=Mn(hy),[Ahe,Rhe]=Ihe(hy),yB=p.forwardRef((e,t)=>{const{__scopeSwitch:n,name:r,checked:s,defaultChecked:i,required:o,disabled:l,value:c="on",onCheckedChange:d,form:u,...h}=e,[f,m]=p.useState(null),g=We(t,b=>m(b)),v=p.useRef(!1),x=f?u||!!f.closest("form"):!0,[S,y]=qr({prop:s,defaultProp:i??!1,onChange:d,caller:hy});return a.jsxs(Ahe,{scope:n,checked:S,disabled:l,children:[a.jsx(Re.button,{type:"button",role:"switch","aria-checked":S,"aria-required":o,"data-state":SB(S),"data-disabled":l?"":void 0,disabled:l,value:c,...h,ref:g,onClick:pe(e.onClick,b=>{y(w=>!w),x&&(v.current=b.isPropagationStopped(),v.current||b.stopPropagation())})}),x&&a.jsx(wB,{control:f,bubbles:!v.current,name:r,value:c,checked:S,required:o,disabled:l,form:u,style:{transform:"translateX(-100%)"}})]})});yB.displayName=hy;var xB="SwitchThumb",bB=p.forwardRef((e,t)=>{const{__scopeSwitch:n,...r}=e,s=Rhe(xB,n);return a.jsx(Re.span,{"data-state":SB(s.checked),"data-disabled":s.disabled?"":void 0,...r,ref:t})});bB.displayName=xB;var jhe="SwitchBubbleInput",wB=p.forwardRef(({__scopeSwitch:e,control:t,checked:n,bubbles:r=!0,...s},i)=>{const o=p.useRef(null),l=We(o,i),c=ry(n),d=fv(t);return p.useEffect(()=>{const u=o.current;if(!u)return;const h=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(h,"checked").set;if(c!==n&&m){const g=new Event("click",{bubbles:r});m.call(u,n),u.dispatchEvent(g)}},[c,n,r]),a.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...s,tabIndex:-1,ref:l,style:{...s.style,...d,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});wB.displayName=jhe;function SB(e){return e?"checked":"unchecked"}var kB=yB,Mhe=bB;const TB=p.forwardRef(({className:e,...t},n)=>a.jsx(kB,{className:be("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...t,ref:n,children:a.jsx(Mhe,{className:be("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));TB.displayName=kB.displayName;const xS=new Set;function CB(e){return xS.add(e),()=>{xS.delete(e)}}function hN(e){xS.forEach(t=>t(e))}const Dhe={enableOverlay:async()=>(console.log("[Voice Overlay] Enabling web overlay"),localStorage.setItem("voice-overlay-enabled","true"),hN(!0),{enabled:!0}),disableOverlay:async()=>(console.log("[Voice Overlay] Disabling web overlay"),localStorage.setItem("voice-overlay-enabled","false"),hN(!1),{enabled:!1}),checkPermission:async()=>({granted:!0}),requestPermission:async()=>({granted:!0}),updateParticipants:async e=>(console.log("[Voice Overlay] Participants updated:",e.participants.length),{success:!0}),updateMicState:async e=>(console.log("[Voice Overlay] Mic state updated:",e.isMuted?"muted":"unmuted"),{success:!0}),updateSpeakerState:async e=>(console.log("[Voice Overlay] Speaker state updated:",e.isMuted?"muted":"unmuted"),{success:!0})},qi=kf("VoiceOverlay",{web:()=>Dhe}),Ohe=Object.freeze(Object.defineProperty({__proto__:null,default:qi,subscribeToOverlayState:CB},Symbol.toStringTag,{value:"Module"}));function Lhe({userId:e}){const[t,n]=p.useState(!1),[r,s]=p.useState(!1),[i,o]=p.useState(!1),[l,c]=p.useState(!1),d=Ol.isNativePlatform();p.useEffect(()=>{u()},[e]);const u=async()=>{try{const g=await qi.checkPermission();if(s(g.granted),!e)return;const v=await fetch(lt("/api/auth/user"),{credentials:"include"});if(v.ok){const S=(await v.json()).voiceOverlayEnabled||!1;n(S),S&&g.granted&&await qi.enableOverlay()}}catch(g){console.error("Error initializing overlay:",g)}},h=async g=>{c(!0);try{if(g){if(!r&&d){o(!0),c(!1);return}await qi.enableOverlay(),await m(!0),n(!0)}else await qi.disableOverlay(),await m(!1),n(!1)}catch(v){console.error("Error toggling voice overlay:",v)}finally{c(!1)}},f=async()=>{try{const g=await qi.requestPermission();s(g.granted),o(!1),g.granted&&(await qi.enableOverlay(),await m(!0),n(!0))}catch(g){console.error("Error requesting overlay permission:",g)}},m=async g=>{if(e)try{await fetch(lt("/api/users/me/settings"),{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({voiceOverlayEnabled:g})})}catch(v){console.error("Error saving overlay preference:",v)}};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-card rounded-lg border",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"h-10 w-10 rounded-full bg-primary/20 flex items-center justify-center",children:a.jsx(rw,{className:"h-5 w-5 text-primary"})}),a.jsxs("div",{children:[a.jsx(Xn,{htmlFor:"voice-overlay",className:"text-sm font-medium cursor-pointer",children:"Floating Voice Controls"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:d?"Show draggable mic/speaker buttons over other apps":"Show floating voice overlay while in voice channels"})]})]}),a.jsx(TB,{id:"voice-overlay",checked:t,onCheckedChange:h,disabled:l,"data-testid":"switch-voice-overlay"})]}),a.jsx(gr,{open:i,onOpenChange:o,children:a.jsxs(nr,{children:[a.jsxs(rr,{children:[a.jsx(sr,{children:"Enable Floating Controls?"}),a.jsx($h,{children:"This feature requires permission to display over other apps. You'll be redirected to Android settings to grant this permission."})]}),a.jsxs("div",{className:"my-4 p-4 bg-muted rounded-lg",children:[a.jsx("h4",{className:"font-semibold mb-2",children:"What you'll get:"}),a.jsxs("ul",{className:"space-y-2 text-sm",children:[a.jsxs("li",{className:"flex items-start gap-2",children:[a.jsx(wd,{className:"h-4 w-4 mt-0.5 text-primary shrink-0"}),a.jsx("span",{children:"Quick access to mic and speaker controls"})]}),a.jsxs("li",{className:"flex items-start gap-2",children:[a.jsx(rw,{className:"h-4 w-4 mt-0.5 text-primary shrink-0"}),a.jsx("span",{children:"Draggable overlay that works across all apps"})]})]})]}),a.jsxs(D$,{children:[a.jsx(ee,{variant:"outline",onClick:()=>o(!1),"data-testid":"button-cancel-overlay",children:"Cancel"}),a.jsx(ee,{onClick:f,"data-testid":"button-grant-overlay-permission",children:"Grant Permission"})]})]})})]})}const Fhe=[{value:"dark",label:"Gaming Dark",description:"Classic dark mode",color:"bg-[hsl(230,85%,65%)]"},{value:"light",label:"Light Mode",description:"Clean and bright",color:"bg-[hsl(230,85%,55%)]"},{value:"neon",label:"Neon Cyberpunk",description:"Pink & orange glow",color:"bg-gradient-to-r from-[hsl(280,100%,60%)] to-[hsl(40,100%,55%)]"},{value:"midnight",label:"Neon Cyan",description:"Cyan glow vibes",color:"bg-[hsl(180,100%,50%)]"},{value:"forest",label:"Vibrant Purple",description:"Electric purple energy",color:"bg-[hsl(280,90%,65%)]"},{value:"sunset",label:"Electric Teal",description:"Teal with glow effects",color:"bg-[hsl(165,85%,55%)]"},{value:"system",label:"System Default",description:"Follow system preference",color:"bg-gradient-to-r from-[hsl(0,0%,15%)] to-[hsl(0,0%,95%)]"}],$he=[{value:"canvas2d",label:"Canvas Stars",description:"Smooth depth-based starfield"},{value:"webgl",label:"WebGL Stars",description:"Interactive fractal starfield"},{value:"solid",label:"Solid Dark",description:"Simple solid background"}];function Uhe(){const{theme:e,setTheme:t}=g7(),{background:n,setBackground:r}=V0();return a.jsxs(m$,{children:[a.jsx(g$,{asChild:!0,children:a.jsxs(ee,{variant:"ghost",size:"icon",className:"h-9 w-9","data-testid":"button-unified-theme-selector",children:[a.jsx(P0,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Appearance settings"})]})}),a.jsxs(zk,{align:"end",className:"w-64",children:[a.jsx(Jw,{children:"Color Theme"}),a.jsx(sh,{}),Fhe.map(s=>a.jsxs(Fh,{onClick:()=>t(s.value),className:"flex items-center gap-3 cursor-pointer","data-testid":`menu-item-theme-${s.value}`,children:[a.jsx("div",{className:`w-4 h-4 rounded-full ${s.color} flex-shrink-0`}),a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"font-medium",children:s.label}),a.jsx("div",{className:"text-xs text-muted-foreground",children:s.description})]}),e===s.value&&a.jsx(Zr,{className:"h-4 w-4 text-primary","data-testid":`check-theme-${s.value}`})]},s.value)),a.jsx(sh,{className:"my-2"}),a.jsx(Jw,{children:"Background"}),a.jsx(sh,{}),$he.map(s=>a.jsxs(Fh,{onClick:()=>r(s.value),className:"flex items-center gap-3 cursor-pointer","data-testid":`menu-item-background-${s.value}`,children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"font-medium",children:s.label}),a.jsx("div",{className:"text-xs text-muted-foreground",children:s.description})]}),n===s.value&&a.jsx(Zr,{className:"h-4 w-4 text-primary","data-testid":`check-background-${s.value}`})]},s.value))]})]})}function Vhe({user:e}){const{layoutWidth:t,setLayoutWidth:n,getContainerClass:r}=Ri(),{background:s,setBackground:i}=V0();return a.jsxs("div",{className:`${r()} mx-auto`,children:[a.jsx("h1",{className:"text-2xl font-bold text-foreground mb-6",children:"Settings"}),a.jsxs("div",{className:"space-y-6",children:[e&&a.jsx(Ehe,{userId:e.id}),a.jsxs(Ne,{children:[a.jsxs(an,{children:[a.jsxs(mr,{className:"flex items-center gap-2",children:[a.jsx(P0,{className:"h-5 w-5"}),"Appearance"]}),a.jsx(Sl,{children:"Customize your viewing experience"})]}),a.jsxs(Fe,{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium mb-3 block",children:"Color Theme"}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Uhe,{}),a.jsx("span",{className:"text-sm text-muted-foreground",children:"Choose your preferred color theme"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium mb-3 block",children:"Page Width"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[a.jsxs(ee,{variant:t==="compact"?"default":"outline",className:"h-auto flex-col gap-2 py-4",onClick:()=>n("compact"),"data-testid":"button-layout-compact",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-12 h-8 border-2 border-current rounded flex items-center justify-center",children:a.jsx("div",{className:"w-6 h-6 bg-current/20 rounded-sm"})}),t==="compact"&&a.jsx(Zr,{className:"h-4 w-4"})]}),a.jsx("span",{className:"font-semibold",children:"Compact"}),a.jsx("span",{className:"text-xs text-muted-foreground",children:"Narrow width"})]}),a.jsxs(ee,{variant:t==="cozy"?"default":"outline",className:"h-auto flex-col gap-2 py-4",onClick:()=>n("cozy"),"data-testid":"button-layout-cozy",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-12 h-8 border-2 border-current rounded flex items-center justify-center",children:a.jsx("div",{className:"w-8 h-6 bg-current/20 rounded-sm"})}),t==="cozy"&&a.jsx(Zr,{className:"h-4 w-4"})]}),a.jsx("span",{className:"font-semibold",children:"Cozy"}),a.jsx("span",{className:"text-xs text-muted-foreground",children:"Medium width"})]}),a.jsxs(ee,{variant:t==="comfortable"?"default":"outline",className:"h-auto flex-col gap-2 py-4",onClick:()=>n("comfortable"),"data-testid":"button-layout-comfortable",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-12 h-8 border-2 border-current rounded flex items-center justify-center",children:a.jsx("div",{className:"w-11 h-6 bg-current/20 rounded-sm"})}),t==="comfortable"&&a.jsx(Zr,{className:"h-4 w-4"})]}),a.jsx("span",{className:"font-semibold",children:"Comfortable"}),a.jsx("span",{className:"text-xs text-muted-foreground",children:"Wide like Discover"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium mb-3 block",children:"Background Effect"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[a.jsxs(ee,{variant:s==="canvas2d"?"default":"outline",className:"h-auto flex-col gap-2 py-4",onClick:()=>i("canvas2d"),"data-testid":"button-background-canvas2d",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Th,{className:"h-6 w-6"}),s==="canvas2d"&&a.jsx(Zr,{className:"h-4 w-4"})]}),a.jsx("span",{className:"font-semibold",children:"Animated Stars"}),a.jsx("span",{className:"text-xs text-muted-foreground",children:"Classic effect"})]}),a.jsxs(ee,{variant:s==="webgl"?"default":"outline",className:"h-auto flex-col gap-2 py-4",onClick:()=>i("webgl"),"data-testid":"button-background-webgl",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(QD,{className:"h-6 w-6"}),s==="webgl"&&a.jsx(Zr,{className:"h-4 w-4"})]}),a.jsx("span",{className:"font-semibold",children:"3D Stars"}),a.jsx("span",{className:"text-xs text-muted-foreground",children:"High performance"})]}),a.jsxs(ee,{variant:s==="solid"?"default":"outline",className:"h-auto flex-col gap-2 py-4",onClick:()=>i("solid"),"data-testid":"button-background-solid",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(B8,{className:"h-6 w-6"}),s==="solid"&&a.jsx(Zr,{className:"h-4 w-4"})]}),a.jsx("span",{className:"font-semibold",children:"Solid Dark"}),a.jsx("span",{className:"text-xs text-muted-foreground",children:"Simple & clean"})]})]})]})]})]}),a.jsxs(Ne,{children:[a.jsxs(an,{children:[a.jsx(mr,{children:"Notifications"}),a.jsx(Sl,{children:"Manage your notification preferences"})]}),a.jsx(Fe,{children:a.jsx(Nhe,{})})]}),a.jsxs(Ne,{children:[a.jsxs(an,{children:[a.jsx(mr,{children:"Voice Channel"}),a.jsx(Sl,{children:"Control voice channel behavior on mobile"})]}),a.jsx(Fe,{children:a.jsx(Lhe,{userId:e==null?void 0:e.id})})]})]})]})}var fy="Checkbox",[Bhe]=Mn(fy),[zhe,RT]=Bhe(fy);function Ghe(e){const{__scopeCheckbox:t,checked:n,children:r,defaultChecked:s,disabled:i,form:o,name:l,onCheckedChange:c,required:d,value:u="on",internal_do_not_use_render:h}=e,[f,m]=qr({prop:n,defaultProp:s??!1,onChange:c,caller:fy}),[g,v]=p.useState(null),[x,S]=p.useState(null),y=p.useRef(!1),b=g?!!o||!!g.closest("form"):!0,w={checked:f,disabled:i,setChecked:m,control:g,setControl:v,name:l,form:o,value:u,hasConsumerStoppedPropagationRef:y,required:d,defaultChecked:yo(s)?!1:s,isFormControl:b,bubbleInput:x,setBubbleInput:S};return a.jsx(zhe,{scope:t,...w,children:Whe(h)?h(w):r})}var EB="CheckboxTrigger",_B=p.forwardRef(({__scopeCheckbox:e,onKeyDown:t,onClick:n,...r},s)=>{const{control:i,value:o,disabled:l,checked:c,required:d,setControl:u,setChecked:h,hasConsumerStoppedPropagationRef:f,isFormControl:m,bubbleInput:g}=RT(EB,e),v=We(s,u),x=p.useRef(c);return p.useEffect(()=>{const S=i==null?void 0:i.form;if(S){const y=()=>h(x.current);return S.addEventListener("reset",y),()=>S.removeEventListener("reset",y)}},[i,h]),a.jsx(Re.button,{type:"button",role:"checkbox","aria-checked":yo(c)?"mixed":c,"aria-required":d,"data-state":RB(c),"data-disabled":l?"":void 0,disabled:l,value:o,...r,ref:v,onKeyDown:pe(t,S=>{S.key==="Enter"&&S.preventDefault()}),onClick:pe(n,S=>{h(y=>yo(y)?!0:!y),g&&m&&(f.current=S.isPropagationStopped(),f.current||S.stopPropagation())})})});_B.displayName=EB;var jT=p.forwardRef((e,t)=>{const{__scopeCheckbox:n,name:r,checked:s,defaultChecked:i,required:o,disabled:l,value:c,onCheckedChange:d,form:u,...h}=e;return a.jsx(Ghe,{__scopeCheckbox:n,checked:s,defaultChecked:i,disabled:l,required:o,onCheckedChange:d,name:r,form:u,value:c,internal_do_not_use_render:({isFormControl:f})=>a.jsxs(a.Fragment,{children:[a.jsx(_B,{...h,ref:t,__scopeCheckbox:n}),f&&a.jsx(AB,{__scopeCheckbox:n})]})})});jT.displayName=fy;var PB="CheckboxIndicator",NB=p.forwardRef((e,t)=>{const{__scopeCheckbox:n,forceMount:r,...s}=e,i=RT(PB,n);return a.jsx(Pn,{present:r||yo(i.checked)||i.checked===!0,children:a.jsx(Re.span,{"data-state":RB(i.checked),"data-disabled":i.disabled?"":void 0,...s,ref:t,style:{pointerEvents:"none",...e.style}})})});NB.displayName=PB;var IB="CheckboxBubbleInput",AB=p.forwardRef(({__scopeCheckbox:e,...t},n)=>{const{control:r,hasConsumerStoppedPropagationRef:s,checked:i,defaultChecked:o,required:l,disabled:c,name:d,value:u,form:h,bubbleInput:f,setBubbleInput:m}=RT(IB,e),g=We(n,m),v=ry(i),x=fv(r);p.useEffect(()=>{const y=f;if(!y)return;const b=window.HTMLInputElement.prototype,C=Object.getOwnPropertyDescriptor(b,"checked").set,I=!s.current;if(v!==i&&C){const R=new Event("click",{bubbles:I});y.indeterminate=yo(i),C.call(y,yo(i)?!1:i),y.dispatchEvent(R)}},[f,v,i,s]);const S=p.useRef(yo(i)?!1:i);return a.jsx(Re.input,{type:"checkbox","aria-hidden":!0,defaultChecked:o??S.current,required:l,disabled:c,name:d,value:u,form:h,...t,tabIndex:-1,ref:g,style:{...t.style,...x,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});AB.displayName=IB;function Whe(e){return typeof e=="function"}function yo(e){return e==="indeterminate"}function RB(e){return yo(e)?"indeterminate":e?"checked":"unchecked"}const jB=p.forwardRef(({className:e,...t},n)=>a.jsx(jT,{ref:n,className:be("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:a.jsx(NB,{className:be("flex items-center justify-center text-current"),children:a.jsx(Zr,{className:"h-4 w-4"})})}));jB.displayName=jT.displayName;const Hhe=qk,qhe=Kk,Khe=Qk,MB=p.forwardRef(({className:e,...t},n)=>a.jsx(Df,{className:be("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:n}));MB.displayName=Df.displayName;const Qhe=gf("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),DB=p.forwardRef(({side:e="right",className:t,children:n,...r},s)=>a.jsxs(Khe,{children:[a.jsx(MB,{}),a.jsxs(Of,{ref:s,className:be(Qhe({side:e}),t),...r,children:[n,a.jsxs(zv,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[a.jsx(Ot,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));DB.displayName=Of.displayName;const OB=({className:e,...t})=>a.jsx("div",{className:be("flex flex-col space-y-2 text-center sm:text-left",e),...t});OB.displayName="SheetHeader";const LB=p.forwardRef(({className:e,...t},n)=>a.jsx(Lf,{ref:n,className:be("text-lg font-semibold text-foreground",e),...t}));LB.displayName=Lf.displayName;const Jhe=p.forwardRef(({className:e,...t},n)=>a.jsx(Ff,{ref:n,className:be("text-sm text-muted-foreground",e),...t}));Jhe.displayName=Ff.displayName;function Yhe({channel:e,currentUserId:t,isActiveChannel:n,onJoin:r,onLeave:s}){const i=pk(),o=pr(Zs),l=pr(Kd),c=pr(ok);pr(Iw);const d=pr(og),u=pr(Qd),{activeVoiceChannel:h,setVoiceChannelActive:f}=P2(),m=o&&(h==null?void 0:h.id)===e.id&&(h==null?void 0:h.type)==="group",[g,v]=p.useState(!1),[x,S]=p.useState([]),[y,b]=p.useState(!1),[w,C]=p.useState(null),[I,R]=p.useState(!1),[L,N]=p.useState({}),[O,G]=p.useState(!1),[H,re]=p.useState(!1),{toast:X}=Wn(),Q=x.some(Z=>Z.isActive),{data:V}=Pt({queryKey:["/api/users",w],queryFn:async()=>{if(!w)throw new Error("No user ID");const Z=await fetch(lt(`/api/users/${w}`),{credentials:"include"});if(!Z.ok)throw new Error("Failed to fetch user");return Z.json()},enabled:!!w}),te=`${window.location.origin}/join-channel/${e.inviteCode}`;p.useEffect(()=>{k()},[e.id]),p.useEffect(()=>{i.setLogLevel(4),console.log("[HMS] Verbose logging enabled")},[i]),p.useEffect(()=>{o&&g&&(console.log("[HMS] Successfully connected to room!"),v(!1),r&&r(),X({title:"Joined voice channel",description:`You're now in ${e.name}`}))},[o,g,e.name,X,r]),p.useEffect(()=>{if(u&&u.length>0){const Z=u[u.length-1];if(console.log("[HMS] Notification:",Z),Z.type===fo.ERROR){const ne=Z.data;console.error("[HMS] Error received:",{code:ne==null?void 0:ne.code,message:ne==null?void 0:ne.message,description:ne==null?void 0:ne.description,isTerminal:ne==null?void 0:ne.isTerminal,action:ne==null?void 0:ne.action}),g&&(v(!1),X({title:"Connection failed",description:`${(ne==null?void 0:ne.message)||"Could not connect to voice channel"} (Code: ${ne==null?void 0:ne.code})`,variant:"destructive"}))}Z.type===fo.PEER_JOINED&&console.log("[HMS] Peer joined:",Z.data),Z.type===fo.PEER_LEFT&&console.log("[HMS] Peer left:",Z.data)}},[u,g,X]);const k=async()=>{try{const Z=await fetch(lt(`/api/group-voice/${e.id}/members`),{credentials:"include"});if(Z.ok){const ne=await Z.json();S(ne)}}catch(Z){console.error("Error fetching members:",Z)}},E=async()=>{v(!0);try{if(o){if(console.log("[HMS] Already connected to a room, leaving first..."),(h==null?void 0:h.type)==="individual")try{await fetch(lt("/api/voice/leave"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:h.id})}),console.log("[HMS] Notified backend to leave previous individual voice channel")}catch(ae){console.warn("[HMS] Failed to notify backend about leaving previous channel:",ae)}await i.leave(),f(null),await new Promise(ae=>setTimeout(ae,500)),X({title:"Switched channels",description:"Left previous voice call to join this group channel"})}console.log("[HMS] Requesting auth token from backend...");const ne=await(await kt("POST","/api/group-voice/join",{channelId:e.id})).json();console.log("[HMS] Auth token received, room ID:",ne.roomId),console.log("[HMS] Attempting to join room..."),await i.join({userName:t,authToken:ne.token,settings:{isAudioMuted:!1,isVideoMuted:!0}}),console.log("[HMS] Join request sent successfully"),f(e.id,"group"),X({title:"Connecting...",description:"Joining voice channel"})}catch(Z){console.error("[HMS] Error in joinChannel:",Z),v(!1);const ne=Z instanceof Error?Z.message:"Could not connect to voice channel";X({title:"Failed to join",description:ne,variant:"destructive"})}},M=async()=>{try{await i.leave(),await kt("POST","/api/group-voice/leave",{channelId:e.id}),f(null),X({title:"Left voice channel",description:"You've disconnected from the voice channel"}),s&&s()}catch(Z){console.error("Error leaving channel:",Z)}},A=async()=>{try{o&&await i.leave();const Z=await kt("POST","/api/group-voice/exit",{channelId:e.id});f(null);const ne=Z.channelDeleted;X({title:ne?"Channel deleted":"Exited channel",description:ne?"Channel was automatically deleted as you were the last member":"You've permanently left the channel"}),s&&s()}catch(Z){console.error("Error exiting channel:",Z),X({title:"Failed to exit",description:"Could not exit the channel. Please try again.",variant:"destructive"})}},F=async()=>{await i.setLocalAudioEnabled(!c)},q=async()=>{const Z=!O;G(Z);const ne=l.filter(ae=>!ae.isLocal);for(const ae of ne)ae.audioTrack&&(Z?(N(ge=>ae.id in ge?ge:{...ge,[ae.id]:100}),await i.setVolume(0,ae.audioTrack)):await i.setVolume(L[ae.id]||100,ae.audioTrack));X({title:Z?"Incoming audio muted":"Incoming audio unmuted",description:Z?"You won't hear others in the call":"You can now hear others in the call"})},P=async()=>{try{d?(await i.setScreenShareEnabled(!1),X({title:"Screen sharing stopped"})):(await i.setScreenShareEnabled(!0),X({title:"Screen sharing started",description:"Your screen is now visible to everyone"}))}catch(Z){console.error("Error toggling screen share:",Z),X({title:"Screen share error",description:"Failed to start screen sharing",variant:"destructive"})}};p.useEffect(()=>{if(!o)return;const Z=l.filter(ae=>!ae.isLocal);(async()=>{for(const ae of Z)ae.audioTrack&&O&&(N(ge=>ae.id in ge?ge:{...ge,[ae.id]:100}),await i.setVolume(0,ae.audioTrack))})()},[l.map(Z=>Z.id).join(","),O,o,i]),p.useEffect(()=>{const Z=l.filter(ae=>!ae.isLocal),ne=new Set(Z.map(ae=>ae.id));N(ae=>{const ge={};for(const[Le,Ct]of Object.entries(ae))ne.has(Le)&&(ge[Le]=Ct);return ge})},[l.map(Z=>Z.id).join(",")]);const j=()=>{navigator.clipboard.writeText(te),b(!0),X({title:"Invite link copied",description:"Share this link to invite others"}),setTimeout(()=>b(!1),2e3)},$=async Z=>{try{await kt("DELETE",`/api/group-voice/${e.id}/member/${Z}`),X({title:"Member removed",description:"User has been removed from the channel"}),k()}catch{X({title:"Error",description:"Failed to remove member",variant:"destructive"})}},W=l.filter(Z=>Z.auxiliaryTracks.length>0),ie=l.filter(Z=>!Z.isLocal);return a.jsxs("div",{className:"space-y-4",children:[m?a.jsxs(Ne,{className:"bg-primary/5 border-primary/20","data-testid":"card-in-channel",children:[a.jsx(an,{className:"pb-3",children:a.jsxs(mr,{className:"flex items-center justify-between text-lg",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"relative",children:[a.jsx(Jt,{className:"h-5 w-5"}),a.jsx("div",{className:"absolute -bottom-1 -right-1 h-3 w-3 bg-green-500 rounded-full border-2 border-background animate-pulse"})]}),a.jsx("span",{children:e.name})]}),a.jsxs(ee,{size:"sm",variant:"destructive",onClick:M,"data-testid":"button-leave-channel",children:[a.jsx(GD,{className:"h-4 w-4 mr-1"}),"Leave"]})]})}),a.jsxs(Fe,{className:"space-y-3",children:[a.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[a.jsx(ee,{size:"sm",variant:c?"secondary":"destructive",onClick:F,"data-testid":"button-toggle-audio",children:c?a.jsxs(a.Fragment,{children:[a.jsx(wd,{className:"h-4 w-4 mr-1"}),"Mute"]}):a.jsxs(a.Fragment,{children:[a.jsx(xl,{className:"h-4 w-4 mr-1"}),"Unmute"]})}),a.jsx(ee,{size:"sm",variant:O?"destructive":"secondary",onClick:q,"data-testid":"button-toggle-speaker",title:O?"Unmute incoming audio":"Mute incoming audio",children:O?a.jsxs(a.Fragment,{children:[a.jsx(KD,{className:"h-4 w-4 mr-1"}),"Speaker Off"]}):a.jsxs(a.Fragment,{children:[a.jsx(N0,{className:"h-4 w-4 mr-1"}),"Speaker"]})}),a.jsx(ee,{size:"sm",variant:d?"default":"secondary",onClick:P,"data-testid":"button-toggle-screenshare",children:d?a.jsxs(a.Fragment,{children:[a.jsx(zD,{className:"h-4 w-4 mr-1"}),"Stop Sharing"]}):a.jsxs(a.Fragment,{children:[a.jsx(Xu,{className:"h-4 w-4 mr-1"}),"Share Screen"]})})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium mb-2",children:ie.length===0?"You are alone in this channel":`You + ${ie.length} other${ie.length!==1?"s":""}`}),a.jsx("div",{className:"grid grid-cols-2 gap-2",children:l.map(Z=>{var ae;const ne=x.find(ge=>ge.userId===Z.name);return a.jsxs("div",{className:"flex items-center gap-2 bg-background rounded-lg p-2 cursor-pointer hover:bg-muted",onClick:()=>{ne!=null&&ne.userId&&(C(ne.userId),R(!0))},"data-testid":`peer-${Z.id}`,children:[a.jsxs(Tn,{className:"h-8 w-8",children:[ne!=null&&ne.profileImageUrl?a.jsx(tr,{src:ne.profileImageUrl}):null,a.jsx(Cn,{children:((ae=Z.name[0])==null?void 0:ae.toUpperCase())||"?"})]}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm font-medium truncate",children:(ne==null?void 0:ne.gamertag)||Z.name}),a.jsxs("div",{className:"flex gap-1",children:[Z.audioTrack?a.jsx(wd,{className:"h-3 w-3 text-green-500"}):a.jsx(xl,{className:"h-3 w-3 text-muted-foreground"}),Z.auxiliaryTracks.length>0&&a.jsx(Xu,{className:"h-3 w-3 text-primary"})]})]})]},Z.id)})})]}),W.length>0&&a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium mb-2",children:"Screen Shares"}),a.jsx("div",{className:"grid gap-2",children:W.map(Z=>{const ne=x.find(ae=>ae.userId===Z.name);return a.jsxs("div",{className:"bg-black rounded-lg overflow-hidden aspect-video relative","data-testid":`screenshare-${Z.id}`,children:[a.jsx("video",{ref:ae=>{if(ae&&Z.auxiliaryTracks[0]){const ge=Z.auxiliaryTracks[0],Le=typeof ge=="string"?ge:ge.id;i.attachVideo(Le,ae)}},autoPlay:!0,muted:!0,playsInline:!0,controls:!0,className:"w-full h-full object-contain"}),a.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/70 to-transparent p-2",children:a.jsxs("p",{className:"text-xs text-white font-medium",children:[(ne==null?void 0:ne.gamertag)||Z.name,"'s screen"]})})]},Z.id)})})]})]})]}):a.jsxs(Ne,{"data-testid":"card-join-channel",children:[a.jsx(an,{className:"pb-3",children:a.jsxs(mr,{className:"flex items-center gap-2 text-lg",children:[a.jsx(Jt,{className:"h-5 w-5"}),e.name]})}),a.jsxs(Fe,{className:"space-y-3",children:[a.jsxs("div",{className:"text-sm text-muted-foreground",children:[a.jsxs("p",{children:[e.memberCount," member",e.memberCount!==1?"s":""]}),a.jsxs("p",{className:"text-xs mt-1",children:["Created by ",e.creatorGamertag||"Unknown"]})]}),a.jsx("div",{className:"space-y-2",children:a.jsxs("div",{className:"flex gap-2",children:[a.jsx(ee,{onClick:E,disabled:g,className:"flex-1","data-testid":"button-join-channel",children:g?"Joining...":"Join Voice Channel"}),a.jsx(ee,{variant:"outline",size:"icon",onClick:j,"data-testid":"button-copy-invite",children:y?a.jsx(Zr,{className:"h-4 w-4"}):a.jsx(A8,{className:"h-4 w-4"})})]})}),a.jsxs(ee,{variant:"ghost",size:"sm",onClick:A,className:"text-xs text-destructive hover:bg-destructive/10","data-testid":"button-exit-channel",children:[a.jsx(Ot,{className:"h-3 w-3 mr-1"}),"Exit Channel"]}),Q&&a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"h-2 w-2 bg-green-500 rounded-full animate-pulse"}),a.jsxs("span",{className:"text-xs font-semibold text-green-600 dark:text-green-400",children:["Active Now (",x.filter(Z=>Z.isActive).length,")"]})]}),a.jsx("div",{className:"flex flex-wrap gap-1.5",children:x.filter(Z=>Z.isActive).map(Z=>{var ne,ae;return a.jsxs("div",{className:"flex items-center gap-1.5 bg-green-500/10 border border-green-500/30 rounded-full px-2 py-1","data-testid":`active-member-${Z.userId}`,children:[a.jsxs(Tn,{className:"h-5 w-5 ring-1 ring-green-500",children:[a.jsx(tr,{src:Z.profileImageUrl||void 0}),a.jsx(Cn,{className:"text-xs",children:((ae=(ne=Z.gamertag)==null?void 0:ne[0])==null?void 0:ae.toUpperCase())||"?"})]}),a.jsx("span",{className:"text-xs font-medium cursor-pointer hover:underline",onClick:()=>{C(Z.userId),R(!0)},"data-testid":`active-member-name-${Z.userId}`,children:Z.gamertag||"Unknown"}),a.jsx("div",{className:"h-1.5 w-1.5 bg-green-500 rounded-full animate-pulse","data-testid":`active-indicator-${Z.userId}`})]},Z.id)})})]}),a.jsxs(Hhe,{open:H,onOpenChange:re,children:[a.jsx(qhe,{asChild:!0,children:a.jsxs(ee,{variant:"outline",size:"sm",className:"w-full","data-testid":"button-view-all-members",children:[a.jsx(Jt,{className:"h-4 w-4 mr-2"}),"View All Members (",x.length,")"]})}),a.jsxs(DB,{"data-testid":"sheet-channel-members",children:[a.jsx(OB,{children:a.jsx(LB,{"data-testid":"title-channel-members",children:"Channel Members"})}),a.jsx("div",{className:"mt-6 space-y-3",children:x.map(Z=>{var ne,ae;return a.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-md ${Z.isActive?"bg-green-500/10 border border-green-500/30":"bg-muted"}`,"data-testid":`member-${Z.userId}`,children:[a.jsxs(Tn,{className:`h-10 w-10 ${Z.isActive?"ring-2 ring-green-500":""}`,children:[a.jsx(tr,{src:Z.profileImageUrl||void 0}),a.jsx(Cn,{children:((ae=(ne=Z.gamertag)==null?void 0:ne[0])==null?void 0:ae.toUpperCase())||"?"})]}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-medium cursor-pointer hover:underline truncate",onClick:()=>{C(Z.userId),R(!0)},"data-testid":`member-name-${Z.userId}`,children:Z.gamertag||"Unknown"}),Z.isActive&&a.jsx("div",{className:"h-2 w-2 bg-green-500 rounded-full animate-pulse","data-testid":`active-${Z.userId}`})]}),Z.isActive&&a.jsx("p",{className:"text-xs text-green-600 dark:text-green-400",children:"Active in voice"})]}),e.creatorId===t&&Z.userId!==t&&a.jsx(ee,{size:"sm",variant:"ghost",className:"text-destructive hover:bg-destructive hover:text-destructive-foreground",onClick:()=>$(Z.userId),"data-testid":`button-remove-${Z.userId}`,children:a.jsx(Ot,{className:"h-4 w-4"})})]},Z.id)})})]})]})]})]}),I&&w&&V&&a.jsx(xi,{userId:w,gamertag:V.gamertag||V.firstName||"Unknown",profileImageUrl:V.profileImageUrl||void 0,currentUserId:t,trigger:a.jsx("button",{style:{display:"none"},ref:Z=>{Z&&I&&setTimeout(()=>{Z.click(),R(!1)},50)}})})]})}function Xhe({currentUserId:e}){const[t,n]=p.useState(!1),[r,s]=p.useState(!1),[i,o]=p.useState(!1),[l,c]=p.useState(""),[d,u]=p.useState(""),[h,f]=p.useState(null),[m,g]=p.useState([]),[v,x]=p.useState(!1),[S,y]=p.useState(""),[b,w]=p.useState(""),[C,I]=p.useState(()=>localStorage.getItem("activeGroupVoiceChannelId")),{toast:R}=Wn(),{getContainerClass:L}=Ri(),N=pr(Zs),[,O]=Jl();p.useEffect(()=>{!N&&C&&(I(null),localStorage.removeItem("activeGroupVoiceChannelId"))},[N,C]);const G=se=>{I(se),localStorage.setItem("activeGroupVoiceChannelId",se)},H=()=>{I(null),localStorage.removeItem("activeGroupVoiceChannelId"),ze.invalidateQueries({queryKey:["/api/group-voice/channels"]})};if(!e)return a.jsx("div",{className:"p-4 text-center text-muted-foreground",children:"Loading..."});const{data:re=[],isLoading:X}=Pt({queryKey:["/api/group-voice/channels"]}),Q=re.filter(se=>{var Y;if(!S.trim())return!0;const Ee=S.toLowerCase(),U=se.name.toLowerCase().includes(Ee),J=(Y=se.members)==null?void 0:Y.some(ce=>{var he;return(he=ce.gamertag)==null?void 0:he.toLowerCase().includes(Ee)});return U||J}).sort((se,Ee)=>{var Y,ce;const U=((Y=se.members)==null?void 0:Y.some(he=>he.isActive))||!1,J=((ce=Ee.members)==null?void 0:ce.some(he=>he.isActive))||!1;return U&&!J?-1:!U&&J?1:0}),{data:V=[]}=Pt({queryKey:["/api/group-voice/invites"]}),te=V.filter(se=>se.inviteeId===e),k=V.filter(se=>se.inviterId===e),{data:E}=Pt({queryKey:["/api/user/connections"]}),{data:M}=Pt({queryKey:["/api/connection-requests"]}),{data:A}=Pt({queryKey:["/api/users"]}),F=(E==null?void 0:E.filter(se=>se.status==="accepted"))||[],q=(M==null?void 0:M.filter(se=>se.status==="accepted"))||[];A!=null&&A.users;const P=Nt({mutationFn:async se=>{console.log("Creating channel with name:",se);const Ee=await kt("POST","/api/group-voice/create",{name:se});console.log("Response received:",Ee.status);const U=await Ee.json();return console.log("Response data:",U),U},onSuccess:se=>{console.log("Channel created successfully:",se),ze.invalidateQueries({queryKey:["/api/group-voice/channels"]}),n(!1),c(""),R({title:"Channel created",description:"Your voice channel is ready"})},onError:se=>{console.error("Error creating channel:",se),R({title:"Error",description:"Failed to create channel",variant:"destructive"})}}),j=Nt({mutationFn:async({channelId:se,userIds:Ee})=>await(await kt("POST","/api/group-voice/invite",{channelId:se,userIds:Ee})).json(),onSuccess:se=>{ze.invalidateQueries({queryKey:["/api/group-voice/invites"]}),ze.invalidateQueries({queryKey:["/api/group-voice/channels"]}),s(!1),g([]),R({title:"Invites sent",description:se.message||`Invited ${se.invitedCount||0} user(s)`})},onError:()=>{R({title:"Error",description:"Failed to send invites",variant:"destructive"})}}),$=Nt({mutationFn:async se=>await(await kt("DELETE",`/api/group-voice/invite/${se}`)).json(),onSuccess:()=>{ze.invalidateQueries({queryKey:["/api/group-voice/invites"]}),R({title:"Invite cancelled",description:"The invitation has been withdrawn"})},onError:()=>{R({title:"Error",description:"Failed to cancel invite",variant:"destructive"})}}),W=Nt({mutationFn:async se=>await(await kt("POST",`/api/group-voice/invite/${se}/accept`)).json(),onSuccess:()=>{ze.invalidateQueries({queryKey:["/api/group-voice/invites"]}),ze.invalidateQueries({queryKey:["/api/group-voice/channels"]}),R({title:"Invite accepted",description:"You've joined the voice channel"})},onError:()=>{R({title:"Error",description:"Failed to accept invite",variant:"destructive"})}}),ie=Nt({mutationFn:async se=>await(await kt("POST",`/api/group-voice/invite/${se}/decline`)).json(),onSuccess:()=>{ze.invalidateQueries({queryKey:["/api/group-voice/invites"]}),R({title:"Invite declined",description:"You've declined the channel invite"})},onError:()=>{R({title:"Error",description:"Failed to decline invite",variant:"destructive"})}}),Z=()=>{if(!l.trim()){R({title:"Name required",description:"Please enter a channel name",variant:"destructive"});return}P.mutate(l)},ne=()=>{if(!h||m.length===0){R({title:"Select friends",description:"Please select at least one friend to invite",variant:"destructive"});return}j.mutate({channelId:h.id,userIds:m})},ae=()=>ge().filter(U=>{var Y,ce;if(!b.trim())return!0;const J=b.toLowerCase();return((Y=U.gamertag)==null?void 0:Y.toLowerCase().includes(J))||((ce=U.firstName)==null?void 0:ce.toLowerCase().includes(J))}).sort((U,J)=>{const Y=Ct((h==null?void 0:h.id)||"",U.id),ce=Ct((h==null?void 0:h.id)||"",J.id),he={none:0,sent:1,member:2},fe=he[Y.status]||0,je=he[ce.status]||0;return fe-je}),ge=()=>{const se=F.map(Y=>{const ce=Y.requesterId===e,he=ce?Y.accepterId:Y.requesterId,fe=ce?Y.accepterGamertag:Y.requesterGamertag,je=ce?Y.accepterProfileImageUrl:Y.requesterProfileImageUrl;return{id:he,gamertag:fe,profileImageUrl:je}}).filter(Y=>Y.id&&Y.gamertag),Ee=q.filter(Y=>Y.status==="accepted").map(Y=>{const ce=Y.senderId===e,he=ce?Y.receiverId:Y.senderId,fe=ce?Y.receiverGamertag:Y.senderGamertag,je=ce?Y.receiverProfileImageUrl:Y.senderProfileImageUrl;return{id:he,gamertag:fe,profileImageUrl:je}}).filter(Y=>Y.id&&Y.gamertag),U=[...se,...Ee],J=new Map;return U.forEach(Y=>{J.has(Y.id)||J.set(Y.id,Y)}),Array.from(J.values())},Le=se=>k.filter(Ee=>Ee.channelId===se),Ct=(se,Ee)=>{var ce;const J=Le(se).find(he=>he.inviteeId===Ee);return h?((ce=h.members)==null?void 0:ce.some(he=>he.userId===Ee))?{status:"member",inviteId:null}:J?{status:"sent",inviteId:J.id}:{status:"none",inviteId:null}:{status:"none",inviteId:null}},pn=se=>{g(Ee=>Ee.includes(se)?Ee.filter(U=>U!==se):[...Ee,se])},mn=()=>{window.location.reload()},Fn=()=>{if(!d.trim()){R({title:"Invalid link",description:"Please paste a valid invite link",variant:"destructive"});return}const se=/join-channel\/([a-zA-Z0-9]+)/,Ee=d.match(se);if(!Ee||!Ee[1]){R({title:"Invalid link",description:"Please paste a valid invite link",variant:"destructive"});return}const U=Ee[1];o(!1),u(""),O(`/join-channel/${U}`)};return X?a.jsx("div",{className:"p-4",children:"Loading channels..."}):a.jsxs("div",{className:`w-full ${L()} mx-auto space-y-6`,children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start gap-3",children:[a.jsxs("div",{children:[a.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2","data-testid":"heading-voice-channels",children:[a.jsx(F8,{className:"h-6 w-6 text-primary"}),"Voice Channels"]}),a.jsx("p",{className:"text-muted-foreground",children:"Create and join group voice channels"})]}),a.jsxs("div",{className:"flex gap-2 flex-wrap sm:ml-auto",children:[a.jsx(ee,{variant:"outline",size:"sm",onClick:mn,disabled:v,"data-testid":"button-refresh-channels",className:`transition-transform ${v?"scale-95":"hover:scale-105"}`,children:a.jsx(bl,{className:`h-4 w-4 ${v?"animate-spin":""}`})}),a.jsxs(gr,{open:i,onOpenChange:o,children:[a.jsx(Vl,{asChild:!0,children:a.jsxs(ee,{variant:"outline",size:"sm","data-testid":"button-paste-invite",children:[a.jsx(L8,{className:"h-4 w-4 mr-2"}),"Paste Invite Link"]})}),a.jsxs(nr,{"data-testid":"dialog-paste-invite",children:[a.jsx(rr,{children:a.jsx(sr,{children:"Join with Invite Link"})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(Xn,{htmlFor:"invite-link",children:"Invite Link"}),a.jsx(tt,{id:"invite-link",value:d,onChange:se=>u(se.target.value),placeholder:"Paste invite link here...","data-testid":"input-invite-link",onKeyDown:se=>{se.key==="Enter"&&Fn()}}),a.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Example: https://nexus-final-tau.vercel.app/join-channel/abc123"})]}),a.jsx(ee,{onClick:Fn,className:"w-full","data-testid":"button-submit-paste-invite",children:"Join Channel"})]})]})]}),a.jsxs(gr,{open:t,onOpenChange:n,children:[a.jsx(Vl,{asChild:!0,children:a.jsxs(ee,{size:"sm","data-testid":"button-create-channel",children:[a.jsx(Nr,{className:"h-4 w-4 mr-2"}),"Create Channel"]})}),a.jsxs(nr,{"data-testid":"dialog-create-channel",children:[a.jsx(rr,{children:a.jsx(sr,{children:"Create Voice Channel"})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(Xn,{htmlFor:"channel-name",children:"Channel Name"}),a.jsx(tt,{id:"channel-name",value:l,onChange:se=>c(se.target.value),placeholder:"Enter channel name","data-testid":"input-channel-name"})]}),a.jsx(ee,{onClick:Z,disabled:P.isPending,className:"w-full","data-testid":"button-submit-create",children:P.isPending?"Creating...":"Create Channel"})]})]})]})]})]}),a.jsx(Ne,{className:"mb-6",children:a.jsx(Fe,{className:"p-4",children:a.jsxs("div",{className:"relative",children:[a.jsx(wo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground pointer-events-none z-10"}),a.jsx(tt,{type:"text",placeholder:"Search channels by name or members...",value:S,onChange:se=>y(se.target.value),className:"pl-10 overflow-x-auto whitespace-nowrap",style:{textOverflow:"clip",scrollbarWidth:"none",msOverflowStyle:"none"},"data-testid":"input-search-channels"})]})})}),te.length>0&&a.jsxs("div",{className:"space-y-2",children:[a.jsx("h2",{className:"text-xl font-semibold",children:"Pending Invites"}),a.jsx("div",{className:"grid gap-3",children:te.map(se=>{var Ee,U;return a.jsx(Ne,{children:a.jsx(Fe,{className:"pt-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(xi,{userId:se.inviterId,gamertag:se.inviterGamertag||void 0,profileImageUrl:se.inviterProfileImageUrl||void 0,currentUserId:e,trigger:a.jsx("button",{className:"hover:opacity-80 transition-opacity",children:a.jsxs(Tn,{className:"h-10 w-10 cursor-pointer hover:ring-2 hover:ring-primary","data-testid":`avatar-inviter-${se.id}`,children:[a.jsx(tr,{src:se.inviterProfileImageUrl||void 0}),a.jsx(Cn,{children:((U=(Ee=se.inviterGamertag)==null?void 0:Ee[0])==null?void 0:U.toUpperCase())||"?"})]})})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:se.channelName||"Voice Channel"}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:["Invited by"," ",a.jsx(xi,{userId:se.inviterId,gamertag:se.inviterGamertag||void 0,profileImageUrl:se.inviterProfileImageUrl||void 0,currentUserId:e,trigger:a.jsx("span",{className:"cursor-pointer hover:underline inline","data-testid":`inviter-name-${se.id}`,children:se.inviterGamertag||"Unknown"})})]})]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(ee,{size:"sm",onClick:()=>W.mutate(se.id),disabled:W.isPending,"data-testid":`button-accept-invite-${se.id}`,children:"Accept"}),a.jsx(ee,{size:"sm",variant:"outline",onClick:()=>ie.mutate(se.id),disabled:ie.isPending,"data-testid":`button-decline-invite-${se.id}`,children:a.jsx(Ot,{className:"h-4 w-4"})})]})]})})},se.id)})})]}),k.length>0&&a.jsxs("div",{className:"space-y-2",children:[a.jsx("h2",{className:"text-xl font-semibold",children:"Sent Invites"}),a.jsx("div",{className:"grid gap-3",children:k.map(se=>{var Ee,U;return a.jsx(Ne,{children:a.jsx(Fe,{className:"pt-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(xi,{userId:se.inviteeId,gamertag:se.inviteeGamertag||void 0,profileImageUrl:se.inviteeProfileImageUrl||void 0,currentUserId:e,trigger:a.jsx("button",{className:"hover:opacity-80 transition-opacity",children:a.jsxs(Tn,{className:"h-10 w-10 cursor-pointer hover:ring-2 hover:ring-primary","data-testid":`avatar-invitee-${se.id}`,children:[a.jsx(tr,{src:se.inviteeProfileImageUrl||void 0}),a.jsx(Cn,{children:((U=(Ee=se.inviteeGamertag)==null?void 0:Ee[0])==null?void 0:U.toUpperCase())||"?"})]})})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:se.channelName||"Voice Channel"}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:["Sent to"," ",a.jsx(xi,{userId:se.inviteeId,gamertag:se.inviteeGamertag||void 0,profileImageUrl:se.inviteeProfileImageUrl||void 0,currentUserId:e,trigger:a.jsx("span",{className:"cursor-pointer hover:underline inline","data-testid":`invitee-name-${se.id}`,children:se.inviteeGamertag||"Unknown"})})]})]})]}),a.jsx("div",{className:"flex gap-2",children:a.jsx(ee,{size:"sm",variant:"outline",onClick:()=>$.mutate(se.id),disabled:$.isPending,"data-testid":`button-cancel-sent-invite-${se.id}`,children:"Cancel"})})]})})},se.id)})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h2",{className:"text-xl font-semibold",children:"My Channels"}),a.jsx("div",{className:"grid gap-4",children:Q.length===0?a.jsx(Ne,{children:a.jsx(Fe,{className:"pt-6",children:a.jsxs("div",{className:"text-center text-muted-foreground",children:[a.jsx(Jt,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),a.jsx("p",{children:"No voice channels yet"}),a.jsx("p",{className:"text-sm",children:"Create your first channel to get started"})]})})}):Q.map(se=>{var U,J,Y;const Ee=((U=se.members)==null?void 0:U.some(ce=>ce.isActive))||!1;return a.jsx("div",{children:a.jsxs(Ne,{className:Ee?"border-green-500/50 bg-green-500/5":"",children:[a.jsx(an,{children:a.jsxs(mr,{className:"flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[a.jsx("span",{className:"truncate",children:se.name}),Ee&&a.jsxs("div",{className:"flex items-center gap-1.5 bg-green-500/20 border border-green-500/40 rounded-full px-2 py-0.5 shrink-0",children:[a.jsx("div",{className:"h-2 w-2 bg-green-500 rounded-full animate-pulse"}),a.jsxs("span",{className:"text-xs font-semibold text-green-600 dark:text-green-400",children:[(J=se.members)==null?void 0:J.filter(ce=>ce.isActive).length," Active"]})]})]}),((Y=se.members)==null?void 0:Y.some(ce=>ce.userId===e))&&a.jsxs(ee,{size:"sm",variant:"outline",onClick:()=>{f(se),s(!0)},"data-testid":`button-invite-${se.id}`,className:"shrink-0",children:[a.jsx(Km,{className:"h-4 w-4 mr-1"}),"Invite"]})]})}),a.jsx(Fe,{children:a.jsx(Yhe,{channel:se,currentUserId:e,isActiveChannel:C===se.id,onJoin:()=>G(se.id),onLeave:H})})]})},se.id)})})]}),a.jsx(gr,{open:r,onOpenChange:se=>{s(se),se||(w(""),g([]))},children:a.jsxs(nr,{"data-testid":"dialog-invite-friends",children:[a.jsx(rr,{children:a.jsx(sr,{children:"Invite Friends"})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx(wo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground pointer-events-none z-10"}),a.jsx(tt,{type:"text",placeholder:"Search friends...",value:b,onChange:se=>w(se.target.value),className:"pl-10","data-testid":"input-search-friends"})]}),a.jsxs("div",{className:"max-h-80 overflow-y-auto space-y-2",children:[ae().map(se=>{var J,Y;const Ee=Ct((h==null?void 0:h.id)||"",se.id),U=Ee.status!=="none";return a.jsxs("div",{className:`flex items-center justify-between gap-3 p-2 rounded-lg ${U?"opacity-60":"hover:bg-muted cursor-pointer"}`,onClick:()=>!U&&pn(se.id),"data-testid":`friend-item-${se.id}`,children:[a.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[a.jsx(jB,{checked:m.includes(se.id),onCheckedChange:()=>!U&&pn(se.id),onClick:ce=>ce.stopPropagation(),disabled:U}),a.jsxs(Tn,{className:"h-8 w-8",children:[a.jsx(tr,{src:se.profileImageUrl||void 0}),a.jsx(Cn,{children:((Y=(J=se.gamertag)==null?void 0:J[0])==null?void 0:Y.toUpperCase())||"?"})]}),a.jsx("span",{className:"flex-1",children:se.gamertag||se.firstName||"Unknown"})]}),Ee.status==="member"&&a.jsx("span",{className:"text-xs text-muted-foreground px-2 py-1 bg-secondary rounded",children:"Member"}),Ee.status==="sent"&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-xs text-primary px-2 py-1 bg-primary/10 rounded",children:"Sent"}),a.jsx(ee,{variant:"ghost",size:"sm",className:"h-6 text-xs px-2",onClick:ce=>{ce.stopPropagation(),Ee.inviteId&&$.mutate(Ee.inviteId)},"data-testid":`button-cancel-invite-${se.id}`,children:"Cancel"})]})]},se.id)}),ae().length===0&&a.jsx("p",{className:"text-center text-muted-foreground py-4",children:b.trim()?"No friends found matching your search.":"No friends to invite. Add friends first!"})]}),a.jsx(ee,{onClick:ne,disabled:m.length===0||j.isPending,className:"w-full","data-testid":"button-submit-invite",children:j.isPending?"Inviting...":`Invite ${m.length} friend(s)`})]})]})})]})}function Zhe(){var y,b;const[,e]=MW("/join-channel/:inviteCode"),[,t]=Jl(),{toast:n}=Wn(),{user:r,isAuthenticated:s,isLoading:i}=mk(),[o,l]=p.useState(!1),[c,d]=p.useState(!1),u=e==null?void 0:e.inviteCode;p.useEffect(()=>{u&&sessionStorage.setItem("pendingInviteCode",u)},[u]);const{data:h,isLoading:f,error:m}=Pt({queryKey:["/api/group-voice/channel-by-code",u],queryFn:async()=>{if(!u)throw new Error("No invite code provided");const w=await fetch(lt(`/api/group-voice/channel-by-code/${u}`),{credentials:"include"});if(!w.ok){const C=await w.json().catch(()=>({error:"Channel not found"}));throw new Error(C.error||"Channel not found")}return w.json()},enabled:!!u}),g=Nt({mutationFn:async w=>(await kt("POST","/api/group-voice/accept-invite-link",{channelId:w})).json(),onSuccess:()=>{ze.invalidateQueries({queryKey:["/api/group-voice/channels"]}),ze.invalidateQueries({queryKey:["/api/group-voice/invites"]}),sessionStorage.removeItem("pendingInviteCode"),n({title:"Success!",description:"You've joined the voice channel"}),setTimeout(()=>{t("/voice-channels")},1e3)},onError:w=>{n({title:"Error",description:w.message||"Failed to join channel",variant:"destructive"})}});p.useEffect(()=>{var w;!i&&s&&r&&h&&!c&&(d(!0),((w=h.members)==null?void 0:w.some(I=>I.userId===r.id))?(sessionStorage.removeItem("pendingInviteCode"),n({title:"Already a member",description:"You're already in this channel"}),setTimeout(()=>{t("/voice-channels")},1500)):v())},[i,s,r,h,c]),p.useEffect(()=>{!i&&!s&&u&&(n({title:"Login Required",description:"Please log in to join this voice channel"}),setTimeout(()=>{t("/")},1500))},[i,s,u]);const v=async()=>{if(h){l(!0);try{await g.mutateAsync(h.id)}finally{l(!1)}}};if(!u)return a.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:a.jsx(Ne,{className:"max-w-md w-full",children:a.jsxs(Fe,{className:"pt-6 text-center",children:[a.jsx(tw,{className:"h-12 w-12 text-destructive mx-auto mb-4"}),a.jsx("p",{className:"text-lg font-semibold mb-2",children:"Invalid Invite Link"}),a.jsx("p",{className:"text-muted-foreground mb-4",children:"The invite link appears to be invalid or incomplete."}),a.jsx(ee,{onClick:()=>t("/"),"data-testid":"button-go-home",children:"Go Home"})]})})});if(i||f)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx(Rl,{className:"h-12 w-12 animate-spin mx-auto mb-4 text-primary"}),a.jsx("p",{className:"text-muted-foreground",children:i?"Checking authentication...":"Loading channel details..."})]})});if(m||!h)return a.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:a.jsx(Ne,{className:"max-w-md w-full",children:a.jsxs(Fe,{className:"pt-6 text-center",children:[a.jsx(tw,{className:"h-12 w-12 text-destructive mx-auto mb-4"}),a.jsx("p",{className:"text-lg font-semibold mb-2",children:"Channel Not Found"}),a.jsx("p",{className:"text-muted-foreground mb-4",children:m instanceof Error?m.message:"This invite link may be expired or invalid."}),a.jsx(ee,{onClick:()=>t("/"),"data-testid":"button-go-home",children:"Go Home"})]})})});const x=((y=h.members)==null?void 0:y.length)||0,S=r?(b=h.members)==null?void 0:b.some(w=>w.userId===r.id):!1;return a.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:a.jsxs(Ne,{className:"max-w-md w-full",children:[a.jsx(an,{children:a.jsxs(mr,{className:"text-center flex items-center justify-center gap-2",children:[a.jsx(Jt,{className:"h-6 w-6 text-primary"}),"Voice Channel Invite"]})}),a.jsxs(Fe,{className:"space-y-6",children:[a.jsxs("div",{className:"text-center space-y-2",children:[a.jsx("h2",{className:"text-2xl font-bold",children:h.name}),a.jsx("p",{className:"text-muted-foreground",children:"You've been invited to join this voice channel"})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted rounded-lg",children:[a.jsx("span",{className:"text-sm text-muted-foreground",children:"Members"}),a.jsx("span",{className:"font-semibold",children:x})]}),h.members&&h.members.length>0&&a.jsxs("div",{className:"space-y-2",children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"Channel Members:"}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[h.members.slice(0,5).map(w=>{var C,I;return a.jsxs("div",{className:"flex items-center gap-2 p-2 bg-muted rounded-lg",children:[a.jsxs(Tn,{className:"h-6 w-6",children:[a.jsx(tr,{src:w.profileImageUrl||void 0}),a.jsx(Cn,{className:"text-xs",children:((I=(C=w.gamertag)==null?void 0:C[0])==null?void 0:I.toUpperCase())||"?"})]}),a.jsx("span",{className:"text-sm",children:w.gamertag||"Unknown"})]},w.userId)}),x>5&&a.jsx("div",{className:"flex items-center p-2 bg-muted rounded-lg",children:a.jsxs("span",{className:"text-sm text-muted-foreground",children:["+",x-5," more"]})})]})]})]}),a.jsxs("div",{className:"flex flex-col gap-2",children:[a.jsx(ee,{onClick:v,disabled:o||S,className:"w-full","data-testid":"button-join-channel",children:o?a.jsxs(a.Fragment,{children:[a.jsx(Rl,{className:"h-4 w-4 mr-2 animate-spin"}),"Joining..."]}):S?"Already a Member":"Join Channel"}),a.jsx(ee,{variant:"outline",onClick:()=>t("/"),"data-testid":"button-decline",children:"Decline"})]})]})]})})}function efe(){return a.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-gray-50",children:a.jsx(Ne,{className:"w-full max-w-md mx-4",children:a.jsxs(Fe,{className:"pt-6",children:[a.jsxs("div",{className:"flex mb-4 gap-2",children:[a.jsx(tw,{className:"h-8 w-8 text-red-500"}),a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"404 Page Not Found"})]}),a.jsx("p",{className:"mt-4 text-sm text-gray-600",children:"Did you forget to add the page to the router?"})]})})})}function tfe(){const e=p.useRef(null);return p.useEffect(()=>{const t=e.current;if(!t)return;const n=t.getContext("2d");if(!n)return;let r,s=[];const i=()=>{const{innerWidth:c,innerHeight:d}=window;t.width=c,t.height=d,s=nfe(200,c,d)};i(),window.addEventListener("resize",i);let o=0;const l=()=>{o+=.3,n.fillStyle="rgba(3, 7, 18, 1)",n.fillRect(0,0,t.width,t.height);const c=t.width/2,d=t.height/2;s.forEach(u=>{u.z-=2,u.z<=0&&(u.z=1e3,u.x=Math.random()*t.width-t.width/2,u.y=Math.random()*t.height-t.height/2);const h=128/u.z,f=u.x*h+c,m=u.y*h+d;if(f>=0&&f<=t.width&&m>=0&&m<=t.height){const g=(1-u.z/1e3)*u.size,v=1-u.z/1e3,S=200+Math.sin(o*.001+u.x)*30;n.fillStyle=`hsla(${S}, 70%, 80%, ${v})`,n.beginPath(),n.arc(f,m,g,0,Math.PI*2),n.fill()}}),r=requestAnimationFrame(l)};return l(),()=>{window.removeEventListener("resize",i),cancelAnimationFrame(r)}},[]),a.jsx("canvas",{ref:e,style:{position:"fixed",inset:0,width:"100%",height:"100vh",zIndex:0,pointerEvents:"none",opacity:.4}})}function nfe(e,t,n){const r=[];for(let s=0;s<e;s++)r.push({x:Math.random()*t-t/2,y:Math.random()*n-n/2,z:Math.random()*1e3,size:Math.random()*2+.5});return r}function rfe(){const e=p.useRef(null);return p.useEffect(()=>{const t=e.current;if(!t)return;const n=Math.max(1,.5*devicePixelRatio);let r=null,s=null;const i=()=>{const{innerWidth:l,innerHeight:c}=window;t.width=l*n,t.height=c*n,r&&r.updateScale(n)},o=`#version 300 es
/*********
* Based on shader by Matthias Hurrle (@atzedent)
* Simplified version without 3D ball geometry
*/ 
precision highp float;
out vec4 O;
uniform float time;
uniform vec2 resolution;
uniform vec2 touch;
uniform int pointerCount;

#define mouse (touch / R)
#define P pointerCount
#define FC gl_FragCoord.xy
#define R resolution
#define T time
#define rot(a) mat2(cos(a - vec4(0,11,33,0)))

vec3 stars(vec2 uv) {
  vec3 col = vec3(0.0);
  vec3 ro = vec3(0.2 + sin(T * 0.2) * 0.1, 1.0, T * 0.1);
  vec3 rd = vec3(uv, 0.2);
  float d = 0.0, e = 0.0;

  for (int i = 0; i < 40; i++) {
    vec3 p = ro + rd * d;
    p.z = fract(p.z);
    for (int j = 0; j < 10; j++) {
      p = abs(p) / dot(p, p * 0.5) - 0.8;
    }
    e += (1.0 - e) * dot(p, p) * 0.002;
    col += vec3(e * 0.8, 0.5 - d, d * 0.5) * e * 0.05;
    d += 0.01;
  }

  return col;
}

void cam(inout vec3 p) {
  if (P > 0) {
    p.yz *= rot(-mouse.y * 3.14 + 1.57);
    p.xz *= rot(1.57 - mouse.x * 3.14);
  } else {
    p.xz *= rot(sin(T * 0.125) * 0.75);
  }
}

void main() {
  vec2 uv = (FC - 0.5 * R) / min(R.x, R.y);
  vec3 col = vec3(0.0);
  vec3 p = vec3(sin(T), cos(T), T * 0.5);
  vec3 rd = normalize(vec3(uv, 1.0));

  cam(p);
  cam(rd);

  // Only stars and background color
  col = stars(rd.xy);
  col = mix(col, vec3(0.3, 0.6, 0.9), pow(abs(rd.y), 1.4));

  O = vec4(col, 1.0);
}`;try{r=new sfe(t,n),s=new ife(t,n),r.setup(),r.init(),i(),r.test(o)===null&&r.updateShader(o),window.addEventListener("resize",i);const l=c=>{r&&s&&(r.updateMouse(s.first),r.updatePointerCount(s.count),r.updatePointerCoords(s.coords),r.render(c)),requestAnimationFrame(l)};l(0)}catch(l){console.error("WebGL background error:",l)}return()=>{window.removeEventListener("resize",i)}},[]),a.jsx("canvas",{ref:e,style:{position:"fixed",inset:0,width:"100%",height:"100vh",zIndex:0,pointerEvents:"none",opacity:.6}})}class sfe{constructor(t,n){this.vertexSrc=`#version 300 es
precision highp float;
in vec4 position;
void main(){gl_Position=position;}`,this.fragmtSrc=`#version 300 es
precision highp float;
out vec4 O;
uniform float time;
uniform vec2 resolution;
void main(){vec2 uv=gl_FragCoord.xy/resolution;O=vec4(uv,sin(time)*.5+.5,1);}`,this.vertices=[-1,1,-1,-1,1,1,1,-1],this.canvas=t,this.scale=n;const r=t.getContext("webgl2");if(!r)throw new Error("WebGL2 not supported");this.gl=r,this.gl.viewport(0,0,t.width*n,t.height*n),this.shaderSource=this.fragmtSrc,this.mouseCoords=[0,0],this.pointerCoords=[0,0],this.nbrOfPointers=0}get defaultSource(){return this.fragmtSrc}updateShader(t){this.reset(),this.shaderSource=t,this.setup(),this.init()}updateMouse(t){this.mouseCoords=t}updatePointerCoords(t){this.pointerCoords=t}updatePointerCount(t){this.nbrOfPointers=t}updateScale(t){this.scale=t,this.gl.viewport(0,0,this.canvas.width*t,this.canvas.height*t)}compile(t,n){const r=this.gl;r.shaderSource(t,n),r.compileShader(t),r.getShaderParameter(t,r.COMPILE_STATUS)||console.error(r.getShaderInfoLog(t))}test(t){let n=null;const r=this.gl,s=r.createShader(r.FRAGMENT_SHADER);return s?(r.shaderSource(s,t),r.compileShader(s),r.getShaderParameter(s,r.COMPILE_STATUS)||(n=r.getShaderInfoLog(s)),n):"Failed to create shader"}reset(){const{gl:t,program:n,vs:r,fs:s}=this;n&&(t.deleteProgram(n),r&&t.deleteShader(r),s&&t.deleteShader(s))}setup(){const t=this.gl;if(this.vs=t.createShader(t.VERTEX_SHADER),this.fs=t.createShader(t.FRAGMENT_SHADER),!this.vs||!this.fs)throw new Error("Failed to create shaders");if(this.compile(this.vs,this.vertexSrc),this.compile(this.fs,this.shaderSource),this.program=t.createProgram(),!this.program)throw new Error("Failed to create program");t.attachShader(this.program,this.vs),t.attachShader(this.program,this.fs),t.linkProgram(this.program)}init(){const{gl:t,program:n}=this;if(!n)throw new Error("Program not initialized");this.buffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.buffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.vertices),t.STATIC_DRAW);const r=t.getAttribLocation(n,"position");t.enableVertexAttribArray(r),t.vertexAttribPointer(r,2,t.FLOAT,!1,0,0),n.resolution=t.getUniformLocation(n,"resolution"),n.time=t.getUniformLocation(n,"time"),n.touch=t.getUniformLocation(n,"touch"),n.pointerCount=t.getUniformLocation(n,"pointerCount"),n.pointers=t.getUniformLocation(n,"pointers")}render(t=0){const{gl:n,program:r,buffer:s,canvas:i,mouseCoords:o,pointerCoords:l,nbrOfPointers:c}=this;!r||!s||(n.clearColor(0,0,0,1),n.clear(n.COLOR_BUFFER_BIT),n.useProgram(r),n.bindBuffer(n.ARRAY_BUFFER,s),n.uniform2f(r.resolution,i.width,i.height),n.uniform1f(r.time,t*.001),n.uniform2f(r.touch,...o),n.uniform1i(r.pointerCount,c),n.uniform2fv(r.pointers,l),n.drawArrays(n.TRIANGLE_STRIP,0,4))}}class ife{constructor(t,n){this.scale=n,this.active=!1,this.pointers=new Map,this.lastCoords=[0,0];const r=(s,i,o,l)=>[o*i,s.height-l*i];t.addEventListener("pointerdown",s=>{this.active=!0,this.pointers.set(s.pointerId,r(t,this.scale,s.clientX,s.clientY))}),t.addEventListener("pointerup",s=>{this.count===1&&(this.lastCoords=this.first),this.pointers.delete(s.pointerId),this.active=this.pointers.size>0}),t.addEventListener("pointerleave",s=>{this.count===1&&(this.lastCoords=this.first),this.pointers.delete(s.pointerId),this.active=this.pointers.size>0}),t.addEventListener("pointermove",s=>{this.active&&(this.lastCoords=[s.clientX,s.clientY],this.pointers.set(s.pointerId,r(t,this.scale,s.clientX,s.clientY)))})}get count(){return this.pointers.size}get coords(){return this.pointers.size>0?Array.from(this.pointers.values()).flat():[0,0]}get first(){return this.pointers.values().next().value||this.lastCoords}}async function afe(){if("serviceWorker"in navigator)try{const e=await navigator.serviceWorker.register("/sw.js",{scope:"/"});return console.log("[PWA] Service Worker registered successfully:",e.scope),setInterval(()=>{e.update()},60*60*1e3),e.addEventListener("updatefound",()=>{const t=e.installing;t&&t.addEventListener("statechange",()=>{t.state==="installed"&&navigator.serviceWorker.controller&&console.log("[PWA] New content available, please refresh")})}),e}catch(e){console.error("[PWA] Service Worker registration failed:",e)}else console.log("[PWA] Service Workers are not supported")}var fN;(function(e){e.General="General",e.ParentalGuidance="ParentalGuidance",e.Teen="Teen",e.MatureAudience="MatureAudience"})(fN||(fN={}));var pN;(function(e){e.SizeChanged="bannerAdSizeChanged",e.Loaded="bannerAdLoaded",e.FailedToLoad="bannerAdFailedToLoad",e.Opened="bannerAdOpened",e.Closed="bannerAdClosed",e.AdImpression="bannerAdImpression"})(pN||(pN={}));var mN;(function(e){e.TOP_CENTER="TOP_CENTER",e.CENTER="CENTER",e.BOTTOM_CENTER="BOTTOM_CENTER"})(mN||(mN={}));var gN;(function(e){e.BANNER="BANNER",e.FULL_BANNER="FULL_BANNER",e.LARGE_BANNER="LARGE_BANNER",e.MEDIUM_RECTANGLE="MEDIUM_RECTANGLE",e.LEADERBOARD="LEADERBOARD",e.ADAPTIVE_BANNER="ADAPTIVE_BANNER",e.SMART_BANNER="SMART_BANNER"})(gN||(gN={}));var vN;(function(e){e.Loaded="interstitialAdLoaded",e.FailedToLoad="interstitialAdFailedToLoad",e.Showed="interstitialAdShowed",e.FailedToShow="interstitialAdFailedToShow",e.Dismissed="interstitialAdDismissed"})(vN||(vN={}));var yN;(function(e){e.Loaded="onRewardedInterstitialAdLoaded",e.FailedToLoad="onRewardedInterstitialAdFailedToLoad",e.Showed="onRewardedInterstitialAdShowed",e.FailedToShow="onRewardedInterstitialAdFailedToShow",e.Dismissed="onRewardedInterstitialAdDismissed",e.Rewarded="onRewardedInterstitialAdReward"})(yN||(yN={}));var xN;(function(e){e.Loaded="onRewardedVideoAdLoaded",e.FailedToLoad="onRewardedVideoAdFailedToLoad",e.Showed="onRewardedVideoAdShowed",e.FailedToShow="onRewardedVideoAdFailedToShow",e.Dismissed="onRewardedVideoAdDismissed",e.Rewarded="onRewardedVideoAdReward"})(xN||(xN={}));var bN;(function(e){e.NOT_REQUIRED="NOT_REQUIRED",e.OBTAINED="OBTAINED",e.REQUIRED="REQUIRED",e.UNKNOWN="UNKNOWN"})(bN||(bN={}));var wN;(function(e){e[e.DISABLED=0]="DISABLED",e[e.EEA=1]="EEA",e[e.NOT_EEA=2]="NOT_EEA",e[e.US=3]="US",e[e.OTHER=4]="OTHER"})(wN||(wN={}));const ofe=kf("AdMob",{web:()=>m0(()=>import("./web-Ofn_WQah.js"),[]).then(e=>new e.AdMobWeb)}),lfe=Ol.isNativePlatform(),cfe={testMode:!0,appId:"ca-app-pub-3940256099942544~3347511713",bannerId:"ca-app-pub-3940256099942544/6300978111",rewardedId:"ca-app-pub-3940256099942544/5224354917",interstitialId:"ca-app-pub-3940256099942544/1033173712"},dfe=async()=>{if(!lfe){console.log("AdMob is only available on native platforms");return}try{await ofe.initialize({testingDevices:["YOUR_TEST_DEVICE_ID"],initializeForTesting:cfe.testMode}),console.log("AdMob initialized successfully")}catch(e){console.error("Failed to initialize AdMob:",e)}};function ufe({isVisible:e,onClose:t}){const[n,r]=p.useState(()=>{const b=localStorage.getItem("voice-overlay-position");return b?JSON.parse(b):{x:window.innerWidth-320,y:20}}),[s,i]=p.useState(()=>localStorage.getItem("voice-overlay-minimized")==="true"),[o,l]=p.useState(!1),c=p.useRef({x:0,y:0}),d=p.useRef(null),u=pk(),h=pr(Zs),f=pr(Kd),m=pr(ok),g=f.find(b=>b.isLocal),v=f.filter(b=>!b.isLocal),x=Ol.isNativePlatform();p.useEffect(()=>{if(x&&e&&h){const b=v.map(w=>({name:w.name||"User",isSpeaking:!!w.audioTrack}));qi.updateParticipants({participants:b}).catch(console.error)}},[v,e,h,x]),p.useEffect(()=>{x&&e&&qi.updateMicState({isMuted:!m}).catch(console.error)},[m,e,x]),p.useEffect(()=>{localStorage.setItem("voice-overlay-position",JSON.stringify(n))},[n]),p.useEffect(()=>{localStorage.setItem("voice-overlay-minimized",s.toString())},[s]),p.useEffect(()=>{if(!o)return;const b=C=>{r({x:Math.max(0,Math.min(window.innerWidth-(s?200:300),C.clientX-c.current.x)),y:Math.max(0,Math.min(window.innerHeight-(s?60:200),C.clientY-c.current.y))})},w=()=>{l(!1)};return document.addEventListener("mousemove",b),document.addEventListener("mouseup",w),()=>{document.removeEventListener("mousemove",b),document.removeEventListener("mouseup",w)}},[o,s]);const S=b=>{if(d.current){const w=d.current.getBoundingClientRect();c.current={x:b.clientX-w.left,y:b.clientY-w.top},l(!0)}},y=async()=>{h&&await u.setLocalAudioEnabled(!m)};return e?a.jsxs("div",{ref:d,className:be("fixed z-[9999] bg-card border border-border rounded-lg shadow-2xl transition-all",o?"cursor-grabbing":"cursor-default"),style:{left:`${n.x}px`,top:`${n.y}px`,width:s?"200px":"300px"},"data-testid":"floating-voice-overlay",children:[a.jsxs("div",{className:be("flex items-center justify-between p-3 border-b bg-muted/50 rounded-t-lg",!s&&"cursor-grab active:cursor-grabbing"),onMouseDown:s?void 0:S,children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(rw,{className:"h-4 w-4 text-muted-foreground"}),a.jsx("span",{className:"text-sm font-medium",children:"Voice Channel"}),h&&a.jsx($e,{variant:"default",className:"h-5 px-1.5 text-xs",children:"Live"})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(ee,{size:"icon",variant:"ghost",className:"h-6 w-6",onClick:()=>i(!s),"data-testid":"button-minimize-overlay",children:s?a.jsx(UD,{className:"h-3 w-3"}):a.jsx(BD,{className:"h-3 w-3"})}),a.jsx(ee,{size:"icon",variant:"ghost",className:"h-6 w-6",onClick:t,"data-testid":"button-close-overlay",children:a.jsx(Ot,{className:"h-3 w-3"})})]})]}),!s&&a.jsx("div",{className:"p-3 space-y-3 max-h-[400px] overflow-y-auto",children:h?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("h4",{className:"text-xs font-semibold text-muted-foreground uppercase",children:"You"}),g&&a.jsxs("div",{className:"flex items-center gap-2 p-2 bg-muted rounded-md",children:[a.jsx(Tn,{className:"h-8 w-8",children:a.jsx(Cn,{children:(g.name||"U").charAt(0).toUpperCase()})}),a.jsx("span",{className:"text-sm flex-1 truncate",children:g.name||"You"}),a.jsx(ee,{size:"icon",variant:m?"default":"destructive",className:"h-7 w-7 shrink-0",onClick:y,"data-testid":"button-toggle-mic-overlay",children:m?a.jsx(wd,{className:"h-3 w-3"}):a.jsx(xl,{className:"h-3 w-3"})})]})]}),v.length>0&&a.jsxs("div",{className:"space-y-2",children:[a.jsxs("h4",{className:"text-xs font-semibold text-muted-foreground uppercase",children:["In Channel (",v.length,")"]}),a.jsx("div",{className:"space-y-1",children:v.map(b=>a.jsxs("div",{className:"flex items-center gap-2 p-2 bg-muted/50 rounded-md","data-testid":`participant-${b.id}`,children:[a.jsx(Tn,{className:"h-7 w-7",children:a.jsx(Cn,{children:(b.name||"U").charAt(0).toUpperCase()})}),a.jsx("span",{className:"text-sm flex-1 truncate",children:b.name||"User"}),a.jsx("div",{className:"shrink-0",children:b.audioTrack?a.jsx(N0,{className:"h-3 w-3 text-green-500"}):a.jsx(xl,{className:"h-3 w-3 text-muted-foreground"})})]},b.id))})]})]}):a.jsxs("div",{className:"text-center py-6",children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"Not in a voice channel"}),a.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Join a voice call to see controls here"})]})}),s&&a.jsxs("div",{className:"p-2 flex items-center justify-center gap-2 cursor-grab active:cursor-grabbing",onMouseDown:S,children:[a.jsx($e,{variant:h?"default":"secondary",className:"text-xs",children:h?`${v.length+1} in call`:"Not connected"}),h&&g&&a.jsx(ee,{size:"icon",variant:m?"default":"destructive",className:"h-7 w-7",onClick:y,"data-testid":"button-toggle-mic-minimized",children:m?a.jsx(wd,{className:"h-3 w-3"}):a.jsx(xl,{className:"h-3 w-3"})})]})]}):null}function Ra(e){return{id:e.id,gamertag:e.gamertag||"",firstName:e.firstName??void 0,lastName:e.lastName??void 0,profileImageUrl:e.profileImageUrl??void 0,bio:e.bio??void 0,location:e.location??void 0,latitude:e.latitude??void 0,longitude:e.longitude??void 0,age:e.age??void 0,preferredGames:e.preferredGames??void 0}}function hfe(){const{user:e,isLoading:t,isFetching:n,isAuthenticated:r}=mk(),{getContainerClass:s}=Ri(),[i,o]=Jl(),l=N=>({"/":"home","/discover":"search","/connections":"connections","/messages":"messages","/voice-channels":"voice-channels","/profile":"profile","/settings":"settings","/profile-setup":"profile-setup"})[N]||"home",[c,d]=p.useState(()=>l(i)),[u,h]=p.useState(!1),[f,m]=p.useState(!1),g=N=>{const O={home:"/",search:"/discover",connections:"/connections",messages:"/messages","voice-channels":"/voice-channels",profile:"/profile",settings:"/settings","profile-setup":"/profile-setup"};if(O[N]){const G=O[N];i!==G&&o(G)}d(N),h(!1)};if(p.useEffect(()=>{const N=l(i);N!==c&&d(N)},[i,c]),p.useEffect(()=>{r&&e&&!e.gamertag&&c!=="profile-setup"&&o("/profile-setup")},[r,e,c]),t||n&&!r)return a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary mx-auto"}),a.jsx("p",{className:"mt-4 text-muted-foreground",children:"Loading..."})]})});const v=()=>{m(!0)},x=()=>{ze.invalidateQueries({queryKey:["/api/auth/user"]}),m(!1);const N=sessionStorage.getItem("pendingInviteCode");N&&o(`/join-channel/${N}`)},S=async()=>{try{const N=await fetch(lt("/api/logout"),{method:"GET",credentials:"include"});window.location.href="/"}catch(N){console.error("Logout error:",N),window.location.href="/"}},y=()=>{h(!0)},b=()=>{h(!1)},w=async N=>{try{const O=await fetch(lt("/api/match-requests"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(N)});if(!O.ok)throw new Error("Failed to create match request");const G=await O.json();console.log("Match request created successfully:",G),h(!1)}catch(O){console.error("Error creating match request:",O)}},C=async(N,O)=>{try{const G=await fetch(lt("/api/match-connections"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({requestId:N,accepterId:O})});if(!G.ok){const re=await G.json();throw new Error(re.message||"Failed to apply to match")}const H=await G.json();console.log("Match application sent successfully:",H),ze.invalidateQueries({queryKey:["/api/match-requests"]}),ze.invalidateQueries({queryKey:["/api/user/connections"]})}catch(G){console.error("Error applying to match:",G)}},I=async N=>{try{const O=await fetch(lt("/api/hidden-matches"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({matchRequestId:N})});if(!O.ok){const G=await O.json();throw new Error(G.message||"Failed to hide match request")}console.log("Match request hidden successfully"),ze.invalidateQueries({queryKey:["/api/hidden-matches"]}),ze.invalidateQueries({queryKey:["/api/match-requests"]})}catch(O){console.error("Error hiding match request:",O)}},R=async N=>{try{const O=await fetch(lt(`/api/match-requests/${N}`),{method:"DELETE",credentials:"include"});if(!O.ok){const G=await O.json();throw new Error(G.message||"Failed to delete match request")}console.log("Match request deleted successfully"),ze.invalidateQueries({queryKey:["/api/match-requests"]})}catch(O){console.error("Error deleting match request:",O)}},L=()=>{if(u)return a.jsx("div",{className:"md:ml-20 pt-16 md:pt-6 pb-16 md:pb-6 px-4",children:a.jsx(Uue,{onSubmit:w,onCancel:b})});switch(c){case"home":return a.jsxs("div",{className:"md:ml-20 pt-16 md:pt-6 pb-16 md:pb-6 px-4",children:[a.jsx(Phe,{}),a.jsx(dN,{onCreateMatch:y,onAcceptMatch:C,onDeclineMatch:I,onDeleteMatch:R,currentUserId:e==null?void 0:e.id})]});case"profile":return a.jsx("div",{className:"md:ml-20 pt-16 md:pt-6 pb-16 md:pb-6 px-4",children:a.jsxs("div",{className:`${s()} mx-auto`,children:[a.jsx("h1",{className:"text-2xl font-bold text-foreground mb-6",children:"My Profile"}),e&&e.gamertag&&a.jsx(NT,{...Ra(e),isOwn:!0,onEdit:()=>g("profile-setup")}),e&&!e.gamertag&&a.jsxs("div",{className:"p-6 bg-card rounded-lg border",children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Complete Your Profile"}),a.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"You need to set up your gamertag and profile to use the matchmaking system."}),a.jsx("button",{onClick:()=>g("profile-setup"),className:"bg-primary text-primary-foreground px-4 py-2 rounded-md hover:bg-primary/90","data-testid":"button-setup-profile",children:"Setup Profile"})]})]})});case"connections":return a.jsx("div",{className:"md:ml-20 pt-16 md:pt-6 pb-16 md:pb-6 px-4",children:a.jsx(che,{currentUserId:e==null?void 0:e.id})});case"search":return a.jsx("div",{className:"md:ml-20 pt-16 md:pt-6 pb-16 md:pb-6 px-4",children:a.jsx(mhe,{currentUserId:e==null?void 0:e.id})});case"messages":return a.jsx("div",{className:"md:ml-20 pt-16 md:pt-6 pb-16 md:pb-6 px-4",children:a.jsx(dhe,{currentUserId:e==null?void 0:e.id,onNavigateToVoiceChannels:()=>g("voice-channels")})});case"voice-channels":return a.jsx("div",{className:"md:ml-20 pt-16 md:pt-6 pb-16 md:pb-6 px-4",children:a.jsx(Xhe,{currentUserId:e==null?void 0:e.id})});case"settings":return a.jsx("div",{className:"md:ml-20 pt-16 md:pt-6 pb-16 md:pb-6 px-4",children:a.jsx(Vhe,{user:e})});case"profile-setup":return a.jsx("div",{className:"md:ml-20 pt-16 md:pt-6 pb-16 md:pb-6 px-4",children:a.jsx(Bue,{user:e,onComplete:()=>{g("profile")},onCancel:()=>{g(e!=null&&e.gamertag?"profile":"home")}})});default:return a.jsx("div",{className:"md:ml-20 pt-16 md:pt-6 pb-16 md:pb-6 px-4",children:a.jsx(dN,{onCreateMatch:y,onAcceptMatch:C,onDeclineMatch:I,onDeleteMatch:R,currentUserId:e==null?void 0:e.id})})}};return a.jsxs(LW,{children:[a.jsx(Ls,{path:"/join-channel/:inviteCode",children:()=>a.jsx("div",{className:"min-h-screen relative",children:a.jsx(Zhe,{})})}),!r&&!t?a.jsx(Ls,{path:"/",component:()=>f?a.jsx(Ure,{onAuthSuccess:x}):a.jsx(eX,{onShowAuth:v})}):r?a.jsxs(a.Fragment,{children:[a.jsx(Ls,{path:"/connections",children:()=>(c!=="connections"&&d("connections"),a.jsxs("div",{className:"min-h-screen relative",children:[e&&e.gamertag&&a.jsx(Ko,{currentPage:c,onNavigate:g,user:Ra(e),onLogout:S}),a.jsx("div",{className:"relative z-10",children:L()})]}))}),a.jsx(Ls,{path:"/voice-channels",children:()=>(c!=="voice-channels"&&d("voice-channels"),a.jsxs("div",{className:"min-h-screen relative",children:[e&&e.gamertag&&a.jsx(Ko,{currentPage:c,onNavigate:g,user:Ra(e),onLogout:S}),a.jsx("div",{className:"relative z-10",children:L()})]}))}),a.jsx(Ls,{path:"/messages",children:()=>(c!=="messages"&&d("messages"),a.jsxs("div",{className:"min-h-screen relative",children:[e&&e.gamertag&&a.jsx(Ko,{currentPage:c,onNavigate:g,user:Ra(e),onLogout:S}),a.jsx("div",{className:"relative z-10",children:L()})]}))}),a.jsx(Ls,{path:"/profile-setup",children:()=>(c!=="profile-setup"&&d("profile-setup"),a.jsx("div",{className:"min-h-screen relative",children:a.jsx("div",{className:"relative z-10",children:L()})}))}),a.jsx(Ls,{path:"/discover",children:()=>(c!=="search"&&d("search"),a.jsxs("div",{className:"min-h-screen relative",children:[e&&e.gamertag&&a.jsx(Ko,{currentPage:c,onNavigate:g,user:Ra(e),onLogout:S}),a.jsx("div",{className:"relative z-10",children:L()})]}))}),a.jsx(Ls,{path:"/profile",children:()=>(c!=="profile"&&d("profile"),a.jsxs("div",{className:"min-h-screen relative",children:[e&&e.gamertag&&a.jsx(Ko,{currentPage:c,onNavigate:g,user:Ra(e),onLogout:S}),a.jsx("div",{className:"relative z-10",children:L()})]}))}),a.jsx(Ls,{path:"/settings",children:()=>(c!=="settings"&&d("settings"),a.jsxs("div",{className:"min-h-screen relative",children:[e&&e.gamertag&&a.jsx(Ko,{currentPage:c,onNavigate:g,user:Ra(e),onLogout:S}),a.jsx("div",{className:"relative z-10",children:L()})]}))}),a.jsx(Ls,{path:"/",children:()=>(c!=="home"&&d("home"),a.jsxs("div",{className:"min-h-screen relative",children:[e&&e.gamertag&&a.jsx(Ko,{currentPage:c,onNavigate:g,user:Ra(e),onLogout:S}),a.jsx("div",{className:"relative z-10",children:L()})]}))})]}):null,a.jsx(Ls,{component:efe})]})}function ffe(){const{background:e}=V0();return e==="webgl"?a.jsx(rfe,{}):e==="solid"?a.jsx("div",{className:"fixed inset-0 bg-background -z-10 pointer-events-none"}):a.jsx(tfe,{})}function pfe(){const[,e]=Jl(),[t,n]=p.useState(()=>localStorage.getItem("voice-overlay-enabled")==="true");p.useEffect(()=>{afe(),dfe()},[]),p.useEffect(()=>CB(i=>{n(i)}),[]),p.useEffect(()=>{var i;const s=o=>{if(o.data&&o.data.type==="NAVIGATE"){const{url:l}=o.data;e(l)}};return(i=navigator.serviceWorker)==null||i.addEventListener("message",s),()=>{var o;(o=navigator.serviceWorker)==null||o.removeEventListener("message",s)}},[e]);const r=async()=>{await(await m0(async()=>{const{default:i}=await Promise.resolve().then(()=>Ohe);return{default:i}},void 0)).default.disableOverlay()};return a.jsx(oH,{client:ze,children:a.jsx(KY,{children:a.jsx(m7,{defaultTheme:"dark",storageKey:"gamematch-ui-theme",children:a.jsx(v7,{children:a.jsx(y7,{children:a.jsxs(h7,{children:[a.jsx(ffe,{}),a.jsx(hfe,{}),a.jsx(Eq,{}),a.jsx(ufe,{isVisible:t,onClose:r})]})})})})})})}class mfe extends xe.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,n){console.error("React Error Boundary caught an error:",t,n)}render(){var t,n;return this.state.hasError?a.jsxs("div",{style:{padding:"20px",textAlign:"center",fontFamily:"system-ui",backgroundColor:"#1a1a1a",color:"#fff",minHeight:"100vh",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[a.jsx("h1",{style:{color:"#ef4444"},children:"Something went wrong"}),a.jsx("p",{style:{marginTop:"10px",color:"#9ca3af"},children:((t=this.state.error)==null?void 0:t.message)||"Unknown error"}),a.jsx("pre",{style:{marginTop:"20px",padding:"15px",backgroundColor:"#262626",borderRadius:"8px",overflow:"auto",maxWidth:"90%",textAlign:"left",fontSize:"12px"},children:(n=this.state.error)==null?void 0:n.stack}),a.jsx("button",{onClick:()=>window.location.reload(),style:{marginTop:"20px",padding:"10px 20px",backgroundColor:"#6366f1",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"16px"},children:"Reload Page"})]}):this.props.children}}window.addEventListener("error",e=>{console.error("Global error:",e.error)});window.addEventListener("unhandledrejection",e=>{console.error("Unhandled promise rejection:",e.reason)});try{const e=document.getElementById("root");if(!e)throw new Error("Root element not found");$M(e).render(a.jsx(mfe,{children:a.jsx(pfe,{})}))}catch(e){console.error("Failed to initialize app:",e),document.body.innerHTML=`
    <div style="padding: 20px; text-align: center; font-family: system-ui;">
      <h1 style="color: red;">Failed to initialize app</h1>
      <p>${e instanceof Error?e.message:"Unknown error"}</p>
    </div>
  `}export{vte as A,Dfe as B,Hfe as C,Gfe as D,tc as E,Ua as F,Ba as G,qfe as H,Wfe as I,$te as J,ya as K,$fe as L,rP as M,dne as N,dm as O,F_ as P,zF as Q,gne as R,Xte as S,za as T,bN as U,N2 as W,_fe as a,Efe as b,Pfe as c,Bfe as d,Kfe as e,jfe as f,fre as g,Va as h,Afe as i,Vfe as j,Cfe as k,zfe as l,Ife as m,L_ as n,Ufe as o,Sfe as p,Tfe as q,Wee as r,Mfe as s,Nfe as t,Rfe as u,yne as v,kfe as w,Lfe as x,Ffe as y,Ofe as z};
